/*!
*  filename: ej2-dropdowns.umd.min.js.map
*  version : 15.4.17
*  Copyright Syncfusion Inc. 2001 - 2017. All rights reserved.
*  Use of this code is subject to the terms of our license.
*  A copy of the current license can be obtained at any time by e-mailing
*  licensing@syncfusion.com. Any infringement will be prosecuted under
*  applicable laws. 
*/

{"version":3,"sources":["ej2-dropdowns.umd.js"],"names":["root","factory","exports","module","require","define","amd","a","i","this","__WEBPACK_EXTERNAL_MODULE_6__","__WEBPACK_EXTERNAL_MODULE_7__","__WEBPACK_EXTERNAL_MODULE_8__","__WEBPACK_EXTERNAL_MODULE_11__","__WEBPACK_EXTERNAL_MODULE_12__","modules","__webpack_require__","moduleId","installedModules","id","loaded","call","m","c","p","__WEBPACK_AMD_DEFINE_ARRAY__","__WEBPACK_AMD_DEFINE_RESULT__","undefined","index_1","index_2","index_3","index_4","index_5","index_6","__export","hasOwnProperty","Object","defineProperty","value","apply","incremental_search_1","highlight_search_1","incrementalSearch","keyCode","items","selectedIndex","ignoreCase","queryString","String","fromCharCode","setTimeout","index","toLowerCase","prevString","matches","length","classList","contains","activeClass","listItems","strLength","text","item","innerText","substr","push","Search","inputVal","searchType","itemData","queryStr","toLocaleLowerCase","itemsData","textContent","replace","highlightSearch","content","query","type","revert","ignoreRegex","test","replaceQuery","pattern","RegExp","li","querySelectorAll","element","innerHTML","contentElement","parent_1","parentNode","document","createTextNode","replaceChild","drop_down_base_1","__extends","extendStatics","setPrototypeOf","__proto__","Array","d","b","__","constructor","prototype","create","__decorate","decorators","target","key","desc","arguments","r","getOwnPropertyDescriptor","Reflect","decorate","ej2_base_1","ej2_base_2","ej2_base_3","ej2_data_1","ej2_lists_1","SPINNER_SIZE","Browser","isDevice","dropDownBaseClasses","rtl","selected","hover","noData","fixedHead","focus","cssClass","group","disabled","grouping","DropDownBase","_super","options","_this","scrollTimer","enableRtlElements","isRequested","getPropObject","prop","newProp","oldProp","newProperty","oldProperty","propName","Function","data","getValueByText","dataSource","listData","fields","typeOfData","typeof","_i","dataSource_1","isNullOrUndefined","toString","getFormattedValue","filter","_a","dataSource_2","l10nUpdate","actionFailure","noRecordsTemplate","actionFailureTemplate","template","compiledString","list","compile","appendChild","l10nLocale","l10n","L10n","locale","getConstant","getTextByValue","dataSource_3","parseInt","setEnableRtl","enableRtl","addClass","removeClass","initialize","bindEvent","tagName","jsonElement","ListBase","createJsonFromElement","setProperties","resetList","renderItemsBySelect","setListData","getPersistData","addOnPersist","setEnabled","enabled","setAttribute","option","getJSONfromOption","optionGroup","label","isHeader","child","options_1","json","getAttribute","preRender","ulElement","isActive","showSpinner","DataManager","trigger","executeQuery","getQuery","then","e","result","renderItems","onActionComplete","hideSpinner","catch","onActionFailure","dataManager","executeLocal","liCollections","querySelector","postRender","listElement","focusItem","selectedItem","remove","groupTemplate","renderGroupTemplate","Query","listEle","groupBy","headerItems","createListItems","groupDataSource","getSortedDataSource","iconCss","showIcon","ariaAttributes","groupItemRole","createList","setFloatingHeader","fixedHeaderElement","createElement","className","style","display","prepend","setFixedHeader","scrollStop","liHeight","getComputedStyle","getPropertyValue","topIndex","Math","round","scrollTop","currentLi","itemTemplate","sortOrder","renderContentTemplate","parentElement","liWidth","offsetWidth","width","setStyleAttribute","zIndex","firstLi","textField","getDataSource","addSorting","getIndexByValue","getItems","dispatchEvent","evt","createEvent","initEvent","setFields","updateSelection","renderList","render","onPropertyChanged","keys","isEmptyData","attrs","tabindex","add","rippleModel","duration","selector","rippleFun","rippleEffect","EventHandler","getModuleName","wrapperElement","insertBefore","addItem","itemIndex","itemsCount","selectedItemValue","updateActionCompleteData","append","tempLi","slice","splice","getDataByValue","_b","_c","destroy","body","detach","Component","Property","Event","NotifyPropertyChanges","drop_down_list_1","ej2_base_4","ej2_popups_1","ej2_inputs_1","dropDownListClasses","disable","base","input","inputFocus","icon","iconAnimation","device","backIcon","filterBarClearIcon","filterInput","filterParent","mobileFilter","footer","header","clearIcon","clearIconHide","popupFullScreen","disableIcon","inputObject","container","buttons","DropDownList","isPopupOpen","isDocumentClick","isInteracted","isFilterFocus","beforePopupOpen","initial","initRemoteRender","isNotSearchList","isTyped","isSelected","preventFocus","preventAutoFill","isValidKey","typedString","isEscapeKey","isPreventBlur","isTabKey","actionCompleteData","isUpdated","prevSelectPoints","isSelectCustom","isDropDownClick","preventAltUp","keyConfigure","tab","enter","escape","end","home","down","up","pageUp","pageDown","open","close","hide","space","opacity","activeIndex","wireListEvents","floatLabelChange","floatLabelType","floatElement","inputWrapper","inputElement","resetHandler","preventDefault","clear","resetFocusElement","removeHover","removeSelection","removeFocus","property","resetSelection","onChangeEvent","allowFiltering","cloneNode","hiddenElement","valueTempElement","setSelection","updateIconState","setHTMLAttributes","htmlAttributes","htmlAttr","setEnable","readonly","dataBind","defaultAttr","indexOf","Input","setPlaceholder","getAriaAttributes","aria-disabled","aria-owns","role","aria-haspopup","aria-expanded","aria-activedescendant","aria-labelledby","popupObj","targetElement","tabIndex","hidePopup","preventTabIndex","getNgDirective","getElementByText","getElementByValue","listItems_1","liItem","initValue","updateValues","setHiddenValue","setValue","showClearButton","onBlur","relatedTarget","currentTarget","isFilterLayout","activeElement","focusOutAction","focusOut","onFocusOut","clearButton","onFocus","wireEvent","dropDownClick","focusIn","onSearch","bindCommonEvent","keyboardModule","KeyboardEvents","keyAction","keyActionHandler","bind","keyConfigs","eventName","bindClearEvent","unBindCommonEvent","onMouseClick","onMouseOver","onMouseLeave","charCode","searchKeyEvent","closest","isValidLI","history","back","closePopup","setHover","hoveredItem","hasAttribute","setScrollPosition","spinnerElement","filterInputObj","createSpinner","preventAction","action","preventHomeEnd","isNavigation","isEditTextBox","isTabAction","focusEle","isSelectFocusItem","nextItem","startIndex","pageUpSelection","getPageCount","pageDownSelection","lastLi","showPopup","focusDropDown","selectCurrentItem","getBoundingClientRect","height","steps","event","previousItem","unWireEvent","unWireListEvents","onDocumentClick","isIE","info","name","activeStateChange","trim","updateSelectedItem","preventSelect","eventArgs","focusedItem","activeItem","dataItem","getItemData","previousValue","selectedLI","valueTemplate","setValueTemplate","previousSibling","attributes","selectedItems","removeAttribute","eve","detachChangeEvent","onFilterUp","searchLists","onFilterDown","getSelectionPoints","removeFillSelection","selection","setSelectionRange","start","abs","selectionStart","selectionEnd","visibility","isFiltering","updateData","focusIndexItem","setSearchBox","popupElement","createInput","properties","placeholder","filterBarPlaceholder","autocomplete","autocorrect","autocapitalize","spellcheck","clearIconElement","clearText","searchKeyModule","onInput","renderPopup","aria-hidden","addNewItem","newElement","value_1","some","highlightedItem","refreshPopup","popupEle","searchBox","listHeight","formatUnit","popupHeight","headerTemplate","footerTemplate","setFooterTemplate","searchBoxHeight","maxHeight","left","offsetValue","getOffsetValue","firstItem","isEmptyList","textIndent","paddingLeft","borderLeftWidth","getFocusElement","createPopup","checkCollision","collision","X","Y","position","setSearchBoxPosition","backIconElement","clickOnBackIcon","scrollParentElements","getScrollableParent","scrollParentElements_1","scrollHandler","listScroll","inputParent","animModel","popup","show","Animation","isCollide","marginTop","popupStyles","borderTop","borderBottom","setPopupPosition","Popup","setWidth","targetType","relateTo","offsetY","offsetX","destroyPopup","window","innerHeight","clearElement","border","popupOffset","lastItem","offsetHeight","offsetTop","count","paddingBottom","popupWidth","parseFloat","scrollBottom","isInitial","currentOffset","nextBottom","nextOffset","paddingTop","boxRange","isPopupButton","blur","delay","scrollableParentElements","scrollableParentElements_1","styles","getUniqueID","selectElement","setOldText","setOldValue","refreshPosition","setReadonly","setCssClass","removeFloating","addFloating","ddlProps","isUndefined","proxy_1","onpopstate","pushState","children","isFocused","forEach","combo_box_1","ComboBox","preventBlur","targetFocus","customValue","allowCustom","valueMuteChange","inputValue","aria-autocomplete","aria-hasPopup","aria-readonly","setHoverList","inlineSearch","isNaN","autofill","setAutoFill","isHover","currentValue","currentFillValue","isAndroidAutoFill","setAutoFillSelection","isAndroid","currentPoints","prevEnd","curEnd","prevStart","curStart","isKeyNavigate","comboProps","isEscape","searchItem","auto_complete_1","AutoComplete","isFiltered","filterQuery","clone","dataType","where","filterType","suggestionCount","take","isDownUpKey","preventDefaultAction","filterAction","minLength","postBackAction","highlight","appendSpan","showPopupButton","button","atcProps","multi_select_1","ej2_base_5","ej2_base_6","FOCUS","HIDE_LIST","CHIP","CHIP_CLOSE","MultiSelect","mainListCollection","scrollFocusStatus","keyDownStatus","enableRTL","state","overAllWrapper","updateHTMLAttribute","popupWrapper","enable","updateReadonly","updateClearButton","overAllClear","componentWrapper","updateCssClass","onPopupShown","focusAtFirstListItem","refreshListItems","addListFocus","focusAtLastListItem","aria-multiselectable","updateListARIA","temp","removelastSelection","elements","chipCollectionWrapper","removeValue","removeChipSelection","updateDelimeter","makeTextBoxEmpty","mainList","mainData","refreshSelection","remoteCustomValue","allowCustomValue","checkForCustomValue","tempQuery","unwireListEvents","setInitialValue","selectAllAction","hideSelectedItem","KeyUp","expandTextbox","checkTextLength","dataUpdater","dataChecks","tempData","JSON","parse","stringify","wrapperClick","mode","updateDelimView","updateValueState","tempValues","removeChipFocus","refreshInputHight","refreshPlaceHolder","searchWrapper","validateValues","newValue","oldValue","sort","newVal","oldVal","getPagingCount","showDelimWrapper","viewWrapper","delimiterWrapper","hideDelimWrapper","size","calcPopupWidth","popupKeyActions","updateAriaAttribute","onKeyDown","altKey","moveByTop","moveByList","selectByKey","escapeAction","moveBy","removeSelectedChip","selectListByKey","initialValueUpdate","showOverAllClear","hideOverAllClear","limit","maximumSelectionLength","updateListSelection","removeListSelection","closePopupOnSelect","selectedElem","nextElementSibling","addChipSelection","previousElementSibling","chipClick","elem","onChipRemove","concat","updateMainList","removeChip","updateChipStatus","element2","addValue","addListSelection","addChip","dispatchSelect","isNotTrigger","initStatus","getChip","closeElements","split","onMobileChipInteraction","chipElem","chipClose","chip","data-value","title","chipContent","mouseIn","mouseOut","overAllHeight","onListMouseDown","ClearAll","windowResize","delim","delimiterChar","newData","mainlist","addListHover","CLOSEICON_CLASS","tempIndex","wrapperleng","remaining","overflowCountTemplate","remainContent","raminElement","remainSize","overAllContainer","paddingRight","selectAllItem","selectAll","DELIMITER_VIEW","multiple","initialUpdate"],"mappings":"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","file":"ej2-dropdowns.umd.min.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"@syncfusion/ej2-base\"), require(\"@syncfusion/ej2-data\"), require(\"@syncfusion/ej2-lists\"), require(\"@syncfusion/ej2-popups\"), require(\"@syncfusion/ej2-inputs\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([\"@syncfusion/ej2-base\", \"@syncfusion/ej2-data\", \"@syncfusion/ej2-lists\", \"@syncfusion/ej2-popups\", \"@syncfusion/ej2-inputs\"], factory);\n\telse {\n\t\tvar a = typeof exports === 'object' ? factory(require(\"@syncfusion/ej2-base\"), require(\"@syncfusion/ej2-data\"), require(\"@syncfusion/ej2-lists\"), require(\"@syncfusion/ej2-popups\"), require(\"@syncfusion/ej2-inputs\")) : factory(root[\"@syncfusion/ej2-base\"], root[\"@syncfusion/ej2-data\"], root[\"@syncfusion/ej2-lists\"], root[\"@syncfusion/ej2-popups\"], root[\"@syncfusion/ej2-inputs\"]);\n\t\tfor(var i in a) (typeof exports === 'object' ? exports : root)[i] = a[i];\n\t}\n})(this, function(__WEBPACK_EXTERNAL_MODULE_6__, __WEBPACK_EXTERNAL_MODULE_7__, __WEBPACK_EXTERNAL_MODULE_8__, __WEBPACK_EXTERNAL_MODULE_11__, __WEBPACK_EXTERNAL_MODULE_12__) {\nreturn /******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId])\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\texports: {},\n/******/ \t\t\tid: moduleId,\n/******/ \t\t\tloaded: false\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.loaded = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"\";\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(0);\n/******/ })\n/************************************************************************/\n/******/ ([\n/* 0 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\tvar __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__, exports, __webpack_require__(1), __webpack_require__(4), __webpack_require__(9), __webpack_require__(13), __webpack_require__(15), __webpack_require__(17)], __WEBPACK_AMD_DEFINE_RESULT__ = function (require, exports, index_1, index_2, index_3, index_4, index_5, index_6) {\n\t    \"use strict\";\n\t    function __export(m) {\n\t        for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\n\t    }\n\t    Object.defineProperty(exports, \"__esModule\", { value: true });\n\t    __export(index_1);\n\t    __export(index_2);\n\t    __export(index_3);\n\t    __export(index_4);\n\t    __export(index_5);\n\t    __export(index_6);\n\t}.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__), __WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));\n\n\n/***/ }),\n/* 1 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\tvar __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__, exports, __webpack_require__(2), __webpack_require__(3)], __WEBPACK_AMD_DEFINE_RESULT__ = function (require, exports, incremental_search_1, highlight_search_1) {\n\t    \"use strict\";\n\t    function __export(m) {\n\t        for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\n\t    }\n\t    Object.defineProperty(exports, \"__esModule\", { value: true });\n\t    __export(incremental_search_1);\n\t    __export(highlight_search_1);\n\t}.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__), __WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));\n\n\n/***/ }),\n/* 2 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\tvar __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__, exports], __WEBPACK_AMD_DEFINE_RESULT__ = function (require, exports) {\n\t    \"use strict\";\n\t    Object.defineProperty(exports, \"__esModule\", { value: true });\n\t    var queryString = '';\n\t    var prevString = '';\n\t    var matches = [];\n\t    var activeClass = 'e-active';\n\t    function incrementalSearch(keyCode, items, selectedIndex, ignoreCase) {\n\t        queryString += String.fromCharCode(keyCode);\n\t        setTimeout(function () { queryString = ''; }, 1000);\n\t        var index;\n\t        queryString = ignoreCase ? queryString.toLowerCase() : queryString;\n\t        if (prevString === queryString) {\n\t            for (var i = 0; i < matches.length; i++) {\n\t                if (matches[i].classList.contains(activeClass)) {\n\t                    index = i;\n\t                    break;\n\t                }\n\t            }\n\t            index = index + 1;\n\t            return matches[index];\n\t        }\n\t        else {\n\t            var listItems = items;\n\t            var strLength = queryString.length;\n\t            var text = void 0;\n\t            var item = void 0;\n\t            selectedIndex = selectedIndex ? selectedIndex + 1 : 0;\n\t            var i = selectedIndex;\n\t            matches = [];\n\t            do {\n\t                if (i === listItems.length) {\n\t                    i = -1;\n\t                }\n\t                i === -1 ? index = 0 : index = i;\n\t                item = listItems[index];\n\t                text = ignoreCase ? item.innerText.toLowerCase() : item.innerText;\n\t                if (text.substr(0, strLength) === queryString) {\n\t                    matches.push(listItems[index]);\n\t                }\n\t                i++;\n\t            } while (i !== selectedIndex);\n\t            prevString = queryString;\n\t            return matches[0];\n\t        }\n\t    }\n\t    exports.incrementalSearch = incrementalSearch;\n\t    function Search(inputVal, items, searchType, ignoreCase) {\n\t        var listItems = items;\n\t        ignoreCase = ignoreCase !== undefined && ignoreCase !== null ? ignoreCase : true;\n\t        var itemData = { item: null, index: null };\n\t        if (inputVal.length) {\n\t            var strLength = inputVal.length;\n\t            var queryStr = ignoreCase ? inputVal.toLocaleLowerCase() : inputVal;\n\t            for (var i = 0, itemsData = listItems; i < itemsData.length; i++) {\n\t                var item = itemsData[i];\n\t                var text = (ignoreCase ? item.textContent.toLocaleLowerCase() : item.textContent).replace(/^\\s+|\\s+$/g, '');\n\t                if ((searchType === 'Equal' && text === queryStr) || (searchType === 'StartsWith' && text.substr(0, strLength) === queryStr)) {\n\t                    itemData.item = item;\n\t                    itemData.index = i;\n\t                    return { item: item, index: i };\n\t                }\n\t            }\n\t            return itemData;\n\t        }\n\t        return itemData;\n\t    }\n\t    exports.Search = Search;\n\t}.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__), __WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));\n\n\n/***/ }),\n/* 3 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\tvar __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__, exports], __WEBPACK_AMD_DEFINE_RESULT__ = function (require, exports) {\n\t    \"use strict\";\n\t    Object.defineProperty(exports, \"__esModule\", { value: true });\n\t    function highlightSearch(content, query, ignoreCase, type) {\n\t        revert(content);\n\t        if (query === '') {\n\t            return;\n\t        }\n\t        else {\n\t            var ignoreRegex = ignoreCase ? 'gim' : 'gm';\n\t            query = /^[a-zA-Z0-9- ]*$/.test(query) ? query : query.replace(/[\\-\\[\\]\\/\\{\\}\\(\\)\\*\\+\\?\\.\\\\\\^\\$\\|]/g, '\\\\$&');\n\t            var replaceQuery = type === 'StartsWith' ? '^(' + query + ')' : type === 'EndsWith' ? '(' + query + ')$' : '(' + query + ')';\n\t            var pattern = new RegExp(replaceQuery, ignoreRegex);\n\t            var li = content.querySelectorAll('ul li');\n\t            for (var i = 0; i < li.length; i++) {\n\t                var element = li[i];\n\t                element.innerHTML = element.innerHTML.replace(pattern, '<span class=\"e-highlight\">$1</span>');\n\t            }\n\t        }\n\t    }\n\t    exports.highlightSearch = highlightSearch;\n\t    function revert(content) {\n\t        var contentElement = content.querySelectorAll('.e-highlight');\n\t        for (var i = contentElement.length - 1; i >= 0; i--) {\n\t            var parent_1 = contentElement[i].parentNode;\n\t            var text = document.createTextNode(contentElement[i].textContent);\n\t            parent_1.replaceChild(text, contentElement[i]);\n\t        }\n\t    }\n\t}.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__), __WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));\n\n\n/***/ }),\n/* 4 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\tvar __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__, exports, __webpack_require__(5)], __WEBPACK_AMD_DEFINE_RESULT__ = function (require, exports, drop_down_base_1) {\n\t    \"use strict\";\n\t    function __export(m) {\n\t        for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\n\t    }\n\t    Object.defineProperty(exports, \"__esModule\", { value: true });\n\t    __export(drop_down_base_1);\n\t}.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__), __WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));\n\n\n/***/ }),\n/* 5 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\tvar __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;var __extends = (this && this.__extends) || (function () {\n\t    var extendStatics = Object.setPrototypeOf ||\n\t        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n\t        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n\t    return function (d, b) {\n\t        extendStatics(d, b);\n\t        function __() { this.constructor = d; }\n\t        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n\t    };\n\t})();\n\tvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n\t    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n\t    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n\t    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n\t    return c > 3 && r && Object.defineProperty(target, key, r), r;\n\t};\n\t!(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__, exports, __webpack_require__(6), __webpack_require__(6), __webpack_require__(6), __webpack_require__(7), __webpack_require__(8)], __WEBPACK_AMD_DEFINE_RESULT__ = function (require, exports, ej2_base_1, ej2_base_2, ej2_base_3, ej2_data_1, ej2_lists_1) {\n\t    \"use strict\";\n\t    Object.defineProperty(exports, \"__esModule\", { value: true });\n\t    exports.SPINNER_SIZE = ej2_base_2.Browser.isDevice ? '16px' : '14px';\n\t    exports.dropDownBaseClasses = {\n\t        root: 'e-dropdownbase',\n\t        rtl: 'e-rtl',\n\t        content: 'e-content',\n\t        selected: 'e-active',\n\t        hover: 'e-hover',\n\t        noData: 'e-nodata',\n\t        fixedHead: 'e-fixed-head',\n\t        focus: 'e-item-focus',\n\t        li: ej2_lists_1.cssClass.li,\n\t        group: ej2_lists_1.cssClass.group,\n\t        disabled: ej2_lists_1.cssClass.disabled,\n\t        grouping: 'e-dd-group'\n\t    };\n\t    var DropDownBase = (function (_super) {\n\t        __extends(DropDownBase, _super);\n\t        function DropDownBase(options, element) {\n\t            var _this = _super.call(this, options, element) || this;\n\t            _this.scrollTimer = -1;\n\t            _this.enableRtlElements = [];\n\t            _this.isRequested = false;\n\t            return _this;\n\t        }\n\t        ;\n\t        DropDownBase.prototype.getPropObject = function (prop, newProp, oldProp) {\n\t            var newProperty = new Object();\n\t            var oldProperty = new Object();\n\t            var propName = new Function('prop', 'return prop');\n\t            newProperty[propName(prop)] = newProp[propName(prop)];\n\t            oldProperty[propName(prop)] = oldProp[propName(prop)];\n\t            var data = new Object();\n\t            data.newProperty = newProperty;\n\t            data.oldProperty = oldProperty;\n\t            return data;\n\t        };\n\t        DropDownBase.prototype.getValueByText = function (text, ignoreCase) {\n\t            var value = null;\n\t            var dataSource = this.listData;\n\t            var fields = this.fields;\n\t            var type = this.typeOfData(dataSource).typeof;\n\t            if (ignoreCase) {\n\t                if (type === 'string' || type === 'number') {\n\t                    for (var _i = 0, dataSource_1 = dataSource; _i < dataSource_1.length; _i++) {\n\t                        var item = dataSource_1[_i];\n\t                        if (!ej2_base_2.isNullOrUndefined(item) && String(item).toLowerCase() === text.toString().toLowerCase()) {\n\t                            value = type === 'string' ? String(item) : this.getFormattedValue(String(item));\n\t                            break;\n\t                        }\n\t                    }\n\t                }\n\t                else {\n\t                    dataSource.filter(function (item) {\n\t                        var itemText = item[fields.text].toString();\n\t                        if (itemText.toLowerCase() === text.toLowerCase()) {\n\t                            value = item[fields.value];\n\t                        }\n\t                    });\n\t                }\n\t            }\n\t            else {\n\t                if (type === 'string' || type === 'number') {\n\t                    for (var _a = 0, dataSource_2 = dataSource; _a < dataSource_2.length; _a++) {\n\t                        var item = dataSource_2[_a];\n\t                        if (!ej2_base_2.isNullOrUndefined(item) && String(item) === text.toString()) {\n\t                            value = type === 'string' ? text : this.getFormattedValue(text);\n\t                            break;\n\t                        }\n\t                    }\n\t                }\n\t                else {\n\t                    dataSource.filter(function (item) {\n\t                        if (item[fields.text] === text) {\n\t                            value = item[fields.value];\n\t                        }\n\t                    });\n\t                }\n\t            }\n\t            return value;\n\t        };\n\t        ;\n\t        DropDownBase.prototype.l10nUpdate = function (actionFailure) {\n\t            if (this.noRecordsTemplate !== 'No Records Found' || this.actionFailureTemplate !== 'The Request Failed') {\n\t                var template = actionFailure ? this.actionFailureTemplate : this.noRecordsTemplate;\n\t                var compiledString = void 0;\n\t                this.list.innerHTML = '';\n\t                compiledString = ej2_base_1.compile(template);\n\t                for (var _i = 0, _a = compiledString({}); _i < _a.length; _i++) {\n\t                    var item = _a[_i];\n\t                    this.list.appendChild(item);\n\t                }\n\t            }\n\t            else {\n\t                var l10nLocale = { noRecordsTemplate: 'No Records Found', actionFailureTemplate: 'The Request Failed' };\n\t                this.l10n = new ej2_base_1.L10n('dropdownlist', l10nLocale, this.locale);\n\t                this.list.innerHTML = actionFailure ?\n\t                    this.l10n.getConstant('actionFailureTemplate') : this.l10n.getConstant('noRecordsTemplate');\n\t            }\n\t        };\n\t        DropDownBase.prototype.getTextByValue = function (value) {\n\t            var text;\n\t            var dataSource = this.listData;\n\t            var fields = this.fields;\n\t            var type = this.typeOfData(dataSource).typeof;\n\t            if (type === 'string' || type === 'number') {\n\t                for (var _i = 0, dataSource_3 = dataSource; _i < dataSource_3.length; _i++) {\n\t                    var item = dataSource_3[_i];\n\t                    if (!ej2_base_2.isNullOrUndefined(item) && item.toString() === value.toString()) {\n\t                        text = item.toString();\n\t                        break;\n\t                    }\n\t                }\n\t            }\n\t            else {\n\t                dataSource.filter(function (item) {\n\t                    if (!ej2_base_2.isNullOrUndefined(item[fields.value]) && item[fields.value].toString() === value.toString()) {\n\t                        text = item[fields.text];\n\t                    }\n\t                });\n\t            }\n\t            return text;\n\t        };\n\t        DropDownBase.prototype.getFormattedValue = function (value) {\n\t            if (this.listData && this.listData.length) {\n\t                var item = this.typeOfData(this.listData);\n\t                if (typeof item.item[this.fields.value ? this.fields.value : 'value'] === 'number'\n\t                    || item.typeof === 'number') {\n\t                    return parseInt(value, 10);\n\t                }\n\t            }\n\t            return value;\n\t        };\n\t        DropDownBase.prototype.setEnableRtl = function () {\n\t            if (this.list) {\n\t                this.enableRtlElements.push(this.list);\n\t            }\n\t            this.enableRtl ? ej2_base_1.addClass(this.enableRtlElements, exports.dropDownBaseClasses.rtl) :\n\t                ej2_base_2.removeClass(this.enableRtlElements, exports.dropDownBaseClasses.rtl);\n\t        };\n\t        ;\n\t        DropDownBase.prototype.initialize = function () {\n\t            this.bindEvent = true;\n\t            if (this.element.tagName === 'UL') {\n\t                var jsonElement = ej2_lists_1.ListBase.createJsonFromElement(this.element);\n\t                this.setProperties({ fields: { text: 'text', value: 'text' } }, true);\n\t                this.resetList(jsonElement, this.fields);\n\t            }\n\t            else if (this.element.tagName === 'SELECT') {\n\t                var dataSource = this.dataSource instanceof Array ? (this.dataSource.length > 0 ? true : false)\n\t                    : !ej2_base_2.isNullOrUndefined(this.dataSource) ? true : false;\n\t                if (!dataSource) {\n\t                    this.renderItemsBySelect();\n\t                }\n\t            }\n\t            else {\n\t                this.setListData(this.dataSource, this.fields, this.query);\n\t            }\n\t        };\n\t        ;\n\t        DropDownBase.prototype.getPersistData = function () {\n\t            return this.addOnPersist([]);\n\t        };\n\t        ;\n\t        DropDownBase.prototype.setEnabled = function () {\n\t            if (this.enabled) {\n\t                this.element.setAttribute('aria-disabled', 'false');\n\t            }\n\t            else {\n\t                this.element.setAttribute('aria-disabled', 'true');\n\t            }\n\t        };\n\t        ;\n\t        DropDownBase.prototype.renderItemsBySelect = function () {\n\t            var element = this.element;\n\t            var fields = { value: 'value', text: 'text' };\n\t            var jsonElement = [];\n\t            var group = element.querySelectorAll('select>optgroup');\n\t            var option = element.querySelectorAll('select>option');\n\t            this.getJSONfromOption(jsonElement, option, fields);\n\t            if (group.length) {\n\t                for (var i = 0; i < group.length; i++) {\n\t                    var item = group[i];\n\t                    var optionGroup = {};\n\t                    optionGroup[fields.text] = item.label;\n\t                    optionGroup.isHeader = true;\n\t                    var child = item.querySelectorAll('option');\n\t                    jsonElement.push(optionGroup);\n\t                    this.getJSONfromOption(jsonElement, child, fields);\n\t                }\n\t                var items = element.querySelectorAll('select>option');\n\t            }\n\t            this.fields.text = fields.text;\n\t            this.fields.value = fields.value;\n\t            this.resetList(jsonElement, fields);\n\t        };\n\t        DropDownBase.prototype.getJSONfromOption = function (items, options, fields) {\n\t            for (var _i = 0, options_1 = options; _i < options_1.length; _i++) {\n\t                var option = options_1[_i];\n\t                var json = {};\n\t                json[fields.text] = option.innerText;\n\t                json[fields.value] = option.getAttribute(fields.value) ? option.getAttribute(fields.value) : option.innerText;\n\t                items.push(json);\n\t            }\n\t        };\n\t        DropDownBase.prototype.preRender = function () {\n\t        };\n\t        DropDownBase.prototype.setListData = function (dataSource, fields, query) {\n\t            var _this = this;\n\t            fields = fields ? fields : this.fields;\n\t            var ulElement;\n\t            this.isActive = true;\n\t            this.showSpinner();\n\t            if (dataSource instanceof ej2_data_1.DataManager) {\n\t                this.isRequested = true;\n\t                this.trigger('actionBegin');\n\t                dataSource.executeQuery(this.getQuery(query)).then(function (e) {\n\t                    _this.trigger('actionComplete', e);\n\t                    var listItems = e.result;\n\t                    ulElement = _this.renderItems(listItems, fields);\n\t                    _this.onActionComplete(ulElement, listItems, e);\n\t                    _this.isRequested = false;\n\t                    _this.hideSpinner();\n\t                }).catch(function (e) {\n\t                    _this.isRequested = false;\n\t                    _this.onActionFailure(e);\n\t                    _this.hideSpinner();\n\t                });\n\t            }\n\t            else {\n\t                var dataManager = new ej2_data_1.DataManager(dataSource);\n\t                var listItems = (this.getQuery(query)).executeLocal(dataManager);\n\t                ulElement = this.renderItems(listItems, fields);\n\t                this.onActionComplete(ulElement, listItems);\n\t                this.hideSpinner();\n\t            }\n\t        };\n\t        DropDownBase.prototype.showSpinner = function () {\n\t        };\n\t        DropDownBase.prototype.hideSpinner = function () {\n\t        };\n\t        DropDownBase.prototype.onActionFailure = function (e) {\n\t            this.liCollections = [];\n\t            this.trigger('actionFailure', e);\n\t            this.l10nUpdate(true);\n\t            ej2_base_1.addClass([this.list], exports.dropDownBaseClasses.noData);\n\t        };\n\t        DropDownBase.prototype.onActionComplete = function (ulElement, list, e) {\n\t            this.listData = list;\n\t            this.list.innerHTML = '';\n\t            this.list.appendChild(ulElement);\n\t            this.liCollections = this.list.querySelectorAll('.' + exports.dropDownBaseClasses.li);\n\t            this.ulElement = this.list.querySelector('ul');\n\t            this.postRender(this.list, list, this.bindEvent);\n\t        };\n\t        DropDownBase.prototype.postRender = function (listElement, list, bindEvent) {\n\t            var focusItem = listElement.querySelector('.' + exports.dropDownBaseClasses.li);\n\t            var selectedItem = listElement.querySelector('.' + exports.dropDownBaseClasses.selected);\n\t            if (focusItem && !selectedItem) {\n\t                ej2_base_1.addClass([focusItem], exports.dropDownBaseClasses.focus);\n\t            }\n\t            if (list.length <= 0) {\n\t                this.l10nUpdate();\n\t                ej2_base_1.addClass([listElement], exports.dropDownBaseClasses.noData);\n\t            }\n\t            else {\n\t                listElement.classList.remove(exports.dropDownBaseClasses.noData);\n\t            }\n\t            if (this.groupTemplate) {\n\t                this.renderGroupTemplate(listElement);\n\t            }\n\t        };\n\t        DropDownBase.prototype.getQuery = function (query) {\n\t            return query ? query : this.query ? this.query : new ej2_data_1.Query();\n\t        };\n\t        DropDownBase.prototype.renderGroupTemplate = function (listEle) {\n\t            if (this.fields.groupBy !== null && this.dataSource || this.element.querySelector('.' + exports.dropDownBaseClasses.group)) {\n\t                var dataSource = this.dataSource;\n\t                var headerItems = listEle.querySelectorAll('.' + exports.dropDownBaseClasses.group);\n\t                var tempHeaders = ej2_lists_1.ListBase.renderGroupTemplate(this.groupTemplate, dataSource, this.fields, headerItems);\n\t            }\n\t        };\n\t        DropDownBase.prototype.createListItems = function (dataSource, fields) {\n\t            if (dataSource && fields.groupBy || this.element.querySelector('optgroup')) {\n\t                if (fields.groupBy) {\n\t                    dataSource = ej2_lists_1.ListBase.groupDataSource(dataSource, fields);\n\t                }\n\t                ej2_base_1.addClass([this.list], exports.dropDownBaseClasses.grouping);\n\t            }\n\t            else {\n\t                dataSource = this.getSortedDataSource(dataSource);\n\t            }\n\t            var iconCss = ej2_base_2.isNullOrUndefined(fields.iconCss) ? false : true;\n\t            var options = (fields.text !== null || fields.value !== null) ? {\n\t                fields: fields, showIcon: iconCss, ariaAttributes: { groupItemRole: 'presentation' }\n\t            } : { fields: { value: 'text' } };\n\t            return ej2_lists_1.ListBase.createList(dataSource, options, true);\n\t        };\n\t        ;\n\t        DropDownBase.prototype.setFloatingHeader = function (e) {\n\t            if (ej2_base_2.isNullOrUndefined(this.fixedHeaderElement)) {\n\t                this.fixedHeaderElement = ej2_base_2.createElement('div', { className: exports.dropDownBaseClasses.fixedHead });\n\t                if (!this.list.querySelector('li').classList.contains(exports.dropDownBaseClasses.group)) {\n\t                    this.fixedHeaderElement.style.display = 'none';\n\t                }\n\t                ej2_base_2.prepend([this.fixedHeaderElement], this.list);\n\t                this.setFixedHeader();\n\t            }\n\t            this.scrollStop(e);\n\t        };\n\t        DropDownBase.prototype.scrollStop = function (e) {\n\t            var target = e.target;\n\t            var liHeight = parseInt(getComputedStyle(this.liCollections[0], null).getPropertyValue('height'), 10);\n\t            var topIndex = Math.round(target.scrollTop / liHeight);\n\t            var liCollections = this.ulElement.querySelectorAll('li');\n\t            for (var i = topIndex; i > -1; i--) {\n\t                if (!ej2_base_2.isNullOrUndefined(liCollections[i]) && liCollections[i].classList.contains(exports.dropDownBaseClasses.group)) {\n\t                    var currentLi = liCollections[i];\n\t                    this.fixedHeaderElement.innerHTML = currentLi.innerHTML;\n\t                    this.fixedHeaderElement.style.display = 'block';\n\t                    break;\n\t                }\n\t                else {\n\t                    this.fixedHeaderElement.style.display = 'none';\n\t                }\n\t            }\n\t        };\n\t        DropDownBase.prototype.renderItems = function (listData, fields) {\n\t            var ulElement;\n\t            if (this.itemTemplate && listData) {\n\t                var dataSource = listData;\n\t                if (dataSource && fields.groupBy) {\n\t                    dataSource = ej2_lists_1.ListBase.groupDataSource(dataSource, fields, this.sortOrder);\n\t                }\n\t                else {\n\t                    dataSource = this.getSortedDataSource(dataSource);\n\t                }\n\t                ulElement = ej2_lists_1.ListBase.renderContentTemplate(this.itemTemplate, dataSource, fields);\n\t            }\n\t            else {\n\t                ulElement = this.createListItems(listData, fields);\n\t            }\n\t            return ulElement;\n\t        };\n\t        ;\n\t        DropDownBase.prototype.typeOfData = function (items) {\n\t            var item = { typeof: null, item: null };\n\t            for (var i = 0; i < items.length; i++) {\n\t                if (!ej2_base_2.isNullOrUndefined(items[i])) {\n\t                    return item = { typeof: typeof items[i], item: items[i] };\n\t                }\n\t            }\n\t            return item;\n\t        };\n\t        DropDownBase.prototype.setFixedHeader = function () {\n\t            this.list.parentElement.style.display = 'block';\n\t            var liWidth = this.liCollections[0].offsetWidth;\n\t            this.fixedHeaderElement.style.width = liWidth.toString() + 'px';\n\t            ej2_base_2.setStyleAttribute(this.fixedHeaderElement, { zIndex: 10 });\n\t            var firstLi = this.ulElement.querySelector('.' + exports.dropDownBaseClasses.group);\n\t            this.fixedHeaderElement.innerHTML = firstLi.innerHTML;\n\t        };\n\t        DropDownBase.prototype.getSortedDataSource = function (dataSource) {\n\t            if (dataSource && this.sortOrder !== 'None') {\n\t                var textField = this.fields.text ? this.fields.text : 'text';\n\t                dataSource = ej2_lists_1.ListBase.getDataSource(dataSource, ej2_lists_1.ListBase.addSorting(this.sortOrder, textField));\n\t            }\n\t            return dataSource;\n\t        };\n\t        DropDownBase.prototype.getIndexByValue = function (value) {\n\t            var index;\n\t            var listItems = this.getItems();\n\t            for (var i = 0; i < listItems.length; i++) {\n\t                if (listItems[i].getAttribute('data-value') === value.toString()) {\n\t                    index = i;\n\t                    break;\n\t                }\n\t            }\n\t            return index;\n\t        };\n\t        ;\n\t        DropDownBase.prototype.dispatchEvent = function (element, type) {\n\t            var evt = document.createEvent('HTMLEvents');\n\t            evt.initEvent(type, false, true);\n\t            element.dispatchEvent(evt);\n\t        };\n\t        DropDownBase.prototype.setFields = function () {\n\t            var fields = this.fields;\n\t            if (this.fields.value && !this.fields.text) {\n\t                this.fields.text = this.fields.value;\n\t            }\n\t            else if (!fields.value && fields.text) {\n\t                this.fields.value = this.fields.text;\n\t            }\n\t            else if (!this.fields.value && !this.fields.text) {\n\t                this.fields.value = this.fields.text = 'text';\n\t            }\n\t        };\n\t        DropDownBase.prototype.resetList = function (dataSource, fields, query) {\n\t            if (this.list) {\n\t                this.setListData(dataSource, fields, query);\n\t            }\n\t        };\n\t        DropDownBase.prototype.updateSelection = function () {\n\t        };\n\t        DropDownBase.prototype.renderList = function () {\n\t            this.render();\n\t        };\n\t        DropDownBase.prototype.onPropertyChanged = function (newProp, oldProp) {\n\t            for (var _i = 0, _a = Object.keys(newProp); _i < _a.length; _i++) {\n\t                var prop = _a[_i];\n\t                switch (prop) {\n\t                    case 'enableRtl':\n\t                        this.setEnableRtl();\n\t                        break;\n\t                    case 'enabled':\n\t                        this.setEnabled();\n\t                        break;\n\t                    case 'query':\n\t                    case 'sortOrder':\n\t                    case 'dataSource':\n\t                    case 'itemTemplate':\n\t                        this.resetList(this.dataSource);\n\t                        break;\n\t                    case 'groupTemplate':\n\t                        this.renderGroupTemplate(this.list);\n\t                        break;\n\t                    case 'locale':\n\t                        if (this.list) {\n\t                            this.l10nUpdate();\n\t                        }\n\t                        break;\n\t                }\n\t            }\n\t        };\n\t        ;\n\t        DropDownBase.prototype.render = function (isEmptyData) {\n\t            this.list = ej2_base_2.createElement('div', { className: exports.dropDownBaseClasses.content, attrs: { 'tabindex': '0' } });\n\t            this.list.classList.add(exports.dropDownBaseClasses.root);\n\t            this.setFields();\n\t            var rippleModel = { duration: 300, selector: '.' + exports.dropDownBaseClasses.li };\n\t            this.rippleFun = ej2_base_3.rippleEffect(this.list, rippleModel);\n\t            var group = this.element.querySelector('select>optgroup');\n\t            if (this.fields.groupBy || !ej2_base_2.isNullOrUndefined(group)) {\n\t                ej2_base_1.EventHandler.add(this.list, 'scroll', this.setFloatingHeader, this);\n\t            }\n\t            if (this.getModuleName() === 'dropdownbase') {\n\t                if (this.element.getAttribute('tabindex')) {\n\t                    this.list.setAttribute('tabindex', this.element.getAttribute('tabindex'));\n\t                }\n\t                ej2_base_2.removeClass([this.element], exports.dropDownBaseClasses.root);\n\t                this.element.style.display = 'none';\n\t                var wrapperElement = document.createElement('div');\n\t                this.element.parentElement.insertBefore(wrapperElement, this.element);\n\t                wrapperElement.appendChild(this.element);\n\t                wrapperElement.appendChild(this.list);\n\t            }\n\t            this.setEnableRtl();\n\t            this.setEnabled();\n\t            if (!isEmptyData) {\n\t                this.initialize();\n\t            }\n\t        };\n\t        ;\n\t        DropDownBase.prototype.getModuleName = function () {\n\t            return 'dropdownbase';\n\t        };\n\t        ;\n\t        DropDownBase.prototype.getItems = function () {\n\t            return this.ulElement.querySelectorAll('.' + exports.dropDownBaseClasses.li);\n\t        };\n\t        ;\n\t        DropDownBase.prototype.addItem = function (items, itemIndex) {\n\t            if (!this.list || this.list.textContent === this.noRecordsTemplate) {\n\t                this.renderList();\n\t            }\n\t            var itemsCount = this.getItems().length;\n\t            var selectedItemValue = this.list.querySelector('.' + exports.dropDownBaseClasses.selected);\n\t            items = items instanceof Array ? items : [items];\n\t            var index;\n\t            index = (ej2_base_2.isNullOrUndefined(itemIndex) || itemIndex < 0 || itemIndex > itemsCount - 1) ? itemsCount : itemIndex;\n\t            var fields = this.fields;\n\t            var liCollections = [];\n\t            for (var i = 0; i < items.length; i++) {\n\t                var item = items[i];\n\t                var li = ej2_base_2.createElement('li', { className: exports.dropDownBaseClasses.li, id: 'option-add-' + i });\n\t                li.setAttribute('data-value', item[fields.value]);\n\t                li.setAttribute('role', 'option');\n\t                li.appendChild(document.createTextNode(item[fields.text]));\n\t                liCollections.push(li);\n\t                this.listData.push(item);\n\t                this.updateActionCompleteData(li, item);\n\t            }\n\t            if (itemsCount === 0 && ej2_base_2.isNullOrUndefined(this.list.querySelector('ul'))) {\n\t                this.list.innerHTML = '';\n\t                this.list.appendChild(this.ulElement);\n\t                ej2_base_1.append(liCollections, this.ulElement);\n\t            }\n\t            else {\n\t                for (var i = 0; i < items.length; i++) {\n\t                    if (this.liCollections[index]) {\n\t                        this.liCollections[index].parentNode.insertBefore(liCollections[i], this.liCollections[index]);\n\t                    }\n\t                    else {\n\t                        this.ulElement.appendChild(liCollections[i]);\n\t                    }\n\t                    var tempLi = [].slice.call(this.liCollections);\n\t                    tempLi.splice(index, 0, liCollections[i]);\n\t                    this.liCollections = tempLi;\n\t                    index += 1;\n\t                }\n\t            }\n\t            if (selectedItemValue || itemIndex === 0) {\n\t                this.updateSelection();\n\t            }\n\t        };\n\t        DropDownBase.prototype.updateActionCompleteData = function (li, item) {\n\t        };\n\t        DropDownBase.prototype.getDataByValue = function (value) {\n\t            var type = this.typeOfData(this.listData).typeof;\n\t            if (type === 'string' || type === 'number') {\n\t                for (var _i = 0, _a = this.listData; _i < _a.length; _i++) {\n\t                    var item = _a[_i];\n\t                    if (!ej2_base_2.isNullOrUndefined(item) && item === value) {\n\t                        return item;\n\t                    }\n\t                }\n\t            }\n\t            else {\n\t                for (var _b = 0, _c = this.listData; _b < _c.length; _b++) {\n\t                    var item = _c[_b];\n\t                    if (!ej2_base_2.isNullOrUndefined(item) && item[this.fields.value ? this.fields.value : 'value'] === value) {\n\t                        return item;\n\t                    }\n\t                }\n\t            }\n\t            return null;\n\t        };\n\t        DropDownBase.prototype.destroy = function () {\n\t            if (document.body.contains(this.list)) {\n\t                ej2_base_1.EventHandler.remove(this.list, 'scroll', this.setFloatingHeader);\n\t                if (!ej2_base_2.isNullOrUndefined(this.rippleFun)) {\n\t                    this.rippleFun();\n\t                }\n\t                ej2_base_2.detach(this.list);\n\t            }\n\t            _super.prototype.destroy.call(this);\n\t        };\n\t        ;\n\t        return DropDownBase;\n\t    }(ej2_base_1.Component));\n\t    __decorate([\n\t        ej2_base_1.Property({ text: null, value: null, iconCss: null, groupBy: null })\n\t    ], DropDownBase.prototype, \"fields\", void 0);\n\t    __decorate([\n\t        ej2_base_1.Property(false)\n\t    ], DropDownBase.prototype, \"enableRtl\", void 0);\n\t    __decorate([\n\t        ej2_base_1.Property(false)\n\t    ], DropDownBase.prototype, \"enablePersistence\", void 0);\n\t    __decorate([\n\t        ej2_base_1.Property(null)\n\t    ], DropDownBase.prototype, \"itemTemplate\", void 0);\n\t    __decorate([\n\t        ej2_base_1.Property(null)\n\t    ], DropDownBase.prototype, \"groupTemplate\", void 0);\n\t    __decorate([\n\t        ej2_base_1.Property('No Records Found')\n\t    ], DropDownBase.prototype, \"noRecordsTemplate\", void 0);\n\t    __decorate([\n\t        ej2_base_1.Property('The Request Failed')\n\t    ], DropDownBase.prototype, \"actionFailureTemplate\", void 0);\n\t    __decorate([\n\t        ej2_base_1.Property('None')\n\t    ], DropDownBase.prototype, \"sortOrder\", void 0);\n\t    __decorate([\n\t        ej2_base_1.Property(true)\n\t    ], DropDownBase.prototype, \"enabled\", void 0);\n\t    __decorate([\n\t        ej2_base_1.Property([])\n\t    ], DropDownBase.prototype, \"dataSource\", void 0);\n\t    __decorate([\n\t        ej2_base_1.Property(null)\n\t    ], DropDownBase.prototype, \"query\", void 0);\n\t    __decorate([\n\t        ej2_base_1.Event()\n\t    ], DropDownBase.prototype, \"actionBegin\", void 0);\n\t    __decorate([\n\t        ej2_base_1.Event()\n\t    ], DropDownBase.prototype, \"actionComplete\", void 0);\n\t    __decorate([\n\t        ej2_base_1.Event()\n\t    ], DropDownBase.prototype, \"actionFailure\", void 0);\n\t    __decorate([\n\t        ej2_base_1.Event()\n\t    ], DropDownBase.prototype, \"select\", void 0);\n\t    DropDownBase = __decorate([\n\t        ej2_base_3.NotifyPropertyChanges\n\t    ], DropDownBase);\n\t    exports.DropDownBase = DropDownBase;\n\t}.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__), __WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));\n\n\n/***/ }),\n/* 6 */\n/***/ (function(module, exports) {\n\n\tmodule.exports = __WEBPACK_EXTERNAL_MODULE_6__;\n\n/***/ }),\n/* 7 */\n/***/ (function(module, exports) {\n\n\tmodule.exports = __WEBPACK_EXTERNAL_MODULE_7__;\n\n/***/ }),\n/* 8 */\n/***/ (function(module, exports) {\n\n\tmodule.exports = __WEBPACK_EXTERNAL_MODULE_8__;\n\n/***/ }),\n/* 9 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\tvar __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__, exports, __webpack_require__(10)], __WEBPACK_AMD_DEFINE_RESULT__ = function (require, exports, drop_down_list_1) {\n\t    \"use strict\";\n\t    function __export(m) {\n\t        for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\n\t    }\n\t    Object.defineProperty(exports, \"__esModule\", { value: true });\n\t    __export(drop_down_list_1);\n\t}.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__), __WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));\n\n\n/***/ }),\n/* 10 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\tvar __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;var __extends = (this && this.__extends) || (function () {\n\t    var extendStatics = Object.setPrototypeOf ||\n\t        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n\t        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n\t    return function (d, b) {\n\t        extendStatics(d, b);\n\t        function __() { this.constructor = d; }\n\t        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n\t    };\n\t})();\n\tvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n\t    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n\t    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n\t    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n\t    return c > 3 && r && Object.defineProperty(target, key, r), r;\n\t};\n\t!(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__, exports, __webpack_require__(6), __webpack_require__(6), __webpack_require__(6), __webpack_require__(6), __webpack_require__(11), __webpack_require__(12), __webpack_require__(2), __webpack_require__(5), __webpack_require__(7)], __WEBPACK_AMD_DEFINE_RESULT__ = function (require, exports, ej2_base_1, ej2_base_2, ej2_base_3, ej2_base_4, ej2_popups_1, ej2_inputs_1, incremental_search_1, drop_down_base_1, ej2_data_1) {\n\t    \"use strict\";\n\t    Object.defineProperty(exports, \"__esModule\", { value: true });\n\t    exports.dropDownListClasses = {\n\t        root: 'e-dropdownlist',\n\t        hover: drop_down_base_1.dropDownBaseClasses.hover,\n\t        selected: drop_down_base_1.dropDownBaseClasses.selected,\n\t        rtl: drop_down_base_1.dropDownBaseClasses.rtl,\n\t        li: drop_down_base_1.dropDownBaseClasses.li,\n\t        disable: drop_down_base_1.dropDownBaseClasses.disabled,\n\t        base: drop_down_base_1.dropDownBaseClasses.root,\n\t        focus: drop_down_base_1.dropDownBaseClasses.focus,\n\t        input: 'e-input-group',\n\t        inputFocus: 'e-input-focus',\n\t        icon: 'e-input-group-icon e-ddl-icon',\n\t        iconAnimation: 'e-icon-anim',\n\t        value: 'e-input-value',\n\t        device: 'e-ddl-device',\n\t        backIcon: 'e-input-group-icon e-back-icon e-icons',\n\t        filterBarClearIcon: 'e-input-group-icon e-clear-icon e-icons',\n\t        filterInput: 'e-input-filter',\n\t        filterParent: 'e-filter-parent',\n\t        mobileFilter: 'e-ddl-device-filter',\n\t        footer: 'e-ddl-footer',\n\t        header: 'e-ddl-header',\n\t        clearIcon: 'e-clear-icon',\n\t        clearIconHide: 'e-clear-icon-hide',\n\t        popupFullScreen: 'e-popup-full-page',\n\t        disableIcon: 'e-ddl-disable-icon'\n\t    };\n\t    var inputObject = {\n\t        container: null,\n\t        buttons: []\n\t    };\n\t    var DropDownList = (function (_super) {\n\t        __extends(DropDownList, _super);\n\t        function DropDownList(options, element) {\n\t            var _this = _super.call(this, options, element) || this;\n\t            _this.isPopupOpen = false;\n\t            _this.isDocumentClick = false;\n\t            _this.isInteracted = false;\n\t            _this.isFilterFocus = false;\n\t            _this.beforePopupOpen = false;\n\t            _this.initial = true;\n\t            _this.initRemoteRender = false;\n\t            _this.isNotSearchList = false;\n\t            _this.isTyped = false;\n\t            _this.isSelected = false;\n\t            _this.preventFocus = false;\n\t            _this.preventAutoFill = false;\n\t            _this.isValidKey = false;\n\t            _this.typedString = '';\n\t            _this.isEscapeKey = false;\n\t            _this.isPreventBlur = false;\n\t            _this.isTabKey = false;\n\t            _this.actionCompleteData = { isUpdated: false };\n\t            _this.prevSelectPoints = {};\n\t            _this.isSelectCustom = false;\n\t            _this.isDropDownClick = false;\n\t            _this.preventAltUp = false;\n\t            _this.keyConfigure = {\n\t                tab: 'tab',\n\t                enter: '13',\n\t                escape: '27',\n\t                end: '35',\n\t                home: '36',\n\t                down: '40',\n\t                up: '38',\n\t                pageUp: '33',\n\t                pageDown: '34',\n\t                open: 'alt+40',\n\t                close: 'shift+tab',\n\t                hide: 'alt+38',\n\t                space: '32'\n\t            };\n\t            return _this;\n\t        }\n\t        ;\n\t        DropDownList.prototype.preRender = function () {\n\t            this.element.style.opacity = '0';\n\t            _super.prototype.preRender.call(this);\n\t            this.activeIndex = this.index;\n\t            this.queryString = '';\n\t        };\n\t        DropDownList.prototype.renderList = function (isEmptyData) {\n\t            _super.prototype.render.call(this, isEmptyData);\n\t            this.wireListEvents();\n\t        };\n\t        DropDownList.prototype.floatLabelChange = function () {\n\t            if (this.getModuleName() === 'dropdownlist' && this.floatLabelType === 'Auto') {\n\t                var floatElement = this.inputWrapper.container.querySelector('.e-float-text');\n\t                if (this.inputElement.value !== '' || this.isInteracted) {\n\t                    ej2_base_4.classList(floatElement, ['e-label-top'], ['e-label-bottom']);\n\t                }\n\t                else {\n\t                    ej2_base_4.classList(floatElement, ['e-label-bottom'], ['e-label-top']);\n\t                }\n\t            }\n\t        };\n\t        DropDownList.prototype.resetHandler = function (e) {\n\t            e.preventDefault();\n\t            this.clear();\n\t        };\n\t        DropDownList.prototype.resetFocusElement = function () {\n\t            this.removeHover();\n\t            this.removeSelection();\n\t            this.removeFocus();\n\t            this.list.scrollTop = 0;\n\t            if (this.getModuleName() !== 'autocomplete') {\n\t                var li = this.ulElement.querySelector('.' + exports.dropDownListClasses.li);\n\t                if (li) {\n\t                    li.classList.add(exports.dropDownListClasses.focus);\n\t                }\n\t            }\n\t        };\n\t        DropDownList.prototype.clear = function (property) {\n\t            this.resetSelection();\n\t            this.onChangeEvent(null);\n\t        };\n\t        DropDownList.prototype.resetSelection = function () {\n\t            if (this.list) {\n\t                if (this.allowFiltering && this.getModuleName() !== 'autocomplete') {\n\t                    this.onActionComplete(this.actionCompleteData.ulElement.cloneNode(true), this.actionCompleteData.list);\n\t                }\n\t                this.resetFocusElement();\n\t            }\n\t            this.hiddenElement.innerHTML = '';\n\t            this.inputElement.value = '';\n\t            this.value = null;\n\t            this.text = null;\n\t            this.index = null;\n\t            this.activeIndex = null;\n\t            this.item = null;\n\t            this.itemData = null;\n\t            this.queryString = '';\n\t            if (this.valueTempElement) {\n\t                ej2_base_4.detach(this.valueTempElement);\n\t                this.inputElement.style.display = 'block';\n\t                this.valueTempElement = null;\n\t            }\n\t            this.setSelection(null, null);\n\t            this.isSelectCustom = false;\n\t            this.updateIconState();\n\t        };\n\t        DropDownList.prototype.setHTMLAttributes = function () {\n\t            if (Object.keys(this.htmlAttributes).length) {\n\t                for (var _i = 0, _a = Object.keys(this.htmlAttributes); _i < _a.length; _i++) {\n\t                    var htmlAttr = _a[_i];\n\t                    if (htmlAttr === 'class') {\n\t                        this.inputWrapper.container.classList.add(this.htmlAttributes[htmlAttr]);\n\t                    }\n\t                    else if (htmlAttr === 'disabled' && this.htmlAttributes[htmlAttr] === 'disabled') {\n\t                        this.enabled = false;\n\t                        this.setEnable();\n\t                    }\n\t                    else if (htmlAttr === 'readonly' && this.htmlAttributes[htmlAttr] === 'readonly') {\n\t                        this.readonly = true;\n\t                        this.dataBind();\n\t                    }\n\t                    else if (htmlAttr === 'style') {\n\t                        this.inputWrapper.container.setAttribute('style', this.htmlAttributes[htmlAttr]);\n\t                    }\n\t                    else {\n\t                        var defaultAttr = ['title', 'id', 'name', 'placeholder', 'required'];\n\t                        if (defaultAttr.indexOf(htmlAttr) > -1) {\n\t                            htmlAttr === 'placeholder' ? ej2_inputs_1.Input.setPlaceholder(this.htmlAttributes[htmlAttr], this.inputElement) :\n\t                                this.element.setAttribute(htmlAttr, this.htmlAttributes[htmlAttr]);\n\t                        }\n\t                        else {\n\t                            this.inputWrapper.container.setAttribute(htmlAttr, this.htmlAttributes[htmlAttr]);\n\t                        }\n\t                    }\n\t                }\n\t            }\n\t        };\n\t        DropDownList.prototype.getAriaAttributes = function () {\n\t            return {\n\t                'aria-disabled': 'false',\n\t                'aria-owns': this.element.id + '_options',\n\t                'role': 'listbox',\n\t                'aria-haspopup': 'true',\n\t                'aria-expanded': 'false',\n\t                'aria-activedescendant': 'null',\n\t                'aria-labelledby': this.hiddenElement.id\n\t            };\n\t        };\n\t        DropDownList.prototype.setEnableRtl = function () {\n\t            ej2_inputs_1.Input.setEnableRtl(this.enableRtl, [this.inputElement.parentElement]);\n\t            if (this.popupObj) {\n\t                this.popupObj.enableRtl = this.enableRtl;\n\t                this.popupObj.dataBind();\n\t            }\n\t        };\n\t        DropDownList.prototype.setEnable = function () {\n\t            ej2_inputs_1.Input.setEnabled(this.enabled, this.inputElement);\n\t            if (this.enabled) {\n\t                ej2_base_4.removeClass([this.inputWrapper.container], exports.dropDownListClasses.disable);\n\t                this.inputElement.setAttribute('aria-disabled', 'false');\n\t                this.targetElement().setAttribute('tabindex', this.tabIndex);\n\t            }\n\t            else {\n\t                this.hidePopup();\n\t                ej2_base_4.addClass([this.inputWrapper.container], exports.dropDownListClasses.disable);\n\t                this.inputElement.setAttribute('aria-disabled', 'true');\n\t                this.targetElement().tabIndex = -1;\n\t            }\n\t        };\n\t        DropDownList.prototype.getPersistData = function () {\n\t            return this.addOnPersist(['value']);\n\t        };\n\t        ;\n\t        DropDownList.prototype.preventTabIndex = function (element) {\n\t            if (this.getModuleName() === 'dropdownlist') {\n\t                element.tabIndex = -1;\n\t            }\n\t        };\n\t        DropDownList.prototype.targetElement = function () {\n\t            return this.inputWrapper.container;\n\t        };\n\t        DropDownList.prototype.getNgDirective = function () {\n\t            return 'EJ-DROPDOWNLIST';\n\t        };\n\t        DropDownList.prototype.getElementByText = function (text) {\n\t            return this.getElementByValue(this.getValueByText(text));\n\t        };\n\t        DropDownList.prototype.getElementByValue = function (value) {\n\t            var item;\n\t            var listItems = this.getItems();\n\t            for (var _i = 0, listItems_1 = listItems; _i < listItems_1.length; _i++) {\n\t                var liItem = listItems_1[_i];\n\t                if (this.getFormattedValue(liItem.getAttribute('data-value')) === value) {\n\t                    item = liItem;\n\t                    break;\n\t                }\n\t            }\n\t            return item;\n\t        };\n\t        ;\n\t        DropDownList.prototype.initValue = function () {\n\t            this.renderList();\n\t            if (this.dataSource instanceof ej2_data_1.DataManager) {\n\t                this.initRemoteRender = true;\n\t            }\n\t            else {\n\t                this.updateValues();\n\t            }\n\t        };\n\t        DropDownList.prototype.updateValues = function () {\n\t            if (!ej2_base_2.isNullOrUndefined(this.value)) {\n\t                this.setSelection(this.getElementByValue(this.value), null);\n\t            }\n\t            else if (this.text && ej2_base_2.isNullOrUndefined(this.value)) {\n\t                this.setSelection(this.getElementByText(this.text), null);\n\t            }\n\t            else {\n\t                this.setSelection(this.liCollections[this.activeIndex], null);\n\t            }\n\t            this.setHiddenValue();\n\t            ej2_inputs_1.Input.setValue(this.text, this.inputElement, this.floatLabelType, this.showClearButton);\n\t        };\n\t        DropDownList.prototype.onBlur = function (e) {\n\t            var target = e.relatedTarget;\n\t            var currentTarget = e.target;\n\t            var isPreventBlur = this.isPreventBlur;\n\t            this.isPreventBlur = false;\n\t            if (isPreventBlur && !this.isDocumentClick && this.isPopupOpen && (!ej2_base_2.isNullOrUndefined(currentTarget) ||\n\t                !this.isFilterLayout() && ej2_base_2.isNullOrUndefined(target))) {\n\t                if (this.getModuleName() === 'dropdownlist' && this.allowFiltering && this.isPopupOpen) {\n\t                    this.filterInput.focus();\n\t                }\n\t                else {\n\t                    this.targetElement().focus();\n\t                }\n\t                return;\n\t            }\n\t            if (this.isDocumentClick || (!ej2_base_2.isNullOrUndefined(this.popupObj)\n\t                && document.body.contains(this.popupObj.element) &&\n\t                this.popupObj.element.classList.contains(exports.dropDownListClasses.mobileFilter))) {\n\t                if (!this.beforePopupOpen) {\n\t                    this.isDocumentClick = false;\n\t                }\n\t                return;\n\t            }\n\t            if (((this.getModuleName() === 'dropdownlist' && !this.isFilterFocus && target !== this.inputElement)\n\t                && (document.activeElement !== target || (document.activeElement === target &&\n\t                    currentTarget.classList.contains(exports.dropDownListClasses.inputFocus)))) ||\n\t                (ej2_base_2.isNullOrUndefined(target) && this.getModuleName() === 'dropdownlist' && this.allowFiltering &&\n\t                    currentTarget !== this.inputWrapper.container) || this.getModuleName() !== 'dropdownlist' &&\n\t                !this.inputWrapper.container.contains(target) || this.isTabKey) {\n\t                this.isDocumentClick = this.isPopupOpen ? true : false;\n\t                this.focusOutAction();\n\t                this.isTabKey = false;\n\t            }\n\t        };\n\t        DropDownList.prototype.focusOutAction = function () {\n\t            this.isInteracted = false;\n\t            this.focusOut();\n\t            this.onFocusOut();\n\t        };\n\t        DropDownList.prototype.onFocusOut = function () {\n\t            if (this.isSelected) {\n\t                this.isSelectCustom = false;\n\t                this.onChangeEvent(null);\n\t            }\n\t            this.floatLabelChange();\n\t            this.dispatchEvent(this.hiddenElement, 'change');\n\t            if (this.inputWrapper.clearButton) {\n\t                ej2_base_4.addClass([this.inputWrapper.clearButton], exports.dropDownListClasses.clearIconHide);\n\t            }\n\t            this.trigger('blur');\n\t        };\n\t        DropDownList.prototype.onFocus = function () {\n\t            if (!this.isInteracted) {\n\t                this.isInteracted = true;\n\t                this.trigger('focus');\n\t            }\n\t            this.updateIconState();\n\t        };\n\t        DropDownList.prototype.wireEvent = function () {\n\t            ej2_base_1.EventHandler.add(this.inputWrapper.container, 'mousedown', this.dropDownClick, this);\n\t            ej2_base_1.EventHandler.add(this.inputWrapper.container, 'focus', this.focusIn, this);\n\t            ej2_base_1.EventHandler.add(this.inputWrapper.container, 'keypress', this.onSearch, this);\n\t            this.bindCommonEvent();\n\t        };\n\t        DropDownList.prototype.bindCommonEvent = function () {\n\t            ej2_base_1.EventHandler.add(this.targetElement(), 'blur', this.onBlur, this);\n\t            if (!ej2_base_3.Browser.isDevice) {\n\t                this.keyboardModule = new ej2_base_1.KeyboardEvents(this.targetElement(), {\n\t                    keyAction: this.keyActionHandler.bind(this), keyConfigs: this.keyConfigure, eventName: 'keydown'\n\t                });\n\t            }\n\t            this.bindClearEvent();\n\t        };\n\t        DropDownList.prototype.bindClearEvent = function () {\n\t            if (this.showClearButton) {\n\t                ej2_base_1.EventHandler.add(this.inputWrapper.clearButton, 'mousedown', this.resetHandler, this);\n\t            }\n\t        };\n\t        DropDownList.prototype.unBindCommonEvent = function () {\n\t            ej2_base_1.EventHandler.remove(this.targetElement(), 'blur', this.onBlur);\n\t            if (!ej2_base_3.Browser.isDevice) {\n\t                this.keyboardModule.destroy();\n\t            }\n\t            if (this.showClearButton) {\n\t                ej2_base_1.EventHandler.remove(this.inputWrapper.clearButton, 'mousedown', this.resetHandler);\n\t            }\n\t        };\n\t        DropDownList.prototype.updateIconState = function () {\n\t            if (this.showClearButton) {\n\t                if (this.inputElement.value !== '') {\n\t                    ej2_base_4.removeClass([this.inputWrapper.clearButton], exports.dropDownListClasses.clearIconHide);\n\t                }\n\t                else {\n\t                    ej2_base_4.addClass([this.inputWrapper.clearButton], exports.dropDownListClasses.clearIconHide);\n\t                }\n\t            }\n\t        };\n\t        DropDownList.prototype.wireListEvents = function () {\n\t            ej2_base_1.EventHandler.add(this.list, 'click', this.onMouseClick, this);\n\t            ej2_base_1.EventHandler.add(this.list, 'mouseover', this.onMouseOver, this);\n\t            ej2_base_1.EventHandler.add(this.list, 'mouseout', this.onMouseLeave, this);\n\t        };\n\t        ;\n\t        DropDownList.prototype.onSearch = function (e) {\n\t            if (e.charCode !== 32 && e.charCode !== 13) {\n\t                if (this.list === undefined) {\n\t                    this.renderList();\n\t                }\n\t                this.searchKeyEvent = e;\n\t                if (!this.isRequested && !ej2_base_2.isNullOrUndefined(this.list.querySelector('li'))) {\n\t                    this.incrementalSearch(e);\n\t                }\n\t            }\n\t        };\n\t        DropDownList.prototype.onMouseClick = function (e) {\n\t            var target = e.target;\n\t            var classList = target.classList;\n\t            var li = ej2_base_4.closest(target, '.' + drop_down_base_1.dropDownBaseClasses.li);\n\t            if (!this.isValidLI(li)) {\n\t                return;\n\t            }\n\t            this.setSelection(li, e);\n\t            if (ej2_base_3.Browser.isDevice && this.isFilterLayout()) {\n\t                history.back();\n\t            }\n\t            else {\n\t                var delay = 100;\n\t                this.closePopup(delay);\n\t            }\n\t        };\n\t        DropDownList.prototype.onMouseOver = function (e) {\n\t            var currentLi = ej2_base_4.closest(e.target, '.' + drop_down_base_1.dropDownBaseClasses.li);\n\t            this.setHover(currentLi);\n\t        };\n\t        ;\n\t        DropDownList.prototype.setHover = function (li) {\n\t            if (this.enabled && this.isValidLI(li) && !li.classList.contains(drop_down_base_1.dropDownBaseClasses.hover)) {\n\t                this.removeHover();\n\t                ej2_base_4.addClass([li], drop_down_base_1.dropDownBaseClasses.hover);\n\t            }\n\t        };\n\t        ;\n\t        DropDownList.prototype.onMouseLeave = function (e) {\n\t            this.removeHover();\n\t        };\n\t        ;\n\t        DropDownList.prototype.removeHover = function () {\n\t            var hoveredItem = this.list.querySelectorAll('.' + drop_down_base_1.dropDownBaseClasses.hover);\n\t            if (hoveredItem && hoveredItem.length) {\n\t                ej2_base_4.removeClass(hoveredItem, drop_down_base_1.dropDownBaseClasses.hover);\n\t            }\n\t        };\n\t        ;\n\t        DropDownList.prototype.isValidLI = function (li) {\n\t            return (li && li.hasAttribute('role') && li.getAttribute('role') === 'option');\n\t        };\n\t        ;\n\t        DropDownList.prototype.incrementalSearch = function (e) {\n\t            if (this.liCollections.length > 0) {\n\t                var li = incremental_search_1.incrementalSearch(e.charCode, this.liCollections, this.activeIndex, true);\n\t                if (!ej2_base_2.isNullOrUndefined(li)) {\n\t                    this.setSelection(li, e);\n\t                    this.setScrollPosition();\n\t                }\n\t            }\n\t        };\n\t        ;\n\t        DropDownList.prototype.hideSpinner = function () {\n\t            if (!ej2_base_2.isNullOrUndefined(this.spinnerElement)) {\n\t                ej2_popups_1.hideSpinner(this.spinnerElement);\n\t                ej2_base_4.removeClass([this.spinnerElement], exports.dropDownListClasses.disableIcon);\n\t                this.spinnerElement.innerHTML = '';\n\t                this.spinnerElement = null;\n\t            }\n\t        };\n\t        DropDownList.prototype.showSpinner = function () {\n\t            if (ej2_base_2.isNullOrUndefined(this.spinnerElement)) {\n\t                this.spinnerElement = ej2_base_3.Browser.isDevice && !ej2_base_2.isNullOrUndefined(this.filterInputObj) && this.filterInputObj.buttons[1] ||\n\t                    !ej2_base_2.isNullOrUndefined(this.filterInputObj) && this.filterInputObj.buttons[0] || this.inputWrapper.buttons[0];\n\t                ej2_base_4.addClass([this.spinnerElement], exports.dropDownListClasses.disableIcon);\n\t                ej2_popups_1.createSpinner({\n\t                    target: this.spinnerElement,\n\t                    width: drop_down_base_1.SPINNER_SIZE\n\t                });\n\t                ej2_popups_1.showSpinner(this.spinnerElement);\n\t            }\n\t        };\n\t        DropDownList.prototype.keyActionHandler = function (e) {\n\t            var preventAction = e.action === 'pageUp' || e.action === 'pageDown';\n\t            var preventHomeEnd = this.getModuleName() !== 'dropdownlist' && (e.action === 'home' || e.action === 'end');\n\t            this.isEscapeKey = e.action === 'escape';\n\t            this.isTabKey = !this.isPopupOpen && e.action === 'tab';\n\t            var isNavigation = (e.action === 'down' || e.action === 'up' || e.action === 'pageUp' || e.action === 'pageDown'\n\t                || e.action === 'home' || e.action === 'end');\n\t            if ((this.isEditTextBox() || preventAction || preventHomeEnd) && !this.isPopupOpen) {\n\t                return;\n\t            }\n\t            if (!this.readonly) {\n\t                var isTabAction = e.action === 'tab' || e.action === 'close';\n\t                if (this.list === undefined && !this.isRequested && !isTabAction && e.action !== 'escape') {\n\t                    this.searchKeyEvent = e;\n\t                    this.renderList();\n\t                }\n\t                if (ej2_base_2.isNullOrUndefined(this.list) || (!ej2_base_2.isNullOrUndefined(this.liCollections) &&\n\t                    isNavigation && this.liCollections.length === 0) || this.isRequested) {\n\t                    return;\n\t                }\n\t                if (isTabAction && this.isPopupOpen || e.action === 'escape') {\n\t                    e.preventDefault();\n\t                }\n\t                this.isSelected = e.action === 'escape' ? false : this.isSelected;\n\t                this.isTyped = (isNavigation || e.action === 'escape') ? false : this.isTyped;\n\t                switch (e.action) {\n\t                    case 'down':\n\t                    case 'up':\n\t                        var focusEle = this.list.querySelector('.' + exports.dropDownListClasses.focus);\n\t                        if (this.isSelectFocusItem(focusEle)) {\n\t                            this.setSelection(focusEle, e);\n\t                        }\n\t                        else {\n\t                            var nextItem = void 0;\n\t                            var index = e.action === 'down' ? this.activeIndex + 1 : this.activeIndex - 1;\n\t                            var startIndex = 0;\n\t                            if (this.getModuleName() === 'autocomplete') {\n\t                                startIndex = e.action === 'down' && ej2_base_2.isNullOrUndefined(this.activeIndex) ? 0 : this.liCollections.length - 1;\n\t                                index = index < 0 ? this.liCollections.length - 1 : index === this.liCollections.length ? 0 : index;\n\t                            }\n\t                            nextItem = ej2_base_2.isNullOrUndefined(this.activeIndex) ? this.liCollections[startIndex] : this.liCollections[index];\n\t                            this.setSelection(nextItem, e);\n\t                        }\n\t                        e.preventDefault();\n\t                        break;\n\t                    case 'pageUp':\n\t                        this.pageUpSelection(this.activeIndex - this.getPageCount(), e);\n\t                        e.preventDefault();\n\t                        break;\n\t                    case 'pageDown':\n\t                        this.pageDownSelection(this.activeIndex + this.getPageCount(), e);\n\t                        e.preventDefault();\n\t                        break;\n\t                    case 'home':\n\t                        e.preventDefault();\n\t                        if (this.activeIndex === 0) {\n\t                            return;\n\t                        }\n\t                        this.setSelection(this.liCollections[0], e);\n\t                        break;\n\t                    case 'end':\n\t                        e.preventDefault();\n\t                        var lastLi = this.getItems().length - 1;\n\t                        if (this.activeIndex === lastLi) {\n\t                            return;\n\t                        }\n\t                        this.setSelection(this.liCollections[lastLi], e);\n\t                        break;\n\t                    case 'space':\n\t                        if (this.getModuleName() === 'dropdownlist') {\n\t                            if (!this.beforePopupOpen) {\n\t                                this.showPopup();\n\t                            }\n\t                            else {\n\t                                e.preventDefault();\n\t                            }\n\t                        }\n\t                        break;\n\t                    case 'open':\n\t                        this.showPopup();\n\t                        break;\n\t                    case 'hide':\n\t                        this.preventAltUp = this.isPopupOpen;\n\t                        this.hidePopup();\n\t                        this.focusDropDown(e);\n\t                        break;\n\t                    case 'enter':\n\t                        this.selectCurrentItem(e);\n\t                        break;\n\t                    case 'escape':\n\t                    case 'tab':\n\t                    case 'close':\n\t                        if (this.isPopupOpen) {\n\t                            this.hidePopup();\n\t                            this.focusDropDown(e);\n\t                        }\n\t                        break;\n\t                }\n\t            }\n\t        };\n\t        DropDownList.prototype.selectCurrentItem = function (e) {\n\t            if (this.isPopupOpen) {\n\t                var li = this.list.querySelector('.' + exports.dropDownListClasses.focus);\n\t                if (li) {\n\t                    this.setSelection(li, e);\n\t                    this.isTyped = false;\n\t                }\n\t                if (this.isSelected) {\n\t                    this.isSelectCustom = false;\n\t                    this.onChangeEvent(e);\n\t                }\n\t                this.hidePopup();\n\t                this.focusDropDown(e);\n\t            }\n\t            else {\n\t                this.showPopup();\n\t            }\n\t        };\n\t        DropDownList.prototype.isSelectFocusItem = function (element) {\n\t            return !ej2_base_2.isNullOrUndefined(element);\n\t        };\n\t        DropDownList.prototype.getPageCount = function () {\n\t            var liHeight = this.list.classList.contains(drop_down_base_1.dropDownBaseClasses.noData) ? null :\n\t                getComputedStyle(this.getItems()[0], null).getPropertyValue('height');\n\t            return Math.round(this.list.getBoundingClientRect().height / parseInt(liHeight, 10));\n\t        };\n\t        DropDownList.prototype.pageUpSelection = function (steps, event) {\n\t            var previousItem = steps >= 0 ? this.liCollections[steps + 1] : this.liCollections[0];\n\t            this.setSelection(previousItem, event);\n\t        };\n\t        ;\n\t        DropDownList.prototype.pageDownSelection = function (steps, event) {\n\t            var list = this.getItems();\n\t            var previousItem = steps <= list.length ? this.liCollections[steps - 1] : this.liCollections[list.length - 1];\n\t            this.setSelection(previousItem, event);\n\t        };\n\t        ;\n\t        DropDownList.prototype.unWireEvent = function () {\n\t            ej2_base_1.EventHandler.remove(this.inputWrapper.container, 'mousedown', this.dropDownClick);\n\t            ej2_base_1.EventHandler.remove(this.inputWrapper.container, 'keypress', this.onSearch);\n\t            ej2_base_1.EventHandler.remove(this.inputWrapper.container, 'focus', this.focusIn);\n\t            this.unBindCommonEvent();\n\t        };\n\t        DropDownList.prototype.unWireListEvents = function () {\n\t            ej2_base_1.EventHandler.remove(this.list, 'click', this.onMouseClick);\n\t            ej2_base_1.EventHandler.remove(this.list, 'mouseover', this.onMouseOver);\n\t            ej2_base_1.EventHandler.remove(this.list, 'mouseout', this.onMouseLeave);\n\t        };\n\t        ;\n\t        DropDownList.prototype.onDocumentClick = function (e) {\n\t            var target = e.target;\n\t            if (!(!ej2_base_2.isNullOrUndefined(this.popupObj) && ej2_base_4.closest(target, '#' + this.popupObj.element.id)) &&\n\t                !this.inputWrapper.container.contains(e.target)) {\n\t                if (this.inputWrapper.container.classList.contains(exports.dropDownListClasses.inputFocus) || this.isPopupOpen) {\n\t                    this.isDocumentClick = true;\n\t                    var isActive = this.isRequested;\n\t                    this.isInteracted = false;\n\t                    this.hidePopup();\n\t                    if (!isActive) {\n\t                        this.onFocusOut();\n\t                        this.inputWrapper.container.classList.remove(exports.dropDownListClasses.inputFocus);\n\t                    }\n\t                }\n\t            }\n\t            else if (target !== this.inputElement && !(this.allowFiltering && target === this.filterInput)\n\t                && !(this.getModuleName() === 'combobox' &&\n\t                    !this.allowFiltering && ej2_base_3.Browser.isDevice && target === this.inputWrapper.buttons[0])) {\n\t                this.isPreventBlur = (ej2_base_3.Browser.isIE || ej2_base_3.Browser.info.name === 'edge') && (document.activeElement === this.targetElement() ||\n\t                    document.activeElement === this.filterInput);\n\t                e.preventDefault();\n\t            }\n\t        };\n\t        DropDownList.prototype.activeStateChange = function () {\n\t            if (this.isDocumentClick) {\n\t                this.hidePopup();\n\t                this.onFocusOut();\n\t                this.inputWrapper.container.classList.remove(exports.dropDownListClasses.inputFocus);\n\t            }\n\t        };\n\t        DropDownList.prototype.focusDropDown = function (e) {\n\t            if (!this.initial && this.isFilterLayout()) {\n\t                this.focusIn();\n\t            }\n\t        };\n\t        DropDownList.prototype.dropDownClick = function (e) {\n\t            if (this.targetElement().classList.contains(exports.dropDownListClasses.disable) || this.inputWrapper.clearButton === e.target) {\n\t                return;\n\t            }\n\t            var target = e.target;\n\t            if (target !== this.inputElement && !(this.allowFiltering && target === this.filterInput) && this.getModuleName() !== 'combobox') {\n\t                e.preventDefault();\n\t            }\n\t            if (!this.readonly) {\n\t                if (this.isPopupOpen) {\n\t                    this.hidePopup();\n\t                    if (this.isFilterLayout()) {\n\t                        this.focusDropDown(e);\n\t                    }\n\t                }\n\t                else {\n\t                    this.focusIn();\n\t                    this.floatLabelChange();\n\t                    this.queryString = this.inputElement.value.trim() === '' ? null : this.inputElement.value;\n\t                    this.isDropDownClick = true;\n\t                    this.showPopup();\n\t                }\n\t            }\n\t        };\n\t        DropDownList.prototype.updateSelectedItem = function (li, e, preventSelect) {\n\t            this.removeSelection();\n\t            li.classList.add(drop_down_base_1.dropDownBaseClasses.selected);\n\t            this.removeHover();\n\t            var value = this.getFormattedValue(li.getAttribute('data-value'));\n\t            this.item = li;\n\t            this.itemData = this.getDataByValue(value);\n\t            if (!this.initial && !preventSelect) {\n\t                this.isSelected = true;\n\t                var eventArgs = {\n\t                    e: e,\n\t                    item: this.item,\n\t                    itemData: this.itemData,\n\t                    isInteracted: e ? true : false\n\t                };\n\t                this.trigger('select', eventArgs);\n\t            }\n\t            var focusedItem = this.list.querySelector('.' + drop_down_base_1.dropDownBaseClasses.focus);\n\t            if (focusedItem) {\n\t                ej2_base_4.removeClass([focusedItem], drop_down_base_1.dropDownBaseClasses.focus);\n\t            }\n\t            li.setAttribute('aria-selected', 'true');\n\t            this.activeIndex = this.getIndexByValue(value);\n\t        };\n\t        DropDownList.prototype.activeItem = function (li) {\n\t            if (this.isValidLI(li) && !li.classList.contains(drop_down_base_1.dropDownBaseClasses.selected)) {\n\t                this.removeSelection();\n\t                li.classList.add(drop_down_base_1.dropDownBaseClasses.selected);\n\t                this.removeHover();\n\t                li.setAttribute('aria-selected', 'true');\n\t            }\n\t        };\n\t        DropDownList.prototype.setValue = function (e) {\n\t            var dataItem = this.getItemData();\n\t            if (dataItem.value === null) {\n\t                ej2_inputs_1.Input.setValue(null, this.inputElement, this.floatLabelType, this.showClearButton);\n\t            }\n\t            else {\n\t                ej2_inputs_1.Input.setValue(dataItem.text, this.inputElement, this.floatLabelType, this.showClearButton);\n\t            }\n\t            if (this.previousValue === dataItem.value) {\n\t                this.isSelected = false;\n\t                return true;\n\t            }\n\t            else {\n\t                this.isSelected = !this.initial ? true : false;\n\t                this.isSelectCustom = false;\n\t                if (this.getModuleName() === 'dropdownlist') {\n\t                    this.updateIconState();\n\t                }\n\t                return false;\n\t            }\n\t        };\n\t        DropDownList.prototype.setSelection = function (li, e) {\n\t            if (this.isValidLI(li) && !li.classList.contains(drop_down_base_1.dropDownBaseClasses.selected)) {\n\t                this.updateSelectedItem(li, e, false);\n\t            }\n\t            if (this.list) {\n\t                this.removeHover();\n\t            }\n\t            this.selectedLI = li;\n\t            if (this.setValue(e)) {\n\t                return;\n\t            }\n\t            if (this.valueTemplate && this.itemData !== null) {\n\t                this.setValueTemplate();\n\t            }\n\t            else if (this.inputElement.previousSibling === this.valueTempElement) {\n\t                ej2_base_4.detach(this.valueTempElement);\n\t                this.inputElement.style.display = 'block';\n\t            }\n\t            if (this.isPopupOpen) {\n\t                ej2_base_2.attributes(this.targetElement(), { 'aria-activedescendant': this.selectedLI ? this.selectedLI.id : null });\n\t                if (this.isFilterLayout()) {\n\t                    ej2_base_2.attributes(this.filterInput, { 'aria-activedescendant': this.selectedLI ? this.selectedLI.id : null });\n\t                }\n\t            }\n\t            if ((!this.isPopupOpen && !ej2_base_2.isNullOrUndefined(li)) || (this.isPopupOpen && !ej2_base_2.isNullOrUndefined(e) &&\n\t                (e.type !== 'keydown' || e.type === 'keydown' && e.action === 'enter'))) {\n\t                this.isSelectCustom = false;\n\t                this.onChangeEvent(e);\n\t            }\n\t            if (this.isPopupOpen && !ej2_base_2.isNullOrUndefined(this.selectedLI) && this.itemData !== null && (!e || e.type !== 'click')) {\n\t                this.setScrollPosition(e);\n\t            }\n\t        };\n\t        DropDownList.prototype.setValueTemplate = function () {\n\t            var compiledString;\n\t            if (!this.valueTempElement) {\n\t                this.valueTempElement = ej2_base_1.createElement('span', { className: exports.dropDownListClasses.value });\n\t                this.inputElement.parentElement.insertBefore(this.valueTempElement, this.inputElement);\n\t                this.inputElement.style.display = 'none';\n\t                this.inputWrapper.container.focus();\n\t                ej2_base_4.addClass([this.inputWrapper.container], [exports.dropDownListClasses.inputFocus]);\n\t            }\n\t            this.valueTempElement.innerHTML = '';\n\t            compiledString = ej2_base_1.compile(this.valueTemplate);\n\t            for (var _i = 0, _a = compiledString(this.itemData); _i < _a.length; _i++) {\n\t                var item = _a[_i];\n\t                this.valueTempElement.appendChild(item);\n\t            }\n\t        };\n\t        DropDownList.prototype.removeSelection = function () {\n\t            var selectedItems = this.list.querySelectorAll('.' + drop_down_base_1.dropDownBaseClasses.selected);\n\t            if (selectedItems.length) {\n\t                ej2_base_4.removeClass(selectedItems, drop_down_base_1.dropDownBaseClasses.selected);\n\t                selectedItems[0].removeAttribute('aria-selected');\n\t            }\n\t        };\n\t        ;\n\t        DropDownList.prototype.getItemData = function () {\n\t            var fields = this.fields;\n\t            var dataItem = {};\n\t            dataItem = this.itemData;\n\t            var value = (!ej2_base_2.isNullOrUndefined(dataItem) &&\n\t                (dataItem[fields.value] === null || dataItem[fields.value]) ? dataItem[fields.value] : dataItem);\n\t            var text = (!ej2_base_2.isNullOrUndefined(dataItem) &&\n\t                (dataItem[fields.text] === null || dataItem[fields.text]) ? dataItem[fields.text] : dataItem);\n\t            return { value: value, text: text };\n\t        };\n\t        DropDownList.prototype.onChangeEvent = function (eve) {\n\t            var dataItem = this.getItemData();\n\t            var index = this.isSelectCustom ? null : this.activeIndex;\n\t            this.setProperties({ 'value': dataItem.value, 'index': index, 'text': dataItem.text }, true);\n\t            this.detachChangeEvent(eve);\n\t        };\n\t        ;\n\t        DropDownList.prototype.detachChangeEvent = function (eve) {\n\t            this.isSelected = false;\n\t            this.previousValue = this.value;\n\t            this.activeIndex = this.index;\n\t            this.typedString = !ej2_base_2.isNullOrUndefined(this.text) ? this.text : '';\n\t            if (!this.initial) {\n\t                this.setHiddenValue();\n\t                var eventArgs = {\n\t                    e: eve,\n\t                    item: this.item,\n\t                    itemData: this.itemData,\n\t                    isInteracted: eve ? true : false,\n\t                    value: this.value\n\t                };\n\t                this.trigger('change', eventArgs);\n\t            }\n\t        };\n\t        DropDownList.prototype.setHiddenValue = function () {\n\t            if (!ej2_base_2.isNullOrUndefined(this.value)) {\n\t                this.hiddenElement.innerHTML = '<option selected value =' + this.value + '>' + this.text + '</option>';\n\t            }\n\t            else {\n\t                this.hiddenElement.innerHTML = '';\n\t            }\n\t        };\n\t        DropDownList.prototype.onFilterUp = function (e) {\n\t            this.isValidKey = e.keyCode === 40 || e.keyCode === 38 || this.isValidKey;\n\t            if (this.isValidKey) {\n\t                this.isValidKey = false;\n\t                switch (e.keyCode) {\n\t                    case 38:\n\t                    case 40:\n\t                        if (this.getModuleName() === 'autocomplete' && !this.isPopupOpen && !this.preventAltUp && !this.isRequested) {\n\t                            this.preventAutoFill = true;\n\t                            this.searchLists(e);\n\t                        }\n\t                        else {\n\t                            this.preventAutoFill = false;\n\t                        }\n\t                        this.preventAltUp = false;\n\t                        e.preventDefault();\n\t                        break;\n\t                    case 46:\n\t                    case 8:\n\t                        this.typedString = this.filterInput.value;\n\t                        if (!this.isPopupOpen && this.typedString !== '' || this.isPopupOpen && this.queryString.length > 0) {\n\t                            this.preventAutoFill = true;\n\t                            this.searchLists(e);\n\t                        }\n\t                        else if (this.typedString === '') {\n\t                            this.resetFocusElement();\n\t                            this.activeIndex = null;\n\t                            if (this.getModuleName() === 'autocomplete') {\n\t                                this.hidePopup();\n\t                            }\n\t                        }\n\t                        e.preventDefault();\n\t                        break;\n\t                    default:\n\t                        this.typedString = this.filterInput.value;\n\t                        this.preventAutoFill = false;\n\t                        this.searchLists(e);\n\t                        break;\n\t                }\n\t            }\n\t        };\n\t        DropDownList.prototype.onFilterDown = function (e) {\n\t            switch (e.keyCode) {\n\t                case 13:\n\t                    break;\n\t                case 40:\n\t                case 38:\n\t                    this.queryString = this.filterInput.value;\n\t                    e.preventDefault();\n\t                    break;\n\t                case 9:\n\t                    if (this.isPopupOpen) {\n\t                        e.preventDefault();\n\t                    }\n\t                    break;\n\t                default:\n\t                    this.prevSelectPoints = this.getSelectionPoints();\n\t                    this.queryString = this.filterInput.value;\n\t                    break;\n\t            }\n\t        };\n\t        DropDownList.prototype.removeFillSelection = function () {\n\t            if (this.isInteracted) {\n\t                var selection = this.getSelectionPoints();\n\t                this.inputElement.setSelectionRange(selection.end, selection.end);\n\t            }\n\t        };\n\t        DropDownList.prototype.getSelectionPoints = function () {\n\t            var input = this.inputElement;\n\t            return { start: Math.abs(input.selectionStart), end: Math.abs(input.selectionEnd) };\n\t        };\n\t        DropDownList.prototype.searchLists = function (e) {\n\t            var _this = this;\n\t            this.isTyped = true;\n\t            this.activeIndex = null;\n\t            if (this.filterInput.parentElement.querySelector('.' + exports.dropDownListClasses.clearIcon)) {\n\t                var clearElement = this.filterInput.parentElement.querySelector('.' + exports.dropDownListClasses.clearIcon);\n\t                clearElement.style.visibility = this.filterInput.value === '' ? 'hidden' : 'visible';\n\t            }\n\t            if (this.isFiltering()) {\n\t                this.trigger('filtering', {\n\t                    text: this.filterInput.value,\n\t                    updateData: function (dataSource, query, fields) {\n\t                        if (!ej2_base_2.isNullOrUndefined(_this.filterInput)) {\n\t                            _this.beforePopupOpen = true;\n\t                            if (_this.filterInput.value.trim() === '') {\n\t                                _this.actionCompleteData.isUpdated = false;\n\t                                _this.isTyped = false;\n\t                                _this.onActionComplete(_this.actionCompleteData.ulElement, _this.actionCompleteData.list);\n\t                                _this.isTyped = true;\n\t                                if (!ej2_base_2.isNullOrUndefined(_this.itemData) && _this.getModuleName() === 'dropdownlist') {\n\t                                    _this.focusIndexItem();\n\t                                    _this.setScrollPosition();\n\t                                }\n\t                                _this.isNotSearchList = true;\n\t                            }\n\t                            else {\n\t                                _this.isNotSearchList = false;\n\t                                _this.resetList(dataSource, fields, query);\n\t                            }\n\t                        }\n\t                    },\n\t                    event: e\n\t                });\n\t            }\n\t        };\n\t        DropDownList.prototype.setSearchBox = function (popupElement) {\n\t            if (this.isFiltering()) {\n\t                var parentElement = ej2_base_1.createElement('span', {\n\t                    className: exports.dropDownListClasses.filterParent\n\t                });\n\t                this.filterInput = ej2_base_1.createElement('input', {\n\t                    attrs: { type: 'text' },\n\t                    className: exports.dropDownListClasses.filterInput\n\t                });\n\t                this.element.parentNode.insertBefore(this.filterInput, this.element);\n\t                var backIcon = false;\n\t                if (ej2_base_3.Browser.isDevice) {\n\t                    backIcon = true;\n\t                }\n\t                this.filterInputObj = ej2_inputs_1.Input.createInput({\n\t                    element: this.filterInput,\n\t                    buttons: backIcon ?\n\t                        [exports.dropDownListClasses.backIcon, exports.dropDownListClasses.filterBarClearIcon] : [exports.dropDownListClasses.filterBarClearIcon],\n\t                    properties: { placeholder: this.filterBarPlaceholder }\n\t                });\n\t                ej2_base_1.append([this.filterInputObj.container], parentElement);\n\t                ej2_base_4.prepend([parentElement], popupElement);\n\t                ej2_base_2.attributes(this.filterInput, {\n\t                    'aria-disabled': 'false',\n\t                    'aria-owns': this.element.id + '_options',\n\t                    'role': 'listbox',\n\t                    'aria-activedescendant': this.selectedLI ? this.selectedLI.id : null,\n\t                    'autocomplete': 'off',\n\t                    'autocorrect': 'off',\n\t                    'autocapitalize': 'off',\n\t                    'spellcheck': 'false'\n\t                });\n\t                this.clearIconElement = this.filterInput.parentElement.querySelector('.' + exports.dropDownListClasses.clearIcon);\n\t                if (!ej2_base_3.Browser.isDevice && this.clearIconElement) {\n\t                    ej2_base_1.EventHandler.add(this.clearIconElement, 'click', this.clearText, this);\n\t                    this.clearIconElement.style.visibility = 'hidden';\n\t                }\n\t                if (!ej2_base_3.Browser.isDevice) {\n\t                    this.searchKeyModule = new ej2_base_1.KeyboardEvents(this.filterInput, {\n\t                        keyAction: this.keyActionHandler.bind(this),\n\t                        keyConfigs: this.keyConfigure,\n\t                        eventName: 'keydown'\n\t                    });\n\t                }\n\t                ej2_base_1.EventHandler.add(this.filterInput, 'input', this.onInput, this);\n\t                ej2_base_1.EventHandler.add(this.filterInput, 'keyup', this.onFilterUp, this);\n\t                ej2_base_1.EventHandler.add(this.filterInput, 'keydown', this.onFilterDown, this);\n\t                ej2_base_1.EventHandler.add(this.filterInput, 'blur', this.onBlur, this);\n\t                return this.filterInputObj;\n\t            }\n\t            else {\n\t                return inputObject;\n\t            }\n\t        };\n\t        ;\n\t        DropDownList.prototype.onInput = function () {\n\t            this.isValidKey = true;\n\t        };\n\t        DropDownList.prototype.onActionFailure = function (e) {\n\t            _super.prototype.onActionFailure.call(this, e);\n\t            this.renderPopup();\n\t        };\n\t        DropDownList.prototype.onActionComplete = function (ulElement, list, e, isUpdated) {\n\t            if (this.isNotSearchList) {\n\t                this.isNotSearchList = false;\n\t                return;\n\t            }\n\t            if (this.isActive) {\n\t                var selectedItem = this.selectedLI ? this.selectedLI.cloneNode(true) : null;\n\t                _super.prototype.onActionComplete.call(this, ulElement, list, e);\n\t                if (this.isRequested && !ej2_base_2.isNullOrUndefined(this.searchKeyEvent) && this.searchKeyEvent.type === 'keydown') {\n\t                    this.isRequested = false;\n\t                    this.keyActionHandler(this.searchKeyEvent);\n\t                    this.searchKeyEvent = null;\n\t                }\n\t                if (this.isRequested && !ej2_base_2.isNullOrUndefined(this.searchKeyEvent)) {\n\t                    this.incrementalSearch(this.searchKeyEvent);\n\t                    this.searchKeyEvent = null;\n\t                }\n\t                this.list.scrollTop = 0;\n\t                if (!ej2_base_2.isNullOrUndefined(ulElement)) {\n\t                    ej2_base_2.attributes(ulElement, { 'id': this.element.id + '_options', 'role': 'listbox', 'aria-hidden': 'false' });\n\t                }\n\t                if (this.initRemoteRender) {\n\t                    this.initial = true;\n\t                    this.activeIndex = this.index;\n\t                    this.updateValues();\n\t                    this.initRemoteRender = false;\n\t                    this.initial = false;\n\t                }\n\t                if (this.getModuleName() !== 'autocomplete' && this.isFiltering() && !this.isTyped) {\n\t                    if (!this.actionCompleteData.isUpdated) {\n\t                        this.actionCompleteData = { ulElement: ulElement.cloneNode(true), list: list, isUpdated: true };\n\t                    }\n\t                    this.addNewItem(list, selectedItem);\n\t                    if (!ej2_base_2.isNullOrUndefined(this.itemData)) {\n\t                        this.focusIndexItem();\n\t                    }\n\t                }\n\t                if (this.beforePopupOpen) {\n\t                    this.renderPopup();\n\t                }\n\t            }\n\t        };\n\t        DropDownList.prototype.addNewItem = function (listData, newElement) {\n\t            var _this = this;\n\t            if (!ej2_base_2.isNullOrUndefined(this.itemData) && !ej2_base_2.isNullOrUndefined(newElement)) {\n\t                var value_1 = this.getItemData().value;\n\t                var isExist = listData.some(function (data) {\n\t                    return data[_this.fields.value] === value_1;\n\t                });\n\t                if (!isExist) {\n\t                    this.addItem(this.itemData);\n\t                    this.actionCompleteData.list.push(this.itemData);\n\t                    this.actionCompleteData.ulElement.appendChild(newElement);\n\t                }\n\t                var selectedItems = void 0;\n\t                var ulElement = this.actionCompleteData.ulElement;\n\t                selectedItems = ulElement.querySelectorAll('.' + drop_down_base_1.dropDownBaseClasses.selected);\n\t                if (selectedItems.length) {\n\t                    ej2_base_4.removeClass(selectedItems, drop_down_base_1.dropDownBaseClasses.selected);\n\t                    selectedItems[0].removeAttribute('aria-selected');\n\t                }\n\t            }\n\t        };\n\t        DropDownList.prototype.updateActionCompleteData = function (li, item) {\n\t            if (this.getModuleName() !== 'autocomplete' && this.actionCompleteData.ulElement) {\n\t                this.actionCompleteData.ulElement.appendChild(li.cloneNode(true));\n\t                this.actionCompleteData.list.push(item);\n\t            }\n\t        };\n\t        DropDownList.prototype.focusIndexItem = function () {\n\t            var value = this.getItemData().value;\n\t            this.activeIndex = this.getIndexByValue(value);\n\t            var element = this.list.querySelector('[data-value=\"' + value + '\"]');\n\t            this.selectedLI = element;\n\t            this.activeItem(element);\n\t            this.removeFocus();\n\t        };\n\t        DropDownList.prototype.updateSelection = function () {\n\t            var selectedItem = this.list.querySelector('.' + drop_down_base_1.dropDownBaseClasses.selected);\n\t            if (selectedItem) {\n\t                this.setProperties({ 'index': this.getIndexByValue(selectedItem.getAttribute('data-value')) });\n\t                this.activeIndex = this.index;\n\t            }\n\t            else {\n\t                this.removeFocus();\n\t                this.list.querySelector('.' + drop_down_base_1.dropDownBaseClasses.li).classList.add(exports.dropDownListClasses.focus);\n\t            }\n\t        };\n\t        DropDownList.prototype.removeFocus = function () {\n\t            var highlightedItem = this.list.querySelectorAll('.' + exports.dropDownListClasses.focus);\n\t            if (highlightedItem && highlightedItem.length) {\n\t                ej2_base_4.removeClass(highlightedItem, exports.dropDownListClasses.focus);\n\t            }\n\t        };\n\t        ;\n\t        DropDownList.prototype.renderPopup = function () {\n\t            if (this.popupObj && document.body.contains(this.popupObj.element)) {\n\t                this.refreshPopup();\n\t                return;\n\t            }\n\t            var popupEle = ej2_base_1.createElement('div', { id: this.element.id + '_popup', className: 'e-ddl e-popup' });\n\t            var searchBox = this.setSearchBox(popupEle);\n\t            this.listHeight = ej2_base_2.formatUnit(this.popupHeight);\n\t            if (this.headerTemplate) {\n\t                var compiledString = void 0;\n\t                this.header = document.createElement('div');\n\t                ej2_base_4.addClass([this.header], exports.dropDownListClasses.header);\n\t                compiledString = ej2_base_1.compile(this.headerTemplate);\n\t                for (var _i = 0, _a = compiledString({}); _i < _a.length; _i++) {\n\t                    var item = _a[_i];\n\t                    this.header.appendChild(item);\n\t                }\n\t                ej2_base_1.append([this.header], popupEle);\n\t            }\n\t            ej2_base_1.append([this.list], popupEle);\n\t            if (this.footerTemplate) {\n\t                this.setFooterTemplate(popupEle);\n\t            }\n\t            document.body.appendChild(popupEle);\n\t            popupEle.style.visibility = 'hidden';\n\t            if (this.popupHeight !== 'auto') {\n\t                this.searchBoxHeight = 0;\n\t                if (!ej2_base_2.isNullOrUndefined(searchBox.container)) {\n\t                    this.searchBoxHeight = (searchBox.container.parentElement).getBoundingClientRect().height;\n\t                    this.listHeight = (parseInt(this.listHeight, 10) - (this.searchBoxHeight)).toString() + 'px';\n\t                }\n\t                if (this.headerTemplate) {\n\t                    var height = Math.round(this.header.getBoundingClientRect().height);\n\t                    this.listHeight = (parseInt(this.listHeight, 10) - (height + this.searchBoxHeight)).toString() + 'px';\n\t                }\n\t                if (this.footerTemplate) {\n\t                    var height = Math.round(this.footer.getBoundingClientRect().height);\n\t                    this.listHeight = (parseInt(this.listHeight, 10) - (height + this.searchBoxHeight)).toString() + 'px';\n\t                }\n\t                this.list.style.maxHeight = (parseInt(this.listHeight, 10) - 2).toString() + 'px';\n\t                popupEle.style.maxHeight = ej2_base_2.formatUnit(this.popupHeight);\n\t            }\n\t            else {\n\t                popupEle.style.height = 'auto';\n\t            }\n\t            var offsetValue = 0;\n\t            var left;\n\t            if (!ej2_base_2.isNullOrUndefined(this.selectedLI) && (!ej2_base_2.isNullOrUndefined(this.activeIndex) && this.activeIndex >= 0)) {\n\t                this.setScrollPosition();\n\t            }\n\t            else {\n\t                this.list.scrollTop = 0;\n\t            }\n\t            if (ej2_base_3.Browser.isDevice && (!this.allowFiltering && (this.getModuleName() === 'dropdownlist' ||\n\t                (this.isDropDownClick && this.getModuleName() === 'combobox')))) {\n\t                offsetValue = this.getOffsetValue(popupEle);\n\t                var firstItem = this.isEmptyList() ? this.list : this.liCollections[0];\n\t                left = -(parseInt(getComputedStyle(firstItem).textIndent, 10) -\n\t                    parseInt(getComputedStyle(this.inputElement).paddingLeft, 10) +\n\t                    parseInt(getComputedStyle(this.inputElement.parentElement).borderLeftWidth, 10));\n\t            }\n\t            this.getFocusElement();\n\t            this.createPopup(popupEle, offsetValue, left);\n\t            this.checkCollision(popupEle);\n\t            if (ej2_base_3.Browser.isDevice) {\n\t                this.popupObj.element.classList.add(exports.dropDownListClasses.device);\n\t                if (this.getModuleName() === 'dropdownlist' || (this.getModuleName() === 'combobox'\n\t                    && !this.allowFiltering && this.isDropDownClick)) {\n\t                    this.popupObj.collision = { X: 'none', Y: 'fit' };\n\t                }\n\t                if (this.isFilterLayout()) {\n\t                    this.popupObj.element.classList.add(exports.dropDownListClasses.mobileFilter);\n\t                    this.popupObj.position = { X: 0, Y: 0 };\n\t                    this.popupObj.dataBind();\n\t                    ej2_base_2.attributes(this.popupObj.element, { style: 'left:0px;right:0px;top:0px;bottom:0px;' });\n\t                    ej2_base_4.addClass([document.body, this.popupObj.element], exports.dropDownListClasses.popupFullScreen);\n\t                    this.setSearchBoxPosition();\n\t                    this.backIconElement = searchBox.container.querySelector('.e-back-icon');\n\t                    this.clearIconElement = searchBox.container.querySelector('.' + exports.dropDownListClasses.clearIcon);\n\t                    ej2_base_1.EventHandler.add(this.backIconElement, 'click', this.clickOnBackIcon, this);\n\t                    ej2_base_1.EventHandler.add(this.clearIconElement, 'click', this.clearText, this);\n\t                }\n\t            }\n\t            popupEle.style.visibility = 'visible';\n\t            ej2_base_4.addClass([popupEle], 'e-popup-close');\n\t            var scrollParentElements = this.popupObj.getScrollableParent(this.inputWrapper.container);\n\t            for (var _b = 0, scrollParentElements_1 = scrollParentElements; _b < scrollParentElements_1.length; _b++) {\n\t                var element = scrollParentElements_1[_b];\n\t                ej2_base_1.EventHandler.add(element, 'scroll', this.scrollHandler, this);\n\t            }\n\t            if (ej2_base_3.Browser.isDevice && this.isFilterLayout()) {\n\t                ej2_base_1.EventHandler.add(this.list, 'scroll', this.listScroll, this);\n\t            }\n\t            ej2_base_2.attributes(this.targetElement(), { 'aria-expanded': 'true' });\n\t            var inputParent = this.isFiltering() ? this.filterInput.parentElement : this.inputWrapper.container;\n\t            ej2_base_4.addClass([inputParent], [exports.dropDownListClasses.inputFocus]);\n\t            ej2_base_4.addClass([this.inputWrapper.container], [exports.dropDownListClasses.iconAnimation]);\n\t            var animModel = { name: 'FadeIn', duration: 100 };\n\t            this.beforePopupOpen = true;\n\t            var eventArgs = { popup: this.popupObj };\n\t            this.trigger('open', eventArgs);\n\t            ej2_base_1.EventHandler.add(document, 'mousedown', this.onDocumentClick, this);\n\t            this.popupObj.show(new ej2_base_3.Animation(animModel));\n\t        };\n\t        DropDownList.prototype.checkCollision = function (popupEle) {\n\t            if (!ej2_base_3.Browser.isDevice || (ej2_base_3.Browser.isDevice && !(this.getModuleName() === 'dropdownlist' || this.isDropDownClick))) {\n\t                var collision = ej2_popups_1.isCollide(popupEle);\n\t                if (collision.length > 0) {\n\t                    popupEle.style.marginTop = -parseInt(getComputedStyle(popupEle).marginTop, 10) + 'px';\n\t                }\n\t            }\n\t        };\n\t        DropDownList.prototype.getOffsetValue = function (popupEle) {\n\t            var popupStyles = getComputedStyle(popupEle);\n\t            var borderTop = parseInt(popupStyles.borderTop, 10);\n\t            var borderBottom = parseInt(popupStyles.borderBottom, 10);\n\t            return this.setPopupPosition(borderTop + borderBottom);\n\t        };\n\t        DropDownList.prototype.createPopup = function (element, offsetValue, left) {\n\t            var _this = this;\n\t            this.popupObj = new ej2_popups_1.Popup(element, {\n\t                width: this.setWidth(), targetType: 'relative',\n\t                relateTo: this.inputWrapper.container, collision: { X: 'none', Y: 'flip' }, offsetY: offsetValue,\n\t                enableRtl: this.enableRtl, offsetX: left, position: { X: 'left', Y: 'bottom' },\n\t                close: function () {\n\t                    if (!_this.isDocumentClick) {\n\t                        _this.focusDropDown();\n\t                    }\n\t                    _this.isDocumentClick = false;\n\t                    _this.destroyPopup();\n\t                },\n\t                open: function () {\n\t                    _this.isPopupOpen = true;\n\t                    if (_this.isFilterLayout()) {\n\t                        ej2_base_4.removeClass([_this.inputWrapper.container], [exports.dropDownListClasses.inputFocus]);\n\t                        _this.isFilterFocus = true;\n\t                        _this.filterInput.focus();\n\t                        if (_this.inputWrapper.clearButton) {\n\t                            ej2_base_4.addClass([_this.inputWrapper.clearButton], exports.dropDownListClasses.clearIconHide);\n\t                        }\n\t                    }\n\t                    _this.activeStateChange();\n\t                }\n\t            });\n\t        };\n\t        DropDownList.prototype.isEmptyList = function () {\n\t            return !ej2_base_2.isNullOrUndefined(this.liCollections) && this.liCollections.length === 0;\n\t        };\n\t        DropDownList.prototype.getFocusElement = function () {\n\t        };\n\t        DropDownList.prototype.isFilterLayout = function () {\n\t            return this.getModuleName() === 'dropdownlist' && this.allowFiltering;\n\t        };\n\t        DropDownList.prototype.scrollHandler = function () {\n\t            if (ej2_base_3.Browser.isDevice && ((this.getModuleName() === 'dropdownlist' &&\n\t                !this.isFilterLayout()) || (this.getModuleName() === 'combobox' && !this.allowFiltering && this.isDropDownClick))) {\n\t                this.hidePopup();\n\t            }\n\t        };\n\t        DropDownList.prototype.setSearchBoxPosition = function () {\n\t            var searchBoxHeight = this.filterInput.parentElement.getBoundingClientRect().height;\n\t            this.popupObj.element.style.maxHeight = '100%';\n\t            this.popupObj.element.style.width = '100%';\n\t            this.list.style.maxHeight = (window.innerHeight - searchBoxHeight) + 'px';\n\t            this.list.style.height = (window.innerHeight - searchBoxHeight) + 'px';\n\t            var clearElement = this.filterInput.parentElement.querySelector('.' + exports.dropDownListClasses.clearIcon);\n\t            ej2_base_4.detach(this.filterInput);\n\t            clearElement.parentElement.insertBefore(this.filterInput, clearElement);\n\t        };\n\t        DropDownList.prototype.setPopupPosition = function (border) {\n\t            var offsetValue;\n\t            var popupOffset = border;\n\t            var selectedLI = this.list.querySelector('.' + exports.dropDownListClasses.focus) || this.selectedLI;\n\t            var firstItem = this.isEmptyList() ? this.list : this.liCollections[0];\n\t            var lastItem = this.isEmptyList() ? this.list : this.liCollections[this.getItems().length - 1];\n\t            var liHeight = firstItem.getBoundingClientRect().height;\n\t            var listHeight = this.list.offsetHeight / 2;\n\t            var height = ej2_base_2.isNullOrUndefined(selectedLI) ? firstItem.offsetTop : selectedLI.offsetTop;\n\t            var lastItemOffsetValue = lastItem.offsetTop;\n\t            if (lastItemOffsetValue - listHeight < height && !ej2_base_2.isNullOrUndefined(this.liCollections) &&\n\t                this.liCollections.length > 0 && !ej2_base_2.isNullOrUndefined(selectedLI)) {\n\t                var count = this.list.offsetHeight / liHeight;\n\t                var paddingBottom = parseInt(getComputedStyle(this.list).paddingBottom, 10);\n\t                offsetValue = (count - (this.liCollections.length - this.activeIndex)) * liHeight - popupOffset + paddingBottom;\n\t                this.list.scrollTop = selectedLI.offsetTop;\n\t            }\n\t            else if (height > listHeight) {\n\t                offsetValue = listHeight - liHeight / 2;\n\t                this.list.scrollTop = height - listHeight + liHeight / 2;\n\t            }\n\t            else {\n\t                offsetValue = height;\n\t            }\n\t            var inputHeight = this.inputWrapper.container.offsetHeight;\n\t            offsetValue = offsetValue + liHeight + popupOffset - ((liHeight - inputHeight) / 2);\n\t            return -offsetValue;\n\t        };\n\t        DropDownList.prototype.setWidth = function () {\n\t            var width = ej2_base_2.formatUnit(this.popupWidth);\n\t            if (width.indexOf('%') > -1) {\n\t                var inputWidth = this.inputWrapper.container.offsetWidth * parseFloat(width) / 100;\n\t                width = inputWidth.toString() + 'px';\n\t            }\n\t            if (ej2_base_3.Browser.isDevice && (!this.allowFiltering && (this.getModuleName() === 'dropdownlist' ||\n\t                (this.isDropDownClick && this.getModuleName() === 'combobox')))) {\n\t                var firstItem = this.isEmptyList() ? this.list : this.liCollections[0];\n\t                width = (parseInt(width, 10) + (parseInt(getComputedStyle(firstItem).textIndent, 10) -\n\t                    parseInt(getComputedStyle(this.inputElement).paddingLeft, 10) +\n\t                    parseInt(getComputedStyle(this.inputElement.parentElement).borderLeftWidth, 10)) * 2) + 'px';\n\t            }\n\t            return width;\n\t        };\n\t        DropDownList.prototype.scrollBottom = function (isInitial) {\n\t            var currentOffset = this.list.offsetHeight;\n\t            var nextBottom = this.selectedLI.offsetTop + this.selectedLI.offsetHeight - this.list.scrollTop;\n\t            var nextOffset = this.list.scrollTop + nextBottom - currentOffset;\n\t            nextOffset = isInitial ? nextOffset + parseInt(getComputedStyle(this.list).paddingTop, 10) * 2 : nextOffset;\n\t            var boxRange = this.selectedLI.offsetTop + this.selectedLI.offsetHeight - this.list.scrollTop;\n\t            boxRange = this.fields.groupBy && !ej2_base_2.isNullOrUndefined(this.fixedHeaderElement) ?\n\t                boxRange - this.fixedHeaderElement.offsetHeight : boxRange;\n\t            if (this.activeIndex === 0) {\n\t                this.list.scrollTop = 0;\n\t            }\n\t            else if (nextBottom > currentOffset || !(boxRange > 0 && this.list.offsetHeight > boxRange)) {\n\t                this.list.scrollTop = nextOffset;\n\t            }\n\t        };\n\t        DropDownList.prototype.scrollTop = function () {\n\t            var nextOffset = this.selectedLI.offsetTop - this.list.scrollTop;\n\t            var nextBottom = this.selectedLI.offsetTop + this.selectedLI.offsetHeight - this.list.scrollTop;\n\t            nextOffset = this.fields.groupBy && !ej2_base_2.isNullOrUndefined(this.fixedHeaderElement) ?\n\t                nextOffset - this.fixedHeaderElement.offsetHeight : nextOffset;\n\t            var boxRange = (this.selectedLI.offsetTop + this.selectedLI.offsetHeight - this.list.scrollTop);\n\t            if (this.activeIndex === 0) {\n\t                this.list.scrollTop = 0;\n\t            }\n\t            else if (nextOffset < 0) {\n\t                this.list.scrollTop = this.list.scrollTop + nextOffset;\n\t            }\n\t            else if (!(boxRange > 0 && this.list.offsetHeight > boxRange)) {\n\t                this.list.scrollTop = this.selectedLI.offsetTop - (this.fields.groupBy && !ej2_base_2.isNullOrUndefined(this.fixedHeaderElement) ?\n\t                    this.fixedHeaderElement.offsetHeight : 0);\n\t            }\n\t        };\n\t        DropDownList.prototype.isEditTextBox = function () {\n\t            return false;\n\t        };\n\t        DropDownList.prototype.isFiltering = function () {\n\t            return this.allowFiltering;\n\t        };\n\t        DropDownList.prototype.isPopupButton = function () {\n\t            return true;\n\t        };\n\t        DropDownList.prototype.setScrollPosition = function (e) {\n\t            if (!ej2_base_2.isNullOrUndefined(e)) {\n\t                switch (e.action) {\n\t                    case 'pageDown':\n\t                    case 'down':\n\t                    case 'end':\n\t                        this.scrollBottom();\n\t                        break;\n\t                    default:\n\t                        this.scrollTop();\n\t                        break;\n\t                }\n\t            }\n\t            else {\n\t                this.scrollBottom(true);\n\t            }\n\t        };\n\t        DropDownList.prototype.clearText = function () {\n\t            this.filterInput.value = '';\n\t            this.searchLists(null);\n\t        };\n\t        DropDownList.prototype.listScroll = function () {\n\t            this.filterInput.blur();\n\t        };\n\t        DropDownList.prototype.closePopup = function (delay) {\n\t            this.isTyped = false;\n\t            if (!(this.popupObj && document.body.contains(this.popupObj.element))) {\n\t                return;\n\t            }\n\t            ej2_base_1.EventHandler.remove(document, 'mousedown', this.onDocumentClick);\n\t            this.isActive = false;\n\t            this.filterInputObj = null;\n\t            this.isDropDownClick = false;\n\t            this.preventAutoFill = false;\n\t            var scrollableParentElements = this.popupObj.getScrollableParent(this.inputWrapper.container);\n\t            for (var _i = 0, scrollableParentElements_1 = scrollableParentElements; _i < scrollableParentElements_1.length; _i++) {\n\t                var element = scrollableParentElements_1[_i];\n\t                ej2_base_1.EventHandler.remove(element, 'scroll', this.scrollHandler);\n\t            }\n\t            if (ej2_base_3.Browser.isDevice && this.isFilterLayout()) {\n\t                ej2_base_4.removeClass([document.body, this.popupObj.element], exports.dropDownListClasses.popupFullScreen);\n\t                ej2_base_1.EventHandler.remove(this.list, 'scroll', this.listScroll);\n\t            }\n\t            if (this.isFilterLayout()) {\n\t                if (!ej2_base_3.Browser.isDevice) {\n\t                    this.searchKeyModule.destroy();\n\t                    if (this.clearIconElement) {\n\t                        ej2_base_1.EventHandler.remove(this.clearIconElement, 'click', this.clearText);\n\t                    }\n\t                }\n\t                if (this.backIconElement) {\n\t                    ej2_base_1.EventHandler.remove(this.backIconElement, 'click', this.clickOnBackIcon);\n\t                    ej2_base_1.EventHandler.remove(this.clearIconElement, 'click', this.clearText);\n\t                }\n\t                ej2_base_1.EventHandler.remove(this.filterInput, 'input', this.onInput);\n\t                ej2_base_1.EventHandler.remove(this.filterInput, 'keyup', this.onFilterUp);\n\t                ej2_base_1.EventHandler.remove(this.filterInput, 'keydown', this.onFilterDown);\n\t                ej2_base_1.EventHandler.remove(this.filterInput, 'blur', this.onBlur);\n\t                this.filterInput = null;\n\t            }\n\t            ej2_base_2.attributes(this.targetElement(), { 'aria-expanded': 'false', 'aria-activedescendant': null });\n\t            this.inputWrapper.container.classList.remove(exports.dropDownListClasses.iconAnimation);\n\t            if (this.isFiltering()) {\n\t                this.actionCompleteData.isUpdated = false;\n\t            }\n\t            this.beforePopupOpen = false;\n\t            var eventArgs = { popup: this.popupObj };\n\t            this.trigger('close', eventArgs);\n\t            var animModel = {\n\t                name: 'FadeOut',\n\t                duration: 100,\n\t                delay: delay ? delay : 0\n\t            };\n\t            if (this.getModuleName() === 'autocomplete') {\n\t                this.rippleFun();\n\t            }\n\t            if (this.isPopupOpen) {\n\t                this.popupObj.hide(new ej2_base_3.Animation(animModel));\n\t            }\n\t            else {\n\t                this.destroyPopup();\n\t            }\n\t        };\n\t        DropDownList.prototype.destroyPopup = function () {\n\t            this.isPopupOpen = false;\n\t            this.isFilterFocus = false;\n\t            this.popupObj.destroy();\n\t            ej2_base_4.detach(this.popupObj.element);\n\t        };\n\t        DropDownList.prototype.clickOnBackIcon = function () {\n\t            this.hidePopup();\n\t            this.focusIn();\n\t        };\n\t        DropDownList.prototype.render = function () {\n\t            if (this.element.tagName === 'INPUT') {\n\t                this.inputElement = this.element;\n\t            }\n\t            else {\n\t                this.inputElement = ej2_base_1.createElement('input');\n\t                if (this.element.tagName !== this.getNgDirective()) {\n\t                    this.element.style.display = 'none';\n\t                }\n\t                this.element.parentElement.insertBefore(this.inputElement, this.element);\n\t                this.preventTabIndex(this.inputElement);\n\t            }\n\t            this.inputWrapper = ej2_inputs_1.Input.createInput({\n\t                element: this.inputElement,\n\t                buttons: this.isPopupButton() ? [exports.dropDownListClasses.icon] : null,\n\t                floatLabelType: this.floatLabelType,\n\t                properties: {\n\t                    readonly: this.getModuleName() === 'dropdownlist' ? true : this.readonly,\n\t                    placeholder: this.placeholder,\n\t                    cssClass: this.cssClass,\n\t                    enabled: this.enabled,\n\t                    enableRtl: this.enableRtl,\n\t                    showClearButton: this.showClearButton\n\t                },\n\t            });\n\t            if (this.element.tagName === this.getNgDirective()) {\n\t                this.element.appendChild(this.inputWrapper.container);\n\t            }\n\t            else {\n\t                this.inputElement.parentElement.insertBefore(this.element, this.inputElement);\n\t            }\n\t            var name = this.element.getAttribute('name') ? this.element.getAttribute('name') : this.element.getAttribute('id');\n\t            this.hiddenElement = ej2_base_1.createElement('select', {\n\t                attrs: { 'name': name, 'aria-hidden': 'true' }, styles: 'display:none'\n\t            });\n\t            ej2_base_4.prepend([this.hiddenElement], this.inputWrapper.container);\n\t            this.element.removeAttribute('name');\n\t            this.setFields();\n\t            this.inputWrapper.container.style.width = ej2_base_2.formatUnit(this.width);\n\t            this.inputWrapper.container.classList.add('e-ddl');\n\t            this.wireEvent();\n\t            this.tabIndex = this.element.hasAttribute('tabindex') ? this.element.getAttribute('tabindex') : '0';\n\t            this.element.removeAttribute('tabindex');\n\t            var id = this.element.getAttribute('id') ? this.element.getAttribute('id') : ej2_base_2.getUniqueID('ej2_dropdownlist');\n\t            this.element.id = id;\n\t            this.hiddenElement.id = id + '_hidden';\n\t            this.targetElement().setAttribute('tabindex', this.tabIndex);\n\t            ej2_base_2.attributes(this.targetElement(), this.getAriaAttributes());\n\t            this.setHTMLAttributes();\n\t            if (this.value !== null || this.activeIndex !== null || this.text !== null) {\n\t                this.initValue();\n\t            }\n\t            else if (this.element.tagName === 'SELECT' && this.element.options[0]) {\n\t                var selectElement = this.element;\n\t                this.value = selectElement.options[selectElement.selectedIndex].value;\n\t                this.text = ej2_base_2.isNullOrUndefined(this.value) ? null : selectElement.options[selectElement.selectedIndex].textContent;\n\t                this.initValue();\n\t            }\n\t            this.preventTabIndex(this.element);\n\t            if (!this.enabled) {\n\t                this.targetElement().tabIndex = -1;\n\t            }\n\t            this.initial = false;\n\t            this.element.style.opacity = '';\n\t        };\n\t        ;\n\t        DropDownList.prototype.setFooterTemplate = function (popupEle) {\n\t            var compiledString;\n\t            if (this.footer) {\n\t                this.footer.innerHTML = '';\n\t            }\n\t            else {\n\t                this.footer = document.createElement('div');\n\t                ej2_base_4.addClass([this.footer], exports.dropDownListClasses.footer);\n\t            }\n\t            compiledString = ej2_base_1.compile(this.footerTemplate);\n\t            for (var _i = 0, _a = compiledString({}); _i < _a.length; _i++) {\n\t                var item = _a[_i];\n\t                this.footer.appendChild(item);\n\t            }\n\t            ej2_base_1.append([this.footer], popupEle);\n\t        };\n\t        DropDownList.prototype.setOldText = function (text) {\n\t            this.text = text;\n\t        };\n\t        DropDownList.prototype.setOldValue = function (value) {\n\t            this.value = value;\n\t        };\n\t        DropDownList.prototype.refreshPopup = function () {\n\t            if (!ej2_base_2.isNullOrUndefined(this.popupObj) && document.body.contains(this.popupObj.element) &&\n\t                ((this.allowFiltering && !(ej2_base_3.Browser.isDevice && this.isFilterLayout())) || this.getModuleName() === 'autocomplete')) {\n\t                this.popupObj.refreshPosition();\n\t            }\n\t        };\n\t        DropDownList.prototype.onPropertyChanged = function (newProp, oldProp) {\n\t            for (var _i = 0, _a = Object.keys(newProp); _i < _a.length; _i++) {\n\t                var prop = _a[_i];\n\t                switch (prop) {\n\t                    case 'htmlAttributes':\n\t                        this.setHTMLAttributes();\n\t                        break;\n\t                    case 'width':\n\t                        ej2_base_4.setStyleAttribute(this.inputWrapper.container, { 'width': ej2_base_2.formatUnit(newProp.width) });\n\t                        break;\n\t                    case 'placeholder':\n\t                        ej2_inputs_1.Input.setPlaceholder(newProp.placeholder, this.inputElement);\n\t                        break;\n\t                    case 'filterBarPlaceholder':\n\t                        ej2_inputs_1.Input.setPlaceholder(newProp.filterBarPlaceholder, this.filterInput);\n\t                        break;\n\t                    case 'readonly':\n\t                        ej2_inputs_1.Input.setReadonly(newProp.readonly, this.inputElement);\n\t                        break;\n\t                    case 'cssClass':\n\t                        ej2_inputs_1.Input.setCssClass(newProp.cssClass, [this.inputWrapper.container]);\n\t                        if (this.popupObj) {\n\t                            this.popupObj.element.classList.add(newProp.cssClass);\n\t                        }\n\t                        break;\n\t                    case 'enableRtl':\n\t                        this.setEnableRtl();\n\t                        break;\n\t                    case 'enabled':\n\t                        this.setEnable();\n\t                        break;\n\t                    case 'text':\n\t                        if (newProp.text === null) {\n\t                            this.clear();\n\t                            return;\n\t                        }\n\t                        if (!this.list) {\n\t                            if (this.dataSource instanceof ej2_data_1.DataManager) {\n\t                                this.initRemoteRender = true;\n\t                            }\n\t                            this.renderList();\n\t                        }\n\t                        if (!this.initRemoteRender) {\n\t                            var li = this.getElementByText(newProp.text);\n\t                            if (this.isValidLI(li)) {\n\t                                this.setSelection(li, null);\n\t                            }\n\t                            else {\n\t                                this.setOldText(oldProp.text);\n\t                            }\n\t                        }\n\t                        break;\n\t                    case 'value':\n\t                        if (newProp.value === null) {\n\t                            this.clear();\n\t                            return;\n\t                        }\n\t                        if (!this.list) {\n\t                            if (this.dataSource instanceof ej2_data_1.DataManager) {\n\t                                this.initRemoteRender = true;\n\t                            }\n\t                            this.renderList();\n\t                        }\n\t                        if (!this.initRemoteRender) {\n\t                            var item = this.getElementByValue(newProp.value);\n\t                            if (this.isValidLI(item)) {\n\t                                this.setSelection(item, null);\n\t                            }\n\t                            else {\n\t                                this.setOldValue(oldProp.value);\n\t                            }\n\t                        }\n\t                        break;\n\t                    case 'index':\n\t                        if (newProp.index === null) {\n\t                            this.clear();\n\t                            return;\n\t                        }\n\t                        if (!this.list) {\n\t                            if (this.dataSource instanceof ej2_data_1.DataManager) {\n\t                                this.initRemoteRender = true;\n\t                            }\n\t                            this.renderList();\n\t                        }\n\t                        if (!this.initRemoteRender) {\n\t                            var element = this.liCollections[newProp.index];\n\t                            if (this.isValidLI(element)) {\n\t                                this.setSelection(element, null);\n\t                            }\n\t                            else {\n\t                                this.index = oldProp.index;\n\t                            }\n\t                        }\n\t                        break;\n\t                    case 'query':\n\t                    case 'dataSource':\n\t                        this.clear(prop);\n\t                        this.resetList(this.dataSource);\n\t                        break;\n\t                    case 'footerTemplate':\n\t                        if (this.popupObj) {\n\t                            this.setFooterTemplate(this.popupObj.element);\n\t                        }\n\t                        break;\n\t                    case 'floatLabelType':\n\t                        ej2_inputs_1.Input.removeFloating(this.inputWrapper);\n\t                        ej2_inputs_1.Input.addFloating(this.inputElement, newProp.floatLabelType, this.placeholder);\n\t                        break;\n\t                    default:\n\t                        var ddlProps = void 0;\n\t                        ddlProps = this.getPropObject(prop, newProp, oldProp);\n\t                        _super.prototype.onPropertyChanged.call(this, ddlProps.newProperty, ddlProps.oldProperty);\n\t                        break;\n\t                }\n\t            }\n\t        };\n\t        DropDownList.prototype.getModuleName = function () {\n\t            return 'dropdownlist';\n\t        };\n\t        DropDownList.prototype.showPopup = function () {\n\t            if (this.beforePopupOpen) {\n\t                this.refreshPopup();\n\t                return;\n\t            }\n\t            this.beforePopupOpen = true;\n\t            if (this.isFiltering() && !this.isActive && this.actionCompleteData.list && this.actionCompleteData.list[0]) {\n\t                this.isActive = true;\n\t                this.onActionComplete(this.actionCompleteData.ulElement, this.actionCompleteData.list, null, true);\n\t            }\n\t            else if (ej2_base_2.isNullOrUndefined(this.list) || !ej2_base_2.isUndefined(this.list) && this.list.classList.contains(drop_down_base_1.dropDownBaseClasses.noData)) {\n\t                this.renderList();\n\t            }\n\t            if (ej2_base_3.Browser.isDevice && this.isFilterLayout()) {\n\t                var proxy_1 = this;\n\t                window.onpopstate = function () {\n\t                    proxy_1.hidePopup();\n\t                };\n\t                history.pushState({}, '');\n\t            }\n\t            if (!ej2_base_2.isNullOrUndefined(this.list.children[0]) || this.list.classList.contains(drop_down_base_1.dropDownBaseClasses.noData)) {\n\t                this.renderPopup();\n\t            }\n\t            ej2_base_2.attributes(this.targetElement(), { 'aria-activedescendant': this.selectedLI ? this.selectedLI.id : null });\n\t        };\n\t        DropDownList.prototype.hidePopup = function () {\n\t            if (this.isEscapeKey && this.getModuleName() === 'dropdownlist') {\n\t                ej2_inputs_1.Input.setValue(this.text, this.inputElement, this.floatLabelType, this.showClearButton);\n\t                this.isEscapeKey = false;\n\t                if (!ej2_base_2.isNullOrUndefined(this.index)) {\n\t                    this.selectedLI = this.liCollections[this.index];\n\t                    this.updateSelectedItem(this.selectedLI, null, true);\n\t                    if (this.valueTemplate && this.itemData !== null) {\n\t                        this.setValueTemplate();\n\t                    }\n\t                }\n\t                else {\n\t                    this.resetSelection();\n\t                }\n\t            }\n\t            this.closePopup();\n\t            var dataItem = this.getItemData();\n\t            if (this.inputElement.value.trim() === '' && !this.isInteracted && (this.isSelectCustom ||\n\t                !ej2_base_2.isNullOrUndefined(this.selectedLI) && this.inputElement.value !== dataItem.text)) {\n\t                this.isSelectCustom = false;\n\t                this.clear();\n\t            }\n\t        };\n\t        DropDownList.prototype.focusIn = function () {\n\t            if (this.targetElement().classList.contains(exports.dropDownListClasses.disable)) {\n\t                return;\n\t            }\n\t            var isFocused = false;\n\t            if (this.preventFocus && ej2_base_3.Browser.isDevice) {\n\t                this.inputWrapper.container.tabIndex = 1;\n\t                this.inputWrapper.container.focus();\n\t                this.preventFocus = false;\n\t                isFocused = true;\n\t            }\n\t            if (!isFocused) {\n\t                this.targetElement().focus();\n\t            }\n\t            ej2_base_4.addClass([this.inputWrapper.container], [exports.dropDownListClasses.inputFocus]);\n\t            this.onFocus();\n\t        };\n\t        DropDownList.prototype.focusOut = function () {\n\t            this.isTyped = true;\n\t            this.hidePopup();\n\t            this.targetElement().blur();\n\t            ej2_base_4.removeClass([this.inputWrapper.container], [exports.dropDownListClasses.inputFocus]);\n\t        };\n\t        DropDownList.prototype.destroy = function () {\n\t            var _this = this;\n\t            this.isActive = false;\n\t            this.hidePopup();\n\t            this.unWireEvent();\n\t            if (this.list) {\n\t                this.unWireListEvents();\n\t            }\n\t            ['readonly', 'aria-disabled', 'aria-placeholder', 'placeholder'].forEach(function (value) {\n\t                _this.inputElement.removeAttribute(value);\n\t            });\n\t            this.inputElement.setAttribute('tabindex', this.tabIndex);\n\t            this.inputElement.classList.remove('e-input');\n\t            ej2_inputs_1.Input.setValue('', this.inputElement, this.floatLabelType, this.showClearButton);\n\t            this.element.style.display = 'block';\n\t            if (this.inputWrapper.container.parentElement.tagName === this.getNgDirective()) {\n\t                ej2_base_4.detach(this.inputWrapper.container);\n\t            }\n\t            else {\n\t                this.inputWrapper.container.parentElement.insertBefore(this.element, this.inputWrapper.container);\n\t                ej2_base_4.detach(this.inputWrapper.container);\n\t            }\n\t            _super.prototype.destroy.call(this);\n\t        };\n\t        ;\n\t        return DropDownList;\n\t    }(drop_down_base_1.DropDownBase));\n\t    __decorate([\n\t        ej2_base_1.Property(null)\n\t    ], DropDownList.prototype, \"cssClass\", void 0);\n\t    __decorate([\n\t        ej2_base_1.Property('100%')\n\t    ], DropDownList.prototype, \"width\", void 0);\n\t    __decorate([\n\t        ej2_base_1.Property('300px')\n\t    ], DropDownList.prototype, \"popupHeight\", void 0);\n\t    __decorate([\n\t        ej2_base_1.Property('100%')\n\t    ], DropDownList.prototype, \"popupWidth\", void 0);\n\t    __decorate([\n\t        ej2_base_1.Property(null)\n\t    ], DropDownList.prototype, \"placeholder\", void 0);\n\t    __decorate([\n\t        ej2_base_1.Property(null)\n\t    ], DropDownList.prototype, \"filterBarPlaceholder\", void 0);\n\t    __decorate([\n\t        ej2_base_1.Property({})\n\t    ], DropDownList.prototype, \"htmlAttributes\", void 0);\n\t    __decorate([\n\t        ej2_base_1.Property(null)\n\t    ], DropDownList.prototype, \"query\", void 0);\n\t    __decorate([\n\t        ej2_base_1.Property(null)\n\t    ], DropDownList.prototype, \"valueTemplate\", void 0);\n\t    __decorate([\n\t        ej2_base_1.Property(null)\n\t    ], DropDownList.prototype, \"headerTemplate\", void 0);\n\t    __decorate([\n\t        ej2_base_1.Property(null)\n\t    ], DropDownList.prototype, \"footerTemplate\", void 0);\n\t    __decorate([\n\t        ej2_base_1.Property(false)\n\t    ], DropDownList.prototype, \"allowFiltering\", void 0);\n\t    __decorate([\n\t        ej2_base_1.Property(false)\n\t    ], DropDownList.prototype, \"readonly\", void 0);\n\t    __decorate([\n\t        ej2_base_1.Property(null)\n\t    ], DropDownList.prototype, \"text\", void 0);\n\t    __decorate([\n\t        ej2_base_1.Property(null)\n\t    ], DropDownList.prototype, \"value\", void 0);\n\t    __decorate([\n\t        ej2_base_1.Property(null)\n\t    ], DropDownList.prototype, \"index\", void 0);\n\t    __decorate([\n\t        ej2_base_1.Property('Never')\n\t    ], DropDownList.prototype, \"floatLabelType\", void 0);\n\t    __decorate([\n\t        ej2_base_1.Property(false)\n\t    ], DropDownList.prototype, \"showClearButton\", void 0);\n\t    __decorate([\n\t        ej2_base_1.Event()\n\t    ], DropDownList.prototype, \"filtering\", void 0);\n\t    __decorate([\n\t        ej2_base_1.Event()\n\t    ], DropDownList.prototype, \"change\", void 0);\n\t    __decorate([\n\t        ej2_base_1.Event()\n\t    ], DropDownList.prototype, \"open\", void 0);\n\t    __decorate([\n\t        ej2_base_1.Event()\n\t    ], DropDownList.prototype, \"close\", void 0);\n\t    __decorate([\n\t        ej2_base_1.Event()\n\t    ], DropDownList.prototype, \"blur\", void 0);\n\t    __decorate([\n\t        ej2_base_1.Event()\n\t    ], DropDownList.prototype, \"focus\", void 0);\n\t    DropDownList = __decorate([\n\t        ej2_base_3.NotifyPropertyChanges\n\t    ], DropDownList);\n\t    exports.DropDownList = DropDownList;\n\t}.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__), __WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));\n\n\n/***/ }),\n/* 11 */\n/***/ (function(module, exports) {\n\n\tmodule.exports = __WEBPACK_EXTERNAL_MODULE_11__;\n\n/***/ }),\n/* 12 */\n/***/ (function(module, exports) {\n\n\tmodule.exports = __WEBPACK_EXTERNAL_MODULE_12__;\n\n/***/ }),\n/* 13 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\tvar __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__, exports, __webpack_require__(14)], __WEBPACK_AMD_DEFINE_RESULT__ = function (require, exports, combo_box_1) {\n\t    \"use strict\";\n\t    function __export(m) {\n\t        for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\n\t    }\n\t    Object.defineProperty(exports, \"__esModule\", { value: true });\n\t    __export(combo_box_1);\n\t}.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__), __WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));\n\n\n/***/ }),\n/* 14 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\tvar __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;var __extends = (this && this.__extends) || (function () {\n\t    var extendStatics = Object.setPrototypeOf ||\n\t        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n\t        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n\t    return function (d, b) {\n\t        extendStatics(d, b);\n\t        function __() { this.constructor = d; }\n\t        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n\t    };\n\t})();\n\tvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n\t    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n\t    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n\t    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n\t    return c > 3 && r && Object.defineProperty(target, key, r), r;\n\t};\n\t!(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__, exports, __webpack_require__(6), __webpack_require__(6), __webpack_require__(10), __webpack_require__(5), __webpack_require__(2), __webpack_require__(11), __webpack_require__(12)], __WEBPACK_AMD_DEFINE_RESULT__ = function (require, exports, ej2_base_1, ej2_base_2, drop_down_list_1, drop_down_base_1, incremental_search_1, ej2_popups_1, ej2_inputs_1) {\n\t    \"use strict\";\n\t    Object.defineProperty(exports, \"__esModule\", { value: true });\n\t    drop_down_list_1.dropDownListClasses.root = 'e-combobox';\n\t    var inputObject = {\n\t        container: null,\n\t        buttons: []\n\t    };\n\t    var ComboBox = (function (_super) {\n\t        __extends(ComboBox, _super);\n\t        function ComboBox(options, element) {\n\t            return _super.call(this, options, element) || this;\n\t        }\n\t        ;\n\t        ComboBox.prototype.preRender = function () {\n\t            _super.prototype.preRender.call(this);\n\t        };\n\t        ComboBox.prototype.wireEvent = function () {\n\t            if (this.getModuleName() === 'combobox') {\n\t                ej2_base_1.EventHandler.add(this.inputWrapper.buttons[0], 'mousedown', this.preventBlur, this);\n\t                ej2_base_1.EventHandler.add(this.inputWrapper.container, 'blur', this.onBlur, this);\n\t            }\n\t            if (!ej2_base_2.isNullOrUndefined(this.inputWrapper.buttons[0])) {\n\t                ej2_base_1.EventHandler.add(this.inputWrapper.buttons[0], 'mousedown', this.dropDownClick, this);\n\t            }\n\t            ej2_base_1.EventHandler.add(this.inputElement, 'focus', this.targetFocus, this);\n\t            if (!this.readonly) {\n\t                ej2_base_1.EventHandler.add(this.inputElement, 'input', this.onInput, this);\n\t                ej2_base_1.EventHandler.add(this.inputElement, 'keyup', this.onFilterUp, this);\n\t                ej2_base_1.EventHandler.add(this.inputElement, 'keydown', this.onFilterDown, this);\n\t            }\n\t            this.bindCommonEvent();\n\t        };\n\t        ComboBox.prototype.preventBlur = function (e) {\n\t            if ((!this.allowFiltering && document.activeElement !== this.inputElement &&\n\t                !document.activeElement.classList.contains(drop_down_list_1.dropDownListClasses.input) && ej2_base_1.Browser.isDevice || !ej2_base_1.Browser.isDevice)) {\n\t                e.preventDefault();\n\t            }\n\t        };\n\t        ComboBox.prototype.targetElement = function () {\n\t            return this.inputElement;\n\t        };\n\t        ComboBox.prototype.setOldText = function (text) {\n\t            ej2_inputs_1.Input.setValue(this.text, this.inputElement, this.floatLabelType, this.showClearButton);\n\t            this.customValue();\n\t            this.removeSelection();\n\t        };\n\t        ComboBox.prototype.setOldValue = function (value) {\n\t            if (this.allowCustom) {\n\t                this.valueMuteChange(this.value);\n\t            }\n\t            else {\n\t                this.valueMuteChange(null);\n\t            }\n\t            this.removeSelection();\n\t            this.setHiddenValue();\n\t        };\n\t        ComboBox.prototype.valueMuteChange = function (value) {\n\t            var inputValue = ej2_base_2.isNullOrUndefined(value) ? null : value.toString();\n\t            ej2_inputs_1.Input.setValue(inputValue, this.inputElement, this.floatLabelType, this.showClearButton);\n\t            this.setProperties({ value: value, text: value, index: null }, true);\n\t            this.activeIndex = this.index;\n\t            var fields = this.fields;\n\t            var dataItem = {};\n\t            dataItem[fields.text] = ej2_base_2.isNullOrUndefined(value) ? null : value.toString();\n\t            dataItem[fields.value] = ej2_base_2.isNullOrUndefined(value) ? null : value.toString();\n\t            this.itemData = dataItem;\n\t            this.item = null;\n\t            if (this.previousValue !== this.value) {\n\t                this.detachChangeEvent(null);\n\t            }\n\t        };\n\t        ComboBox.prototype.updateValues = function () {\n\t            if (!ej2_base_2.isNullOrUndefined(this.value)) {\n\t                var li = this.getElementByValue(this.value);\n\t                if (li) {\n\t                    this.setSelection(li, null);\n\t                }\n\t                else if (this.allowCustom) {\n\t                    this.valueMuteChange(this.value);\n\t                }\n\t                else {\n\t                    this.valueMuteChange(null);\n\t                }\n\t            }\n\t            else if (this.text && ej2_base_2.isNullOrUndefined(this.value)) {\n\t                var li = this.getElementByText(this.text);\n\t                if (li) {\n\t                    this.setSelection(li, null);\n\t                }\n\t                else {\n\t                    ej2_inputs_1.Input.setValue(this.text, this.inputElement, this.floatLabelType, this.showClearButton);\n\t                    this.customValue();\n\t                }\n\t            }\n\t            else {\n\t                this.setSelection(this.liCollections[this.activeIndex], null);\n\t            }\n\t            this.setHiddenValue();\n\t            ej2_inputs_1.Input.setValue(this.text, this.inputElement, this.floatLabelType, this.showClearButton);\n\t        };\n\t        ComboBox.prototype.getAriaAttributes = function () {\n\t            var ariaAttributes = {\n\t                'aria-owns': this.element.id + '_options',\n\t                'role': 'combobox',\n\t                'aria-autocomplete': 'both',\n\t                'aria-labelledby': this.hiddenElement.id,\n\t                'aria-hasPopup': 'true',\n\t                'aria-expanded': 'false',\n\t                'aria-readonly': this.readonly.toString(),\n\t                'autocomplete': 'off',\n\t                'autocorrect': 'off',\n\t                'autocapitalize': 'off',\n\t                'spellcheck': 'false'\n\t            };\n\t            return ariaAttributes;\n\t        };\n\t        ComboBox.prototype.searchLists = function (e) {\n\t            this.isTyped = true;\n\t            if (this.isFiltering()) {\n\t                _super.prototype.searchLists.call(this, e);\n\t                if (this.filterInput.value.trim() === '') {\n\t                    this.setHoverList(this.ulElement.querySelector('.' + drop_down_list_1.dropDownListClasses.li));\n\t                }\n\t            }\n\t            else {\n\t                if (this.ulElement && this.inputElement.value === '' && this.preventAutoFill) {\n\t                    this.setHoverList(this.ulElement.querySelector('.' + drop_down_list_1.dropDownListClasses.li));\n\t                }\n\t                this.incrementalSearch(e);\n\t            }\n\t        };\n\t        ComboBox.prototype.getNgDirective = function () {\n\t            return 'EJ-COMBOBOX';\n\t        };\n\t        ComboBox.prototype.setSearchBox = function () {\n\t            this.filterInput = this.inputElement;\n\t            return (this.isFiltering() ? this.inputWrapper : inputObject);\n\t        };\n\t        ComboBox.prototype.onActionComplete = function (ulElement, list, e, isUpdated) {\n\t            _super.prototype.onActionComplete.call(this, ulElement, list, e);\n\t            if (this.isSelectCustom) {\n\t                this.removeSelection();\n\t            }\n\t            if (!this.preventAutoFill && this.getModuleName() === 'combobox' && this.isTyped) {\n\t                this.inlineSearch();\n\t            }\n\t        };\n\t        ComboBox.prototype.getFocusElement = function () {\n\t            var dataItem = this.isSelectCustom ? { text: '' } : this.getItemData();\n\t            var selected = this.list.querySelector('.' + drop_down_list_1.dropDownListClasses.selected);\n\t            var isSelected = dataItem.text === this.inputElement.value && !ej2_base_2.isNullOrUndefined(selected);\n\t            if (isSelected) {\n\t                return selected;\n\t            }\n\t            if ((ej2_base_1.Browser.isDevice && !this.isDropDownClick || !ej2_base_1.Browser.isDevice) &&\n\t                !ej2_base_2.isNullOrUndefined(this.liCollections) && this.liCollections.length > 0) {\n\t                var inputValue = this.inputElement.value;\n\t                var activeItem = incremental_search_1.Search(inputValue, this.liCollections, 'StartsWith', true);\n\t                var activeElement = activeItem.item;\n\t                if (!ej2_base_2.isNullOrUndefined(activeElement)) {\n\t                    var count = this.getIndexByValue(activeElement.getAttribute('data-value')) - 1;\n\t                    var height = parseInt(getComputedStyle(this.liCollections[0], null).getPropertyValue('height'), 10);\n\t                    if (!isNaN(height) && this.getModuleName() !== 'autocomplete') {\n\t                        this.removeFocus();\n\t                        var fixedHead = this.fields.groupBy ? this.liCollections[0].offsetHeight : 0;\n\t                        this.list.scrollTop = count * height + fixedHead;\n\t                        ej2_base_1.addClass([activeElement], drop_down_list_1.dropDownListClasses.focus);\n\t                    }\n\t                }\n\t                else {\n\t                    if (this.isSelectCustom && this.inputElement.value.trim() !== '') {\n\t                        this.removeFocus();\n\t                        this.list.scrollTop = 0;\n\t                    }\n\t                }\n\t                return activeElement;\n\t            }\n\t            else {\n\t                return null;\n\t            }\n\t        };\n\t        ComboBox.prototype.setValue = function (e) {\n\t            if (e && e.type === 'keydown' && e.action === 'enter') {\n\t                this.removeFillSelection();\n\t            }\n\t            if (this.autofill && this.getModuleName() === 'combobox' && e && e.type === 'keydown' && e.action !== 'enter') {\n\t                this.preventAutoFill = false;\n\t                this.inlineSearch(e);\n\t                return false;\n\t            }\n\t            else {\n\t                return _super.prototype.setValue.call(this, e);\n\t            }\n\t        };\n\t        ComboBox.prototype.showSpinner = function () {\n\t            if (ej2_base_2.isNullOrUndefined(this.spinnerElement)) {\n\t                this.spinnerElement = this.inputWrapper.buttons[0] || this.inputWrapper.clearButton;\n\t                ej2_base_1.addClass([this.spinnerElement], drop_down_list_1.dropDownListClasses.disableIcon);\n\t                ej2_popups_1.createSpinner({\n\t                    target: this.spinnerElement,\n\t                    width: drop_down_base_1.SPINNER_SIZE\n\t                });\n\t                ej2_popups_1.showSpinner(this.spinnerElement);\n\t            }\n\t        };\n\t        ComboBox.prototype.hideSpinner = function () {\n\t            if (!ej2_base_2.isNullOrUndefined(this.spinnerElement)) {\n\t                ej2_popups_1.hideSpinner(this.spinnerElement);\n\t                this.spinnerElement.innerHTML = '';\n\t                ej2_base_1.removeClass([this.spinnerElement], drop_down_list_1.dropDownListClasses.disableIcon);\n\t                this.spinnerElement = null;\n\t            }\n\t        };\n\t        ComboBox.prototype.setAutoFill = function (activeElement, isHover) {\n\t            if (!isHover) {\n\t                this.setHoverList(activeElement);\n\t            }\n\t            if (this.autofill && !this.preventAutoFill) {\n\t                var currentValue = this.getTextByValue(activeElement.getAttribute('data-value')).toString();\n\t                var currentFillValue = this.getFormattedValue(activeElement.getAttribute('data-value'));\n\t                if (this.getModuleName() === 'combobox') {\n\t                    if (!this.isSelected && this.previousValue !== currentFillValue) {\n\t                        this.updateSelectedItem(activeElement, null);\n\t                        this.isSelected = true;\n\t                        this.previousValue = this.getFormattedValue(activeElement.getAttribute('data-value'));\n\t                    }\n\t                    else {\n\t                        this.updateSelectedItem(activeElement, null, true);\n\t                    }\n\t                }\n\t                if (!this.isAndroidAutoFill(currentValue)) {\n\t                    this.setAutoFillSelection(currentValue);\n\t                }\n\t            }\n\t        };\n\t        ComboBox.prototype.isAndroidAutoFill = function (value) {\n\t            if (ej2_base_1.Browser.isAndroid) {\n\t                var currentPoints = this.getSelectionPoints();\n\t                var prevEnd = this.prevSelectPoints.end;\n\t                var curEnd = currentPoints.end;\n\t                var prevStart = this.prevSelectPoints.start;\n\t                var curStart = currentPoints.start;\n\t                if (prevEnd !== 0 && ((prevEnd === value.length && prevStart === value.length) ||\n\t                    (prevStart > curStart && prevEnd > curEnd) || (prevEnd === curEnd && prevStart === curStart))) {\n\t                    return true;\n\t                }\n\t                else {\n\t                    return false;\n\t                }\n\t            }\n\t            else {\n\t                return false;\n\t            }\n\t        };\n\t        ComboBox.prototype.isSelectFocusItem = function (element) {\n\t            return !ej2_base_2.isNullOrUndefined(element);\n\t        };\n\t        ComboBox.prototype.inlineSearch = function (e) {\n\t            var isKeyNavigate = (e && (e.action === 'down' || e.action === 'up' ||\n\t                e.action === 'home' || e.action === 'end' || e.action === 'pageUp' || e.action === 'pageDown'));\n\t            var activeElement = isKeyNavigate ? this.liCollections[this.activeIndex] : this.getFocusElement();\n\t            if (!ej2_base_2.isNullOrUndefined(activeElement)) {\n\t                if (!isKeyNavigate) {\n\t                    var value = this.getFormattedValue(activeElement.getAttribute('data-value'));\n\t                    this.activeIndex = this.getIndexByValue(value);\n\t                    this.activeIndex = !ej2_base_2.isNullOrUndefined(this.activeIndex) ? this.activeIndex : null;\n\t                }\n\t                this.preventAutoFill = this.inputElement.value === '' ? false : this.preventAutoFill;\n\t                this.setAutoFill(activeElement, isKeyNavigate);\n\t            }\n\t            else if (this.inputElement.value === '') {\n\t                this.activeIndex = null;\n\t                this.list.scrollTop = 0;\n\t                var focusItem = this.list.querySelector('.' + drop_down_list_1.dropDownListClasses.li);\n\t                this.setHoverList(focusItem);\n\t            }\n\t            else {\n\t                this.activeIndex = null;\n\t                this.removeSelection();\n\t                this.removeFocus();\n\t            }\n\t        };\n\t        ComboBox.prototype.incrementalSearch = function (e) {\n\t            this.showPopup();\n\t            if (!ej2_base_2.isNullOrUndefined(this.listData)) {\n\t                this.inlineSearch(e);\n\t                e.preventDefault();\n\t            }\n\t        };\n\t        ;\n\t        ComboBox.prototype.setAutoFillSelection = function (currentValue) {\n\t            var selection = this.getSelectionPoints();\n\t            var value = this.inputElement.value.substr(0, selection.start);\n\t            if (value && (value.toLowerCase() === currentValue.substr(0, selection.start).toLowerCase())) {\n\t                var inputValue = value + currentValue.substr(value.length, currentValue.length);\n\t                ej2_inputs_1.Input.setValue(inputValue, this.inputElement, this.floatLabelType, this.showClearButton);\n\t                this.inputElement.setSelectionRange(selection.start, this.inputElement.value.length);\n\t            }\n\t            else {\n\t                ej2_inputs_1.Input.setValue(currentValue, this.inputElement, this.floatLabelType, this.showClearButton);\n\t                this.inputElement.setSelectionRange(0, this.inputElement.value.length);\n\t            }\n\t        };\n\t        ;\n\t        ComboBox.prototype.getValueByText = function (text) {\n\t            return _super.prototype.getValueByText.call(this, text, true);\n\t        };\n\t        ComboBox.prototype.unWireEvent = function () {\n\t            if (this.getModuleName() === 'combobox') {\n\t                ej2_base_1.EventHandler.remove(this.inputWrapper.buttons[0], 'mousedown', this.preventBlur);\n\t                ej2_base_1.EventHandler.remove(this.inputWrapper.container, 'blur', this.onBlur);\n\t            }\n\t            if (!ej2_base_2.isNullOrUndefined(this.inputWrapper.buttons[0])) {\n\t                ej2_base_1.EventHandler.remove(this.inputWrapper.buttons[0], 'mousedown', this.dropDownClick);\n\t            }\n\t            ej2_base_1.EventHandler.remove(this.inputElement, 'focus', this.targetFocus);\n\t            if (!this.readonly) {\n\t                ej2_base_1.EventHandler.remove(this.inputElement, 'input', this.onInput);\n\t                ej2_base_1.EventHandler.remove(this.inputElement, 'keyup', this.onFilterUp);\n\t                ej2_base_1.EventHandler.remove(this.inputElement, 'keydown', this.onFilterDown);\n\t            }\n\t            this.unBindCommonEvent();\n\t        };\n\t        ComboBox.prototype.setSelection = function (li, e) {\n\t            _super.prototype.setSelection.call(this, li, e);\n\t            if (!ej2_base_2.isNullOrUndefined(li) && !this.autofill && !this.isDropDownClick) {\n\t                this.removeFocus();\n\t            }\n\t        };\n\t        ComboBox.prototype.selectCurrentItem = function (e) {\n\t            var li;\n\t            if (this.isPopupOpen) {\n\t                li = this.list.querySelector('.' + drop_down_list_1.dropDownListClasses.focus);\n\t                if (li) {\n\t                    this.setSelection(li, e);\n\t                    this.isTyped = false;\n\t                }\n\t                if (this.isSelected) {\n\t                    this.isSelectCustom = false;\n\t                    this.onChangeEvent(e);\n\t                }\n\t            }\n\t            if (this.isTyped && !this.isSelected && ej2_base_2.isNullOrUndefined(li)) {\n\t                this.customValue();\n\t            }\n\t            this.hidePopup();\n\t        };\n\t        ComboBox.prototype.setHoverList = function (li) {\n\t            this.removeSelection();\n\t            if (this.isValidLI(li) && !li.classList.contains(drop_down_list_1.dropDownListClasses.selected)) {\n\t                this.removeFocus();\n\t                li.classList.add(drop_down_list_1.dropDownListClasses.focus);\n\t            }\n\t        };\n\t        ;\n\t        ComboBox.prototype.targetFocus = function (e) {\n\t            if (ej2_base_1.Browser.isDevice && !this.allowFiltering) {\n\t                this.preventFocus = false;\n\t            }\n\t            this.onFocus();\n\t        };\n\t        ComboBox.prototype.dropDownClick = function (e) {\n\t            if (ej2_base_1.Browser.isDevice && !this.allowFiltering) {\n\t                this.preventFocus = true;\n\t            }\n\t            _super.prototype.dropDownClick.call(this, e);\n\t        };\n\t        ComboBox.prototype.customValue = function () {\n\t            var value = this.getValueByText(this.inputElement.value);\n\t            if (!this.allowCustom && this.inputElement.value !== '') {\n\t                this.setProperties({ value: value });\n\t                if (ej2_base_2.isNullOrUndefined(this.value)) {\n\t                    ej2_inputs_1.Input.setValue('', this.inputElement, this.floatLabelType, this.showClearButton);\n\t                }\n\t            }\n\t            else if (this.inputElement.value.trim() !== '') {\n\t                var previousValue = this.value;\n\t                if (ej2_base_2.isNullOrUndefined(value)) {\n\t                    var value_1 = this.inputElement.value === '' ? null : this.inputElement.value;\n\t                    var fields = this.fields;\n\t                    var eventArgs = void 0;\n\t                    eventArgs = { text: value_1, item: {} };\n\t                    if (!this.initial) {\n\t                        this.trigger('customValueSpecifier', eventArgs);\n\t                    }\n\t                    var item = eventArgs.item;\n\t                    var dataItem = {};\n\t                    if (item && item[fields.text] && item[fields.value]) {\n\t                        dataItem = item;\n\t                    }\n\t                    else {\n\t                        dataItem[fields.text] = value_1;\n\t                        dataItem[fields.value] = value_1;\n\t                    }\n\t                    this.itemData = dataItem;\n\t                    this.setProperties({ text: this.itemData[fields.text], value: this.itemData[fields.value], index: null }, true);\n\t                    this.setSelection(null, null);\n\t                    this.isSelectCustom = true;\n\t                }\n\t                else {\n\t                    this.isSelectCustom = false;\n\t                    this.setProperties({ value: value });\n\t                }\n\t                if (previousValue !== this.value) {\n\t                    this.onChangeEvent(null);\n\t                }\n\t            }\n\t        };\n\t        ComboBox.prototype.onPropertyChanged = function (newProp, oldProp) {\n\t            for (var _i = 0, _a = Object.keys(newProp); _i < _a.length; _i++) {\n\t                var prop = _a[_i];\n\t                switch (prop) {\n\t                    case 'readonly':\n\t                        ej2_inputs_1.Input.setReadonly(this.readonly, this.inputElement);\n\t                        if (this.readonly) {\n\t                            ej2_base_1.EventHandler.remove(this.inputElement, 'keyup', this.onFilterUp);\n\t                            ej2_base_1.EventHandler.remove(this.inputElement, 'keydown', this.onFilterDown);\n\t                        }\n\t                        else {\n\t                            ej2_base_1.EventHandler.add(this.inputElement, 'keyup', this.onFilterUp, this);\n\t                            ej2_base_1.EventHandler.add(this.inputElement, 'keydown', this.onFilterDown, this);\n\t                        }\n\t                        break;\n\t                    case 'allowFiltering':\n\t                        this.setSearchBox();\n\t                        break;\n\t                    case 'allowCustom':\n\t                        break;\n\t                    default:\n\t                        var comboProps = void 0;\n\t                        comboProps = this.getPropObject(prop, newProp, oldProp);\n\t                        _super.prototype.onPropertyChanged.call(this, comboProps.newProperty, comboProps.oldProperty);\n\t                        break;\n\t                }\n\t            }\n\t        };\n\t        ComboBox.prototype.render = function () {\n\t            _super.prototype.render.call(this);\n\t            this.setSearchBox();\n\t            if (this.isFiltering() && this.getModuleName() === 'combobox' && ej2_base_2.isNullOrUndefined(this.list)) {\n\t                _super.prototype.renderList.call(this);\n\t            }\n\t        };\n\t        ;\n\t        ComboBox.prototype.getModuleName = function () {\n\t            return 'combobox';\n\t        };\n\t        ComboBox.prototype.hidePopup = function () {\n\t            if (!ej2_base_2.isNullOrUndefined(this.listData)) {\n\t                var isEscape = this.isEscapeKey;\n\t                if (this.isEscapeKey) {\n\t                    ej2_inputs_1.Input.setValue(this.typedString, this.inputElement, this.floatLabelType, this.showClearButton);\n\t                    this.isEscapeKey = false;\n\t                }\n\t                if (this.autofill) {\n\t                    this.removeFillSelection();\n\t                }\n\t                var dataItem = this.isSelectCustom ? { text: '' } : this.getItemData();\n\t                var selected = this.list.querySelector('.' + drop_down_list_1.dropDownListClasses.selected);\n\t                if (dataItem.text === this.inputElement.value && !ej2_base_2.isNullOrUndefined(selected)) {\n\t                    if (this.isSelected) {\n\t                        this.onChangeEvent(null);\n\t                        this.isSelectCustom = false;\n\t                    }\n\t                    _super.prototype.hidePopup.call(this);\n\t                    return;\n\t                }\n\t                if (this.getModuleName() === 'combobox' && this.inputElement.value.trim() !== '') {\n\t                    var searchItem = incremental_search_1.Search(this.inputElement.value, this.liCollections, 'Equal', true);\n\t                    this.selectedLI = searchItem.item;\n\t                    if (ej2_base_2.isNullOrUndefined(searchItem.index)) {\n\t                        searchItem.index = incremental_search_1.Search(this.inputElement.value, this.liCollections, 'StartsWith', true).index;\n\t                    }\n\t                    this.activeIndex = searchItem.index;\n\t                    if (!ej2_base_2.isNullOrUndefined(this.selectedLI)) {\n\t                        this.updateSelectedItem(this.selectedLI, null, true);\n\t                    }\n\t                    else if (isEscape) {\n\t                        this.isSelectCustom = true;\n\t                        this.removeSelection();\n\t                    }\n\t                }\n\t                if (!this.isEscapeKey && this.isTyped && !this.isInteracted) {\n\t                    this.customValue();\n\t                }\n\t            }\n\t            _super.prototype.hidePopup.call(this);\n\t        };\n\t        ComboBox.prototype.focusIn = function () {\n\t            if (ej2_base_1.Browser.isDevice && !this.allowFiltering) {\n\t                this.preventFocus = true;\n\t            }\n\t            _super.prototype.focusIn.call(this);\n\t        };\n\t        return ComboBox;\n\t    }(drop_down_list_1.DropDownList));\n\t    __decorate([\n\t        ej2_base_1.Property(false)\n\t    ], ComboBox.prototype, \"autofill\", void 0);\n\t    __decorate([\n\t        ej2_base_1.Property(true)\n\t    ], ComboBox.prototype, \"allowCustom\", void 0);\n\t    __decorate([\n\t        ej2_base_1.Property({})\n\t    ], ComboBox.prototype, \"htmlAttributes\", void 0);\n\t    __decorate([\n\t        ej2_base_1.Property(false)\n\t    ], ComboBox.prototype, \"allowFiltering\", void 0);\n\t    __decorate([\n\t        ej2_base_1.Property(null)\n\t    ], ComboBox.prototype, \"query\", void 0);\n\t    __decorate([\n\t        ej2_base_1.Property(true)\n\t    ], ComboBox.prototype, \"showClearButton\", void 0);\n\t    __decorate([\n\t        ej2_base_1.Event()\n\t    ], ComboBox.prototype, \"customValueSpecifier\", void 0);\n\t    __decorate([\n\t        ej2_base_1.Event()\n\t    ], ComboBox.prototype, \"filtering\", void 0);\n\t    __decorate([\n\t        ej2_base_1.Property(null)\n\t    ], ComboBox.prototype, \"valueTemplate\", void 0);\n\t    __decorate([\n\t        ej2_base_1.Property(null)\n\t    ], ComboBox.prototype, \"filterBarPlaceholder\", void 0);\n\t    ComboBox = __decorate([\n\t        ej2_base_2.NotifyPropertyChanges\n\t    ], ComboBox);\n\t    exports.ComboBox = ComboBox;\n\t}.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__), __WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));\n\n\n/***/ }),\n/* 15 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\tvar __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__, exports, __webpack_require__(16)], __WEBPACK_AMD_DEFINE_RESULT__ = function (require, exports, auto_complete_1) {\n\t    \"use strict\";\n\t    function __export(m) {\n\t        for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\n\t    }\n\t    Object.defineProperty(exports, \"__esModule\", { value: true });\n\t    __export(auto_complete_1);\n\t}.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__), __WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));\n\n\n/***/ }),\n/* 16 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\tvar __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;var __extends = (this && this.__extends) || (function () {\n\t    var extendStatics = Object.setPrototypeOf ||\n\t        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n\t        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n\t    return function (d, b) {\n\t        extendStatics(d, b);\n\t        function __() { this.constructor = d; }\n\t        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n\t    };\n\t})();\n\tvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n\t    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n\t    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n\t    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n\t    return c > 3 && r && Object.defineProperty(target, key, r), r;\n\t};\n\t!(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__, exports, __webpack_require__(6), __webpack_require__(6), __webpack_require__(10), __webpack_require__(14), __webpack_require__(3), __webpack_require__(2), __webpack_require__(5), __webpack_require__(11), __webpack_require__(12), __webpack_require__(7)], __WEBPACK_AMD_DEFINE_RESULT__ = function (require, exports, ej2_base_1, ej2_base_2, drop_down_list_1, combo_box_1, highlight_search_1, incremental_search_1, drop_down_base_1, ej2_popups_1, ej2_inputs_1, ej2_data_1) {\n\t    \"use strict\";\n\t    Object.defineProperty(exports, \"__esModule\", { value: true });\n\t    var SPINNER_CLASS = 'e-atc-spinner-icon';\n\t    drop_down_list_1.dropDownListClasses.root = 'e-autocomplete';\n\t    drop_down_list_1.dropDownListClasses.icon = 'e-input-group-icon e-ddl-icon e-search-icon';\n\t    var AutoComplete = (function (_super) {\n\t        __extends(AutoComplete, _super);\n\t        function AutoComplete(options, element) {\n\t            var _this = _super.call(this, options, element) || this;\n\t            _this.isFiltered = false;\n\t            return _this;\n\t        }\n\t        ;\n\t        AutoComplete.prototype.preRender = function () {\n\t            _super.prototype.preRender.call(this);\n\t        };\n\t        AutoComplete.prototype.getNgDirective = function () {\n\t            return 'EJ-AUTOCOMPLETE';\n\t        };\n\t        AutoComplete.prototype.getQuery = function (query) {\n\t            var filterQuery = query ? query : this.query ? this.query.clone() : new ej2_data_1.Query();\n\t            if (this.isFiltered) {\n\t                return filterQuery;\n\t            }\n\t            if (this.queryString !== null) {\n\t                var dataType = this.typeOfData(this.dataSource).typeof;\n\t                if (!(this.dataSource instanceof ej2_data_1.DataManager) && dataType === 'string' || dataType === 'number') {\n\t                    filterQuery.where('', this.filterType, this.queryString, this.ignoreCase);\n\t                }\n\t                else {\n\t                    var fields = this.fields;\n\t                    filterQuery.where(!ej2_base_1.isNullOrUndefined(fields.value) ? fields.value : '', this.filterType, this.queryString, this.ignoreCase);\n\t                }\n\t            }\n\t            if (!ej2_base_1.isNullOrUndefined(this.suggestionCount)) {\n\t                filterQuery.take(this.suggestionCount);\n\t            }\n\t            return filterQuery;\n\t        };\n\t        AutoComplete.prototype.searchLists = function (e) {\n\t            var _this = this;\n\t            this.isTyped = true;\n\t            this.isSelectCustom = false;\n\t            if (ej2_base_1.isNullOrUndefined(this.list)) {\n\t                _super.prototype.renderList.call(this, true);\n\t            }\n\t            var isDownUpKey = e.keyCode === 40 || e.keyCode === 38;\n\t            this.queryString = this.filterInput.value;\n\t            if (isDownUpKey) {\n\t                this.queryString = this.queryString === '' ? null : this.queryString;\n\t                this.beforePopupOpen = true;\n\t                this.resetList(this.dataSource, this.fields);\n\t                return;\n\t            }\n\t            this.isSelected = false;\n\t            this.activeIndex = null;\n\t            var eventArgs = {\n\t                preventDefaultAction: false,\n\t                text: this.filterInput.value,\n\t                updateData: function (dataSource, query, fields) {\n\t                    _this.isFiltered = true;\n\t                    _this.filterAction(dataSource, query, fields);\n\t                }\n\t            };\n\t            this.trigger('filtering', eventArgs);\n\t            if (!this.isFiltered && !eventArgs.preventDefaultAction) {\n\t                this.filterAction(this.dataSource, null, this.fields);\n\t            }\n\t        };\n\t        AutoComplete.prototype.filterAction = function (dataSource, query, fields) {\n\t            this.beforePopupOpen = true;\n\t            if (this.queryString !== '' && (this.queryString.length >= this.minLength || this.isFiltered)) {\n\t                this.resetList(dataSource, fields, query);\n\t            }\n\t            else {\n\t                this.hidePopup();\n\t            }\n\t        };\n\t        AutoComplete.prototype.clear = function (property) {\n\t            if (ej2_base_1.isNullOrUndefined(property) || property !== 'dataSource') {\n\t                _super.prototype.clear.call(this);\n\t            }\n\t            if (this.beforePopupOpen) {\n\t                this.hidePopup();\n\t            }\n\t        };\n\t        AutoComplete.prototype.onActionComplete = function (ulElement, list, e, isUpdated) {\n\t            this.fixedHeaderElement = null;\n\t            _super.prototype.onActionComplete.call(this, ulElement, list, e);\n\t            var item = this.list.querySelector('.' + drop_down_list_1.dropDownListClasses.li);\n\t            if (!ej2_base_1.isNullOrUndefined(item)) {\n\t                ej2_base_2.removeClass([item], drop_down_list_1.dropDownListClasses.focus);\n\t            }\n\t            this.postBackAction();\n\t        };\n\t        AutoComplete.prototype.postBackAction = function () {\n\t            if (this.queryString !== null && this.queryString !== '' && this.highlight) {\n\t                highlight_search_1.highlightSearch(this.list, this.queryString, this.ignoreCase, this.filterType);\n\t            }\n\t            if (this.autofill && !ej2_base_1.isNullOrUndefined(this.liCollections[0])) {\n\t                var items = [this.liCollections[0]];\n\t                var searchItem = incremental_search_1.Search(this.inputElement.value, items, 'StartsWith', this.ignoreCase);\n\t                if (!ej2_base_1.isNullOrUndefined(searchItem.item)) {\n\t                    _super.prototype.setAutoFill.call(this, this.liCollections[0], true);\n\t                }\n\t            }\n\t        };\n\t        AutoComplete.prototype.setSelection = function (li, e) {\n\t            if (!this.isValidLI(li)) {\n\t                return;\n\t            }\n\t            if (!ej2_base_1.isNullOrUndefined(e) && e.type === 'keydown' && e.action !== 'enter' && this.isValidLI(li)) {\n\t                var value = this.getFormattedValue(li.getAttribute('data-value'));\n\t                this.activeIndex = this.getIndexByValue(value);\n\t                this.setHoverList(li);\n\t                this.selectedLI = li;\n\t                this.setScrollPosition(e);\n\t                if (this.autofill) {\n\t                    this.preventAutoFill = false;\n\t                    _super.prototype.setAutoFill.call(this, li);\n\t                }\n\t                ej2_base_2.attributes(this.inputElement, { 'aria-activedescendant': this.selectedLI ? this.selectedLI.id : null });\n\t            }\n\t            else {\n\t                _super.prototype.setSelection.call(this, li, e);\n\t            }\n\t        };\n\t        AutoComplete.prototype.showSpinner = function () {\n\t            if (ej2_base_1.isNullOrUndefined(this.spinnerElement)) {\n\t                this.spinnerElement = this.inputWrapper.buttons[0] || this.inputWrapper.clearButton ||\n\t                    ej2_inputs_1.Input.appendSpan('e-input-group-icon ' + SPINNER_CLASS, this.inputWrapper.container);\n\t                ej2_base_1.addClass([this.spinnerElement], drop_down_list_1.dropDownListClasses.disableIcon);\n\t                ej2_popups_1.createSpinner({\n\t                    target: this.spinnerElement,\n\t                    width: drop_down_base_1.SPINNER_SIZE\n\t                });\n\t                ej2_popups_1.showSpinner(this.spinnerElement);\n\t            }\n\t        };\n\t        AutoComplete.prototype.hideSpinner = function () {\n\t            if (!ej2_base_1.isNullOrUndefined(this.spinnerElement)) {\n\t                ej2_popups_1.hideSpinner(this.spinnerElement);\n\t                ej2_base_2.removeClass([this.spinnerElement], drop_down_list_1.dropDownListClasses.disableIcon);\n\t                if (this.spinnerElement.classList.contains(SPINNER_CLASS)) {\n\t                    ej2_base_1.detach(this.spinnerElement);\n\t                }\n\t                else {\n\t                    this.spinnerElement.innerHTML = '';\n\t                }\n\t                this.spinnerElement = null;\n\t            }\n\t        };\n\t        AutoComplete.prototype.isFiltering = function () {\n\t            return true;\n\t        };\n\t        AutoComplete.prototype.renderPopup = function () {\n\t            this.list.scrollTop = 0;\n\t            _super.prototype.renderPopup.call(this);\n\t            if (this.highlight) {\n\t                highlight_search_1.highlightSearch(this.list, this.queryString, this.ignoreCase, this.filterType);\n\t            }\n\t        };\n\t        AutoComplete.prototype.isEditTextBox = function () {\n\t            return true;\n\t        };\n\t        AutoComplete.prototype.isPopupButton = function () {\n\t            return this.showPopupButton;\n\t        };\n\t        AutoComplete.prototype.isSelectFocusItem = function (element) {\n\t            return false;\n\t        };\n\t        AutoComplete.prototype.showPopup = function () {\n\t            if (this.beforePopupOpen) {\n\t                this.refreshPopup();\n\t                return;\n\t            }\n\t            this.beforePopupOpen = true;\n\t            this.preventAutoFill = true;\n\t            if (ej2_base_1.isNullOrUndefined(this.list)) {\n\t                this.renderList();\n\t            }\n\t            else {\n\t                this.resetList(this.dataSource, this.fields);\n\t            }\n\t        };\n\t        AutoComplete.prototype.hidePopup = function () {\n\t            _super.prototype.hidePopup.call(this);\n\t            this.activeIndex = -1;\n\t        };\n\t        AutoComplete.prototype.onPropertyChanged = function (newProp, oldProp) {\n\t            for (var _i = 0, _a = Object.keys(newProp); _i < _a.length; _i++) {\n\t                var prop = _a[_i];\n\t                switch (prop) {\n\t                    case 'showPopupButton':\n\t                        if (this.showPopupButton) {\n\t                            var button = ej2_inputs_1.Input.appendSpan(drop_down_list_1.dropDownListClasses.icon, this.inputWrapper.container);\n\t                            this.inputWrapper.buttons[0] = button;\n\t                            ej2_base_1.EventHandler.add(this.inputWrapper.buttons[0], 'click', this.dropDownClick, this);\n\t                        }\n\t                        else {\n\t                            ej2_base_1.detach(this.inputWrapper.buttons[0]);\n\t                            this.inputWrapper.buttons[0] = null;\n\t                        }\n\t                        break;\n\t                    default:\n\t                        var atcProps = void 0;\n\t                        atcProps = this.getPropObject(prop, newProp, oldProp);\n\t                        _super.prototype.onPropertyChanged.call(this, atcProps.newProperty, atcProps.oldProperty);\n\t                        break;\n\t                }\n\t            }\n\t        };\n\t        AutoComplete.prototype.getModuleName = function () {\n\t            return 'autocomplete';\n\t        };\n\t        AutoComplete.prototype.render = function () {\n\t            _super.prototype.render.call(this);\n\t        };\n\t        ;\n\t        return AutoComplete;\n\t    }(combo_box_1.ComboBox));\n\t    __decorate([\n\t        ej2_base_1.Property({ value: null, iconCss: null, groupBy: null })\n\t    ], AutoComplete.prototype, \"fields\", void 0);\n\t    __decorate([\n\t        ej2_base_1.Property(true)\n\t    ], AutoComplete.prototype, \"ignoreCase\", void 0);\n\t    __decorate([\n\t        ej2_base_1.Property(false)\n\t    ], AutoComplete.prototype, \"showPopupButton\", void 0);\n\t    __decorate([\n\t        ej2_base_1.Property(false)\n\t    ], AutoComplete.prototype, \"highlight\", void 0);\n\t    __decorate([\n\t        ej2_base_1.Property(20)\n\t    ], AutoComplete.prototype, \"suggestionCount\", void 0);\n\t    __decorate([\n\t        ej2_base_1.Property({})\n\t    ], AutoComplete.prototype, \"htmlAttributes\", void 0);\n\t    __decorate([\n\t        ej2_base_1.Property(null)\n\t    ], AutoComplete.prototype, \"query\", void 0);\n\t    __decorate([\n\t        ej2_base_1.Property(1)\n\t    ], AutoComplete.prototype, \"minLength\", void 0);\n\t    __decorate([\n\t        ej2_base_1.Property('Contains')\n\t    ], AutoComplete.prototype, \"filterType\", void 0);\n\t    __decorate([\n\t        ej2_base_1.Event()\n\t    ], AutoComplete.prototype, \"filtering\", void 0);\n\t    __decorate([\n\t        ej2_base_1.Property(null)\n\t    ], AutoComplete.prototype, \"index\", void 0);\n\t    __decorate([\n\t        ej2_base_1.Property(null)\n\t    ], AutoComplete.prototype, \"valueTemplate\", void 0);\n\t    __decorate([\n\t        ej2_base_1.Property(null)\n\t    ], AutoComplete.prototype, \"filterBarPlaceholder\", void 0);\n\t    __decorate([\n\t        ej2_base_1.Property(false)\n\t    ], AutoComplete.prototype, \"allowFiltering\", void 0);\n\t    __decorate([\n\t        ej2_base_1.Property(null)\n\t    ], AutoComplete.prototype, \"text\", void 0);\n\t    AutoComplete = __decorate([\n\t        ej2_base_2.NotifyPropertyChanges\n\t    ], AutoComplete);\n\t    exports.AutoComplete = AutoComplete;\n\t}.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__), __WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));\n\n\n/***/ }),\n/* 17 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\tvar __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__, exports, __webpack_require__(18)], __WEBPACK_AMD_DEFINE_RESULT__ = function (require, exports, multi_select_1) {\n\t    \"use strict\";\n\t    function __export(m) {\n\t        for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\n\t    }\n\t    Object.defineProperty(exports, \"__esModule\", { value: true });\n\t    __export(multi_select_1);\n\t}.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__), __WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));\n\n\n/***/ }),\n/* 18 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\tvar __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;var __extends = (this && this.__extends) || (function () {\n\t    var extendStatics = Object.setPrototypeOf ||\n\t        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n\t        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n\t    return function (d, b) {\n\t        extendStatics(d, b);\n\t        function __() { this.constructor = d; }\n\t        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n\t    };\n\t})();\n\tvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n\t    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n\t    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n\t    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n\t    return c > 3 && r && Object.defineProperty(target, key, r), r;\n\t};\n\t!(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__, exports, __webpack_require__(5), __webpack_require__(11), __webpack_require__(6), __webpack_require__(6), __webpack_require__(6), __webpack_require__(6), __webpack_require__(2), __webpack_require__(6), __webpack_require__(6), __webpack_require__(7)], __WEBPACK_AMD_DEFINE_RESULT__ = function (require, exports, drop_down_base_1, ej2_popups_1, ej2_base_1, ej2_base_2, ej2_base_3, ej2_base_4, incremental_search_1, ej2_base_5, ej2_base_6, ej2_data_1) {\n\t    \"use strict\";\n\t    Object.defineProperty(exports, \"__esModule\", { value: true });\n\t    var FOCUS = 'e-input-focus';\n\t    var DISABLED = 'e-disabled';\n\t    var OVER_ALL_WRAPPER = 'e-multiselect e-input-group';\n\t    var ELEMENT_WRAPPER = 'e-multi-select-wrapper';\n\t    var ELEMENT_MOBILE_WRAPPER = 'e-mob-wrapper';\n\t    var HIDE_LIST = 'e-hide-listitem';\n\t    var DELIMITER_VIEW = 'e-delim-view';\n\t    var CHIP_WRAPPER = 'e-chips-collection';\n\t    var CHIP = 'e-chips';\n\t    var CHIP_CONTENT = 'e-chipcontent';\n\t    var CHIP_CLOSE = 'e-chips-close e-icon';\n\t    var CHIP_SELECTED = 'e-chip-selected';\n\t    var SEARCHBOX_WRAPPER = 'e-searcher';\n\t    var DELIMITER_VIEW_WRAPPER = 'e-delimiter';\n\t    var ZERO_SIZE = 'e-zero-size';\n\t    var REMAIN_WRAPPER = 'e-remain';\n\t    var CLOSEICON_CLASS = 'e-chips-close e-icon e-close-hooker';\n\t    var DELIMITER_WRAPPER = 'e-delim-values';\n\t    var POPUP_WRAPPER = 'e-ddl e-popup e-multi-select-list-wrapper';\n\t    var INPUT_ELEMENT = 'e-dropdownbase';\n\t    var RTL_CLASS = 'e-rtl';\n\t    var CLOSE_ICON_HIDE = 'e-close-icon-hide';\n\t    var MOBILE_CHIP = 'e-mob-chip';\n\t    var FOOTER = 'e-ddl-footer';\n\t    var HEADER = 'e-ddl-header';\n\t    var DISABLE_ICON = 'e-ddl-disable-icon';\n\t    var SPINNER_CLASS = 'e-ms-spinner-icon';\n\t    var MultiSelect = (function (_super) {\n\t        __extends(MultiSelect, _super);\n\t        function MultiSelect(option, element) {\n\t            var _this = _super.call(this, option, element) || this;\n\t            _this.isValidKey = false;\n\t            _this.mainListCollection = [];\n\t            _this.beforePopupOpen = false;\n\t            _this.scrollFocusStatus = false;\n\t            _this.keyDownStatus = false;\n\t            return _this;\n\t        }\n\t        ;\n\t        MultiSelect.prototype.enableRTL = function (state) {\n\t            this.enableRtl = state;\n\t            if (state) {\n\t                this.overAllWrapper.classList.add(RTL_CLASS);\n\t            }\n\t            else {\n\t                this.overAllWrapper.classList.remove(RTL_CLASS);\n\t            }\n\t            if (this.popupObj) {\n\t                this.popupObj.enableRtl = state;\n\t                this.popupObj.dataBind();\n\t            }\n\t        };\n\t        MultiSelect.prototype.updateHTMLAttribute = function () {\n\t            if (Object.keys(this.htmlAttributes).length) {\n\t                for (var _i = 0, _a = Object.keys(this.htmlAttributes); _i < _a.length; _i++) {\n\t                    var htmlAttr = _a[_i];\n\t                    switch (htmlAttr) {\n\t                        case 'class':\n\t                            this.overAllWrapper.classList.add(this.htmlAttributes[htmlAttr]);\n\t                            this.popupWrapper.classList.add(this.htmlAttributes[htmlAttr]);\n\t                            break;\n\t                        case 'disabled':\n\t                            this.enable(false);\n\t                            break;\n\t                        case 'placeholder':\n\t                            this.inputElement.setAttribute(htmlAttr, this.htmlAttributes[htmlAttr]);\n\t                            break;\n\t                        case 'name':\n\t                            this.hiddenElement.setAttribute(htmlAttr, this.htmlAttributes[htmlAttr]);\n\t                            break;\n\t                        default:\n\t                            var defaultAttr = ['title', 'id', 'required'];\n\t                            if (defaultAttr.indexOf(htmlAttr) > -1) {\n\t                                this.element.setAttribute(htmlAttr, this.htmlAttributes[htmlAttr]);\n\t                            }\n\t                            else {\n\t                                this.overAllWrapper.setAttribute(htmlAttr, this.htmlAttributes[htmlAttr]);\n\t                            }\n\t                            break;\n\t                    }\n\t                }\n\t            }\n\t        };\n\t        MultiSelect.prototype.updateReadonly = function (state) {\n\t            if (state) {\n\t                this.inputElement.setAttribute('readonly', 'true');\n\t            }\n\t            else {\n\t                this.inputElement.removeAttribute('readonly');\n\t            }\n\t        };\n\t        MultiSelect.prototype.updateClearButton = function (state) {\n\t            if (state) {\n\t                if (this.overAllClear.parentNode) {\n\t                    this.overAllClear.style.display = '';\n\t                }\n\t                else {\n\t                    this.componentWrapper.appendChild(this.overAllClear);\n\t                }\n\t                this.componentWrapper.classList.remove(CLOSE_ICON_HIDE);\n\t            }\n\t            else {\n\t                this.overAllClear.style.display = 'none';\n\t                this.componentWrapper.classList.add(CLOSE_ICON_HIDE);\n\t            }\n\t        };\n\t        MultiSelect.prototype.updateCssClass = function () {\n\t            if (this.cssClass) {\n\t                this.popupWrapper.classList.add(this.cssClass);\n\t                this.overAllWrapper.classList.add(this.cssClass);\n\t            }\n\t        };\n\t        MultiSelect.prototype.onPopupShown = function () {\n\t            var animModel = { name: 'FadeIn', duration: 100 };\n\t            this.focusAtFirstListItem();\n\t            document.body.appendChild(this.popupObj.element);\n\t            this.refreshPopup();\n\t            this.popupObj.show(animModel);\n\t            ej2_base_1.attributes(this.inputElement, { 'aria-expanded': 'true' });\n\t            var eventArgs = { popup: this.popupObj };\n\t            this.refreshListItems(null);\n\t            this.trigger('open', eventArgs);\n\t        };\n\t        MultiSelect.prototype.focusAtFirstListItem = function () {\n\t            if (this.ulElement && this.ulElement.querySelector('li.'\n\t                + drop_down_base_1.dropDownBaseClasses.li)) {\n\t                var element = this.ulElement.querySelector('li.'\n\t                    + drop_down_base_1.dropDownBaseClasses.li + ':not(.'\n\t                    + HIDE_LIST + ')');\n\t                if (element !== null) {\n\t                    this.removeFocus();\n\t                    this.addListFocus(element);\n\t                }\n\t            }\n\t        };\n\t        MultiSelect.prototype.focusAtLastListItem = function (data) {\n\t            var activeElement;\n\t            if (data) {\n\t                activeElement = incremental_search_1.Search(data, this.liCollections, 'StartsWith', this.ignoreCase);\n\t            }\n\t            else {\n\t                if (this.value && this.value.length) {\n\t                    incremental_search_1.Search(this.value[this.value.length - 1], this.liCollections, 'StartsWith', this.ignoreCase);\n\t                }\n\t                else {\n\t                    activeElement = null;\n\t                }\n\t            }\n\t            if (activeElement && activeElement.item !== null) {\n\t                this.addListFocus(activeElement.item);\n\t                this.scrollBottom(activeElement.item, activeElement.index);\n\t            }\n\t        };\n\t        MultiSelect.prototype.getAriaAttributes = function () {\n\t            var ariaAttributes = {\n\t                'aria-disabled': 'false',\n\t                'aria-owns': this.element.id + '_options',\n\t                'role': 'listbox',\n\t                'aria-multiselectable': 'true',\n\t                'aria-activedescendant': 'null',\n\t                'aria-haspopup': 'true',\n\t                'aria-expanded': 'false'\n\t            };\n\t            return ariaAttributes;\n\t        };\n\t        MultiSelect.prototype.updateListARIA = function () {\n\t            ej2_base_1.attributes(this.ulElement, { 'id': this.element.id + '_options', 'role': 'listbox', 'aria-hidden': 'false' });\n\t            ej2_base_1.attributes(this.inputElement, this.getAriaAttributes());\n\t            var li;\n\t            li = this.list.querySelectorAll('li.' + drop_down_base_1.dropDownBaseClasses.li);\n\t            var temp = li.length;\n\t            if (li && li.length) {\n\t                while (temp > 0) {\n\t                    if (li[temp - 1].getAttribute('aria-selected') !== 'true') {\n\t                        li[temp - 1].setAttribute('aria-selected', 'false');\n\t                    }\n\t                    temp--;\n\t                }\n\t            }\n\t        };\n\t        MultiSelect.prototype.removelastSelection = function (e) {\n\t            var elements;\n\t            elements = this.chipCollectionWrapper.querySelectorAll('span.' + CHIP);\n\t            var value = elements[elements.length - 1].getAttribute('data-value');\n\t            this.removeValue(value, e);\n\t            this.removeChipSelection();\n\t            this.updateDelimeter(e);\n\t            this.makeTextBoxEmpty();\n\t            if (this.allowFiltering && this.mainList && this.listData) {\n\t                var list = this.mainList.cloneNode ? this.mainList.cloneNode(true) : this.mainList;\n\t                this.onActionComplete(list, this.mainData);\n\t                this.refreshSelection();\n\t            }\n\t            this.focusAtLastListItem(value);\n\t        };\n\t        MultiSelect.prototype.onActionFailure = function (e) {\n\t            _super.prototype.onActionFailure.call(this, e);\n\t            this.renderPopup();\n\t            this.onPopupShown();\n\t        };\n\t        MultiSelect.prototype.onActionComplete = function (ulElement, list, e, isUpdated) {\n\t            _super.prototype.onActionComplete.call(this, ulElement, list, e);\n\t            if (!this.mainList && !this.mainData) {\n\t                this.mainList = ulElement.cloneNode ? ulElement.cloneNode(true) : ulElement;\n\t                this.mainData = list;\n\t                this.mainListCollection = this.liCollections;\n\t            }\n\t            if (this.remoteCustomValue && this.allowCustomValue && this.inputFocus) {\n\t                this.checkForCustomValue(this.tempQuery, this.fields);\n\t                return;\n\t            }\n\t            if (this.value && this.value.length) {\n\t                this.refreshSelection();\n\t            }\n\t            this.updateListARIA();\n\t            this.unwireListEvents();\n\t            this.wireListEvents();\n\t            if (!ej2_base_6.isNullOrUndefined(this.setInitialValue)) {\n\t                this.setInitialValue();\n\t            }\n\t            if (!ej2_base_6.isNullOrUndefined(this.selectAllAction)) {\n\t                this.selectAllAction();\n\t            }\n\t            this.renderPopup();\n\t            this.refreshPopup();\n\t            if (this.beforePopupOpen) {\n\t                this.beforePopupOpen = false;\n\t                this.onPopupShown();\n\t            }\n\t        };\n\t        MultiSelect.prototype.refreshSelection = function () {\n\t            var value;\n\t            var element;\n\t            var className = this.hideSelectedItem ?\n\t                HIDE_LIST :\n\t                drop_down_base_1.dropDownBaseClasses.selected;\n\t            for (var index = 0; this.value[index]; index++) {\n\t                value = this.value[index];\n\t                element = this.ulElement.querySelector('li[data-value=\"' + value + '\"]');\n\t                if (element) {\n\t                    ej2_base_5.addClass([element], className);\n\t                }\n\t            }\n\t        };\n\t        MultiSelect.prototype.KeyUp = function (e) {\n\t            this.isValidKey = e.keyCode === 8 || this.isValidKey;\n\t            if (this.isValidKey) {\n\t                this.isValidKey = false;\n\t                this.expandTextbox();\n\t                switch (e.keyCode) {\n\t                    default:\n\t                        if (!this.isPopupOpen()) {\n\t                            this.showPopup();\n\t                        }\n\t                        if (this.liCollections) {\n\t                            if (this.checkTextLength() && !this.allowFiltering && (e.keyCode !== 8)) {\n\t                                this.focusAtFirstListItem();\n\t                            }\n\t                            else {\n\t                                var text = this.inputElement.value;\n\t                                this.keyCode = e.keyCode;\n\t                                if (this.allowFiltering) {\n\t                                    this.trigger('filtering', {\n\t                                        text: this.inputElement.value,\n\t                                        updateData: this.dataUpdater.bind(this),\n\t                                        event: e\n\t                                    });\n\t                                }\n\t                                else if (this.allowCustomValue) {\n\t                                    var query = new ej2_data_1.Query();\n\t                                    query = (text !== '') ? query.where(this.fields.text, 'startswith', text, true) : query;\n\t                                    this.dataUpdater(this.mainData, query, this.fields);\n\t                                    break;\n\t                                }\n\t                                else {\n\t                                    var liCollections = void 0;\n\t                                    liCollections = this.list.querySelectorAll('li.' + drop_down_base_1.dropDownBaseClasses.li);\n\t                                    var activeElement = incremental_search_1.Search(this.inputElement.value, liCollections, 'StartsWith', this.ignoreCase);\n\t                                    if (activeElement && activeElement.item !== null) {\n\t                                        this.addListFocus(activeElement.item);\n\t                                        this.list.scrollTop =\n\t                                            activeElement.item.getBoundingClientRect().height * activeElement.index;\n\t                                    }\n\t                                }\n\t                            }\n\t                        }\n\t                }\n\t            }\n\t        };\n\t        MultiSelect.prototype.dataUpdater = function (dataSource, query, fields) {\n\t            if (this.inputElement.value.trim() === '') {\n\t                var list = this.mainList.cloneNode ? this.mainList.cloneNode(true) : this.mainList;\n\t                this.onActionComplete(list, this.mainData);\n\t                if (this.value && this.value.length) {\n\t                    this.refreshSelection();\n\t                }\n\t                if (this.keyCode !== 8) {\n\t                    this.focusAtFirstListItem();\n\t                }\n\t            }\n\t            else {\n\t                this.resetList(dataSource, fields, query);\n\t                if (this.allowCustomValue) {\n\t                    if (!(dataSource instanceof ej2_data_1.DataManager)) {\n\t                        this.checkForCustomValue(query, fields);\n\t                    }\n\t                    else {\n\t                        this.remoteCustomValue = true;\n\t                        this.tempQuery = query;\n\t                    }\n\t                }\n\t            }\n\t            this.refreshPopup();\n\t        };\n\t        MultiSelect.prototype.checkForCustomValue = function (query, fields) {\n\t            var dataChecks = !this.getValueByText(this.inputElement.value, this.ignoreCase);\n\t            if (this.allowCustomValue && dataChecks) {\n\t                var text = this.fields.text;\n\t                var value = this.fields.value;\n\t                var data = {};\n\t                data[value] = data[text] = this.inputElement.value;\n\t                var tempData = JSON.parse(JSON.stringify(this.listData));\n\t                tempData.splice(0, 0, data);\n\t                this.resetList(tempData, fields ? fields : this.fields, query);\n\t            }\n\t            if (this.value && this.value.length) {\n\t                this.refreshSelection();\n\t            }\n\t        };\n\t        MultiSelect.prototype.getNgDirective = function () {\n\t            return 'EJ-MULTISELECT';\n\t        };\n\t        MultiSelect.prototype.wrapperClick = function (e) {\n\t            if (this.readonly || !this.enabled) {\n\t                return;\n\t            }\n\t            if (e.target === this.overAllClear) {\n\t                e.preventDefault();\n\t                return;\n\t            }\n\t            if (!this.inputFocus) {\n\t                this.inputElement.focus();\n\t            }\n\t            if (e.target && e.target.classList.toString().indexOf(CHIP_CLOSE) !== -1) {\n\t                if (this.isPopupOpen()) {\n\t                    this.refreshPopup();\n\t                }\n\t                return;\n\t            }\n\t            if (!this.isPopupOpen()) {\n\t                this.showPopup();\n\t            }\n\t            else {\n\t                this.hidePopup();\n\t            }\n\t            e.preventDefault();\n\t        };\n\t        MultiSelect.prototype.enable = function (state) {\n\t            if (state) {\n\t                this.overAllWrapper.classList.remove(DISABLED);\n\t                this.inputElement.removeAttribute('disabled');\n\t                ej2_base_1.attributes(this.inputElement, { 'aria-disabled': 'false' });\n\t            }\n\t            else {\n\t                this.overAllWrapper.classList.add(DISABLED);\n\t                this.inputElement.setAttribute('disabled', 'true');\n\t                ej2_base_1.attributes(this.inputElement, { 'aria-disabled': 'true' });\n\t            }\n\t            if (this.enabled !== state) {\n\t                this.enabled = state;\n\t            }\n\t            this.hidePopup();\n\t        };\n\t        MultiSelect.prototype.onBlur = function (eve) {\n\t            var target = !ej2_base_6.isNullOrUndefined(eve) && eve.relatedTarget;\n\t            if (document.body.contains(this.popupObj.element) && this.popupObj.element.contains(target)) {\n\t                this.inputElement.focus();\n\t                return;\n\t            }\n\t            if (this.scrollFocusStatus) {\n\t                eve.preventDefault();\n\t                this.inputElement.focus();\n\t                this.scrollFocusStatus = false;\n\t                return;\n\t            }\n\t            this.inputFocus = false;\n\t            this.overAllWrapper.classList.remove(FOCUS);\n\t            if (this.mode !== 'box') {\n\t                this.refreshListItems(null);\n\t                this.updateDelimView();\n\t            }\n\t            this.updateValueState(eve, this.value, this.tempValues);\n\t            this.dispatchEvent(this.hiddenElement, 'change');\n\t            this.overAllClear.style.display = 'none';\n\t            if (this.isPopupOpen()) {\n\t                this.hidePopup();\n\t                this.makeTextBoxEmpty();\n\t            }\n\t            this.trigger('blur');\n\t            if (ej2_base_4.Browser.isDevice && this.mode !== 'delimiter') {\n\t                this.removeChipFocus();\n\t            }\n\t            this.removeChipSelection();\n\t            this.refreshInputHight();\n\t            this.refreshPlaceHolder();\n\t        };\n\t        MultiSelect.prototype.refreshInputHight = function () {\n\t            if (!this.value || !this.value.length) {\n\t                this.searchWrapper.classList.remove(ZERO_SIZE);\n\t            }\n\t            else {\n\t                this.searchWrapper.classList.add(ZERO_SIZE);\n\t            }\n\t        };\n\t        MultiSelect.prototype.validateValues = function (newValue, oldValue) {\n\t            return JSON.stringify(newValue.slice().sort()) !== JSON.stringify(oldValue.slice().sort());\n\t        };\n\t        MultiSelect.prototype.updateValueState = function (event, newVal, oldVal) {\n\t            var newValue = newVal ? newVal : [];\n\t            var oldValue = oldVal ? oldVal : [];\n\t            if (this.validateValues(newValue, oldValue)) {\n\t                var eventArgs = {\n\t                    e: event,\n\t                    oldValue: oldVal,\n\t                    value: newVal,\n\t                    isInteracted: event ? true : false\n\t                };\n\t                this.trigger('change', eventArgs);\n\t            }\n\t        };\n\t        MultiSelect.prototype.getPagingCount = function () {\n\t            var height = this.list.classList.contains(drop_down_base_1.dropDownBaseClasses.noData) ? null :\n\t                getComputedStyle(this.getItems()[0], null).getPropertyValue('height');\n\t            return Math.round(this.list.getBoundingClientRect().height / parseInt(height, 10));\n\t        };\n\t        MultiSelect.prototype.pageUpSelection = function (steps) {\n\t            var previousItem = steps >= 0 ? this.liCollections[steps + 1] : this.liCollections[0];\n\t            this.addListFocus(previousItem);\n\t            this.scrollBottom(previousItem, this.getIndexByValue(previousItem.getAttribute('data-value')));\n\t        };\n\t        ;\n\t        MultiSelect.prototype.pageDownSelection = function (steps) {\n\t            var list = this.getItems();\n\t            var previousItem = steps <= list.length ? this.liCollections[steps - 1] : this.liCollections[list.length - 1];\n\t            this.addListFocus(previousItem);\n\t            this.scrollBottom(previousItem, this.getIndexByValue(previousItem.getAttribute('data-value')));\n\t        };\n\t        MultiSelect.prototype.focusIn = function () {\n\t            if (this.enabled && !this.readonly) {\n\t                this.inputFocus = true;\n\t                if (!this.value) {\n\t                    this.tempValues = this.value;\n\t                }\n\t                else {\n\t                    this.tempValues = this.value.slice();\n\t                }\n\t                if (this.value && this.value.length) {\n\t                    if (this.mode !== 'delimiter') {\n\t                        this.chipCollectionWrapper.style.display = '';\n\t                    }\n\t                    else {\n\t                        this.showDelimWrapper();\n\t                    }\n\t                    this.viewWrapper.style.display = 'none';\n\t                }\n\t                this.searchWrapper.classList.remove(ZERO_SIZE);\n\t                this.trigger('focus');\n\t                if (!this.overAllWrapper.classList.contains(FOCUS)) {\n\t                    this.overAllWrapper.classList.add(FOCUS);\n\t                }\n\t                if (this.isPopupOpen()) {\n\t                    this.refreshPopup();\n\t                }\n\t                return true;\n\t            }\n\t            else {\n\t                return false;\n\t            }\n\t        };\n\t        MultiSelect.prototype.showDelimWrapper = function () {\n\t            this.delimiterWrapper.style.display = '';\n\t            this.componentWrapper.classList.add(DELIMITER_VIEW_WRAPPER);\n\t        };\n\t        MultiSelect.prototype.hideDelimWrapper = function () {\n\t            this.delimiterWrapper.style.display = 'none';\n\t            this.componentWrapper.classList.remove(DELIMITER_VIEW_WRAPPER);\n\t        };\n\t        MultiSelect.prototype.expandTextbox = function () {\n\t            var size = 5;\n\t            if (this.placeholder) {\n\t                size = size > this.inputElement.placeholder.length ? size : this.inputElement.placeholder.length;\n\t            }\n\t            if (this.inputElement.value.length > size) {\n\t                this.inputElement.size = this.inputElement.value.length;\n\t            }\n\t            else {\n\t                this.inputElement.size = size;\n\t            }\n\t        };\n\t        MultiSelect.prototype.isPopupOpen = function () {\n\t            return ((this.popupWrapper !== null) && (this.popupWrapper.parentElement !== null));\n\t        };\n\t        MultiSelect.prototype.refreshPopup = function () {\n\t            if (this.popupObj) {\n\t                this.popupObj.setProperties({ width: this.calcPopupWidth() });\n\t                this.popupObj.refreshPosition();\n\t                this.popupObj.show();\n\t            }\n\t        };\n\t        MultiSelect.prototype.checkTextLength = function () {\n\t            return this.inputElement.value.length < 1;\n\t        };\n\t        MultiSelect.prototype.popupKeyActions = function (keyCode) {\n\t            switch (keyCode) {\n\t                case 38:\n\t                    this.hidePopup();\n\t                    break;\n\t                case 40:\n\t                    if (!this.isPopupOpen()) {\n\t                        this.showPopup();\n\t                    }\n\t                    break;\n\t            }\n\t        };\n\t        MultiSelect.prototype.updateAriaAttribute = function () {\n\t            var focusedItem = this.list.querySelector('.' + drop_down_base_1.dropDownBaseClasses.focus);\n\t            if (!ej2_base_6.isNullOrUndefined(focusedItem)) {\n\t                this.inputElement.setAttribute('aria-activedescendant', focusedItem.id);\n\t            }\n\t        };\n\t        MultiSelect.prototype.onKeyDown = function (e) {\n\t            this.keyDownStatus = true;\n\t            if (e.keyCode > 111 && e.keyCode < 124) {\n\t                return;\n\t            }\n\t            if (e.altKey) {\n\t                this.popupKeyActions(e.keyCode);\n\t                e.preventDefault();\n\t                return;\n\t            }\n\t            else if (this.isPopupOpen()) {\n\t                var focusedItem = this.list.querySelector('.' + drop_down_base_1.dropDownBaseClasses.focus);\n\t                var activeIndex = void 0;\n\t                switch (e.keyCode) {\n\t                    case 36:\n\t                        this.moveByTop(true);\n\t                        break;\n\t                    case 35:\n\t                        this.moveByTop(false);\n\t                        break;\n\t                    case 33:\n\t                        e.preventDefault();\n\t                        if (focusedItem) {\n\t                            this.getIndexByValue(focusedItem.getAttribute('data-value'));\n\t                            this.pageUpSelection(activeIndex - this.getPagingCount());\n\t                            this.updateAriaAttribute();\n\t                        }\n\t                        return;\n\t                    case 34:\n\t                        e.preventDefault();\n\t                        if (focusedItem) {\n\t                            this.getIndexByValue(focusedItem.getAttribute('data-value'));\n\t                            this.pageDownSelection(activeIndex + this.getPagingCount());\n\t                            this.updateAriaAttribute();\n\t                        }\n\t                        return;\n\t                    case 38:\n\t                        e.preventDefault();\n\t                        this.moveByList(-1);\n\t                        this.updateAriaAttribute();\n\t                        break;\n\t                    case 40:\n\t                        e.preventDefault();\n\t                        this.moveByList(1);\n\t                        this.updateAriaAttribute();\n\t                        break;\n\t                    case 27:\n\t                        e.preventDefault();\n\t                        this.hidePopup();\n\t                        return;\n\t                    case 13:\n\t                        e.preventDefault();\n\t                        this.selectByKey(e);\n\t                        return;\n\t                }\n\t            }\n\t            else {\n\t                switch (e.keyCode) {\n\t                    case 13:\n\t                    case 9:\n\t                    case 16:\n\t                    case 17:\n\t                    case 20:\n\t                        return;\n\t                    case 40:\n\t                        this.showPopup();\n\t                        break;\n\t                    case 27:\n\t                        e.preventDefault();\n\t                        this.escapeAction();\n\t                        return;\n\t                }\n\t            }\n\t            if (this.checkTextLength()) {\n\t                if ((this.mode !== 'delimiter') && this.value && this.value.length) {\n\t                    switch (e.keyCode) {\n\t                        case 37:\n\t                            e.preventDefault();\n\t                            this.moveBy(-1);\n\t                            break;\n\t                        case 39:\n\t                            e.preventDefault();\n\t                            this.moveBy(1);\n\t                            break;\n\t                        case 8:\n\t                            this.removelastSelection(e);\n\t                            break;\n\t                        case 46:\n\t                            this.removeSelectedChip(e);\n\t                            break;\n\t                    }\n\t                }\n\t                else if (e.keyCode === 8 && this.mode === 'delimiter') {\n\t                    if (this.value && this.value.length) {\n\t                        e.preventDefault();\n\t                        var temp = this.value[this.value.length - 1];\n\t                        this.removeValue(temp, e);\n\t                        this.updateDelimeter(e);\n\t                        this.focusAtLastListItem(temp);\n\t                    }\n\t                }\n\t            }\n\t            this.expandTextbox();\n\t            this.refreshPopup();\n\t        };\n\t        MultiSelect.prototype.selectByKey = function (e) {\n\t            this.removeChipSelection();\n\t            this.selectListByKey(e);\n\t            if (this.hideSelectedItem) {\n\t                this.focusAtFirstListItem();\n\t            }\n\t        };\n\t        MultiSelect.prototype.escapeAction = function () {\n\t            var temp = this.tempValues ? this.tempValues.slice() : [];\n\t            if (this.value && this.validateValues(this.value, temp)) {\n\t                this.value = temp;\n\t                this.initialValueUpdate();\n\t                if (this.mode !== 'delimiter') {\n\t                    this.chipCollectionWrapper.style.display = '';\n\t                }\n\t                else {\n\t                    this.showDelimWrapper();\n\t                }\n\t                this.refreshPlaceHolder();\n\t                if (this.value.length) {\n\t                    this.showOverAllClear();\n\t                }\n\t                else {\n\t                    this.hideOverAllClear();\n\t                }\n\t            }\n\t            this.makeTextBoxEmpty();\n\t        };\n\t        MultiSelect.prototype.scrollBottom = function (selectedLI, activeIndex) {\n\t            var currentOffset = this.list.getBoundingClientRect().height;\n\t            var nextBottom = selectedLI.offsetTop + selectedLI.getBoundingClientRect().height - this.list.scrollTop;\n\t            var nextOffset = this.list.scrollTop + nextBottom - currentOffset;\n\t            var boxRange = (selectedLI.offsetTop + selectedLI.getBoundingClientRect().height - this.list.scrollTop);\n\t            boxRange = this.fields.groupBy && !ej2_base_6.isUndefined(this.fixedHeaderElement) ?\n\t                boxRange - this.fixedHeaderElement.getBoundingClientRect().height : boxRange;\n\t            if (activeIndex === 0) {\n\t                this.list.scrollTop = 0;\n\t            }\n\t            else if (nextBottom > currentOffset) {\n\t                this.list.scrollTop = nextOffset;\n\t            }\n\t            else if (!(boxRange > 0 && this.list.getBoundingClientRect().height > boxRange)) {\n\t                this.list.scrollTop = nextOffset;\n\t            }\n\t        };\n\t        MultiSelect.prototype.scrollTop = function (selectedLI, activeIndex) {\n\t            var nextOffset = selectedLI.offsetTop - this.list.scrollTop;\n\t            var nextBottom = selectedLI.offsetTop + selectedLI.getBoundingClientRect().height - this.list.scrollTop;\n\t            nextOffset = this.fields.groupBy && !ej2_base_6.isUndefined(this.fixedHeaderElement) ?\n\t                nextOffset - this.fixedHeaderElement.getBoundingClientRect().height : nextOffset;\n\t            var boxRange = (selectedLI.offsetTop + selectedLI.getBoundingClientRect().height - this.list.scrollTop);\n\t            if (activeIndex === 0) {\n\t                this.list.scrollTop = 0;\n\t            }\n\t            else if (nextOffset < 0) {\n\t                this.list.scrollTop = this.list.scrollTop + nextOffset;\n\t            }\n\t            else if (!(boxRange > 0 && this.list.getBoundingClientRect().height > boxRange)) {\n\t                this.list.scrollTop = selectedLI.offsetTop - (this.fields.groupBy && !ej2_base_6.isUndefined(this.fixedHeaderElement) ?\n\t                    this.fixedHeaderElement.getBoundingClientRect().height : 0);\n\t            }\n\t        };\n\t        MultiSelect.prototype.selectListByKey = function (e) {\n\t            var li = this.list.querySelector('li.' + drop_down_base_1.dropDownBaseClasses.focus);\n\t            var limit = this.value && this.value.length ? this.value.length : 0;\n\t            if (li !== null) {\n\t                if (this.isValidLI(li) && limit < this.maximumSelectionLength) {\n\t                    this.updateListSelection(li, e);\n\t                    this.addListFocus(li);\n\t                    this.updateDelimeter(e);\n\t                    this.makeTextBoxEmpty();\n\t                    this.refreshListItems(li.getAttribute('data-Value'));\n\t                    this.refreshPopup();\n\t                    if (this.value && this.value.length) {\n\t                        this.removeListSelection();\n\t                        this.refreshSelection();\n\t                    }\n\t                }\n\t                if (this.closePopupOnSelect) {\n\t                    this.hidePopup();\n\t                }\n\t            }\n\t            this.refreshPlaceHolder();\n\t        };\n\t        MultiSelect.prototype.refreshListItems = function (data) {\n\t            if ((this.allowFiltering || this.allowCustomValue) && this.mainList && this.listData) {\n\t                var list = this.mainList.cloneNode ? this.mainList.cloneNode(true) : this.mainList;\n\t                this.onActionComplete(list, this.mainData);\n\t                this.focusAtLastListItem(data);\n\t                if (this.value && this.value.length) {\n\t                    this.refreshSelection();\n\t                }\n\t            }\n\t        };\n\t        MultiSelect.prototype.removeSelectedChip = function (e) {\n\t            var selectedElem = this.chipCollectionWrapper.querySelector('span.' + CHIP_SELECTED);\n\t            var temp;\n\t            if (selectedElem !== null) {\n\t                temp = selectedElem.nextElementSibling;\n\t                if (temp !== null) {\n\t                    this.removeChipSelection();\n\t                    this.addChipSelection(temp);\n\t                }\n\t                this.removeValue(selectedElem.getAttribute('data-value'), e);\n\t                this.makeTextBoxEmpty();\n\t            }\n\t            if (this.closePopupOnSelect) {\n\t                this.hidePopup();\n\t            }\n\t        };\n\t        MultiSelect.prototype.moveByTop = function (state) {\n\t            var elements = this.list.querySelectorAll('li.' + drop_down_base_1.dropDownBaseClasses.li);\n\t            var index;\n\t            if (elements.length > 1) {\n\t                this.removeFocus();\n\t                index = state ? 0 : (elements.length - 1);\n\t                this.addListFocus(elements[index]);\n\t                this.scrollBottom(elements[index], index);\n\t            }\n\t            this.updateAriaAttribute();\n\t        };\n\t        MultiSelect.prototype.moveByList = function (position) {\n\t            if (this.list) {\n\t                var elements = this.list.querySelectorAll('li.'\n\t                    + drop_down_base_1.dropDownBaseClasses.li\n\t                    + ':not(.' + HIDE_LIST + ')');\n\t                var selectedElem = this.list.querySelector('li.' + drop_down_base_1.dropDownBaseClasses.focus);\n\t                var temp = -1;\n\t                if (elements.length) {\n\t                    for (var index = 0; index < elements.length; index++) {\n\t                        if (elements[index] === selectedElem) {\n\t                            temp = index;\n\t                            break;\n\t                        }\n\t                    }\n\t                    if (position > 0) {\n\t                        if (temp < (elements.length - 1)) {\n\t                            this.removeFocus();\n\t                            this.addListFocus(elements[++temp]);\n\t                            this.scrollBottom(elements[temp], temp);\n\t                        }\n\t                    }\n\t                    else {\n\t                        if (temp > 0) {\n\t                            this.removeFocus();\n\t                            this.addListFocus(elements[--temp]);\n\t                            this.scrollTop(elements[temp], temp);\n\t                        }\n\t                    }\n\t                }\n\t            }\n\t        };\n\t        MultiSelect.prototype.moveBy = function (position) {\n\t            var elements;\n\t            var selectedElem;\n\t            var temp;\n\t            elements = this.chipCollectionWrapper.querySelectorAll('span.' + CHIP);\n\t            selectedElem = this.chipCollectionWrapper.querySelector('span.' + CHIP_SELECTED);\n\t            if (selectedElem === null) {\n\t                if (position < 0) {\n\t                    this.addChipSelection(elements[elements.length - 1]);\n\t                }\n\t            }\n\t            else {\n\t                if (position < 0) {\n\t                    temp = selectedElem.previousElementSibling;\n\t                    if (temp !== null) {\n\t                        this.removeChipSelection();\n\t                        this.addChipSelection(temp);\n\t                    }\n\t                }\n\t                else {\n\t                    temp = selectedElem.nextElementSibling;\n\t                    this.removeChipSelection();\n\t                    if (temp !== null) {\n\t                        this.addChipSelection(temp);\n\t                    }\n\t                }\n\t            }\n\t        };\n\t        MultiSelect.prototype.chipClick = function (e) {\n\t            if (this.enabled) {\n\t                var elem = ej2_base_5.closest(e.target, '.' + CHIP);\n\t                this.removeChipSelection();\n\t                this.addChipSelection(elem);\n\t            }\n\t        };\n\t        MultiSelect.prototype.removeChipSelection = function () {\n\t            if (this.chipCollectionWrapper) {\n\t                this.removeChipFocus();\n\t            }\n\t        };\n\t        MultiSelect.prototype.addChipSelection = function (element) {\n\t            ej2_base_5.addClass([element], CHIP_SELECTED);\n\t        };\n\t        MultiSelect.prototype.onChipRemove = function (e) {\n\t            if (this.enabled && !this.readonly) {\n\t                var element = e.target.parentElement;\n\t                var value = this.getFormattedValue(element.getAttribute('data-value'));\n\t                if (this.isPopupOpen()) {\n\t                    this.hidePopup();\n\t                }\n\t                this.removeValue(value, e);\n\t                this.updateDelimeter(e);\n\t                this.makeTextBoxEmpty();\n\t                if (!this.inputFocus) {\n\t                    this.inputElement.focus();\n\t                }\n\t                e.preventDefault();\n\t            }\n\t        };\n\t        MultiSelect.prototype.makeTextBoxEmpty = function () {\n\t            this.inputElement.value = '';\n\t            this.refreshPlaceHolder();\n\t        };\n\t        MultiSelect.prototype.refreshPlaceHolder = function () {\n\t            if (this.placeholder) {\n\t                if (this.value && this.value.length) {\n\t                    this.inputElement.placeholder = '';\n\t                }\n\t                else {\n\t                    this.inputElement.placeholder = this.placeholder;\n\t                }\n\t            }\n\t            this.expandTextbox();\n\t        };\n\t        MultiSelect.prototype.removeValue = function (value, eve) {\n\t            var index = this.value.indexOf(this.getFormattedValue(value));\n\t            var className = this.hideSelectedItem ?\n\t                HIDE_LIST :\n\t                drop_down_base_1.dropDownBaseClasses.selected;\n\t            if (index !== -1) {\n\t                var element = this.list.querySelector('li[data-value=\"' + value + '\"]');\n\t                var eventArgs = {\n\t                    e: eve,\n\t                    item: element,\n\t                    itemData: this.getDataByValue(value),\n\t                    isInteracted: eve ? true : false\n\t                };\n\t                this.trigger('removing', eventArgs);\n\t                this.value.splice(index, 1);\n\t                this.setProperties({ value: [].concat([], this.value) }, true);\n\t                if (element !== null) {\n\t                    element.setAttribute('aria-selected', 'false');\n\t                    ej2_base_5.removeClass([element], className);\n\t                    ej2_base_1.attributes(this.inputElement, { 'aria-activedescendant': element.id });\n\t                }\n\t                this.updateMainList(true, value);\n\t                this.removeChip(value);\n\t                this.updateChipStatus();\n\t                this.trigger('removed', eventArgs);\n\t            }\n\t        };\n\t        MultiSelect.prototype.updateMainList = function (state, value) {\n\t            if (this.allowFiltering) {\n\t                var element2 = this.mainList.querySelector('li[data-value=\"' + value + '\"]');\n\t                if (element2) {\n\t                    if (state) {\n\t                        element2.setAttribute('aria-selected', 'false');\n\t                        ej2_base_5.removeClass([element2], this.hideSelectedItem ?\n\t                            HIDE_LIST :\n\t                            drop_down_base_1.dropDownBaseClasses.selected);\n\t                    }\n\t                    else {\n\t                        element2.setAttribute('aria-selected', 'true');\n\t                        ej2_base_5.addClass([element2], this.hideSelectedItem ?\n\t                            HIDE_LIST :\n\t                            drop_down_base_1.dropDownBaseClasses.selected);\n\t                    }\n\t                }\n\t            }\n\t        };\n\t        MultiSelect.prototype.removeChip = function (value) {\n\t            if (this.chipCollectionWrapper) {\n\t                var element = this.chipCollectionWrapper.querySelector('span[data-value=\"' + value + '\"]');\n\t                if (element) {\n\t                    ej2_base_5.remove(element);\n\t                }\n\t            }\n\t        };\n\t        MultiSelect.prototype.updateChipStatus = function () {\n\t            if (this.value.length) {\n\t                if (!ej2_base_6.isNullOrUndefined(this.chipCollectionWrapper)) {\n\t                    (this.chipCollectionWrapper.style.display = '');\n\t                }\n\t                if (this.mode === 'delimiter') {\n\t                    this.showDelimWrapper();\n\t                }\n\t                this.showOverAllClear();\n\t            }\n\t            else {\n\t                if (!ej2_base_6.isNullOrUndefined(this.chipCollectionWrapper)) {\n\t                    this.chipCollectionWrapper.style.display = 'none';\n\t                }\n\t                if (!ej2_base_6.isNullOrUndefined(this.delimiterWrapper)) {\n\t                    (this.delimiterWrapper.style.display = 'none');\n\t                }\n\t                this.hideOverAllClear();\n\t            }\n\t        };\n\t        MultiSelect.prototype.addValue = function (value, text, eve) {\n\t            if (!this.value) {\n\t                this.value = [];\n\t            }\n\t            this.setProperties({ value: [].concat([], this.value, [value]) }, true);\n\t            var element = this.list.querySelector('li[data-value=\"' + value + '\"]');\n\t            this.removeFocus();\n\t            if (element) {\n\t                this.addListFocus(element);\n\t                this.addListSelection(element);\n\t            }\n\t            if (this.mode !== 'delimiter') {\n\t                this.addChip(text, value);\n\t            }\n\t            this.updateChipStatus();\n\t            this.dispatchSelect(value, eve, element, (eve && eve.type !== 'click'));\n\t        };\n\t        MultiSelect.prototype.dispatchSelect = function (value, eve, element, isNotTrigger) {\n\t            if (this.initStatus && !isNotTrigger) {\n\t                var eventArgs = {\n\t                    e: eve,\n\t                    item: element,\n\t                    itemData: this.getDataByValue(value),\n\t                    isInteracted: eve ? true : false\n\t                };\n\t                this.trigger('select', eventArgs);\n\t            }\n\t        };\n\t        MultiSelect.prototype.addChip = function (text, value) {\n\t            if (this.chipCollectionWrapper) {\n\t                this.chipCollectionWrapper.appendChild(this.getChip(text, value));\n\t            }\n\t        };\n\t        MultiSelect.prototype.removeChipFocus = function () {\n\t            var elements;\n\t            var closeElements;\n\t            elements = this.chipCollectionWrapper.querySelectorAll('span.' + CHIP);\n\t            closeElements = this.chipCollectionWrapper.querySelectorAll('span.' + CHIP_CLOSE.split(' ')[0]);\n\t            ej2_base_5.removeClass(elements, CHIP_SELECTED);\n\t            if (ej2_base_4.Browser.isDevice) {\n\t                for (var index = 0; index < closeElements.length; index++) {\n\t                    closeElements[index].style.display = 'none';\n\t                }\n\t            }\n\t        };\n\t        MultiSelect.prototype.onMobileChipInteraction = function (e) {\n\t            var chipElem = ej2_base_5.closest(e.target, '.' + CHIP);\n\t            var chipClose = chipElem.querySelector('span.' + CHIP_CLOSE.split(' ')[0]);\n\t            if (this.enabled && !this.readonly) {\n\t                if (!chipElem.classList.contains(CHIP_SELECTED)) {\n\t                    this.removeChipFocus();\n\t                    chipClose.style.display = '';\n\t                    chipElem.classList.add(CHIP_SELECTED);\n\t                }\n\t                this.refreshPopup();\n\t                e.preventDefault();\n\t            }\n\t        };\n\t        MultiSelect.prototype.getChip = function (data, value) {\n\t            var itemData = { text: value, value: value };\n\t            var chip = ej2_base_5.createElement('span', {\n\t                className: CHIP,\n\t                attrs: { 'data-value': value, 'title': data }\n\t            });\n\t            var chipContent = ej2_base_5.createElement('span', { className: CHIP_CONTENT });\n\t            var chipClose = ej2_base_5.createElement('span', { className: CHIP_CLOSE });\n\t            if (this.mainData) {\n\t                itemData = this.getDataByValue(value);\n\t            }\n\t            if (this.valueTemplate && itemData) {\n\t                var compiledString = ej2_base_3.compile(this.valueTemplate);\n\t                for (var _i = 0, _a = compiledString(itemData); _i < _a.length; _i++) {\n\t                    var item = _a[_i];\n\t                    chipContent.appendChild(item);\n\t                }\n\t            }\n\t            else {\n\t                chipContent.innerHTML = data;\n\t            }\n\t            chip.appendChild(chipContent);\n\t            if (ej2_base_4.Browser.isDevice) {\n\t                chip.classList.add(MOBILE_CHIP);\n\t                ej2_base_5.append([chipClose], chip);\n\t                chipClose.style.display = 'none';\n\t                ej2_base_3.EventHandler.add(chip, 'click', this.onMobileChipInteraction, this);\n\t            }\n\t            else {\n\t                ej2_base_3.EventHandler.add(chip, 'mousedown', this.chipClick, this);\n\t                if (this.showClearButton) {\n\t                    chip.appendChild(chipClose);\n\t                }\n\t            }\n\t            ej2_base_3.EventHandler.add(chipClose, 'mousedown', this.onChipRemove, this);\n\t            return chip;\n\t        };\n\t        MultiSelect.prototype.calcPopupWidth = function () {\n\t            var width = ej2_base_6.formatUnit(this.popupWidth);\n\t            if (width.indexOf('%') > -1) {\n\t                var inputWidth = (this.componentWrapper.getBoundingClientRect().width) * parseFloat(width) / 100;\n\t                width = inputWidth.toString() + 'px';\n\t            }\n\t            return width;\n\t        };\n\t        MultiSelect.prototype.mouseIn = function () {\n\t            if (this.enabled && !this.readonly) {\n\t                this.showOverAllClear();\n\t            }\n\t        };\n\t        MultiSelect.prototype.mouseOut = function () {\n\t            if (!this.inputFocus) {\n\t                this.overAllClear.style.display = 'none';\n\t            }\n\t        };\n\t        MultiSelect.prototype.renderPopup = function () {\n\t            var _this = this;\n\t            if (!this.list) {\n\t                _super.prototype.render.call(this);\n\t            }\n\t            if (!this.popupObj) {\n\t                document.body.appendChild(this.popupWrapper);\n\t                var overAllHeight = parseInt(this.popupHeight, 10);\n\t                this.popupWrapper.style.visibility = 'hidden';\n\t                if (this.headerTemplate) {\n\t                    var compiledString = void 0;\n\t                    this.header = document.createElement('div');\n\t                    ej2_base_5.addClass([this.header], HEADER);\n\t                    compiledString = ej2_base_3.compile(this.headerTemplate);\n\t                    var elements = compiledString({});\n\t                    for (var temp = 0; temp < elements.length; temp++) {\n\t                        this.header.appendChild(elements[temp]);\n\t                    }\n\t                    ej2_base_5.append([this.header], this.popupWrapper);\n\t                    ej2_base_3.EventHandler.add(this.header, 'mousedown', this.onListMouseDown, this);\n\t                    overAllHeight -= this.header.getBoundingClientRect().height;\n\t                }\n\t                ej2_base_5.append([this.list], this.popupWrapper);\n\t                if (this.footerTemplate) {\n\t                    var compiledString = void 0;\n\t                    this.footer = document.createElement('div');\n\t                    ej2_base_5.addClass([this.footer], FOOTER);\n\t                    compiledString = ej2_base_3.compile(this.footerTemplate);\n\t                    var elements = compiledString({});\n\t                    for (var temp = 0; temp < elements.length; temp++) {\n\t                        this.footer.appendChild(elements[temp]);\n\t                    }\n\t                    ej2_base_5.append([this.footer], this.popupWrapper);\n\t                    ej2_base_3.EventHandler.add(this.footer, 'mousedown', this.onListMouseDown, this);\n\t                    overAllHeight -= this.footer.getBoundingClientRect().height;\n\t                }\n\t                if (this.popupHeight !== 'auto') {\n\t                    this.list.style.maxHeight = ej2_base_6.formatUnit(overAllHeight);\n\t                    this.popupWrapper.style.maxHeight = ej2_base_6.formatUnit(this.popupHeight);\n\t                }\n\t                else {\n\t                    this.list.style.maxHeight = ej2_base_6.formatUnit(this.popupHeight);\n\t                }\n\t                this.popupObj = new ej2_popups_1.Popup(this.popupWrapper, {\n\t                    width: this.calcPopupWidth(), targetType: 'relative', position: { X: 'left', Y: 'bottom' },\n\t                    relateTo: this.overAllWrapper, collision: { X: 'none', Y: 'flip' }, offsetY: 1,\n\t                    enableRtl: this.enableRtl,\n\t                    close: function () {\n\t                        if (_this.popupObj.element.parentElement) {\n\t                            ej2_base_5.detach(_this.popupObj.element);\n\t                        }\n\t                    }\n\t                });\n\t                this.popupObj.close();\n\t                this.popupWrapper.style.visibility = '';\n\t            }\n\t        };\n\t        MultiSelect.prototype.ClearAll = function (e) {\n\t            if (this.enabled && !this.readonly) {\n\t                var temp = void 0;\n\t                var tempValues = this.value ? this.value.slice() : [];\n\t                for (temp = this.value[0]; this.value.length !== 0; temp = this.value[0]) {\n\t                    this.removeValue(temp, e);\n\t                }\n\t                this.updateDelimeter(e);\n\t                if (this.mode !== 'box') {\n\t                    this.updateDelimView();\n\t                }\n\t                this.makeTextBoxEmpty();\n\t                if (this.isPopupOpen()) {\n\t                    this.refreshPopup();\n\t                }\n\t                this.removeFocus();\n\t                if (!this.inputFocus) {\n\t                    this.updateValueState(e, this.value, tempValues);\n\t                    this.inputElement.focus();\n\t                }\n\t                e.preventDefault();\n\t            }\n\t        };\n\t        MultiSelect.prototype.windowResize = function () {\n\t            this.refreshPopup();\n\t            if (!this.inputFocus && this.viewWrapper && this.viewWrapper.parentElement) {\n\t                this.updateDelimView();\n\t            }\n\t        };\n\t        MultiSelect.prototype.wireEvent = function () {\n\t            ej2_base_3.EventHandler.add(this.componentWrapper, 'mousedown', this.wrapperClick, this);\n\t            ej2_base_3.EventHandler.add(window, 'resize', this.windowResize, this);\n\t            ej2_base_3.EventHandler.add(this.inputElement, 'focus', this.focusIn, this);\n\t            ej2_base_3.EventHandler.add(this.inputElement, 'keydown', this.onKeyDown, this);\n\t            ej2_base_3.EventHandler.add(this.inputElement, 'keyup', this.KeyUp, this);\n\t            ej2_base_3.EventHandler.add(this.inputElement, 'input', this.onInput, this);\n\t            ej2_base_3.EventHandler.add(this.inputElement, 'blur', this.onBlur, this);\n\t            ej2_base_3.EventHandler.add(this.componentWrapper, 'mousemove', this.mouseIn, this);\n\t            ej2_base_3.EventHandler.add(this.componentWrapper, 'mouseout', this.mouseOut, this);\n\t            ej2_base_3.EventHandler.add(this.overAllClear, 'mouseup', this.ClearAll, this);\n\t        };\n\t        MultiSelect.prototype.onInput = function () {\n\t            if (this.keyDownStatus) {\n\t                this.isValidKey = true;\n\t            }\n\t            else {\n\t                this.isValidKey = false;\n\t            }\n\t            this.keyDownStatus = false;\n\t        };\n\t        MultiSelect.prototype.preRender = function () {\n\t            _super.prototype.preRender.call(this);\n\t        };\n\t        MultiSelect.prototype.updateData = function () {\n\t            var data = '';\n\t            var delim = this.mode === 'delimiter';\n\t            var text = [];\n\t            var temp;\n\t            var tempData = this.listData;\n\t            this.listData = this.mainData;\n\t            this.hiddenElement.innerHTML = '';\n\t            for (var index = 0; this.value[index]; index++) {\n\t                if (this.listData) {\n\t                    temp = this.getTextByValue(this.value[index]);\n\t                }\n\t                else {\n\t                    temp = this.value[index];\n\t                }\n\t                data += temp + this.delimiterChar + ' ';\n\t                text.push(temp);\n\t                this.hiddenElement.innerHTML += '<option selected value =' + this.value[index] + '>' + index + '</option>';\n\t            }\n\t            this.text = text.toString();\n\t            if (delim) {\n\t                this.delimiterWrapper.innerHTML = data;\n\t            }\n\t            this.listData = tempData;\n\t        };\n\t        MultiSelect.prototype.initialValueUpdate = function () {\n\t            if (this.list) {\n\t                var text = void 0;\n\t                var textField = void 0;\n\t                var valueField = void 0;\n\t                var element = void 0;\n\t                var value = void 0;\n\t                if (this.chipCollectionWrapper) {\n\t                    this.chipCollectionWrapper.innerHTML = '';\n\t                }\n\t                this.removeListSelection();\n\t                for (var index = 0; this.value[index]; index++) {\n\t                    value = this.value[index];\n\t                    element = this.list.querySelector('li[data-value=\"' + value + '\"]');\n\t                    if (element) {\n\t                        text = this.getTextByValue(value);\n\t                        this.addChip(text, value);\n\t                        this.addListSelection(element);\n\t                    }\n\t                }\n\t                this.updateDelimeter(null);\n\t                if (!this.inputFocus) {\n\t                    if (this.mode === 'box') {\n\t                        this.chipCollectionWrapper.style.display = '';\n\t                    }\n\t                    else if (this.mode === 'delimiter') {\n\t                        this.showDelimWrapper();\n\t                    }\n\t                }\n\t            }\n\t        };\n\t        MultiSelect.prototype.isValidLI = function (li) {\n\t            return (li && !li.classList.contains(drop_down_base_1.dropDownBaseClasses.disabled) && !li.classList.contains(drop_down_base_1.dropDownBaseClasses.group) &&\n\t                li.classList.contains(drop_down_base_1.dropDownBaseClasses.li));\n\t        };\n\t        ;\n\t        MultiSelect.prototype.updateListSelection = function (li, e) {\n\t            var value = this.getFormattedValue(li.getAttribute('data-value'));\n\t            var text = this.getTextByValue(value);\n\t            this.removeHover();\n\t            if (!this.value || this.value.indexOf(value) === -1) {\n\t                if ((this.allowCustomValue || this.allowFiltering) && !this.mainList.querySelector('li[data-value=\"' + value + '\"]')) {\n\t                    var temp = li.cloneNode(true);\n\t                    var data = this.getDataByValue(value);\n\t                    ej2_base_5.append([temp], this.mainList);\n\t                    this.mainData.push(this.getDataByValue(value));\n\t                    var eventArgs = {\n\t                        newData: data\n\t                    };\n\t                    this.trigger('customValueSelection', eventArgs);\n\t                }\n\t                this.remoteCustomValue = false;\n\t                this.addValue(value, text, e);\n\t            }\n\t            else {\n\t                this.removeValue(value, e);\n\t            }\n\t        };\n\t        MultiSelect.prototype.removeListSelection = function () {\n\t            var className = this.hideSelectedItem ?\n\t                HIDE_LIST :\n\t                drop_down_base_1.dropDownBaseClasses.selected;\n\t            var selectedItems = this.list.querySelectorAll('.' + className);\n\t            var temp = selectedItems.length;\n\t            if (selectedItems && selectedItems.length) {\n\t                ej2_base_5.removeClass(selectedItems, className);\n\t                while (temp > 0) {\n\t                    selectedItems[temp - 1].setAttribute('aria-selected', 'false');\n\t                    temp--;\n\t                }\n\t            }\n\t        };\n\t        ;\n\t        MultiSelect.prototype.removeHover = function () {\n\t            var hoveredItem = this.list.querySelectorAll('.' + drop_down_base_1.dropDownBaseClasses.hover);\n\t            if (hoveredItem && hoveredItem.length) {\n\t                ej2_base_5.removeClass(hoveredItem, drop_down_base_1.dropDownBaseClasses.hover);\n\t            }\n\t        };\n\t        ;\n\t        MultiSelect.prototype.removeFocus = function () {\n\t            var hoveredItem = this.list.querySelectorAll('.' + drop_down_base_1.dropDownBaseClasses.focus);\n\t            var mainlist = this.mainList.querySelectorAll('.' + drop_down_base_1.dropDownBaseClasses.focus);\n\t            if (hoveredItem && hoveredItem.length) {\n\t                ej2_base_5.removeClass(hoveredItem, drop_down_base_1.dropDownBaseClasses.focus);\n\t                ej2_base_5.removeClass(mainlist, drop_down_base_1.dropDownBaseClasses.focus);\n\t            }\n\t        };\n\t        ;\n\t        MultiSelect.prototype.addListHover = function (li) {\n\t            if (this.enabled && this.isValidLI(li)) {\n\t                this.removeHover();\n\t                ej2_base_5.addClass([li], drop_down_base_1.dropDownBaseClasses.hover);\n\t            }\n\t        };\n\t        ;\n\t        MultiSelect.prototype.addListFocus = function (element) {\n\t            if (this.enabled && this.isValidLI(element)) {\n\t                this.removeFocus();\n\t                ej2_base_5.addClass([element], drop_down_base_1.dropDownBaseClasses.focus);\n\t            }\n\t        };\n\t        MultiSelect.prototype.addListSelection = function (element) {\n\t            var className = this.hideSelectedItem ?\n\t                HIDE_LIST :\n\t                drop_down_base_1.dropDownBaseClasses.selected;\n\t            if (this.enabled && this.isValidLI(element) && !element.classList.contains(drop_down_base_1.dropDownBaseClasses.hover)) {\n\t                ej2_base_5.addClass([element], className);\n\t                this.updateMainList(false, element.getAttribute('data-value'));\n\t                element.setAttribute('aria-selected', 'true');\n\t                if (this.chipCollectionWrapper !== null) {\n\t                    this.removeChipSelection();\n\t                }\n\t                ej2_base_1.attributes(this.inputElement, { 'aria-activedescendant': element.id });\n\t            }\n\t        };\n\t        MultiSelect.prototype.updateDelimeter = function (eve) {\n\t            this.updateData();\n\t        };\n\t        MultiSelect.prototype.onMouseClick = function (e) {\n\t            this.scrollFocusStatus = false;\n\t            var target = e.target;\n\t            var li = ej2_base_5.closest(target, '.' + drop_down_base_1.dropDownBaseClasses.li);\n\t            if (this.isValidLI(li)) {\n\t                var limit = this.value && this.value.length ? this.value.length : 0;\n\t                if (limit < this.maximumSelectionLength) {\n\t                    this.updateListSelection(li, e);\n\t                    this.addListFocus(li);\n\t                    if ((this.allowCustomValue || this.allowFiltering) && this.mainList && this.listData) {\n\t                        this.focusAtLastListItem(li.getAttribute('data-value'));\n\t                        this.refreshSelection();\n\t                    }\n\t                    else {\n\t                        this.makeTextBoxEmpty();\n\t                    }\n\t                }\n\t                this.updateDelimeter(e);\n\t                this.refreshPopup();\n\t                if (this.hideSelectedItem) {\n\t                    this.focusAtFirstListItem();\n\t                }\n\t                if (this.closePopupOnSelect) {\n\t                    this.hidePopup();\n\t                    this.makeTextBoxEmpty();\n\t                }\n\t                else {\n\t                    e.preventDefault();\n\t                }\n\t                var value = this.getFormattedValue(li.getAttribute('data-value'));\n\t                this.dispatchSelect(value, e, li, (li.getAttribute('aria-selected') === 'true' ? false : true));\n\t            }\n\t            else {\n\t                e.preventDefault();\n\t            }\n\t            this.refreshPlaceHolder();\n\t        };\n\t        MultiSelect.prototype.onMouseOver = function (e) {\n\t            var currentLi = ej2_base_5.closest(e.target, '.' + drop_down_base_1.dropDownBaseClasses.li);\n\t            this.addListHover(currentLi);\n\t        };\n\t        MultiSelect.prototype.onMouseLeave = function (e) {\n\t            this.removeHover();\n\t        };\n\t        MultiSelect.prototype.onListMouseDown = function (e) {\n\t            e.preventDefault();\n\t            this.scrollFocusStatus = true;\n\t        };\n\t        MultiSelect.prototype.wireListEvents = function () {\n\t            ej2_base_3.EventHandler.add(this.list, 'mousedown', this.onListMouseDown, this);\n\t            ej2_base_3.EventHandler.add(this.list, 'mouseup', this.onMouseClick, this);\n\t            ej2_base_3.EventHandler.add(this.list, 'mouseover', this.onMouseOver, this);\n\t            ej2_base_3.EventHandler.add(this.list, 'mouseout', this.onMouseLeave, this);\n\t        };\n\t        ;\n\t        MultiSelect.prototype.unwireListEvents = function () {\n\t            if (this.list) {\n\t                ej2_base_3.EventHandler.remove(this.list, 'mousedown', this.onListMouseDown);\n\t                ej2_base_3.EventHandler.remove(this.list, 'mouseup', this.onMouseClick);\n\t                ej2_base_3.EventHandler.remove(this.list, 'mouseover', this.onMouseOver);\n\t                ej2_base_3.EventHandler.remove(this.list, 'mouseout', this.onMouseLeave);\n\t            }\n\t        };\n\t        ;\n\t        MultiSelect.prototype.hideOverAllClear = function () {\n\t            if (!this.value || !this.value.length) {\n\t                this.overAllClear.style.display = 'none';\n\t            }\n\t        };\n\t        MultiSelect.prototype.showOverAllClear = function () {\n\t            if (this.value && this.value.length) {\n\t                this.overAllClear.style.display = '';\n\t            }\n\t        };\n\t        MultiSelect.prototype.showSpinner = function () {\n\t            if (ej2_base_6.isNullOrUndefined(this.spinnerElement)) {\n\t                if (this.overAllClear.style.display !== 'none') {\n\t                    this.spinnerElement = this.overAllClear;\n\t                }\n\t                else {\n\t                    this.spinnerElement = ej2_base_5.createElement('span', { className: CLOSEICON_CLASS + ' ' + SPINNER_CLASS });\n\t                    this.componentWrapper.appendChild(this.spinnerElement);\n\t                }\n\t                ej2_base_5.addClass([this.spinnerElement], DISABLE_ICON);\n\t                ej2_popups_1.createSpinner({\n\t                    target: this.spinnerElement,\n\t                    width: drop_down_base_1.SPINNER_SIZE\n\t                });\n\t                ej2_popups_1.showSpinner(this.spinnerElement);\n\t            }\n\t        };\n\t        MultiSelect.prototype.hideSpinner = function () {\n\t            if (!ej2_base_6.isNullOrUndefined(this.spinnerElement)) {\n\t                ej2_popups_1.hideSpinner(this.spinnerElement);\n\t                ej2_base_5.removeClass([this.spinnerElement], DISABLE_ICON);\n\t                if (this.spinnerElement.classList.contains(SPINNER_CLASS)) {\n\t                    ej2_base_5.detach(this.spinnerElement);\n\t                }\n\t                else {\n\t                    this.spinnerElement.innerHTML = '';\n\t                }\n\t                this.spinnerElement = null;\n\t            }\n\t        };\n\t        MultiSelect.prototype.updateDelimView = function () {\n\t            if (this.delimiterWrapper) {\n\t                this.hideDelimWrapper();\n\t            }\n\t            if (this.chipCollectionWrapper) {\n\t                this.chipCollectionWrapper.style.display = 'none';\n\t            }\n\t            this.viewWrapper.style.display = '';\n\t            if (this.value && this.value.length) {\n\t                var data = '';\n\t                var temp = void 0;\n\t                var tempData = void 0;\n\t                var tempIndex = 1;\n\t                var wrapperleng = void 0;\n\t                var remaining = void 0;\n\t                this.viewWrapper.innerHTML = '';\n\t                var l10nLocale = {\n\t                    noRecordsTemplate: 'No Records Found',\n\t                    actionFailureTemplate: 'The Request Failed',\n\t                    overflowCountTemplate: '+${count} more..'\n\t                };\n\t                var l10n = new ej2_base_3.L10n('dropdowns', l10nLocale, this.locale);\n\t                var remainContent = l10n.getConstant('overflowCountTemplate');\n\t                var raminElement = ej2_base_5.createElement('span', {\n\t                    className: REMAIN_WRAPPER\n\t                });\n\t                var compiledString = ej2_base_3.compile(remainContent);\n\t                raminElement.appendChild(compiledString({ 'count': this.value.length })[0]);\n\t                this.viewWrapper.appendChild(raminElement);\n\t                var remainSize = raminElement.getBoundingClientRect().width;\n\t                ej2_base_5.remove(raminElement);\n\t                this.viewWrapper.innerHTML = '';\n\t                var inputleng = this.searchWrapper.getBoundingClientRect().width;\n\t                var overAllContainer = parseInt(window.getComputedStyle(this.componentWrapper).width, 10) -\n\t                    parseInt(window.getComputedStyle(this.componentWrapper).paddingLeft, 10) -\n\t                    parseInt(window.getComputedStyle(this.componentWrapper).paddingRight, 10);\n\t                for (var index = 0; this.value[index]; index++) {\n\t                    data += (index === 0) ? '' : this.delimiterChar + ' ';\n\t                    if (this.mainData && this.mainData.length) {\n\t                        temp = this.getTextByValue(this.value[index]);\n\t                    }\n\t                    else {\n\t                        temp = this.value[index];\n\t                    }\n\t                    data += temp;\n\t                    temp = this.viewWrapper.innerHTML;\n\t                    this.viewWrapper.innerHTML = data;\n\t                    wrapperleng = this.viewWrapper.getBoundingClientRect().width;\n\t                    if ((wrapperleng) > overAllContainer) {\n\t                        if (tempData !== undefined) {\n\t                            temp = tempData;\n\t                            index = tempIndex + 1;\n\t                        }\n\t                        this.viewWrapper.innerHTML = temp;\n\t                        remaining = this.value.length - index;\n\t                        break;\n\t                    }\n\t                    else if ((wrapperleng + remainSize) <= overAllContainer) {\n\t                        tempData = data;\n\t                        tempIndex = index;\n\t                    }\n\t                    else if (index === 0) {\n\t                        tempData = '';\n\t                        tempIndex = -1;\n\t                    }\n\t                }\n\t                if (remaining > 0) {\n\t                    raminElement.innerHTML = '';\n\t                    raminElement.appendChild(compiledString({ 'count': remaining })[0]);\n\t                    this.viewWrapper.appendChild(raminElement);\n\t                }\n\t            }\n\t            else {\n\t                this.viewWrapper.innerHTML = '';\n\t                this.viewWrapper.style.display = 'none';\n\t            }\n\t        };\n\t        MultiSelect.prototype.unWireEvent = function () {\n\t            ej2_base_3.EventHandler.remove(this.componentWrapper, 'mousedown', this.wrapperClick);\n\t            ej2_base_3.EventHandler.remove(window, 'resize', this.windowResize);\n\t            ej2_base_3.EventHandler.remove(this.inputElement, 'focus', this.focusIn);\n\t            ej2_base_3.EventHandler.remove(this.inputElement, 'keydown', this.onKeyDown);\n\t            ej2_base_3.EventHandler.remove(this.inputElement, 'input', this.onInput);\n\t            ej2_base_3.EventHandler.remove(this.inputElement, 'keyup', this.KeyUp);\n\t            ej2_base_3.EventHandler.remove(this.inputElement, 'blur', this.onBlur);\n\t            ej2_base_3.EventHandler.remove(this.componentWrapper, 'mousemove', this.mouseIn);\n\t            ej2_base_3.EventHandler.remove(this.componentWrapper, 'mouseout', this.mouseOut);\n\t            ej2_base_3.EventHandler.remove(this.overAllClear, 'mousedown', this.ClearAll);\n\t        };\n\t        MultiSelect.prototype.selectAllItem = function (state) {\n\t            var li;\n\t            li = this.list.querySelectorAll(state ?\n\t                'li[aria-selected=\"false\"]' :\n\t                'li[aria-selected=\"true\"]');\n\t            var length = li.length;\n\t            if (li && li.length) {\n\t                while (length > 0) {\n\t                    this.updateListSelection(li[length - 1], null);\n\t                    length--;\n\t                }\n\t            }\n\t            if (this.mode !== 'box' && !this.isPopupOpen()) {\n\t                this.updateDelimView();\n\t            }\n\t            else {\n\t                this.searchWrapper.classList.remove(ZERO_SIZE);\n\t            }\n\t            this.updateData();\n\t            this.refreshPlaceHolder();\n\t        };\n\t        MultiSelect.prototype.getPersistData = function () {\n\t            return this.addOnPersist(['value']);\n\t        };\n\t        ;\n\t        MultiSelect.prototype.onPropertyChanged = function (newProp, oldProp) {\n\t            for (var _i = 0, _a = Object.keys(newProp); _i < _a.length; _i++) {\n\t                var prop = _a[_i];\n\t                switch (prop) {\n\t                    case 'htmlAttributes':\n\t                        this.updateHTMLAttribute();\n\t                        break;\n\t                    case 'showClearButton':\n\t                        this.updateClearButton(newProp.showClearButton);\n\t                        break;\n\t                    case 'value':\n\t                        if (!this.inputFocus) {\n\t                            this.initialValueUpdate();\n\t                            if (this.mode !== 'box') {\n\t                                this.updateDelimView();\n\t                            }\n\t                            this.refreshInputHight();\n\t                            this.refreshPlaceHolder();\n\t                            this.updateValueState(null, this.value, oldProp.value);\n\t                        }\n\t                        break;\n\t                    case 'width':\n\t                        ej2_base_5.setStyleAttribute(this.overAllWrapper, { 'width': ej2_base_6.formatUnit(newProp.width) });\n\t                        this.popupObj.setProperties({ width: this.calcPopupWidth() });\n\t                        break;\n\t                    case 'placeholder':\n\t                        this.refreshPlaceHolder();\n\t                        break;\n\t                    case 'query':\n\t                    case 'dataSource':\n\t                        this.resetList(this.dataSource);\n\t                        if (this.value && this.value.length) {\n\t                            this.refreshSelection();\n\t                        }\n\t                        break;\n\t                    case 'cssClass':\n\t                        this.popupWrapper.classList.remove(oldProp.cssClass);\n\t                        this.overAllWrapper.classList.remove(oldProp.cssClass);\n\t                        this.updateCssClass();\n\t                        break;\n\t                    case 'enableRtl':\n\t                        this.enableRTL(newProp.enableRtl);\n\t                        break;\n\t                    case 'readonly':\n\t                        this.updateReadonly(newProp.readonly);\n\t                        this.hidePopup();\n\t                        break;\n\t                    case 'enabled':\n\t                        this.hidePopup();\n\t                        this.enable(newProp.enabled);\n\t                        break;\n\t                }\n\t            }\n\t        };\n\t        MultiSelect.prototype.hidePopup = function () {\n\t            var delay = 100;\n\t            if (this.isPopupOpen()) {\n\t                var animModel = {\n\t                    name: 'FadeOut',\n\t                    duration: 100,\n\t                    delay: delay ? delay : 0\n\t                };\n\t                this.beforePopupOpen = false;\n\t                this.popupObj.hide(new ej2_base_4.Animation(animModel));\n\t                ej2_base_1.attributes(this.inputElement, { 'aria-expanded': 'false' });\n\t                this.popupObj.hide();\n\t                var eventArgs = { popup: this.popupObj };\n\t                this.trigger('close', eventArgs);\n\t            }\n\t        };\n\t        MultiSelect.prototype.showPopup = function () {\n\t            if (!this.ulElement) {\n\t                this.beforePopupOpen = true;\n\t                _super.prototype.render.call(this);\n\t                return;\n\t            }\n\t            this.onPopupShown();\n\t        };\n\t        MultiSelect.prototype.selectAll = function (state) {\n\t            var _this = this;\n\t            if (ej2_base_6.isNullOrUndefined(this.list)) {\n\t                this.selectAllAction = function () {\n\t                    _this.selectAllItem(state);\n\t                    _this.selectAllAction = null;\n\t                };\n\t                _super.prototype.render.call(this);\n\t            }\n\t            else {\n\t                this.selectAllAction = null;\n\t                this.selectAllItem(state);\n\t            }\n\t        };\n\t        MultiSelect.prototype.getModuleName = function () {\n\t            return 'multiselect';\n\t        };\n\t        ;\n\t        MultiSelect.prototype.render = function () {\n\t            var _this = this;\n\t            this.initStatus = false;\n\t            this.searchWrapper = ej2_base_5.createElement('span', { className: SEARCHBOX_WRAPPER });\n\t            this.viewWrapper = ej2_base_5.createElement('span', {\n\t                className: DELIMITER_VIEW + ' ' + DELIMITER_WRAPPER,\n\t                styles: 'display:none;'\n\t            });\n\t            this.overAllClear = ej2_base_5.createElement('span', { className: CLOSEICON_CLASS, styles: 'display:none;' });\n\t            this.componentWrapper = ej2_base_5.createElement('div', { className: ELEMENT_WRAPPER });\n\t            this.overAllWrapper = ej2_base_5.createElement('div', { className: OVER_ALL_WRAPPER });\n\t            if (ej2_base_4.Browser.isDevice) {\n\t                this.componentWrapper.classList.add(ELEMENT_MOBILE_WRAPPER);\n\t            }\n\t            this.overAllWrapper.style.width = ej2_base_6.formatUnit(this.width);\n\t            this.overAllWrapper.appendChild(this.componentWrapper);\n\t            this.popupWrapper = ej2_base_5.createElement('div', {\n\t                id: this.element.id + '_popup',\n\t                className: POPUP_WRAPPER\n\t            });\n\t            if (this.mode === 'delimiter') {\n\t                this.delimiterWrapper = ej2_base_5.createElement('span', { className: DELIMITER_WRAPPER, styles: 'display:none' });\n\t                this.componentWrapper.appendChild(this.delimiterWrapper);\n\t            }\n\t            else {\n\t                this.chipCollectionWrapper = ej2_base_5.createElement('span', {\n\t                    className: CHIP_WRAPPER,\n\t                    styles: 'display:none'\n\t                });\n\t                this.componentWrapper.appendChild(this.chipCollectionWrapper);\n\t            }\n\t            if (this.mode !== 'box') {\n\t                this.componentWrapper.appendChild(this.viewWrapper);\n\t            }\n\t            this.componentWrapper.appendChild(this.searchWrapper);\n\t            if (this.showClearButton && !ej2_base_4.Browser.isDevice) {\n\t                this.componentWrapper.appendChild(this.overAllClear);\n\t            }\n\t            else {\n\t                this.componentWrapper.classList.add(CLOSE_ICON_HIDE);\n\t            }\n\t            this.inputElement = ej2_base_5.createElement('input', {\n\t                className: INPUT_ELEMENT,\n\t                attrs: {\n\t                    spellcheck: 'false',\n\t                    type: 'text',\n\t                    autocomplete: 'off',\n\t                    tabindex: '0'\n\t                }\n\t            });\n\t            this.refreshPlaceHolder();\n\t            if (this.element.tagName !== this.getNgDirective()) {\n\t                this.element.style.display = 'none';\n\t            }\n\t            if (this.element.tagName === this.getNgDirective()) {\n\t                this.element.appendChild(this.overAllWrapper);\n\t                this.searchWrapper.appendChild(this.inputElement);\n\t            }\n\t            else {\n\t                this.element.parentElement.insertBefore(this.overAllWrapper, this.element);\n\t                this.searchWrapper.appendChild(this.inputElement);\n\t                this.searchWrapper.appendChild(this.element);\n\t                this.element.removeAttribute('tabindex');\n\t            }\n\t            var name = this.element.getAttribute('name') ? this.element.getAttribute('name') : this.element.getAttribute('id');\n\t            var id = this.element.getAttribute('id') ? this.element.getAttribute('id') : ej2_base_6.getUniqueID('ej2_dropdownlist');\n\t            this.element.id = id;\n\t            this.element.style.opacity = '';\n\t            this.hiddenElement = ej2_base_5.createElement('select', {\n\t                attrs: { 'name': name, 'aria-hidden': 'true', 'multiple': 'true' }, styles: 'display:none'\n\t            });\n\t            this.element.removeAttribute('name');\n\t            this.searchWrapper.appendChild(this.hiddenElement);\n\t            this.hideOverAllClear();\n\t            this.wireEvent();\n\t            this.enable(this.enabled);\n\t            this.enableRTL(this.enableRtl);\n\t            if (!(this.dataSource instanceof ej2_data_1.DataManager)) {\n\t                this.renderPopup();\n\t            }\n\t            if (this.value && this.value.length) {\n\t                if (!(this.dataSource instanceof ej2_data_1.DataManager)) {\n\t                    this.initialValueUpdate();\n\t                    this.initialUpdate();\n\t                }\n\t                else {\n\t                    this.setInitialValue = function () {\n\t                        _this.initialValueUpdate();\n\t                        _this.initialUpdate();\n\t                        _this.setInitialValue = null;\n\t                    };\n\t                    _super.prototype.render.call(this);\n\t                }\n\t            }\n\t            else {\n\t                this.initialUpdate();\n\t            }\n\t            this.initStatus = true;\n\t        };\n\t        ;\n\t        MultiSelect.prototype.initialUpdate = function () {\n\t            if (this.mode !== 'box') {\n\t                this.updateDelimView();\n\t            }\n\t            this.updateCssClass();\n\t            this.updateHTMLAttribute();\n\t            this.updateReadonly(this.readonly);\n\t            this.refreshInputHight();\n\t        };\n\t        MultiSelect.prototype.destroy = function () {\n\t            if (this.popupObj) {\n\t                this.popupObj.hide();\n\t            }\n\t            this.unwireListEvents();\n\t            this.unWireEvent();\n\t            _super.prototype.destroy.call(this);\n\t            var temp = ['readonly', 'aria-disabled', 'aria-placeholder', 'placeholder'];\n\t            var length = temp.length;\n\t            while (length > 0) {\n\t                this.inputElement.removeAttribute(temp[length - 1]);\n\t                length--;\n\t            }\n\t            this.element.style.display = 'block';\n\t            if (this.overAllWrapper.parentElement) {\n\t                if (this.overAllWrapper.parentElement.tagName === this.getNgDirective()) {\n\t                    ej2_base_5.remove(this.overAllWrapper);\n\t                }\n\t                else {\n\t                    this.overAllWrapper.parentElement.insertBefore(this.element, this.overAllWrapper);\n\t                    ej2_base_5.remove(this.overAllWrapper);\n\t                }\n\t            }\n\t        };\n\t        ;\n\t        return MultiSelect;\n\t    }(drop_down_base_1.DropDownBase));\n\t    __decorate([\n\t        ej2_base_3.Property(null)\n\t    ], MultiSelect.prototype, \"cssClass\", void 0);\n\t    __decorate([\n\t        ej2_base_3.Property('100%')\n\t    ], MultiSelect.prototype, \"width\", void 0);\n\t    __decorate([\n\t        ej2_base_3.Property('300px')\n\t    ], MultiSelect.prototype, \"popupHeight\", void 0);\n\t    __decorate([\n\t        ej2_base_3.Property('100%')\n\t    ], MultiSelect.prototype, \"popupWidth\", void 0);\n\t    __decorate([\n\t        ej2_base_3.Property(null)\n\t    ], MultiSelect.prototype, \"placeholder\", void 0);\n\t    __decorate([\n\t        ej2_base_3.Property({})\n\t    ], MultiSelect.prototype, \"htmlAttributes\", void 0);\n\t    __decorate([\n\t        ej2_base_3.Property(null)\n\t    ], MultiSelect.prototype, \"valueTemplate\", void 0);\n\t    __decorate([\n\t        ej2_base_3.Property(null)\n\t    ], MultiSelect.prototype, \"headerTemplate\", void 0);\n\t    __decorate([\n\t        ej2_base_3.Property(null)\n\t    ], MultiSelect.prototype, \"footerTemplate\", void 0);\n\t    __decorate([\n\t        ej2_base_3.Property(null)\n\t    ], MultiSelect.prototype, \"itemTemplate\", void 0);\n\t    __decorate([\n\t        ej2_base_3.Property(false)\n\t    ], MultiSelect.prototype, \"allowFiltering\", void 0);\n\t    __decorate([\n\t        ej2_base_3.Property(false)\n\t    ], MultiSelect.prototype, \"allowCustomValue\", void 0);\n\t    __decorate([\n\t        ej2_base_3.Property(true)\n\t    ], MultiSelect.prototype, \"showClearButton\", void 0);\n\t    __decorate([\n\t        ej2_base_3.Property(1000)\n\t    ], MultiSelect.prototype, \"maximumSelectionLength\", void 0);\n\t    __decorate([\n\t        ej2_base_3.Property(false)\n\t    ], MultiSelect.prototype, \"readonly\", void 0);\n\t    __decorate([\n\t        ej2_base_3.Property(null)\n\t    ], MultiSelect.prototype, \"text\", void 0);\n\t    __decorate([\n\t        ej2_base_3.Property(null)\n\t    ], MultiSelect.prototype, \"value\", void 0);\n\t    __decorate([\n\t        ej2_base_3.Property(false)\n\t    ], MultiSelect.prototype, \"hideSelectedItem\", void 0);\n\t    __decorate([\n\t        ej2_base_3.Property(true)\n\t    ], MultiSelect.prototype, \"closePopupOnSelect\", void 0);\n\t    __decorate([\n\t        ej2_base_3.Property('default')\n\t    ], MultiSelect.prototype, \"mode\", void 0);\n\t    __decorate([\n\t        ej2_base_3.Property(',')\n\t    ], MultiSelect.prototype, \"delimiterChar\", void 0);\n\t    __decorate([\n\t        ej2_base_3.Property(true)\n\t    ], MultiSelect.prototype, \"ignoreCase\", void 0);\n\t    __decorate([\n\t        ej2_base_3.Event()\n\t    ], MultiSelect.prototype, \"change\", void 0);\n\t    __decorate([\n\t        ej2_base_3.Event()\n\t    ], MultiSelect.prototype, \"removing\", void 0);\n\t    __decorate([\n\t        ej2_base_3.Event()\n\t    ], MultiSelect.prototype, \"removed\", void 0);\n\t    __decorate([\n\t        ej2_base_3.Event()\n\t    ], MultiSelect.prototype, \"open\", void 0);\n\t    __decorate([\n\t        ej2_base_3.Event()\n\t    ], MultiSelect.prototype, \"close\", void 0);\n\t    __decorate([\n\t        ej2_base_3.Event()\n\t    ], MultiSelect.prototype, \"blur\", void 0);\n\t    __decorate([\n\t        ej2_base_3.Event()\n\t    ], MultiSelect.prototype, \"focus\", void 0);\n\t    __decorate([\n\t        ej2_base_3.Event()\n\t    ], MultiSelect.prototype, \"filtering\", void 0);\n\t    __decorate([\n\t        ej2_base_3.Event()\n\t    ], MultiSelect.prototype, \"customValueSelection\", void 0);\n\t    MultiSelect = __decorate([\n\t        ej2_base_2.NotifyPropertyChanges\n\t    ], MultiSelect);\n\t    exports.MultiSelect = MultiSelect;\n\t}.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__), __WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));\n\n\n/***/ })\n/******/ ])\n});\n;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay91bml2ZXJzYWxNb2R1bGVEZWZpbml0aW9uIiwid2VicGFjazovLy93ZWJwYWNrL2Jvb3RzdHJhcCBmNjdjOGQzMTcyNmZmOGQ4OWZmZSIsIndlYnBhY2s6Ly8vLi9zcmMvaW5kZXguanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2NvbW1vbi9pbmRleC5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvY29tbW9uL2luY3JlbWVudGFsLXNlYXJjaC5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvY29tbW9uL2hpZ2hsaWdodC1zZWFyY2guanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2Ryb3AtZG93bi1iYXNlL2luZGV4LmpzIiwid2VicGFjazovLy8uL3NyYy9kcm9wLWRvd24tYmFzZS9kcm9wLWRvd24tYmFzZS5qcyIsIndlYnBhY2s6Ly8vZXh0ZXJuYWwgXCJAc3luY2Z1c2lvbi9lajItYmFzZVwiIiwid2VicGFjazovLy9leHRlcm5hbCBcIkBzeW5jZnVzaW9uL2VqMi1kYXRhXCIiLCJ3ZWJwYWNrOi8vL2V4dGVybmFsIFwiQHN5bmNmdXNpb24vZWoyLWxpc3RzXCIiLCJ3ZWJwYWNrOi8vLy4vc3JjL2Ryb3AtZG93bi1saXN0L2luZGV4LmpzIiwid2VicGFjazovLy8uL3NyYy9kcm9wLWRvd24tbGlzdC9kcm9wLWRvd24tbGlzdC5qcyIsIndlYnBhY2s6Ly8vZXh0ZXJuYWwgXCJAc3luY2Z1c2lvbi9lajItcG9wdXBzXCIiLCJ3ZWJwYWNrOi8vL2V4dGVybmFsIFwiQHN5bmNmdXNpb24vZWoyLWlucHV0c1wiIiwid2VicGFjazovLy8uL3NyYy9jb21iby1ib3gvaW5kZXguanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2NvbWJvLWJveC9jb21iby1ib3guanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2F1dG8tY29tcGxldGUvaW5kZXguanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2F1dG8tY29tcGxldGUvYXV0by1jb21wbGV0ZS5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvbXVsdGktc2VsZWN0L2luZGV4LmpzIiwid2VicGFjazovLy8uL3NyYy9tdWx0aS1zZWxlY3QvbXVsdGktc2VsZWN0LmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRCxPO0FDVkE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsdUJBQWU7QUFDZjtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7O0FBR0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7Ozs7OztpRUN0Q0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG1EQUFrRCxjQUFjO0FBQ2hFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEVBQUM7Ozs7Ozs7aUVDWkQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG1EQUFrRCxjQUFjO0FBQ2hFO0FBQ0E7QUFDQSxFQUFDOzs7Ozs7O2lFQ1JEO0FBQ0E7QUFDQSxtREFBa0QsY0FBYztBQUNoRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQ0FBZ0Msa0JBQWtCLEVBQUU7QUFDcEQ7QUFDQTtBQUNBO0FBQ0EsNEJBQTJCLG9CQUFvQjtBQUMvQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxjQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHlCQUF3QjtBQUN4QjtBQUNBO0FBQ0E7QUFDQSxtREFBa0Qsc0JBQXNCO0FBQ3hFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw2QkFBNEI7QUFDNUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNB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eUNBQXdDO0FBQ3hDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdFQUF1RSxnQkFBZ0I7QUFDdkY7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esc0RBQXFELHlCQUF5QjtBQUM5RTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0JBQWlCO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsOERBQTZELHVFQUF1RTtBQUNwSTtBQUNBLDhEQUE2RCx1RUFBdUU7QUFDcEk7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDJFQUEwRSwrQ0FBK0M7QUFDekg7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpRUFBZ0UsZ0JBQWdCO0FBQ2hGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxQkFBb0I7QUFDcEI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQ0FBZ0MsaUVBQWlFO0FBQ2pHO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EscUJBQW9CO0FBQ3BCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esc0JBQXFCO0FBQ3JCO0FBQ0Esa0JBQWlCO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtCQUFpQjtBQUNqQjtBQUNBLDZCQUE0QixlQUFl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Q0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG9GQUFtRix3Q0FBd0M7QUFDM0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMERBQXlELDBEQUEwRDtBQUNuSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsOEJBQTZCO0FBQzdCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0JBQWlCO0FBQ2pCLGNBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EseUJBQXdCLHNDQUFzQztBQUM5RCxjQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG9EQUFtRCxFQUFFLGdCQUFnQjtBQUNyRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3REFBdUQsZ0JBQWdCO0FBQ3ZFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG9GQUFtRixnREFBZ0Q7QUFDbkk7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFDQUFvQztBQUNwQztBQUNBO0FBQ0E7QUFDQTtBQUNBLDBEQUF5RCx1RUFBdUU7QUFDaEk7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsY0FBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLCtCQUE4QjtBQUM5QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsRUFBQzs7Ozs7OztBQzN4REQsaUQ7Ozs7OztBQ0FBLGlEOzs7Ozs7aUVDQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG1EQUFrRCxjQUFjO0FBQ2hFO0FBQ0EsRUFBQzs7Ozs7OztBQ1BEO0FBQ0E7QUFDQSxXQUFVLGdCQUFnQixzQ0FBc0MsaUJBQWlCLEVBQUU7QUFDbkYsMEJBQXlCLHVEQUF1RDtBQUNoRjtBQUNBO0FBQ0Esd0JBQXVCLHNCQUFzQjtBQUM3QztBQUNBO0FBQ0EsRUFBQztBQUNEO0FBQ0E7QUFDQTtBQUNBLDZDQUE0QyxRQUFRO0FBQ3BEO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsbURBQWtELGNBQWM7QUFDaEU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUNBQWdDLHlDQUF5QztBQUN6RTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG1EQUFrRCxXQUFXO0FBQzdEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0JBQWlCO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFDQUFvQyxlQUFlO0FBQ25EO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0NBQWlDLHdCQUF3QjtBQUN6RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHlDQUF3QyxvRkFBb0Y7QUFDNUg7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHlDQUF3QyxlQUFlO0FBQ3ZEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0RBQXVELGdCQUFnQjtBQUN2RTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsdURBQXNELFdBQVc7QUFDakU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwrQkFBOEI7QUFDOUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEVBQUM7Ozs7Ozs7aUVDbmlCRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsbURBQWtELGNBQWM7QUFDaEU7QUFDQSxFQUFDOzs7Ozs7O0FDUEQ7QUFDQTtBQUNBLFdBQVUsZ0JBQWdCLHNDQUFzQyxpQkFBaUIsRUFBRTtBQUNuRiwwQkFBeUIsdURBQXVEO0FBQ2hGO0FBQ0E7QUFDQSx3QkFBdUIsc0JBQXNCO0FBQzdDO0FBQ0E7QUFDQSxFQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0EsNkNBQTRDLFFBQVE7QUFDcEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQSxtREFBa0QsY0FBYztBQUNoRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMkRBQTBELHVFQUF1RTtBQUNqSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3REFBdUQsZ0JBQWdCO0FBQ3ZFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFLO0FBQ0w7QUFDQSw4QkFBNkIsNENBQTRDO0FBQ3pFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwrQkFBOEI7QUFDOUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEVBQUM7Ozs7Ozs7aUVDL1JEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxtREFBa0QsY0FBYztBQUNoRTtBQUNBLEVBQUM7Ozs7Ozs7QUNQRDtBQUNBO0FBQ0EsV0FBVSxnQkFBZ0Isc0NBQXNDLGlCQUFpQixFQUFFO0FBQ25GLDBCQUF5Qix1REFBdUQ7QUFDaEY7QUFDQTtBQUNBLHdCQUF1QixzQkFBc0I7QUFDN0M7QUFDQTtBQUNBLEVBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQSw2Q0FBNEMsUUFBUTtBQUNwRDtBQUNBO0FBQ0E7QUFDQTtBQUNBLG1EQUFrRCxjQUFjO0FBQ2hFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdFQUF1RSxnQkFBZ0I7QUFDdkY7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw4QkFBNkI7QUFDN0I7QUFDQTtBQUNBO0FBQ0E7QUFDQSx1REFBc0QsMEJBQTBCO0FBQ2hGLDhCQUE2QjtBQUM3QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG9EQUFtRCxnRkFBZ0Y7QUFDbkk7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0NBQStCLG1CQUFtQjtBQUNsRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esc0NBQXFDO0FBQ3JDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMkRBQTBELDJCQUEyQjtBQUNyRjtBQUNBO0FBQ0E7QUFDQTtBQUNBLDJEQUEwRCwwQkFBMEI7QUFDcEY7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDhDQUE2QywrQkFBK0I7QUFDNUU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3Q0FBdUMseUJBQXlCO0FBQ2hFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFDQUFvQyxtQ0FBbUM7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O0FBQ0E7QUFDQTtBQUNBLG9DQUFtQyxtQkFBbUI7QUFDdEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDJEQUEwRCxzQ0FBc0M7QUFDaEc7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNB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QUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EseUJBQXdCLDBEQUEwRDtBQUNsRixjQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwrQkFBOEI7QUFDOUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEVBQUMiLCJmaWxlIjoiZWoyLWRyb3Bkb3ducy51bWQuanMiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24gd2VicGFja1VuaXZlcnNhbE1vZHVsZURlZmluaXRpb24ocm9vdCwgZmFjdG9yeSkge1xuXHRpZih0eXBlb2YgZXhwb3J0cyA9PT0gJ29iamVjdCcgJiYgdHlwZW9mIG1vZHVsZSA9PT0gJ29iamVjdCcpXG5cdFx0bW9kdWxlLmV4cG9ydHMgPSBmYWN0b3J5KHJlcXVpcmUoXCJAc3luY2Z1c2lvbi9lajItYmFzZVwiKSwgcmVxdWlyZShcIkBzeW5jZnVzaW9uL2VqMi1kYXRhXCIpLCByZXF1aXJlKFwiQHN5bmNmdXNpb24vZWoyLWxpc3RzXCIpLCByZXF1aXJlKFwiQHN5bmNmdXNpb24vZWoyLXBvcHVwc1wiKSwgcmVxdWlyZShcIkBzeW5jZnVzaW9uL2VqMi1pbnB1dHNcIikpO1xuXHRlbHNlIGlmKHR5cGVvZiBkZWZpbmUgPT09ICdmdW5jdGlvbicgJiYgZGVmaW5lLmFtZClcblx0XHRkZWZpbmUoW1wiQHN5bmNmdXNpb24vZWoyLWJhc2VcIiwgXCJAc3luY2Z1c2lvbi9lajItZGF0YVwiLCBcIkBzeW5jZnVzaW9uL2VqMi1saXN0c1wiLCBcIkBzeW5jZnVzaW9uL2VqMi1wb3B1cHNcIiwgXCJAc3luY2Z1c2lvbi9lajItaW5wdXRzXCJdLCBmYWN0b3J5KTtcblx0ZWxzZSB7XG5cdFx0dmFyIGEgPSB0eXBlb2YgZXhwb3J0cyA9PT0gJ29iamVjdCcgPyBmYWN0b3J5KHJlcXVpcmUoXCJAc3luY2Z1c2lvbi9lajItYmFzZVwiKSwgcmVxdWlyZShcIkBzeW5jZnVzaW9uL2VqMi1kYXRhXCIpLCByZXF1aXJlKFwiQHN5bmNmdXNpb24vZWoyLWxpc3RzXCIpLCByZXF1aXJlKFwiQHN5bmNmdXNpb24vZWoyLXBvcHVwc1wiKSwgcmVxdWlyZShcIkBzeW5jZnVzaW9uL2VqMi1pbnB1dHNcIikpIDogZmFjdG9yeShyb290W1wiQHN5bmNmdXNpb24vZWoyLWJhc2VcIl0sIHJvb3RbXCJAc3luY2Z1c2lvbi9lajItZGF0YVwiXSwgcm9vdFtcIkBzeW5jZnVzaW9uL2VqMi1saXN0c1wiXSwgcm9vdFtcIkBzeW5jZnVzaW9uL2VqMi1wb3B1cHNcIl0sIHJvb3RbXCJAc3luY2Z1c2lvbi9lajItaW5wdXRzXCJdKTtcblx0XHRmb3IodmFyIGkgaW4gYSkgKHR5cGVvZiBleHBvcnRzID09PSAnb2JqZWN0JyA/IGV4cG9ydHMgOiByb290KVtpXSA9IGFbaV07XG5cdH1cbn0pKHRoaXMsIGZ1bmN0aW9uKF9fV0VCUEFDS19FWFRFUk5BTF9NT0RVTEVfNl9fLCBfX1dFQlBBQ0tfRVhURVJOQUxfTU9EVUxFXzdfXywgX19XRUJQQUNLX0VYVEVSTkFMX01PRFVMRV84X18sIF9fV0VCUEFDS19FWFRFUk5BTF9NT0RVTEVfMTFfXywgX19XRUJQQUNLX0VYVEVSTkFMX01PRFVMRV8xMl9fKSB7XG5yZXR1cm4gXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIHdlYnBhY2svdW5pdmVyc2FsTW9kdWxlRGVmaW5pdGlvbiIsIiBcdC8vIFRoZSBtb2R1bGUgY2FjaGVcbiBcdHZhciBpbnN0YWxsZWRNb2R1bGVzID0ge307XG5cbiBcdC8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uXG4gXHRmdW5jdGlvbiBfX3dlYnBhY2tfcmVxdWlyZV9fKG1vZHVsZUlkKSB7XG5cbiBcdFx0Ly8gQ2hlY2sgaWYgbW9kdWxlIGlzIGluIGNhY2hlXG4gXHRcdGlmKGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdKVxuIFx0XHRcdHJldHVybiBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXS5leHBvcnRzO1xuXG4gXHRcdC8vIENyZWF0ZSBhIG5ldyBtb2R1bGUgKGFuZCBwdXQgaXQgaW50byB0aGUgY2FjaGUpXG4gXHRcdHZhciBtb2R1bGUgPSBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSA9IHtcbiBcdFx0XHRleHBvcnRzOiB7fSxcbiBcdFx0XHRpZDogbW9kdWxlSWQsXG4gXHRcdFx0bG9hZGVkOiBmYWxzZVxuIFx0XHR9O1xuXG4gXHRcdC8vIEV4ZWN1dGUgdGhlIG1vZHVsZSBmdW5jdGlvblxuIFx0XHRtb2R1bGVzW21vZHVsZUlkXS5jYWxsKG1vZHVsZS5leHBvcnRzLCBtb2R1bGUsIG1vZHVsZS5leHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKTtcblxuIFx0XHQvLyBGbGFnIHRoZSBtb2R1bGUgYXMgbG9hZGVkXG4gXHRcdG1vZHVsZS5sb2FkZWQgPSB0cnVlO1xuXG4gXHRcdC8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlXG4gXHRcdHJldHVybiBtb2R1bGUuZXhwb3J0cztcbiBcdH1cblxuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZXMgb2JqZWN0IChfX3dlYnBhY2tfbW9kdWxlc19fKVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5tID0gbW9kdWxlcztcblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGUgY2FjaGVcbiBcdF9fd2VicGFja19yZXF1aXJlX18uYyA9IGluc3RhbGxlZE1vZHVsZXM7XG5cbiBcdC8vIF9fd2VicGFja19wdWJsaWNfcGF0aF9fXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnAgPSBcIlwiO1xuXG4gXHQvLyBMb2FkIGVudHJ5IG1vZHVsZSBhbmQgcmV0dXJuIGV4cG9ydHNcbiBcdHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKDApO1xuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIHdlYnBhY2svYm9vdHN0cmFwIGY2N2M4ZDMxNzI2ZmY4ZDg5ZmZlIiwiZGVmaW5lKFtcInJlcXVpcmVcIiwgXCJleHBvcnRzXCIsIFwiLi9jb21tb24vaW5kZXhcIiwgXCIuL2Ryb3AtZG93bi1iYXNlL2luZGV4XCIsIFwiLi9kcm9wLWRvd24tbGlzdC9pbmRleFwiLCBcIi4vY29tYm8tYm94L2luZGV4XCIsIFwiLi9hdXRvLWNvbXBsZXRlL2luZGV4XCIsIFwiLi9tdWx0aS1zZWxlY3QvaW5kZXhcIl0sIGZ1bmN0aW9uIChyZXF1aXJlLCBleHBvcnRzLCBpbmRleF8xLCBpbmRleF8yLCBpbmRleF8zLCBpbmRleF80LCBpbmRleF81LCBpbmRleF82KSB7XG4gICAgXCJ1c2Ugc3RyaWN0XCI7XG4gICAgZnVuY3Rpb24gX19leHBvcnQobSkge1xuICAgICAgICBmb3IgKHZhciBwIGluIG0pIGlmICghZXhwb3J0cy5oYXNPd25Qcm9wZXJ0eShwKSkgZXhwb3J0c1twXSA9IG1bcF07XG4gICAgfVxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbiAgICBfX2V4cG9ydChpbmRleF8xKTtcbiAgICBfX2V4cG9ydChpbmRleF8yKTtcbiAgICBfX2V4cG9ydChpbmRleF8zKTtcbiAgICBfX2V4cG9ydChpbmRleF80KTtcbiAgICBfX2V4cG9ydChpbmRleF81KTtcbiAgICBfX2V4cG9ydChpbmRleF82KTtcbn0pO1xuXG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi9zcmMvaW5kZXguanNcbi8vIG1vZHVsZSBpZCA9IDBcbi8vIG1vZHVsZSBjaHVua3MgPSAwIiwiZGVmaW5lKFtcInJlcXVpcmVcIiwgXCJleHBvcnRzXCIsIFwiLi9pbmNyZW1lbnRhbC1zZWFyY2hcIiwgXCIuL2hpZ2hsaWdodC1zZWFyY2hcIl0sIGZ1bmN0aW9uIChyZXF1aXJlLCBleHBvcnRzLCBpbmNyZW1lbnRhbF9zZWFyY2hfMSwgaGlnaGxpZ2h0X3NlYXJjaF8xKSB7XG4gICAgXCJ1c2Ugc3RyaWN0XCI7XG4gICAgZnVuY3Rpb24gX19leHBvcnQobSkge1xuICAgICAgICBmb3IgKHZhciBwIGluIG0pIGlmICghZXhwb3J0cy5oYXNPd25Qcm9wZXJ0eShwKSkgZXhwb3J0c1twXSA9IG1bcF07XG4gICAgfVxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbiAgICBfX2V4cG9ydChpbmNyZW1lbnRhbF9zZWFyY2hfMSk7XG4gICAgX19leHBvcnQoaGlnaGxpZ2h0X3NlYXJjaF8xKTtcbn0pO1xuXG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi9zcmMvY29tbW9uL2luZGV4LmpzXG4vLyBtb2R1bGUgaWQgPSAxXG4vLyBtb2R1bGUgY2h1bmtzID0gMCIsImRlZmluZShbXCJyZXF1aXJlXCIsIFwiZXhwb3J0c1wiXSwgZnVuY3Rpb24gKHJlcXVpcmUsIGV4cG9ydHMpIHtcbiAgICBcInVzZSBzdHJpY3RcIjtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG4gICAgdmFyIHF1ZXJ5U3RyaW5nID0gJyc7XG4gICAgdmFyIHByZXZTdHJpbmcgPSAnJztcbiAgICB2YXIgbWF0Y2hlcyA9IFtdO1xuICAgIHZhciBhY3RpdmVDbGFzcyA9ICdlLWFjdGl2ZSc7XG4gICAgZnVuY3Rpb24gaW5jcmVtZW50YWxTZWFyY2goa2V5Q29kZSwgaXRlbXMsIHNlbGVjdGVkSW5kZXgsIGlnbm9yZUNhc2UpIHtcbiAgICAgICAgcXVlcnlTdHJpbmcgKz0gU3RyaW5nLmZyb21DaGFyQ29kZShrZXlDb2RlKTtcbiAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7IHF1ZXJ5U3RyaW5nID0gJyc7IH0sIDEwMDApO1xuICAgICAgICB2YXIgaW5kZXg7XG4gICAgICAgIHF1ZXJ5U3RyaW5nID0gaWdub3JlQ2FzZSA/IHF1ZXJ5U3RyaW5nLnRvTG93ZXJDYXNlKCkgOiBxdWVyeVN0cmluZztcbiAgICAgICAgaWYgKHByZXZTdHJpbmcgPT09IHF1ZXJ5U3RyaW5nKSB7XG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IG1hdGNoZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICBpZiAobWF0Y2hlc1tpXS5jbGFzc0xpc3QuY29udGFpbnMoYWN0aXZlQ2xhc3MpKSB7XG4gICAgICAgICAgICAgICAgICAgIGluZGV4ID0gaTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaW5kZXggPSBpbmRleCArIDE7XG4gICAgICAgICAgICByZXR1cm4gbWF0Y2hlc1tpbmRleF07XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB2YXIgbGlzdEl0ZW1zID0gaXRlbXM7XG4gICAgICAgICAgICB2YXIgc3RyTGVuZ3RoID0gcXVlcnlTdHJpbmcubGVuZ3RoO1xuICAgICAgICAgICAgdmFyIHRleHQgPSB2b2lkIDA7XG4gICAgICAgICAgICB2YXIgaXRlbSA9IHZvaWQgMDtcbiAgICAgICAgICAgIHNlbGVjdGVkSW5kZXggPSBzZWxlY3RlZEluZGV4ID8gc2VsZWN0ZWRJbmRleCArIDEgOiAwO1xuICAgICAgICAgICAgdmFyIGkgPSBzZWxlY3RlZEluZGV4O1xuICAgICAgICAgICAgbWF0Y2hlcyA9IFtdO1xuICAgICAgICAgICAgZG8ge1xuICAgICAgICAgICAgICAgIGlmIChpID09PSBsaXN0SXRlbXMubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgICAgIGkgPSAtMTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaSA9PT0gLTEgPyBpbmRleCA9IDAgOiBpbmRleCA9IGk7XG4gICAgICAgICAgICAgICAgaXRlbSA9IGxpc3RJdGVtc1tpbmRleF07XG4gICAgICAgICAgICAgICAgdGV4dCA9IGlnbm9yZUNhc2UgPyBpdGVtLmlubmVyVGV4dC50b0xvd2VyQ2FzZSgpIDogaXRlbS5pbm5lclRleHQ7XG4gICAgICAgICAgICAgICAgaWYgKHRleHQuc3Vic3RyKDAsIHN0ckxlbmd0aCkgPT09IHF1ZXJ5U3RyaW5nKSB7XG4gICAgICAgICAgICAgICAgICAgIG1hdGNoZXMucHVzaChsaXN0SXRlbXNbaW5kZXhdKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaSsrO1xuICAgICAgICAgICAgfSB3aGlsZSAoaSAhPT0gc2VsZWN0ZWRJbmRleCk7XG4gICAgICAgICAgICBwcmV2U3RyaW5nID0gcXVlcnlTdHJpbmc7XG4gICAgICAgICAgICByZXR1cm4gbWF0Y2hlc1swXTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBleHBvcnRzLmluY3JlbWVudGFsU2VhcmNoID0gaW5jcmVtZW50YWxTZWFyY2g7XG4gICAgZnVuY3Rpb24gU2VhcmNoKGlucHV0VmFsLCBpdGVtcywgc2VhcmNoVHlwZSwgaWdub3JlQ2FzZSkge1xuICAgICAgICB2YXIgbGlzdEl0ZW1zID0gaXRlbXM7XG4gICAgICAgIGlnbm9yZUNhc2UgPSBpZ25vcmVDYXNlICE9PSB1bmRlZmluZWQgJiYgaWdub3JlQ2FzZSAhPT0gbnVsbCA/IGlnbm9yZUNhc2UgOiB0cnVlO1xuICAgICAgICB2YXIgaXRlbURhdGEgPSB7IGl0ZW06IG51bGwsIGluZGV4OiBudWxsIH07XG4gICAgICAgIGlmIChpbnB1dFZhbC5sZW5ndGgpIHtcbiAgICAgICAgICAgIHZhciBzdHJMZW5ndGggPSBpbnB1dFZhbC5sZW5ndGg7XG4gICAgICAgICAgICB2YXIgcXVlcnlTdHIgPSBpZ25vcmVDYXNlID8gaW5wdXRWYWwudG9Mb2NhbGVMb3dlckNhc2UoKSA6IGlucHV0VmFsO1xuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDAsIGl0ZW1zRGF0YSA9IGxpc3RJdGVtczsgaSA8IGl0ZW1zRGF0YS5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgIHZhciBpdGVtID0gaXRlbXNEYXRhW2ldO1xuICAgICAgICAgICAgICAgIHZhciB0ZXh0ID0gKGlnbm9yZUNhc2UgPyBpdGVtLnRleHRDb250ZW50LnRvTG9jYWxlTG93ZXJDYXNlKCkgOiBpdGVtLnRleHRDb250ZW50KS5yZXBsYWNlKC9eXFxzK3xcXHMrJC9nLCAnJyk7XG4gICAgICAgICAgICAgICAgaWYgKChzZWFyY2hUeXBlID09PSAnRXF1YWwnICYmIHRleHQgPT09IHF1ZXJ5U3RyKSB8fCAoc2VhcmNoVHlwZSA9PT0gJ1N0YXJ0c1dpdGgnICYmIHRleHQuc3Vic3RyKDAsIHN0ckxlbmd0aCkgPT09IHF1ZXJ5U3RyKSkge1xuICAgICAgICAgICAgICAgICAgICBpdGVtRGF0YS5pdGVtID0gaXRlbTtcbiAgICAgICAgICAgICAgICAgICAgaXRlbURhdGEuaW5kZXggPSBpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4geyBpdGVtOiBpdGVtLCBpbmRleDogaSB9O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBpdGVtRGF0YTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gaXRlbURhdGE7XG4gICAgfVxuICAgIGV4cG9ydHMuU2VhcmNoID0gU2VhcmNoO1xufSk7XG5cblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL3NyYy9jb21tb24vaW5jcmVtZW50YWwtc2VhcmNoLmpzXG4vLyBtb2R1bGUgaWQgPSAyXG4vLyBtb2R1bGUgY2h1bmtzID0gMCIsImRlZmluZShbXCJyZXF1aXJlXCIsIFwiZXhwb3J0c1wiXSwgZnVuY3Rpb24gKHJlcXVpcmUsIGV4cG9ydHMpIHtcbiAgICBcInVzZSBzdHJpY3RcIjtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG4gICAgZnVuY3Rpb24gaGlnaGxpZ2h0U2VhcmNoKGNvbnRlbnQsIHF1ZXJ5LCBpZ25vcmVDYXNlLCB0eXBlKSB7XG4gICAgICAgIHJldmVydChjb250ZW50KTtcbiAgICAgICAgaWYgKHF1ZXJ5ID09PSAnJykge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdmFyIGlnbm9yZVJlZ2V4ID0gaWdub3JlQ2FzZSA/ICdnaW0nIDogJ2dtJztcbiAgICAgICAgICAgIHF1ZXJ5ID0gL15bYS16QS1aMC05LSBdKiQvLnRlc3QocXVlcnkpID8gcXVlcnkgOiBxdWVyeS5yZXBsYWNlKC9bXFwtXFxbXFxdXFwvXFx7XFx9XFwoXFwpXFwqXFwrXFw/XFwuXFxcXFxcXlxcJFxcfF0vZywgJ1xcXFwkJicpO1xuICAgICAgICAgICAgdmFyIHJlcGxhY2VRdWVyeSA9IHR5cGUgPT09ICdTdGFydHNXaXRoJyA/ICdeKCcgKyBxdWVyeSArICcpJyA6IHR5cGUgPT09ICdFbmRzV2l0aCcgPyAnKCcgKyBxdWVyeSArICcpJCcgOiAnKCcgKyBxdWVyeSArICcpJztcbiAgICAgICAgICAgIHZhciBwYXR0ZXJuID0gbmV3IFJlZ0V4cChyZXBsYWNlUXVlcnksIGlnbm9yZVJlZ2V4KTtcbiAgICAgICAgICAgIHZhciBsaSA9IGNvbnRlbnQucXVlcnlTZWxlY3RvckFsbCgndWwgbGknKTtcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbGkubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICB2YXIgZWxlbWVudCA9IGxpW2ldO1xuICAgICAgICAgICAgICAgIGVsZW1lbnQuaW5uZXJIVE1MID0gZWxlbWVudC5pbm5lckhUTUwucmVwbGFjZShwYXR0ZXJuLCAnPHNwYW4gY2xhc3M9XCJlLWhpZ2hsaWdodFwiPiQxPC9zcGFuPicpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIGV4cG9ydHMuaGlnaGxpZ2h0U2VhcmNoID0gaGlnaGxpZ2h0U2VhcmNoO1xuICAgIGZ1bmN0aW9uIHJldmVydChjb250ZW50KSB7XG4gICAgICAgIHZhciBjb250ZW50RWxlbWVudCA9IGNvbnRlbnQucXVlcnlTZWxlY3RvckFsbCgnLmUtaGlnaGxpZ2h0Jyk7XG4gICAgICAgIGZvciAodmFyIGkgPSBjb250ZW50RWxlbWVudC5sZW5ndGggLSAxOyBpID49IDA7IGktLSkge1xuICAgICAgICAgICAgdmFyIHBhcmVudF8xID0gY29udGVudEVsZW1lbnRbaV0ucGFyZW50Tm9kZTtcbiAgICAgICAgICAgIHZhciB0ZXh0ID0gZG9jdW1lbnQuY3JlYXRlVGV4dE5vZGUoY29udGVudEVsZW1lbnRbaV0udGV4dENvbnRlbnQpO1xuICAgICAgICAgICAgcGFyZW50XzEucmVwbGFjZUNoaWxkKHRleHQsIGNvbnRlbnRFbGVtZW50W2ldKTtcbiAgICAgICAgfVxuICAgIH1cbn0pO1xuXG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi9zcmMvY29tbW9uL2hpZ2hsaWdodC1zZWFyY2guanNcbi8vIG1vZHVsZSBpZCA9IDNcbi8vIG1vZHVsZSBjaHVua3MgPSAwIiwiZGVmaW5lKFtcInJlcXVpcmVcIiwgXCJleHBvcnRzXCIsIFwiLi9kcm9wLWRvd24tYmFzZVwiXSwgZnVuY3Rpb24gKHJlcXVpcmUsIGV4cG9ydHMsIGRyb3BfZG93bl9iYXNlXzEpIHtcbiAgICBcInVzZSBzdHJpY3RcIjtcbiAgICBmdW5jdGlvbiBfX2V4cG9ydChtKSB7XG4gICAgICAgIGZvciAodmFyIHAgaW4gbSkgaWYgKCFleHBvcnRzLmhhc093blByb3BlcnR5KHApKSBleHBvcnRzW3BdID0gbVtwXTtcbiAgICB9XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xuICAgIF9fZXhwb3J0KGRyb3BfZG93bl9iYXNlXzEpO1xufSk7XG5cblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL3NyYy9kcm9wLWRvd24tYmFzZS9pbmRleC5qc1xuLy8gbW9kdWxlIGlkID0gNFxuLy8gbW9kdWxlIGNodW5rcyA9IDAiLCJ2YXIgX19leHRlbmRzID0gKHRoaXMgJiYgdGhpcy5fX2V4dGVuZHMpIHx8IChmdW5jdGlvbiAoKSB7XG4gICAgdmFyIGV4dGVuZFN0YXRpY3MgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgfHxcbiAgICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fFxuICAgICAgICBmdW5jdGlvbiAoZCwgYikgeyBmb3IgKHZhciBwIGluIGIpIGlmIChiLmhhc093blByb3BlcnR5KHApKSBkW3BdID0gYltwXTsgfTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGQsIGIpIHtcbiAgICAgICAgZXh0ZW5kU3RhdGljcyhkLCBiKTtcbiAgICAgICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9XG4gICAgICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTtcbiAgICB9O1xufSkoKTtcbnZhciBfX2RlY29yYXRlID0gKHRoaXMgJiYgdGhpcy5fX2RlY29yYXRlKSB8fCBmdW5jdGlvbiAoZGVjb3JhdG9ycywgdGFyZ2V0LCBrZXksIGRlc2MpIHtcbiAgICB2YXIgYyA9IGFyZ3VtZW50cy5sZW5ndGgsIHIgPSBjIDwgMyA/IHRhcmdldCA6IGRlc2MgPT09IG51bGwgPyBkZXNjID0gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcih0YXJnZXQsIGtleSkgOiBkZXNjLCBkO1xuICAgIGlmICh0eXBlb2YgUmVmbGVjdCA9PT0gXCJvYmplY3RcIiAmJiB0eXBlb2YgUmVmbGVjdC5kZWNvcmF0ZSA9PT0gXCJmdW5jdGlvblwiKSByID0gUmVmbGVjdC5kZWNvcmF0ZShkZWNvcmF0b3JzLCB0YXJnZXQsIGtleSwgZGVzYyk7XG4gICAgZWxzZSBmb3IgKHZhciBpID0gZGVjb3JhdG9ycy5sZW5ndGggLSAxOyBpID49IDA7IGktLSkgaWYgKGQgPSBkZWNvcmF0b3JzW2ldKSByID0gKGMgPCAzID8gZChyKSA6IGMgPiAzID8gZCh0YXJnZXQsIGtleSwgcikgOiBkKHRhcmdldCwga2V5KSkgfHwgcjtcbiAgICByZXR1cm4gYyA+IDMgJiYgciAmJiBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBrZXksIHIpLCByO1xufTtcbmRlZmluZShbXCJyZXF1aXJlXCIsIFwiZXhwb3J0c1wiLCBcIkBzeW5jZnVzaW9uL2VqMi1iYXNlXCIsIFwiQHN5bmNmdXNpb24vZWoyLWJhc2VcIiwgXCJAc3luY2Z1c2lvbi9lajItYmFzZVwiLCBcIkBzeW5jZnVzaW9uL2VqMi1kYXRhXCIsIFwiQHN5bmNmdXNpb24vZWoyLWxpc3RzXCJdLCBmdW5jdGlvbiAocmVxdWlyZSwgZXhwb3J0cywgZWoyX2Jhc2VfMSwgZWoyX2Jhc2VfMiwgZWoyX2Jhc2VfMywgZWoyX2RhdGFfMSwgZWoyX2xpc3RzXzEpIHtcbiAgICBcInVzZSBzdHJpY3RcIjtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG4gICAgZXhwb3J0cy5TUElOTkVSX1NJWkUgPSBlajJfYmFzZV8yLkJyb3dzZXIuaXNEZXZpY2UgPyAnMTZweCcgOiAnMTRweCc7XG4gICAgZXhwb3J0cy5kcm9wRG93bkJhc2VDbGFzc2VzID0ge1xuICAgICAgICByb290OiAnZS1kcm9wZG93bmJhc2UnLFxuICAgICAgICBydGw6ICdlLXJ0bCcsXG4gICAgICAgIGNvbnRlbnQ6ICdlLWNvbnRlbnQnLFxuICAgICAgICBzZWxlY3RlZDogJ2UtYWN0aXZlJyxcbiAgICAgICAgaG92ZXI6ICdlLWhvdmVyJyxcbiAgICAgICAgbm9EYXRhOiAnZS1ub2RhdGEnLFxuICAgICAgICBmaXhlZEhlYWQ6ICdlLWZpeGVkLWhlYWQnLFxuICAgICAgICBmb2N1czogJ2UtaXRlbS1mb2N1cycsXG4gICAgICAgIGxpOiBlajJfbGlzdHNfMS5jc3NDbGFzcy5saSxcbiAgICAgICAgZ3JvdXA6IGVqMl9saXN0c18xLmNzc0NsYXNzLmdyb3VwLFxuICAgICAgICBkaXNhYmxlZDogZWoyX2xpc3RzXzEuY3NzQ2xhc3MuZGlzYWJsZWQsXG4gICAgICAgIGdyb3VwaW5nOiAnZS1kZC1ncm91cCdcbiAgICB9O1xuICAgIHZhciBEcm9wRG93bkJhc2UgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgICAgICBfX2V4dGVuZHMoRHJvcERvd25CYXNlLCBfc3VwZXIpO1xuICAgICAgICBmdW5jdGlvbiBEcm9wRG93bkJhc2Uob3B0aW9ucywgZWxlbWVudCkge1xuICAgICAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcywgb3B0aW9ucywgZWxlbWVudCkgfHwgdGhpcztcbiAgICAgICAgICAgIF90aGlzLnNjcm9sbFRpbWVyID0gLTE7XG4gICAgICAgICAgICBfdGhpcy5lbmFibGVSdGxFbGVtZW50cyA9IFtdO1xuICAgICAgICAgICAgX3RoaXMuaXNSZXF1ZXN0ZWQgPSBmYWxzZTtcbiAgICAgICAgICAgIHJldHVybiBfdGhpcztcbiAgICAgICAgfVxuICAgICAgICA7XG4gICAgICAgIERyb3BEb3duQmFzZS5wcm90b3R5cGUuZ2V0UHJvcE9iamVjdCA9IGZ1bmN0aW9uIChwcm9wLCBuZXdQcm9wLCBvbGRQcm9wKSB7XG4gICAgICAgICAgICB2YXIgbmV3UHJvcGVydHkgPSBuZXcgT2JqZWN0KCk7XG4gICAgICAgICAgICB2YXIgb2xkUHJvcGVydHkgPSBuZXcgT2JqZWN0KCk7XG4gICAgICAgICAgICB2YXIgcHJvcE5hbWUgPSBuZXcgRnVuY3Rpb24oJ3Byb3AnLCAncmV0dXJuIHByb3AnKTtcbiAgICAgICAgICAgIG5ld1Byb3BlcnR5W3Byb3BOYW1lKHByb3ApXSA9IG5ld1Byb3BbcHJvcE5hbWUocHJvcCldO1xuICAgICAgICAgICAgb2xkUHJvcGVydHlbcHJvcE5hbWUocHJvcCldID0gb2xkUHJvcFtwcm9wTmFtZShwcm9wKV07XG4gICAgICAgICAgICB2YXIgZGF0YSA9IG5ldyBPYmplY3QoKTtcbiAgICAgICAgICAgIGRhdGEubmV3UHJvcGVydHkgPSBuZXdQcm9wZXJ0eTtcbiAgICAgICAgICAgIGRhdGEub2xkUHJvcGVydHkgPSBvbGRQcm9wZXJ0eTtcbiAgICAgICAgICAgIHJldHVybiBkYXRhO1xuICAgICAgICB9O1xuICAgICAgICBEcm9wRG93bkJhc2UucHJvdG90eXBlLmdldFZhbHVlQnlUZXh0ID0gZnVuY3Rpb24gKHRleHQsIGlnbm9yZUNhc2UpIHtcbiAgICAgICAgICAgIHZhciB2YWx1ZSA9IG51bGw7XG4gICAgICAgICAgICB2YXIgZGF0YVNvdXJjZSA9IHRoaXMubGlzdERhdGE7XG4gICAgICAgICAgICB2YXIgZmllbGRzID0gdGhpcy5maWVsZHM7XG4gICAgICAgICAgICB2YXIgdHlwZSA9IHRoaXMudHlwZU9mRGF0YShkYXRhU291cmNlKS50eXBlb2Y7XG4gICAgICAgICAgICBpZiAoaWdub3JlQ2FzZSkge1xuICAgICAgICAgICAgICAgIGlmICh0eXBlID09PSAnc3RyaW5nJyB8fCB0eXBlID09PSAnbnVtYmVyJykge1xuICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBfaSA9IDAsIGRhdGFTb3VyY2VfMSA9IGRhdGFTb3VyY2U7IF9pIDwgZGF0YVNvdXJjZV8xLmxlbmd0aDsgX2krKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGl0ZW0gPSBkYXRhU291cmNlXzFbX2ldO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFlajJfYmFzZV8yLmlzTnVsbE9yVW5kZWZpbmVkKGl0ZW0pICYmIFN0cmluZyhpdGVtKS50b0xvd2VyQ2FzZSgpID09PSB0ZXh0LnRvU3RyaW5nKCkudG9Mb3dlckNhc2UoKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlID0gdHlwZSA9PT0gJ3N0cmluZycgPyBTdHJpbmcoaXRlbSkgOiB0aGlzLmdldEZvcm1hdHRlZFZhbHVlKFN0cmluZyhpdGVtKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGRhdGFTb3VyY2UuZmlsdGVyKGZ1bmN0aW9uIChpdGVtKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgaXRlbVRleHQgPSBpdGVtW2ZpZWxkcy50ZXh0XS50b1N0cmluZygpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGl0ZW1UZXh0LnRvTG93ZXJDYXNlKCkgPT09IHRleHQudG9Mb3dlckNhc2UoKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlID0gaXRlbVtmaWVsZHMudmFsdWVdO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBpZiAodHlwZSA9PT0gJ3N0cmluZycgfHwgdHlwZSA9PT0gJ251bWJlcicpIHtcbiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgX2EgPSAwLCBkYXRhU291cmNlXzIgPSBkYXRhU291cmNlOyBfYSA8IGRhdGFTb3VyY2VfMi5sZW5ndGg7IF9hKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpdGVtID0gZGF0YVNvdXJjZV8yW19hXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghZWoyX2Jhc2VfMi5pc051bGxPclVuZGVmaW5lZChpdGVtKSAmJiBTdHJpbmcoaXRlbSkgPT09IHRleHQudG9TdHJpbmcoKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlID0gdHlwZSA9PT0gJ3N0cmluZycgPyB0ZXh0IDogdGhpcy5nZXRGb3JtYXR0ZWRWYWx1ZSh0ZXh0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgZGF0YVNvdXJjZS5maWx0ZXIoZnVuY3Rpb24gKGl0ZW0pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpdGVtW2ZpZWxkcy50ZXh0XSA9PT0gdGV4dCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlID0gaXRlbVtmaWVsZHMudmFsdWVdO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gdmFsdWU7XG4gICAgICAgIH07XG4gICAgICAgIDtcbiAgICAgICAgRHJvcERvd25CYXNlLnByb3RvdHlwZS5sMTBuVXBkYXRlID0gZnVuY3Rpb24gKGFjdGlvbkZhaWx1cmUpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLm5vUmVjb3Jkc1RlbXBsYXRlICE9PSAnTm8gUmVjb3JkcyBGb3VuZCcgfHwgdGhpcy5hY3Rpb25GYWlsdXJlVGVtcGxhdGUgIT09ICdUaGUgUmVxdWVzdCBGYWlsZWQnKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRlbXBsYXRlID0gYWN0aW9uRmFpbHVyZSA/IHRoaXMuYWN0aW9uRmFpbHVyZVRlbXBsYXRlIDogdGhpcy5ub1JlY29yZHNUZW1wbGF0ZTtcbiAgICAgICAgICAgICAgICB2YXIgY29tcGlsZWRTdHJpbmcgPSB2b2lkIDA7XG4gICAgICAgICAgICAgICAgdGhpcy5saXN0LmlubmVySFRNTCA9ICcnO1xuICAgICAgICAgICAgICAgIGNvbXBpbGVkU3RyaW5nID0gZWoyX2Jhc2VfMS5jb21waWxlKHRlbXBsYXRlKTtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBfaSA9IDAsIF9hID0gY29tcGlsZWRTdHJpbmcoe30pOyBfaSA8IF9hLmxlbmd0aDsgX2krKykge1xuICAgICAgICAgICAgICAgICAgICB2YXIgaXRlbSA9IF9hW19pXTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5saXN0LmFwcGVuZENoaWxkKGl0ZW0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHZhciBsMTBuTG9jYWxlID0geyBub1JlY29yZHNUZW1wbGF0ZTogJ05vIFJlY29yZHMgRm91bmQnLCBhY3Rpb25GYWlsdXJlVGVtcGxhdGU6ICdUaGUgUmVxdWVzdCBGYWlsZWQnIH07XG4gICAgICAgICAgICAgICAgdGhpcy5sMTBuID0gbmV3IGVqMl9iYXNlXzEuTDEwbignZHJvcGRvd25saXN0JywgbDEwbkxvY2FsZSwgdGhpcy5sb2NhbGUpO1xuICAgICAgICAgICAgICAgIHRoaXMubGlzdC5pbm5lckhUTUwgPSBhY3Rpb25GYWlsdXJlID9cbiAgICAgICAgICAgICAgICAgICAgdGhpcy5sMTBuLmdldENvbnN0YW50KCdhY3Rpb25GYWlsdXJlVGVtcGxhdGUnKSA6IHRoaXMubDEwbi5nZXRDb25zdGFudCgnbm9SZWNvcmRzVGVtcGxhdGUnKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgRHJvcERvd25CYXNlLnByb3RvdHlwZS5nZXRUZXh0QnlWYWx1ZSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgdmFyIHRleHQ7XG4gICAgICAgICAgICB2YXIgZGF0YVNvdXJjZSA9IHRoaXMubGlzdERhdGE7XG4gICAgICAgICAgICB2YXIgZmllbGRzID0gdGhpcy5maWVsZHM7XG4gICAgICAgICAgICB2YXIgdHlwZSA9IHRoaXMudHlwZU9mRGF0YShkYXRhU291cmNlKS50eXBlb2Y7XG4gICAgICAgICAgICBpZiAodHlwZSA9PT0gJ3N0cmluZycgfHwgdHlwZSA9PT0gJ251bWJlcicpIHtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBfaSA9IDAsIGRhdGFTb3VyY2VfMyA9IGRhdGFTb3VyY2U7IF9pIDwgZGF0YVNvdXJjZV8zLmxlbmd0aDsgX2krKykge1xuICAgICAgICAgICAgICAgICAgICB2YXIgaXRlbSA9IGRhdGFTb3VyY2VfM1tfaV07XG4gICAgICAgICAgICAgICAgICAgIGlmICghZWoyX2Jhc2VfMi5pc051bGxPclVuZGVmaW5lZChpdGVtKSAmJiBpdGVtLnRvU3RyaW5nKCkgPT09IHZhbHVlLnRvU3RyaW5nKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRleHQgPSBpdGVtLnRvU3RyaW5nKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGRhdGFTb3VyY2UuZmlsdGVyKGZ1bmN0aW9uIChpdGVtKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICghZWoyX2Jhc2VfMi5pc051bGxPclVuZGVmaW5lZChpdGVtW2ZpZWxkcy52YWx1ZV0pICYmIGl0ZW1bZmllbGRzLnZhbHVlXS50b1N0cmluZygpID09PSB2YWx1ZS50b1N0cmluZygpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0ZXh0ID0gaXRlbVtmaWVsZHMudGV4dF07XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB0ZXh0O1xuICAgICAgICB9O1xuICAgICAgICBEcm9wRG93bkJhc2UucHJvdG90eXBlLmdldEZvcm1hdHRlZFZhbHVlID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5saXN0RGF0YSAmJiB0aGlzLmxpc3REYXRhLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgIHZhciBpdGVtID0gdGhpcy50eXBlT2ZEYXRhKHRoaXMubGlzdERhdGEpO1xuICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgaXRlbS5pdGVtW3RoaXMuZmllbGRzLnZhbHVlID8gdGhpcy5maWVsZHMudmFsdWUgOiAndmFsdWUnXSA9PT0gJ251bWJlcidcbiAgICAgICAgICAgICAgICAgICAgfHwgaXRlbS50eXBlb2YgPT09ICdudW1iZXInKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBwYXJzZUludCh2YWx1ZSwgMTApO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB2YWx1ZTtcbiAgICAgICAgfTtcbiAgICAgICAgRHJvcERvd25CYXNlLnByb3RvdHlwZS5zZXRFbmFibGVSdGwgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5saXN0KSB7XG4gICAgICAgICAgICAgICAgdGhpcy5lbmFibGVSdGxFbGVtZW50cy5wdXNoKHRoaXMubGlzdCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLmVuYWJsZVJ0bCA/IGVqMl9iYXNlXzEuYWRkQ2xhc3ModGhpcy5lbmFibGVSdGxFbGVtZW50cywgZXhwb3J0cy5kcm9wRG93bkJhc2VDbGFzc2VzLnJ0bCkgOlxuICAgICAgICAgICAgICAgIGVqMl9iYXNlXzIucmVtb3ZlQ2xhc3ModGhpcy5lbmFibGVSdGxFbGVtZW50cywgZXhwb3J0cy5kcm9wRG93bkJhc2VDbGFzc2VzLnJ0bCk7XG4gICAgICAgIH07XG4gICAgICAgIDtcbiAgICAgICAgRHJvcERvd25CYXNlLnByb3RvdHlwZS5pbml0aWFsaXplID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdGhpcy5iaW5kRXZlbnQgPSB0cnVlO1xuICAgICAgICAgICAgaWYgKHRoaXMuZWxlbWVudC50YWdOYW1lID09PSAnVUwnKSB7XG4gICAgICAgICAgICAgICAgdmFyIGpzb25FbGVtZW50ID0gZWoyX2xpc3RzXzEuTGlzdEJhc2UuY3JlYXRlSnNvbkZyb21FbGVtZW50KHRoaXMuZWxlbWVudCk7XG4gICAgICAgICAgICAgICAgdGhpcy5zZXRQcm9wZXJ0aWVzKHsgZmllbGRzOiB7IHRleHQ6ICd0ZXh0JywgdmFsdWU6ICd0ZXh0JyB9IH0sIHRydWUpO1xuICAgICAgICAgICAgICAgIHRoaXMucmVzZXRMaXN0KGpzb25FbGVtZW50LCB0aGlzLmZpZWxkcyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmICh0aGlzLmVsZW1lbnQudGFnTmFtZSA9PT0gJ1NFTEVDVCcpIHtcbiAgICAgICAgICAgICAgICB2YXIgZGF0YVNvdXJjZSA9IHRoaXMuZGF0YVNvdXJjZSBpbnN0YW5jZW9mIEFycmF5ID8gKHRoaXMuZGF0YVNvdXJjZS5sZW5ndGggPiAwID8gdHJ1ZSA6IGZhbHNlKVxuICAgICAgICAgICAgICAgICAgICA6ICFlajJfYmFzZV8yLmlzTnVsbE9yVW5kZWZpbmVkKHRoaXMuZGF0YVNvdXJjZSkgPyB0cnVlIDogZmFsc2U7XG4gICAgICAgICAgICAgICAgaWYgKCFkYXRhU291cmNlKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucmVuZGVySXRlbXNCeVNlbGVjdCgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHRoaXMuc2V0TGlzdERhdGEodGhpcy5kYXRhU291cmNlLCB0aGlzLmZpZWxkcywgdGhpcy5xdWVyeSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIDtcbiAgICAgICAgRHJvcERvd25CYXNlLnByb3RvdHlwZS5nZXRQZXJzaXN0RGF0YSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmFkZE9uUGVyc2lzdChbXSk7XG4gICAgICAgIH07XG4gICAgICAgIDtcbiAgICAgICAgRHJvcERvd25CYXNlLnByb3RvdHlwZS5zZXRFbmFibGVkID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgaWYgKHRoaXMuZW5hYmxlZCkge1xuICAgICAgICAgICAgICAgIHRoaXMuZWxlbWVudC5zZXRBdHRyaWJ1dGUoJ2FyaWEtZGlzYWJsZWQnLCAnZmFsc2UnKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHRoaXMuZWxlbWVudC5zZXRBdHRyaWJ1dGUoJ2FyaWEtZGlzYWJsZWQnLCAndHJ1ZScpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICA7XG4gICAgICAgIERyb3BEb3duQmFzZS5wcm90b3R5cGUucmVuZGVySXRlbXNCeVNlbGVjdCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciBlbGVtZW50ID0gdGhpcy5lbGVtZW50O1xuICAgICAgICAgICAgdmFyIGZpZWxkcyA9IHsgdmFsdWU6ICd2YWx1ZScsIHRleHQ6ICd0ZXh0JyB9O1xuICAgICAgICAgICAgdmFyIGpzb25FbGVtZW50ID0gW107XG4gICAgICAgICAgICB2YXIgZ3JvdXAgPSBlbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJ3NlbGVjdD5vcHRncm91cCcpO1xuICAgICAgICAgICAgdmFyIG9wdGlvbiA9IGVsZW1lbnQucXVlcnlTZWxlY3RvckFsbCgnc2VsZWN0Pm9wdGlvbicpO1xuICAgICAgICAgICAgdGhpcy5nZXRKU09OZnJvbU9wdGlvbihqc29uRWxlbWVudCwgb3B0aW9uLCBmaWVsZHMpO1xuICAgICAgICAgICAgaWYgKGdyb3VwLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgZ3JvdXAubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGl0ZW0gPSBncm91cFtpXTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIG9wdGlvbkdyb3VwID0ge307XG4gICAgICAgICAgICAgICAgICAgIG9wdGlvbkdyb3VwW2ZpZWxkcy50ZXh0XSA9IGl0ZW0ubGFiZWw7XG4gICAgICAgICAgICAgICAgICAgIG9wdGlvbkdyb3VwLmlzSGVhZGVyID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGNoaWxkID0gaXRlbS5xdWVyeVNlbGVjdG9yQWxsKCdvcHRpb24nKTtcbiAgICAgICAgICAgICAgICAgICAganNvbkVsZW1lbnQucHVzaChvcHRpb25Hcm91cCk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZ2V0SlNPTmZyb21PcHRpb24oanNvbkVsZW1lbnQsIGNoaWxkLCBmaWVsZHMpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB2YXIgaXRlbXMgPSBlbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJ3NlbGVjdD5vcHRpb24nKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuZmllbGRzLnRleHQgPSBmaWVsZHMudGV4dDtcbiAgICAgICAgICAgIHRoaXMuZmllbGRzLnZhbHVlID0gZmllbGRzLnZhbHVlO1xuICAgICAgICAgICAgdGhpcy5yZXNldExpc3QoanNvbkVsZW1lbnQsIGZpZWxkcyk7XG4gICAgICAgIH07XG4gICAgICAgIERyb3BEb3duQmFzZS5wcm90b3R5cGUuZ2V0SlNPTmZyb21PcHRpb24gPSBmdW5jdGlvbiAoaXRlbXMsIG9wdGlvbnMsIGZpZWxkcykge1xuICAgICAgICAgICAgZm9yICh2YXIgX2kgPSAwLCBvcHRpb25zXzEgPSBvcHRpb25zOyBfaSA8IG9wdGlvbnNfMS5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgICAgICAgICB2YXIgb3B0aW9uID0gb3B0aW9uc18xW19pXTtcbiAgICAgICAgICAgICAgICB2YXIganNvbiA9IHt9O1xuICAgICAgICAgICAgICAgIGpzb25bZmllbGRzLnRleHRdID0gb3B0aW9uLmlubmVyVGV4dDtcbiAgICAgICAgICAgICAgICBqc29uW2ZpZWxkcy52YWx1ZV0gPSBvcHRpb24uZ2V0QXR0cmlidXRlKGZpZWxkcy52YWx1ZSkgPyBvcHRpb24uZ2V0QXR0cmlidXRlKGZpZWxkcy52YWx1ZSkgOiBvcHRpb24uaW5uZXJUZXh0O1xuICAgICAgICAgICAgICAgIGl0ZW1zLnB1c2goanNvbik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIERyb3BEb3duQmFzZS5wcm90b3R5cGUucHJlUmVuZGVyID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB9O1xuICAgICAgICBEcm9wRG93bkJhc2UucHJvdG90eXBlLnNldExpc3REYXRhID0gZnVuY3Rpb24gKGRhdGFTb3VyY2UsIGZpZWxkcywgcXVlcnkpIHtcbiAgICAgICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgICAgICBmaWVsZHMgPSBmaWVsZHMgPyBmaWVsZHMgOiB0aGlzLmZpZWxkcztcbiAgICAgICAgICAgIHZhciB1bEVsZW1lbnQ7XG4gICAgICAgICAgICB0aGlzLmlzQWN0aXZlID0gdHJ1ZTtcbiAgICAgICAgICAgIHRoaXMuc2hvd1NwaW5uZXIoKTtcbiAgICAgICAgICAgIGlmIChkYXRhU291cmNlIGluc3RhbmNlb2YgZWoyX2RhdGFfMS5EYXRhTWFuYWdlcikge1xuICAgICAgICAgICAgICAgIHRoaXMuaXNSZXF1ZXN0ZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgIHRoaXMudHJpZ2dlcignYWN0aW9uQmVnaW4nKTtcbiAgICAgICAgICAgICAgICBkYXRhU291cmNlLmV4ZWN1dGVRdWVyeSh0aGlzLmdldFF1ZXJ5KHF1ZXJ5KSkudGhlbihmdW5jdGlvbiAoZSkge1xuICAgICAgICAgICAgICAgICAgICBfdGhpcy50cmlnZ2VyKCdhY3Rpb25Db21wbGV0ZScsIGUpO1xuICAgICAgICAgICAgICAgICAgICB2YXIgbGlzdEl0ZW1zID0gZS5yZXN1bHQ7XG4gICAgICAgICAgICAgICAgICAgIHVsRWxlbWVudCA9IF90aGlzLnJlbmRlckl0ZW1zKGxpc3RJdGVtcywgZmllbGRzKTtcbiAgICAgICAgICAgICAgICAgICAgX3RoaXMub25BY3Rpb25Db21wbGV0ZSh1bEVsZW1lbnQsIGxpc3RJdGVtcywgZSk7XG4gICAgICAgICAgICAgICAgICAgIF90aGlzLmlzUmVxdWVzdGVkID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIF90aGlzLmhpZGVTcGlubmVyKCk7XG4gICAgICAgICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgICAgICAgICAgX3RoaXMuaXNSZXF1ZXN0ZWQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgX3RoaXMub25BY3Rpb25GYWlsdXJlKGUpO1xuICAgICAgICAgICAgICAgICAgICBfdGhpcy5oaWRlU3Bpbm5lcigpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgdmFyIGRhdGFNYW5hZ2VyID0gbmV3IGVqMl9kYXRhXzEuRGF0YU1hbmFnZXIoZGF0YVNvdXJjZSk7XG4gICAgICAgICAgICAgICAgdmFyIGxpc3RJdGVtcyA9ICh0aGlzLmdldFF1ZXJ5KHF1ZXJ5KSkuZXhlY3V0ZUxvY2FsKGRhdGFNYW5hZ2VyKTtcbiAgICAgICAgICAgICAgICB1bEVsZW1lbnQgPSB0aGlzLnJlbmRlckl0ZW1zKGxpc3RJdGVtcywgZmllbGRzKTtcbiAgICAgICAgICAgICAgICB0aGlzLm9uQWN0aW9uQ29tcGxldGUodWxFbGVtZW50LCBsaXN0SXRlbXMpO1xuICAgICAgICAgICAgICAgIHRoaXMuaGlkZVNwaW5uZXIoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgRHJvcERvd25CYXNlLnByb3RvdHlwZS5zaG93U3Bpbm5lciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgfTtcbiAgICAgICAgRHJvcERvd25CYXNlLnByb3RvdHlwZS5oaWRlU3Bpbm5lciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgfTtcbiAgICAgICAgRHJvcERvd25CYXNlLnByb3RvdHlwZS5vbkFjdGlvbkZhaWx1cmUgPSBmdW5jdGlvbiAoZSkge1xuICAgICAgICAgICAgdGhpcy5saUNvbGxlY3Rpb25zID0gW107XG4gICAgICAgICAgICB0aGlzLnRyaWdnZXIoJ2FjdGlvbkZhaWx1cmUnLCBlKTtcbiAgICAgICAgICAgIHRoaXMubDEwblVwZGF0ZSh0cnVlKTtcbiAgICAgICAgICAgIGVqMl9iYXNlXzEuYWRkQ2xhc3MoW3RoaXMubGlzdF0sIGV4cG9ydHMuZHJvcERvd25CYXNlQ2xhc3Nlcy5ub0RhdGEpO1xuICAgICAgICB9O1xuICAgICAgICBEcm9wRG93bkJhc2UucHJvdG90eXBlLm9uQWN0aW9uQ29tcGxldGUgPSBmdW5jdGlvbiAodWxFbGVtZW50LCBsaXN0LCBlKSB7XG4gICAgICAgICAgICB0aGlzLmxpc3REYXRhID0gbGlzdDtcbiAgICAgICAgICAgIHRoaXMubGlzdC5pbm5lckhUTUwgPSAnJztcbiAgICAgICAgICAgIHRoaXMubGlzdC5hcHBlbmRDaGlsZCh1bEVsZW1lbnQpO1xuICAgICAgICAgICAgdGhpcy5saUNvbGxlY3Rpb25zID0gdGhpcy5saXN0LnF1ZXJ5U2VsZWN0b3JBbGwoJy4nICsgZXhwb3J0cy5kcm9wRG93bkJhc2VDbGFzc2VzLmxpKTtcbiAgICAgICAgICAgIHRoaXMudWxFbGVtZW50ID0gdGhpcy5saXN0LnF1ZXJ5U2VsZWN0b3IoJ3VsJyk7XG4gICAgICAgICAgICB0aGlzLnBvc3RSZW5kZXIodGhpcy5saXN0LCBsaXN0LCB0aGlzLmJpbmRFdmVudCk7XG4gICAgICAgIH07XG4gICAgICAgIERyb3BEb3duQmFzZS5wcm90b3R5cGUucG9zdFJlbmRlciA9IGZ1bmN0aW9uIChsaXN0RWxlbWVudCwgbGlzdCwgYmluZEV2ZW50KSB7XG4gICAgICAgICAgICB2YXIgZm9jdXNJdGVtID0gbGlzdEVsZW1lbnQucXVlcnlTZWxlY3RvcignLicgKyBleHBvcnRzLmRyb3BEb3duQmFzZUNsYXNzZXMubGkpO1xuICAgICAgICAgICAgdmFyIHNlbGVjdGVkSXRlbSA9IGxpc3RFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy4nICsgZXhwb3J0cy5kcm9wRG93bkJhc2VDbGFzc2VzLnNlbGVjdGVkKTtcbiAgICAgICAgICAgIGlmIChmb2N1c0l0ZW0gJiYgIXNlbGVjdGVkSXRlbSkge1xuICAgICAgICAgICAgICAgIGVqMl9iYXNlXzEuYWRkQ2xhc3MoW2ZvY3VzSXRlbV0sIGV4cG9ydHMuZHJvcERvd25CYXNlQ2xhc3Nlcy5mb2N1cyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAobGlzdC5sZW5ndGggPD0gMCkge1xuICAgICAgICAgICAgICAgIHRoaXMubDEwblVwZGF0ZSgpO1xuICAgICAgICAgICAgICAgIGVqMl9iYXNlXzEuYWRkQ2xhc3MoW2xpc3RFbGVtZW50XSwgZXhwb3J0cy5kcm9wRG93bkJhc2VDbGFzc2VzLm5vRGF0YSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBsaXN0RWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKGV4cG9ydHMuZHJvcERvd25CYXNlQ2xhc3Nlcy5ub0RhdGEpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHRoaXMuZ3JvdXBUZW1wbGF0ZSkge1xuICAgICAgICAgICAgICAgIHRoaXMucmVuZGVyR3JvdXBUZW1wbGF0ZShsaXN0RWxlbWVudCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIERyb3BEb3duQmFzZS5wcm90b3R5cGUuZ2V0UXVlcnkgPSBmdW5jdGlvbiAocXVlcnkpIHtcbiAgICAgICAgICAgIHJldHVybiBxdWVyeSA/IHF1ZXJ5IDogdGhpcy5xdWVyeSA/IHRoaXMucXVlcnkgOiBuZXcgZWoyX2RhdGFfMS5RdWVyeSgpO1xuICAgICAgICB9O1xuICAgICAgICBEcm9wRG93bkJhc2UucHJvdG90eXBlLnJlbmRlckdyb3VwVGVtcGxhdGUgPSBmdW5jdGlvbiAobGlzdEVsZSkge1xuICAgICAgICAgICAgaWYgKHRoaXMuZmllbGRzLmdyb3VwQnkgIT09IG51bGwgJiYgdGhpcy5kYXRhU291cmNlIHx8IHRoaXMuZWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuJyArIGV4cG9ydHMuZHJvcERvd25CYXNlQ2xhc3Nlcy5ncm91cCkpIHtcbiAgICAgICAgICAgICAgICB2YXIgZGF0YVNvdXJjZSA9IHRoaXMuZGF0YVNvdXJjZTtcbiAgICAgICAgICAgICAgICB2YXIgaGVhZGVySXRlbXMgPSBsaXN0RWxlLnF1ZXJ5U2VsZWN0b3JBbGwoJy4nICsgZXhwb3J0cy5kcm9wRG93bkJhc2VDbGFzc2VzLmdyb3VwKTtcbiAgICAgICAgICAgICAgICB2YXIgdGVtcEhlYWRlcnMgPSBlajJfbGlzdHNfMS5MaXN0QmFzZS5yZW5kZXJHcm91cFRlbXBsYXRlKHRoaXMuZ3JvdXBUZW1wbGF0ZSwgZGF0YVNvdXJjZSwgdGhpcy5maWVsZHMsIGhlYWRlckl0ZW1zKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgRHJvcERvd25CYXNlLnByb3RvdHlwZS5jcmVhdGVMaXN0SXRlbXMgPSBmdW5jdGlvbiAoZGF0YVNvdXJjZSwgZmllbGRzKSB7XG4gICAgICAgICAgICBpZiAoZGF0YVNvdXJjZSAmJiBmaWVsZHMuZ3JvdXBCeSB8fCB0aGlzLmVsZW1lbnQucXVlcnlTZWxlY3Rvcignb3B0Z3JvdXAnKSkge1xuICAgICAgICAgICAgICAgIGlmIChmaWVsZHMuZ3JvdXBCeSkge1xuICAgICAgICAgICAgICAgICAgICBkYXRhU291cmNlID0gZWoyX2xpc3RzXzEuTGlzdEJhc2UuZ3JvdXBEYXRhU291cmNlKGRhdGFTb3VyY2UsIGZpZWxkcyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVqMl9iYXNlXzEuYWRkQ2xhc3MoW3RoaXMubGlzdF0sIGV4cG9ydHMuZHJvcERvd25CYXNlQ2xhc3Nlcy5ncm91cGluZyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBkYXRhU291cmNlID0gdGhpcy5nZXRTb3J0ZWREYXRhU291cmNlKGRhdGFTb3VyY2UpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIGljb25Dc3MgPSBlajJfYmFzZV8yLmlzTnVsbE9yVW5kZWZpbmVkKGZpZWxkcy5pY29uQ3NzKSA/IGZhbHNlIDogdHJ1ZTtcbiAgICAgICAgICAgIHZhciBvcHRpb25zID0gKGZpZWxkcy50ZXh0ICE9PSBudWxsIHx8IGZpZWxkcy52YWx1ZSAhPT0gbnVsbCkgPyB7XG4gICAgICAgICAgICAgICAgZmllbGRzOiBmaWVsZHMsIHNob3dJY29uOiBpY29uQ3NzLCBhcmlhQXR0cmlidXRlczogeyBncm91cEl0ZW1Sb2xlOiAncHJlc2VudGF0aW9uJyB9XG4gICAgICAgICAgICB9IDogeyBmaWVsZHM6IHsgdmFsdWU6ICd0ZXh0JyB9IH07XG4gICAgICAgICAgICByZXR1cm4gZWoyX2xpc3RzXzEuTGlzdEJhc2UuY3JlYXRlTGlzdChkYXRhU291cmNlLCBvcHRpb25zLCB0cnVlKTtcbiAgICAgICAgfTtcbiAgICAgICAgO1xuICAgICAgICBEcm9wRG93bkJhc2UucHJvdG90eXBlLnNldEZsb2F0aW5nSGVhZGVyID0gZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgIGlmIChlajJfYmFzZV8yLmlzTnVsbE9yVW5kZWZpbmVkKHRoaXMuZml4ZWRIZWFkZXJFbGVtZW50KSkge1xuICAgICAgICAgICAgICAgIHRoaXMuZml4ZWRIZWFkZXJFbGVtZW50ID0gZWoyX2Jhc2VfMi5jcmVhdGVFbGVtZW50KCdkaXYnLCB7IGNsYXNzTmFtZTogZXhwb3J0cy5kcm9wRG93bkJhc2VDbGFzc2VzLmZpeGVkSGVhZCB9KTtcbiAgICAgICAgICAgICAgICBpZiAoIXRoaXMubGlzdC5xdWVyeVNlbGVjdG9yKCdsaScpLmNsYXNzTGlzdC5jb250YWlucyhleHBvcnRzLmRyb3BEb3duQmFzZUNsYXNzZXMuZ3JvdXApKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZml4ZWRIZWFkZXJFbGVtZW50LnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVqMl9iYXNlXzIucHJlcGVuZChbdGhpcy5maXhlZEhlYWRlckVsZW1lbnRdLCB0aGlzLmxpc3QpO1xuICAgICAgICAgICAgICAgIHRoaXMuc2V0Rml4ZWRIZWFkZXIoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuc2Nyb2xsU3RvcChlKTtcbiAgICAgICAgfTtcbiAgICAgICAgRHJvcERvd25CYXNlLnByb3RvdHlwZS5zY3JvbGxTdG9wID0gZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgIHZhciB0YXJnZXQgPSBlLnRhcmdldDtcbiAgICAgICAgICAgIHZhciBsaUhlaWdodCA9IHBhcnNlSW50KGdldENvbXB1dGVkU3R5bGUodGhpcy5saUNvbGxlY3Rpb25zWzBdLCBudWxsKS5nZXRQcm9wZXJ0eVZhbHVlKCdoZWlnaHQnKSwgMTApO1xuICAgICAgICAgICAgdmFyIHRvcEluZGV4ID0gTWF0aC5yb3VuZCh0YXJnZXQuc2Nyb2xsVG9wIC8gbGlIZWlnaHQpO1xuICAgICAgICAgICAgdmFyIGxpQ29sbGVjdGlvbnMgPSB0aGlzLnVsRWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKCdsaScpO1xuICAgICAgICAgICAgZm9yICh2YXIgaSA9IHRvcEluZGV4OyBpID4gLTE7IGktLSkge1xuICAgICAgICAgICAgICAgIGlmICghZWoyX2Jhc2VfMi5pc051bGxPclVuZGVmaW5lZChsaUNvbGxlY3Rpb25zW2ldKSAmJiBsaUNvbGxlY3Rpb25zW2ldLmNsYXNzTGlzdC5jb250YWlucyhleHBvcnRzLmRyb3BEb3duQmFzZUNsYXNzZXMuZ3JvdXApKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBjdXJyZW50TGkgPSBsaUNvbGxlY3Rpb25zW2ldO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmZpeGVkSGVhZGVyRWxlbWVudC5pbm5lckhUTUwgPSBjdXJyZW50TGkuaW5uZXJIVE1MO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmZpeGVkSGVhZGVyRWxlbWVudC5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJztcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmZpeGVkSGVhZGVyRWxlbWVudC5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgRHJvcERvd25CYXNlLnByb3RvdHlwZS5yZW5kZXJJdGVtcyA9IGZ1bmN0aW9uIChsaXN0RGF0YSwgZmllbGRzKSB7XG4gICAgICAgICAgICB2YXIgdWxFbGVtZW50O1xuICAgICAgICAgICAgaWYgKHRoaXMuaXRlbVRlbXBsYXRlICYmIGxpc3REYXRhKSB7XG4gICAgICAgICAgICAgICAgdmFyIGRhdGFTb3VyY2UgPSBsaXN0RGF0YTtcbiAgICAgICAgICAgICAgICBpZiAoZGF0YVNvdXJjZSAmJiBmaWVsZHMuZ3JvdXBCeSkge1xuICAgICAgICAgICAgICAgICAgICBkYXRhU291cmNlID0gZWoyX2xpc3RzXzEuTGlzdEJhc2UuZ3JvdXBEYXRhU291cmNlKGRhdGFTb3VyY2UsIGZpZWxkcywgdGhpcy5zb3J0T3JkZXIpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgZGF0YVNvdXJjZSA9IHRoaXMuZ2V0U29ydGVkRGF0YVNvdXJjZShkYXRhU291cmNlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdWxFbGVtZW50ID0gZWoyX2xpc3RzXzEuTGlzdEJhc2UucmVuZGVyQ29udGVudFRlbXBsYXRlKHRoaXMuaXRlbVRlbXBsYXRlLCBkYXRhU291cmNlLCBmaWVsZHMpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgdWxFbGVtZW50ID0gdGhpcy5jcmVhdGVMaXN0SXRlbXMobGlzdERhdGEsIGZpZWxkcyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gdWxFbGVtZW50O1xuICAgICAgICB9O1xuICAgICAgICA7XG4gICAgICAgIERyb3BEb3duQmFzZS5wcm90b3R5cGUudHlwZU9mRGF0YSA9IGZ1bmN0aW9uIChpdGVtcykge1xuICAgICAgICAgICAgdmFyIGl0ZW0gPSB7IHR5cGVvZjogbnVsbCwgaXRlbTogbnVsbCB9O1xuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBpdGVtcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgIGlmICghZWoyX2Jhc2VfMi5pc051bGxPclVuZGVmaW5lZChpdGVtc1tpXSkpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGl0ZW0gPSB7IHR5cGVvZjogdHlwZW9mIGl0ZW1zW2ldLCBpdGVtOiBpdGVtc1tpXSB9O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBpdGVtO1xuICAgICAgICB9O1xuICAgICAgICBEcm9wRG93bkJhc2UucHJvdG90eXBlLnNldEZpeGVkSGVhZGVyID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdGhpcy5saXN0LnBhcmVudEVsZW1lbnQuc3R5bGUuZGlzcGxheSA9ICdibG9jayc7XG4gICAgICAgICAgICB2YXIgbGlXaWR0aCA9IHRoaXMubGlDb2xsZWN0aW9uc1swXS5vZmZzZXRXaWR0aDtcbiAgICAgICAgICAgIHRoaXMuZml4ZWRIZWFkZXJFbGVtZW50LnN0eWxlLndpZHRoID0gbGlXaWR0aC50b1N0cmluZygpICsgJ3B4JztcbiAgICAgICAgICAgIGVqMl9iYXNlXzIuc2V0U3R5bGVBdHRyaWJ1dGUodGhpcy5maXhlZEhlYWRlckVsZW1lbnQsIHsgekluZGV4OiAxMCB9KTtcbiAgICAgICAgICAgIHZhciBmaXJzdExpID0gdGhpcy51bEVsZW1lbnQucXVlcnlTZWxlY3RvcignLicgKyBleHBvcnRzLmRyb3BEb3duQmFzZUNsYXNzZXMuZ3JvdXApO1xuICAgICAgICAgICAgdGhpcy5maXhlZEhlYWRlckVsZW1lbnQuaW5uZXJIVE1MID0gZmlyc3RMaS5pbm5lckhUTUw7XG4gICAgICAgIH07XG4gICAgICAgIERyb3BEb3duQmFzZS5wcm90b3R5cGUuZ2V0U29ydGVkRGF0YVNvdXJjZSA9IGZ1bmN0aW9uIChkYXRhU291cmNlKSB7XG4gICAgICAgICAgICBpZiAoZGF0YVNvdXJjZSAmJiB0aGlzLnNvcnRPcmRlciAhPT0gJ05vbmUnKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRleHRGaWVsZCA9IHRoaXMuZmllbGRzLnRleHQgPyB0aGlzLmZpZWxkcy50ZXh0IDogJ3RleHQnO1xuICAgICAgICAgICAgICAgIGRhdGFTb3VyY2UgPSBlajJfbGlzdHNfMS5MaXN0QmFzZS5nZXREYXRhU291cmNlKGRhdGFTb3VyY2UsIGVqMl9saXN0c18xLkxpc3RCYXNlLmFkZFNvcnRpbmcodGhpcy5zb3J0T3JkZXIsIHRleHRGaWVsZCkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIGRhdGFTb3VyY2U7XG4gICAgICAgIH07XG4gICAgICAgIERyb3BEb3duQmFzZS5wcm90b3R5cGUuZ2V0SW5kZXhCeVZhbHVlID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICB2YXIgaW5kZXg7XG4gICAgICAgICAgICB2YXIgbGlzdEl0ZW1zID0gdGhpcy5nZXRJdGVtcygpO1xuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsaXN0SXRlbXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICBpZiAobGlzdEl0ZW1zW2ldLmdldEF0dHJpYnV0ZSgnZGF0YS12YWx1ZScpID09PSB2YWx1ZS50b1N0cmluZygpKSB7XG4gICAgICAgICAgICAgICAgICAgIGluZGV4ID0gaTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIGluZGV4O1xuICAgICAgICB9O1xuICAgICAgICA7XG4gICAgICAgIERyb3BEb3duQmFzZS5wcm90b3R5cGUuZGlzcGF0Y2hFdmVudCA9IGZ1bmN0aW9uIChlbGVtZW50LCB0eXBlKSB7XG4gICAgICAgICAgICB2YXIgZXZ0ID0gZG9jdW1lbnQuY3JlYXRlRXZlbnQoJ0hUTUxFdmVudHMnKTtcbiAgICAgICAgICAgIGV2dC5pbml0RXZlbnQodHlwZSwgZmFsc2UsIHRydWUpO1xuICAgICAgICAgICAgZWxlbWVudC5kaXNwYXRjaEV2ZW50KGV2dCk7XG4gICAgICAgIH07XG4gICAgICAgIERyb3BEb3duQmFzZS5wcm90b3R5cGUuc2V0RmllbGRzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIGZpZWxkcyA9IHRoaXMuZmllbGRzO1xuICAgICAgICAgICAgaWYgKHRoaXMuZmllbGRzLnZhbHVlICYmICF0aGlzLmZpZWxkcy50ZXh0KSB7XG4gICAgICAgICAgICAgICAgdGhpcy5maWVsZHMudGV4dCA9IHRoaXMuZmllbGRzLnZhbHVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAoIWZpZWxkcy52YWx1ZSAmJiBmaWVsZHMudGV4dCkge1xuICAgICAgICAgICAgICAgIHRoaXMuZmllbGRzLnZhbHVlID0gdGhpcy5maWVsZHMudGV4dDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKCF0aGlzLmZpZWxkcy52YWx1ZSAmJiAhdGhpcy5maWVsZHMudGV4dCkge1xuICAgICAgICAgICAgICAgIHRoaXMuZmllbGRzLnZhbHVlID0gdGhpcy5maWVsZHMudGV4dCA9ICd0ZXh0JztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgRHJvcERvd25CYXNlLnByb3RvdHlwZS5yZXNldExpc3QgPSBmdW5jdGlvbiAoZGF0YVNvdXJjZSwgZmllbGRzLCBxdWVyeSkge1xuICAgICAgICAgICAgaWYgKHRoaXMubGlzdCkge1xuICAgICAgICAgICAgICAgIHRoaXMuc2V0TGlzdERhdGEoZGF0YVNvdXJjZSwgZmllbGRzLCBxdWVyeSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIERyb3BEb3duQmFzZS5wcm90b3R5cGUudXBkYXRlU2VsZWN0aW9uID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB9O1xuICAgICAgICBEcm9wRG93bkJhc2UucHJvdG90eXBlLnJlbmRlckxpc3QgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB0aGlzLnJlbmRlcigpO1xuICAgICAgICB9O1xuICAgICAgICBEcm9wRG93bkJhc2UucHJvdG90eXBlLm9uUHJvcGVydHlDaGFuZ2VkID0gZnVuY3Rpb24gKG5ld1Byb3AsIG9sZFByb3ApIHtcbiAgICAgICAgICAgIGZvciAodmFyIF9pID0gMCwgX2EgPSBPYmplY3Qua2V5cyhuZXdQcm9wKTsgX2kgPCBfYS5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgICAgICAgICB2YXIgcHJvcCA9IF9hW19pXTtcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKHByb3ApIHtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAnZW5hYmxlUnRsJzpcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2V0RW5hYmxlUnRsKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAnZW5hYmxlZCc6XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnNldEVuYWJsZWQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICBjYXNlICdxdWVyeSc6XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgJ3NvcnRPcmRlcic6XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgJ2RhdGFTb3VyY2UnOlxuICAgICAgICAgICAgICAgICAgICBjYXNlICdpdGVtVGVtcGxhdGUnOlxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5yZXNldExpc3QodGhpcy5kYXRhU291cmNlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICBjYXNlICdncm91cFRlbXBsYXRlJzpcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucmVuZGVyR3JvdXBUZW1wbGF0ZSh0aGlzLmxpc3QpO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgJ2xvY2FsZSc6XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5saXN0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5sMTBuVXBkYXRlKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIDtcbiAgICAgICAgRHJvcERvd25CYXNlLnByb3RvdHlwZS5yZW5kZXIgPSBmdW5jdGlvbiAoaXNFbXB0eURhdGEpIHtcbiAgICAgICAgICAgIHRoaXMubGlzdCA9IGVqMl9iYXNlXzIuY3JlYXRlRWxlbWVudCgnZGl2JywgeyBjbGFzc05hbWU6IGV4cG9ydHMuZHJvcERvd25CYXNlQ2xhc3Nlcy5jb250ZW50LCBhdHRyczogeyAndGFiaW5kZXgnOiAnMCcgfSB9KTtcbiAgICAgICAgICAgIHRoaXMubGlzdC5jbGFzc0xpc3QuYWRkKGV4cG9ydHMuZHJvcERvd25CYXNlQ2xhc3Nlcy5yb290KTtcbiAgICAgICAgICAgIHRoaXMuc2V0RmllbGRzKCk7XG4gICAgICAgICAgICB2YXIgcmlwcGxlTW9kZWwgPSB7IGR1cmF0aW9uOiAzMDAsIHNlbGVjdG9yOiAnLicgKyBleHBvcnRzLmRyb3BEb3duQmFzZUNsYXNzZXMubGkgfTtcbiAgICAgICAgICAgIHRoaXMucmlwcGxlRnVuID0gZWoyX2Jhc2VfMy5yaXBwbGVFZmZlY3QodGhpcy5saXN0LCByaXBwbGVNb2RlbCk7XG4gICAgICAgICAgICB2YXIgZ3JvdXAgPSB0aGlzLmVsZW1lbnQucXVlcnlTZWxlY3Rvcignc2VsZWN0Pm9wdGdyb3VwJyk7XG4gICAgICAgICAgICBpZiAodGhpcy5maWVsZHMuZ3JvdXBCeSB8fCAhZWoyX2Jhc2VfMi5pc051bGxPclVuZGVmaW5lZChncm91cCkpIHtcbiAgICAgICAgICAgICAgICBlajJfYmFzZV8xLkV2ZW50SGFuZGxlci5hZGQodGhpcy5saXN0LCAnc2Nyb2xsJywgdGhpcy5zZXRGbG9hdGluZ0hlYWRlciwgdGhpcyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAodGhpcy5nZXRNb2R1bGVOYW1lKCkgPT09ICdkcm9wZG93bmJhc2UnKSB7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuZWxlbWVudC5nZXRBdHRyaWJ1dGUoJ3RhYmluZGV4JykpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5saXN0LnNldEF0dHJpYnV0ZSgndGFiaW5kZXgnLCB0aGlzLmVsZW1lbnQuZ2V0QXR0cmlidXRlKCd0YWJpbmRleCcpKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWoyX2Jhc2VfMi5yZW1vdmVDbGFzcyhbdGhpcy5lbGVtZW50XSwgZXhwb3J0cy5kcm9wRG93bkJhc2VDbGFzc2VzLnJvb3QpO1xuICAgICAgICAgICAgICAgIHRoaXMuZWxlbWVudC5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xuICAgICAgICAgICAgICAgIHZhciB3cmFwcGVyRWxlbWVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgICAgICAgICAgICAgIHRoaXMuZWxlbWVudC5wYXJlbnRFbGVtZW50Lmluc2VydEJlZm9yZSh3cmFwcGVyRWxlbWVudCwgdGhpcy5lbGVtZW50KTtcbiAgICAgICAgICAgICAgICB3cmFwcGVyRWxlbWVudC5hcHBlbmRDaGlsZCh0aGlzLmVsZW1lbnQpO1xuICAgICAgICAgICAgICAgIHdyYXBwZXJFbGVtZW50LmFwcGVuZENoaWxkKHRoaXMubGlzdCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLnNldEVuYWJsZVJ0bCgpO1xuICAgICAgICAgICAgdGhpcy5zZXRFbmFibGVkKCk7XG4gICAgICAgICAgICBpZiAoIWlzRW1wdHlEYXRhKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5pbml0aWFsaXplKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIDtcbiAgICAgICAgRHJvcERvd25CYXNlLnByb3RvdHlwZS5nZXRNb2R1bGVOYW1lID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuICdkcm9wZG93bmJhc2UnO1xuICAgICAgICB9O1xuICAgICAgICA7XG4gICAgICAgIERyb3BEb3duQmFzZS5wcm90b3R5cGUuZ2V0SXRlbXMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy51bEVsZW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLicgKyBleHBvcnRzLmRyb3BEb3duQmFzZUNsYXNzZXMubGkpO1xuICAgICAgICB9O1xuICAgICAgICA7XG4gICAgICAgIERyb3BEb3duQmFzZS5wcm90b3R5cGUuYWRkSXRlbSA9IGZ1bmN0aW9uIChpdGVtcywgaXRlbUluZGV4KSB7XG4gICAgICAgICAgICBpZiAoIXRoaXMubGlzdCB8fCB0aGlzLmxpc3QudGV4dENvbnRlbnQgPT09IHRoaXMubm9SZWNvcmRzVGVtcGxhdGUpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnJlbmRlckxpc3QoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBpdGVtc0NvdW50ID0gdGhpcy5nZXRJdGVtcygpLmxlbmd0aDtcbiAgICAgICAgICAgIHZhciBzZWxlY3RlZEl0ZW1WYWx1ZSA9IHRoaXMubGlzdC5xdWVyeVNlbGVjdG9yKCcuJyArIGV4cG9ydHMuZHJvcERvd25CYXNlQ2xhc3Nlcy5zZWxlY3RlZCk7XG4gICAgICAgICAgICBpdGVtcyA9IGl0ZW1zIGluc3RhbmNlb2YgQXJyYXkgPyBpdGVtcyA6IFtpdGVtc107XG4gICAgICAgICAgICB2YXIgaW5kZXg7XG4gICAgICAgICAgICBpbmRleCA9IChlajJfYmFzZV8yLmlzTnVsbE9yVW5kZWZpbmVkKGl0ZW1JbmRleCkgfHwgaXRlbUluZGV4IDwgMCB8fCBpdGVtSW5kZXggPiBpdGVtc0NvdW50IC0gMSkgPyBpdGVtc0NvdW50IDogaXRlbUluZGV4O1xuICAgICAgICAgICAgdmFyIGZpZWxkcyA9IHRoaXMuZmllbGRzO1xuICAgICAgICAgICAgdmFyIGxpQ29sbGVjdGlvbnMgPSBbXTtcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgaXRlbXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICB2YXIgaXRlbSA9IGl0ZW1zW2ldO1xuICAgICAgICAgICAgICAgIHZhciBsaSA9IGVqMl9iYXNlXzIuY3JlYXRlRWxlbWVudCgnbGknLCB7IGNsYXNzTmFtZTogZXhwb3J0cy5kcm9wRG93bkJhc2VDbGFzc2VzLmxpLCBpZDogJ29wdGlvbi1hZGQtJyArIGkgfSk7XG4gICAgICAgICAgICAgICAgbGkuc2V0QXR0cmlidXRlKCdkYXRhLXZhbHVlJywgaXRlbVtmaWVsZHMudmFsdWVdKTtcbiAgICAgICAgICAgICAgICBsaS5zZXRBdHRyaWJ1dGUoJ3JvbGUnLCAnb3B0aW9uJyk7XG4gICAgICAgICAgICAgICAgbGkuYXBwZW5kQ2hpbGQoZG9jdW1lbnQuY3JlYXRlVGV4dE5vZGUoaXRlbVtmaWVsZHMudGV4dF0pKTtcbiAgICAgICAgICAgICAgICBsaUNvbGxlY3Rpb25zLnB1c2gobGkpO1xuICAgICAgICAgICAgICAgIHRoaXMubGlzdERhdGEucHVzaChpdGVtKTtcbiAgICAgICAgICAgICAgICB0aGlzLnVwZGF0ZUFjdGlvbkNvbXBsZXRlRGF0YShsaSwgaXRlbSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoaXRlbXNDb3VudCA9PT0gMCAmJiBlajJfYmFzZV8yLmlzTnVsbE9yVW5kZWZpbmVkKHRoaXMubGlzdC5xdWVyeVNlbGVjdG9yKCd1bCcpKSkge1xuICAgICAgICAgICAgICAgIHRoaXMubGlzdC5pbm5lckhUTUwgPSAnJztcbiAgICAgICAgICAgICAgICB0aGlzLmxpc3QuYXBwZW5kQ2hpbGQodGhpcy51bEVsZW1lbnQpO1xuICAgICAgICAgICAgICAgIGVqMl9iYXNlXzEuYXBwZW5kKGxpQ29sbGVjdGlvbnMsIHRoaXMudWxFbGVtZW50KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgaXRlbXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMubGlDb2xsZWN0aW9uc1tpbmRleF0pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubGlDb2xsZWN0aW9uc1tpbmRleF0ucGFyZW50Tm9kZS5pbnNlcnRCZWZvcmUobGlDb2xsZWN0aW9uc1tpXSwgdGhpcy5saUNvbGxlY3Rpb25zW2luZGV4XSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnVsRWxlbWVudC5hcHBlbmRDaGlsZChsaUNvbGxlY3Rpb25zW2ldKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB2YXIgdGVtcExpID0gW10uc2xpY2UuY2FsbCh0aGlzLmxpQ29sbGVjdGlvbnMpO1xuICAgICAgICAgICAgICAgICAgICB0ZW1wTGkuc3BsaWNlKGluZGV4LCAwLCBsaUNvbGxlY3Rpb25zW2ldKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5saUNvbGxlY3Rpb25zID0gdGVtcExpO1xuICAgICAgICAgICAgICAgICAgICBpbmRleCArPSAxO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChzZWxlY3RlZEl0ZW1WYWx1ZSB8fCBpdGVtSW5kZXggPT09IDApIHtcbiAgICAgICAgICAgICAgICB0aGlzLnVwZGF0ZVNlbGVjdGlvbigpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICBEcm9wRG93bkJhc2UucHJvdG90eXBlLnVwZGF0ZUFjdGlvbkNvbXBsZXRlRGF0YSA9IGZ1bmN0aW9uIChsaSwgaXRlbSkge1xuICAgICAgICB9O1xuICAgICAgICBEcm9wRG93bkJhc2UucHJvdG90eXBlLmdldERhdGFCeVZhbHVlID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICB2YXIgdHlwZSA9IHRoaXMudHlwZU9mRGF0YSh0aGlzLmxpc3REYXRhKS50eXBlb2Y7XG4gICAgICAgICAgICBpZiAodHlwZSA9PT0gJ3N0cmluZycgfHwgdHlwZSA9PT0gJ251bWJlcicpIHtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBfaSA9IDAsIF9hID0gdGhpcy5saXN0RGF0YTsgX2kgPCBfYS5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGl0ZW0gPSBfYVtfaV07XG4gICAgICAgICAgICAgICAgICAgIGlmICghZWoyX2Jhc2VfMi5pc051bGxPclVuZGVmaW5lZChpdGVtKSAmJiBpdGVtID09PSB2YWx1ZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGl0ZW07XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBfYiA9IDAsIF9jID0gdGhpcy5saXN0RGF0YTsgX2IgPCBfYy5sZW5ndGg7IF9iKyspIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGl0ZW0gPSBfY1tfYl07XG4gICAgICAgICAgICAgICAgICAgIGlmICghZWoyX2Jhc2VfMi5pc051bGxPclVuZGVmaW5lZChpdGVtKSAmJiBpdGVtW3RoaXMuZmllbGRzLnZhbHVlID8gdGhpcy5maWVsZHMudmFsdWUgOiAndmFsdWUnXSA9PT0gdmFsdWUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBpdGVtO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH07XG4gICAgICAgIERyb3BEb3duQmFzZS5wcm90b3R5cGUuZGVzdHJveSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGlmIChkb2N1bWVudC5ib2R5LmNvbnRhaW5zKHRoaXMubGlzdCkpIHtcbiAgICAgICAgICAgICAgICBlajJfYmFzZV8xLkV2ZW50SGFuZGxlci5yZW1vdmUodGhpcy5saXN0LCAnc2Nyb2xsJywgdGhpcy5zZXRGbG9hdGluZ0hlYWRlcik7XG4gICAgICAgICAgICAgICAgaWYgKCFlajJfYmFzZV8yLmlzTnVsbE9yVW5kZWZpbmVkKHRoaXMucmlwcGxlRnVuKSkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnJpcHBsZUZ1bigpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlajJfYmFzZV8yLmRldGFjaCh0aGlzLmxpc3QpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5kZXN0cm95LmNhbGwodGhpcyk7XG4gICAgICAgIH07XG4gICAgICAgIDtcbiAgICAgICAgcmV0dXJuIERyb3BEb3duQmFzZTtcbiAgICB9KGVqMl9iYXNlXzEuQ29tcG9uZW50KSk7XG4gICAgX19kZWNvcmF0ZShbXG4gICAgICAgIGVqMl9iYXNlXzEuUHJvcGVydHkoeyB0ZXh0OiBudWxsLCB2YWx1ZTogbnVsbCwgaWNvbkNzczogbnVsbCwgZ3JvdXBCeTogbnVsbCB9KVxuICAgIF0sIERyb3BEb3duQmFzZS5wcm90b3R5cGUsIFwiZmllbGRzXCIsIHZvaWQgMCk7XG4gICAgX19kZWNvcmF0ZShbXG4gICAgICAgIGVqMl9iYXNlXzEuUHJvcGVydHkoZmFsc2UpXG4gICAgXSwgRHJvcERvd25CYXNlLnByb3RvdHlwZSwgXCJlbmFibGVSdGxcIiwgdm9pZCAwKTtcbiAgICBfX2RlY29yYXRlKFtcbiAgICAgICAgZWoyX2Jhc2VfMS5Qcm9wZXJ0eShmYWxzZSlcbiAgICBdLCBEcm9wRG93bkJhc2UucHJvdG90eXBlLCBcImVuYWJsZVBlcnNpc3RlbmNlXCIsIHZvaWQgMCk7XG4gICAgX19kZWNvcmF0ZShbXG4gICAgICAgIGVqMl9iYXNlXzEuUHJvcGVydHkobnVsbClcbiAgICBdLCBEcm9wRG93bkJhc2UucHJvdG90eXBlLCBcIml0ZW1UZW1wbGF0ZVwiLCB2b2lkIDApO1xuICAgIF9fZGVjb3JhdGUoW1xuICAgICAgICBlajJfYmFzZV8xLlByb3BlcnR5KG51bGwpXG4gICAgXSwgRHJvcERvd25CYXNlLnByb3RvdHlwZSwgXCJncm91cFRlbXBsYXRlXCIsIHZvaWQgMCk7XG4gICAgX19kZWNvcmF0ZShbXG4gICAgICAgIGVqMl9iYXNlXzEuUHJvcGVydHkoJ05vIFJlY29yZHMgRm91bmQnKVxuICAgIF0sIERyb3BEb3duQmFzZS5wcm90b3R5cGUsIFwibm9SZWNvcmRzVGVtcGxhdGVcIiwgdm9pZCAwKTtcbiAgICBfX2RlY29yYXRlKFtcbiAgICAgICAgZWoyX2Jhc2VfMS5Qcm9wZXJ0eSgnVGhlIFJlcXVlc3QgRmFpbGVkJylcbiAgICBdLCBEcm9wRG93bkJhc2UucHJvdG90eXBlLCBcImFjdGlvbkZhaWx1cmVUZW1wbGF0ZVwiLCB2b2lkIDApO1xuICAgIF9fZGVjb3JhdGUoW1xuICAgICAgICBlajJfYmFzZV8xLlByb3BlcnR5KCdOb25lJylcbiAgICBdLCBEcm9wRG93bkJhc2UucHJvdG90eXBlLCBcInNvcnRPcmRlclwiLCB2b2lkIDApO1xuICAgIF9fZGVjb3JhdGUoW1xuICAgICAgICBlajJfYmFzZV8xLlByb3BlcnR5KHRydWUpXG4gICAgXSwgRHJvcERvd25CYXNlLnByb3RvdHlwZSwgXCJlbmFibGVkXCIsIHZvaWQgMCk7XG4gICAgX19kZWNvcmF0ZShbXG4gICAgICAgIGVqMl9iYXNlXzEuUHJvcGVydHkoW10pXG4gICAgXSwgRHJvcERvd25CYXNlLnByb3RvdHlwZSwgXCJkYXRhU291cmNlXCIsIHZvaWQgMCk7XG4gICAgX19kZWNvcmF0ZShbXG4gICAgICAgIGVqMl9iYXNlXzEuUHJvcGVydHkobnVsbClcbiAgICBdLCBEcm9wRG93bkJhc2UucHJvdG90eXBlLCBcInF1ZXJ5XCIsIHZvaWQgMCk7XG4gICAgX19kZWNvcmF0ZShbXG4gICAgICAgIGVqMl9iYXNlXzEuRXZlbnQoKVxuICAgIF0sIERyb3BEb3duQmFzZS5wcm90b3R5cGUsIFwiYWN0aW9uQmVnaW5cIiwgdm9pZCAwKTtcbiAgICBfX2RlY29yYXRlKFtcbiAgICAgICAgZWoyX2Jhc2VfMS5FdmVudCgpXG4gICAgXSwgRHJvcERvd25CYXNlLnByb3RvdHlwZSwgXCJhY3Rpb25Db21wbGV0ZVwiLCB2b2lkIDApO1xuICAgIF9fZGVjb3JhdGUoW1xuICAgICAgICBlajJfYmFzZV8xLkV2ZW50KClcbiAgICBdLCBEcm9wRG93bkJhc2UucHJvdG90eXBlLCBcImFjdGlvbkZhaWx1cmVcIiwgdm9pZCAwKTtcbiAgICBfX2RlY29yYXRlKFtcbiAgICAgICAgZWoyX2Jhc2VfMS5FdmVudCgpXG4gICAgXSwgRHJvcERvd25CYXNlLnByb3RvdHlwZSwgXCJzZWxlY3RcIiwgdm9pZCAwKTtcbiAgICBEcm9wRG93bkJhc2UgPSBfX2RlY29yYXRlKFtcbiAgICAgICAgZWoyX2Jhc2VfMy5Ob3RpZnlQcm9wZXJ0eUNoYW5nZXNcbiAgICBdLCBEcm9wRG93bkJhc2UpO1xuICAgIGV4cG9ydHMuRHJvcERvd25CYXNlID0gRHJvcERvd25CYXNlO1xufSk7XG5cblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL3NyYy9kcm9wLWRvd24tYmFzZS9kcm9wLWRvd24tYmFzZS5qc1xuLy8gbW9kdWxlIGlkID0gNVxuLy8gbW9kdWxlIGNodW5rcyA9IDAiLCJtb2R1bGUuZXhwb3J0cyA9IF9fV0VCUEFDS19FWFRFUk5BTF9NT0RVTEVfNl9fO1xuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIGV4dGVybmFsIFwiQHN5bmNmdXNpb24vZWoyLWJhc2VcIlxuLy8gbW9kdWxlIGlkID0gNlxuLy8gbW9kdWxlIGNodW5rcyA9IDAiLCJtb2R1bGUuZXhwb3J0cyA9IF9fV0VCUEFDS19FWFRFUk5BTF9NT0RVTEVfN19fO1xuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIGV4dGVybmFsIFwiQHN5bmNmdXNpb24vZWoyLWRhdGFcIlxuLy8gbW9kdWxlIGlkID0gN1xuLy8gbW9kdWxlIGNodW5rcyA9IDAiLCJtb2R1bGUuZXhwb3J0cyA9IF9fV0VCUEFDS19FWFRFUk5BTF9NT0RVTEVfOF9fO1xuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIGV4dGVybmFsIFwiQHN5bmNmdXNpb24vZWoyLWxpc3RzXCJcbi8vIG1vZHVsZSBpZCA9IDhcbi8vIG1vZHVsZSBjaHVua3MgPSAwIiwiZGVmaW5lKFtcInJlcXVpcmVcIiwgXCJleHBvcnRzXCIsIFwiLi9kcm9wLWRvd24tbGlzdFwiXSwgZnVuY3Rpb24gKHJlcXVpcmUsIGV4cG9ydHMsIGRyb3BfZG93bl9saXN0XzEpIHtcbiAgICBcInVzZSBzdHJpY3RcIjtcbiAgICBmdW5jdGlvbiBfX2V4cG9ydChtKSB7XG4gICAgICAgIGZvciAodmFyIHAgaW4gbSkgaWYgKCFleHBvcnRzLmhhc093blByb3BlcnR5KHApKSBleHBvcnRzW3BdID0gbVtwXTtcbiAgICB9XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xuICAgIF9fZXhwb3J0KGRyb3BfZG93bl9saXN0XzEpO1xufSk7XG5cblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL3NyYy9kcm9wLWRvd24tbGlzdC9pbmRleC5qc1xuLy8gbW9kdWxlIGlkID0gOVxuLy8gbW9kdWxlIGNodW5rcyA9IDAiLCJ2YXIgX19leHRlbmRzID0gKHRoaXMgJiYgdGhpcy5fX2V4dGVuZHMpIHx8IChmdW5jdGlvbiAoKSB7XG4gICAgdmFyIGV4dGVuZFN0YXRpY3MgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgfHxcbiAgICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fFxuICAgICAgICBmdW5jdGlvbiAoZCwgYikgeyBmb3IgKHZhciBwIGluIGIpIGlmIChiLmhhc093blByb3BlcnR5KHApKSBkW3BdID0gYltwXTsgfTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGQsIGIpIHtcbiAgICAgICAgZXh0ZW5kU3RhdGljcyhkLCBiKTtcbiAgICAgICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9XG4gICAgICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTtcbiAgICB9O1xufSkoKTtcbnZhciBfX2RlY29yYXRlID0gKHRoaXMgJiYgdGhpcy5fX2RlY29yYXRlKSB8fCBmdW5jdGlvbiAoZGVjb3JhdG9ycywgdGFyZ2V0LCBrZXksIGRlc2MpIHtcbiAgICB2YXIgYyA9IGFyZ3VtZW50cy5sZW5ndGgsIHIgPSBjIDwgMyA/IHRhcmdldCA6IGRlc2MgPT09IG51bGwgPyBkZXNjID0gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcih0YXJnZXQsIGtleSkgOiBkZXNjLCBkO1xuICAgIGlmICh0eXBlb2YgUmVmbGVjdCA9PT0gXCJvYmplY3RcIiAmJiB0eXBlb2YgUmVmbGVjdC5kZWNvcmF0ZSA9PT0gXCJmdW5jdGlvblwiKSByID0gUmVmbGVjdC5kZWNvcmF0ZShkZWNvcmF0b3JzLCB0YXJnZXQsIGtleSwgZGVzYyk7XG4gICAgZWxzZSBmb3IgKHZhciBpID0gZGVjb3JhdG9ycy5sZW5ndGggLSAxOyBpID49IDA7IGktLSkgaWYgKGQgPSBkZWNvcmF0b3JzW2ldKSByID0gKGMgPCAzID8gZChyKSA6IGMgPiAzID8gZCh0YXJnZXQsIGtleSwgcikgOiBkKHRhcmdldCwga2V5KSkgfHwgcjtcbiAgICByZXR1cm4gYyA+IDMgJiYgciAmJiBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBrZXksIHIpLCByO1xufTtcbmRlZmluZShbXCJyZXF1aXJlXCIsIFwiZXhwb3J0c1wiLCBcIkBzeW5jZnVzaW9uL2VqMi1iYXNlXCIsIFwiQHN5bmNmdXNpb24vZWoyLWJhc2VcIiwgXCJAc3luY2Z1c2lvbi9lajItYmFzZVwiLCBcIkBzeW5jZnVzaW9uL2VqMi1iYXNlXCIsIFwiQHN5bmNmdXNpb24vZWoyLXBvcHVwc1wiLCBcIkBzeW5jZnVzaW9uL2VqMi1pbnB1dHNcIiwgXCIuLi9jb21tb24vaW5jcmVtZW50YWwtc2VhcmNoXCIsIFwiLi4vZHJvcC1kb3duLWJhc2UvZHJvcC1kb3duLWJhc2VcIiwgXCJAc3luY2Z1c2lvbi9lajItZGF0YVwiXSwgZnVuY3Rpb24gKHJlcXVpcmUsIGV4cG9ydHMsIGVqMl9iYXNlXzEsIGVqMl9iYXNlXzIsIGVqMl9iYXNlXzMsIGVqMl9iYXNlXzQsIGVqMl9wb3B1cHNfMSwgZWoyX2lucHV0c18xLCBpbmNyZW1lbnRhbF9zZWFyY2hfMSwgZHJvcF9kb3duX2Jhc2VfMSwgZWoyX2RhdGFfMSkge1xuICAgIFwidXNlIHN0cmljdFwiO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbiAgICBleHBvcnRzLmRyb3BEb3duTGlzdENsYXNzZXMgPSB7XG4gICAgICAgIHJvb3Q6ICdlLWRyb3Bkb3dubGlzdCcsXG4gICAgICAgIGhvdmVyOiBkcm9wX2Rvd25fYmFzZV8xLmRyb3BEb3duQmFzZUNsYXNzZXMuaG92ZXIsXG4gICAgICAgIHNlbGVjdGVkOiBkcm9wX2Rvd25fYmFzZV8xLmRyb3BEb3duQmFzZUNsYXNzZXMuc2VsZWN0ZWQsXG4gICAgICAgIHJ0bDogZHJvcF9kb3duX2Jhc2VfMS5kcm9wRG93bkJhc2VDbGFzc2VzLnJ0bCxcbiAgICAgICAgbGk6IGRyb3BfZG93bl9iYXNlXzEuZHJvcERvd25CYXNlQ2xhc3Nlcy5saSxcbiAgICAgICAgZGlzYWJsZTogZHJvcF9kb3duX2Jhc2VfMS5kcm9wRG93bkJhc2VDbGFzc2VzLmRpc2FibGVkLFxuICAgICAgICBiYXNlOiBkcm9wX2Rvd25fYmFzZV8xLmRyb3BEb3duQmFzZUNsYXNzZXMucm9vdCxcbiAgICAgICAgZm9jdXM6IGRyb3BfZG93bl9iYXNlXzEuZHJvcERvd25CYXNlQ2xhc3Nlcy5mb2N1cyxcbiAgICAgICAgaW5wdXQ6ICdlLWlucHV0LWdyb3VwJyxcbiAgICAgICAgaW5wdXRGb2N1czogJ2UtaW5wdXQtZm9jdXMnLFxuICAgICAgICBpY29uOiAnZS1pbnB1dC1ncm91cC1pY29uIGUtZGRsLWljb24nLFxuICAgICAgICBpY29uQW5pbWF0aW9uOiAnZS1pY29uLWFuaW0nLFxuICAgICAgICB2YWx1ZTogJ2UtaW5wdXQtdmFsdWUnLFxuICAgICAgICBkZXZpY2U6ICdlLWRkbC1kZXZpY2UnLFxuICAgICAgICBiYWNrSWNvbjogJ2UtaW5wdXQtZ3JvdXAtaWNvbiBlLWJhY2staWNvbiBlLWljb25zJyxcbiAgICAgICAgZmlsdGVyQmFyQ2xlYXJJY29uOiAnZS1pbnB1dC1ncm91cC1pY29uIGUtY2xlYXItaWNvbiBlLWljb25zJyxcbiAgICAgICAgZmlsdGVySW5wdXQ6ICdlLWlucHV0LWZpbHRlcicsXG4gICAgICAgIGZpbHRlclBhcmVudDogJ2UtZmlsdGVyLXBhcmVudCcsXG4gICAgICAgIG1vYmlsZUZpbHRlcjogJ2UtZGRsLWRldmljZS1maWx0ZXInLFxuICAgICAgICBmb290ZXI6ICdlLWRkbC1mb290ZXInLFxuICAgICAgICBoZWFkZXI6ICdlLWRkbC1oZWFkZXInLFxuICAgICAgICBjbGVhckljb246ICdlLWNsZWFyLWljb24nLFxuICAgICAgICBjbGVhckljb25IaWRlOiAnZS1jbGVhci1pY29uLWhpZGUnLFxuICAgICAgICBwb3B1cEZ1bGxTY3JlZW46ICdlLXBvcHVwLWZ1bGwtcGFnZScsXG4gICAgICAgIGRpc2FibGVJY29uOiAnZS1kZGwtZGlzYWJsZS1pY29uJ1xuICAgIH07XG4gICAgdmFyIGlucHV0T2JqZWN0ID0ge1xuICAgICAgICBjb250YWluZXI6IG51bGwsXG4gICAgICAgIGJ1dHRvbnM6IFtdXG4gICAgfTtcbiAgICB2YXIgRHJvcERvd25MaXN0ID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICAgICAgX19leHRlbmRzKERyb3BEb3duTGlzdCwgX3N1cGVyKTtcbiAgICAgICAgZnVuY3Rpb24gRHJvcERvd25MaXN0KG9wdGlvbnMsIGVsZW1lbnQpIHtcbiAgICAgICAgICAgIHZhciBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMsIG9wdGlvbnMsIGVsZW1lbnQpIHx8IHRoaXM7XG4gICAgICAgICAgICBfdGhpcy5pc1BvcHVwT3BlbiA9IGZhbHNlO1xuICAgICAgICAgICAgX3RoaXMuaXNEb2N1bWVudENsaWNrID0gZmFsc2U7XG4gICAgICAgICAgICBfdGhpcy5pc0ludGVyYWN0ZWQgPSBmYWxzZTtcbiAgICAgICAgICAgIF90aGlzLmlzRmlsdGVyRm9jdXMgPSBmYWxzZTtcbiAgICAgICAgICAgIF90aGlzLmJlZm9yZVBvcHVwT3BlbiA9IGZhbHNlO1xuICAgICAgICAgICAgX3RoaXMuaW5pdGlhbCA9IHRydWU7XG4gICAgICAgICAgICBfdGhpcy5pbml0UmVtb3RlUmVuZGVyID0gZmFsc2U7XG4gICAgICAgICAgICBfdGhpcy5pc05vdFNlYXJjaExpc3QgPSBmYWxzZTtcbiAgICAgICAgICAgIF90aGlzLmlzVHlwZWQgPSBmYWxzZTtcbiAgICAgICAgICAgIF90aGlzLmlzU2VsZWN0ZWQgPSBmYWxzZTtcbiAgICAgICAgICAgIF90aGlzLnByZXZlbnRGb2N1cyA9IGZhbHNlO1xuICAgICAgICAgICAgX3RoaXMucHJldmVudEF1dG9GaWxsID0gZmFsc2U7XG4gICAgICAgICAgICBfdGhpcy5pc1ZhbGlkS2V5ID0gZmFsc2U7XG4gICAgICAgICAgICBfdGhpcy50eXBlZFN0cmluZyA9ICcnO1xuICAgICAgICAgICAgX3RoaXMuaXNFc2NhcGVLZXkgPSBmYWxzZTtcbiAgICAgICAgICAgIF90aGlzLmlzUHJldmVudEJsdXIgPSBmYWxzZTtcbiAgICAgICAgICAgIF90aGlzLmlzVGFiS2V5ID0gZmFsc2U7XG4gICAgICAgICAgICBfdGhpcy5hY3Rpb25Db21wbGV0ZURhdGEgPSB7IGlzVXBkYXRlZDogZmFsc2UgfTtcbiAgICAgICAgICAgIF90aGlzLnByZXZTZWxlY3RQb2ludHMgPSB7fTtcbiAgICAgICAgICAgIF90aGlzLmlzU2VsZWN0Q3VzdG9tID0gZmFsc2U7XG4gICAgICAgICAgICBfdGhpcy5pc0Ryb3BEb3duQ2xpY2sgPSBmYWxzZTtcbiAgICAgICAgICAgIF90aGlzLnByZXZlbnRBbHRVcCA9IGZhbHNlO1xuICAgICAgICAgICAgX3RoaXMua2V5Q29uZmlndXJlID0ge1xuICAgICAgICAgICAgICAgIHRhYjogJ3RhYicsXG4gICAgICAgICAgICAgICAgZW50ZXI6ICcxMycsXG4gICAgICAgICAgICAgICAgZXNjYXBlOiAnMjcnLFxuICAgICAgICAgICAgICAgIGVuZDogJzM1JyxcbiAgICAgICAgICAgICAgICBob21lOiAnMzYnLFxuICAgICAgICAgICAgICAgIGRvd246ICc0MCcsXG4gICAgICAgICAgICAgICAgdXA6ICczOCcsXG4gICAgICAgICAgICAgICAgcGFnZVVwOiAnMzMnLFxuICAgICAgICAgICAgICAgIHBhZ2VEb3duOiAnMzQnLFxuICAgICAgICAgICAgICAgIG9wZW46ICdhbHQrNDAnLFxuICAgICAgICAgICAgICAgIGNsb3NlOiAnc2hpZnQrdGFiJyxcbiAgICAgICAgICAgICAgICBoaWRlOiAnYWx0KzM4JyxcbiAgICAgICAgICAgICAgICBzcGFjZTogJzMyJ1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHJldHVybiBfdGhpcztcbiAgICAgICAgfVxuICAgICAgICA7XG4gICAgICAgIERyb3BEb3duTGlzdC5wcm90b3R5cGUucHJlUmVuZGVyID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdGhpcy5lbGVtZW50LnN0eWxlLm9wYWNpdHkgPSAnMCc7XG4gICAgICAgICAgICBfc3VwZXIucHJvdG90eXBlLnByZVJlbmRlci5jYWxsKHRoaXMpO1xuICAgICAgICAgICAgdGhpcy5hY3RpdmVJbmRleCA9IHRoaXMuaW5kZXg7XG4gICAgICAgICAgICB0aGlzLnF1ZXJ5U3RyaW5nID0gJyc7XG4gICAgICAgIH07XG4gICAgICAgIERyb3BEb3duTGlzdC5wcm90b3R5cGUucmVuZGVyTGlzdCA9IGZ1bmN0aW9uIChpc0VtcHR5RGF0YSkge1xuICAgICAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5yZW5kZXIuY2FsbCh0aGlzLCBpc0VtcHR5RGF0YSk7XG4gICAgICAgICAgICB0aGlzLndpcmVMaXN0RXZlbnRzKCk7XG4gICAgICAgIH07XG4gICAgICAgIERyb3BEb3duTGlzdC5wcm90b3R5cGUuZmxvYXRMYWJlbENoYW5nZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLmdldE1vZHVsZU5hbWUoKSA9PT0gJ2Ryb3Bkb3dubGlzdCcgJiYgdGhpcy5mbG9hdExhYmVsVHlwZSA9PT0gJ0F1dG8nKSB7XG4gICAgICAgICAgICAgICAgdmFyIGZsb2F0RWxlbWVudCA9IHRoaXMuaW5wdXRXcmFwcGVyLmNvbnRhaW5lci5xdWVyeVNlbGVjdG9yKCcuZS1mbG9hdC10ZXh0Jyk7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuaW5wdXRFbGVtZW50LnZhbHVlICE9PSAnJyB8fCB0aGlzLmlzSW50ZXJhY3RlZCkge1xuICAgICAgICAgICAgICAgICAgICBlajJfYmFzZV80LmNsYXNzTGlzdChmbG9hdEVsZW1lbnQsIFsnZS1sYWJlbC10b3AnXSwgWydlLWxhYmVsLWJvdHRvbSddKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGVqMl9iYXNlXzQuY2xhc3NMaXN0KGZsb2F0RWxlbWVudCwgWydlLWxhYmVsLWJvdHRvbSddLCBbJ2UtbGFiZWwtdG9wJ10pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgRHJvcERvd25MaXN0LnByb3RvdHlwZS5yZXNldEhhbmRsZXIgPSBmdW5jdGlvbiAoZSkge1xuICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgdGhpcy5jbGVhcigpO1xuICAgICAgICB9O1xuICAgICAgICBEcm9wRG93bkxpc3QucHJvdG90eXBlLnJlc2V0Rm9jdXNFbGVtZW50ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdGhpcy5yZW1vdmVIb3ZlcigpO1xuICAgICAgICAgICAgdGhpcy5yZW1vdmVTZWxlY3Rpb24oKTtcbiAgICAgICAgICAgIHRoaXMucmVtb3ZlRm9jdXMoKTtcbiAgICAgICAgICAgIHRoaXMubGlzdC5zY3JvbGxUb3AgPSAwO1xuICAgICAgICAgICAgaWYgKHRoaXMuZ2V0TW9kdWxlTmFtZSgpICE9PSAnYXV0b2NvbXBsZXRlJykge1xuICAgICAgICAgICAgICAgIHZhciBsaSA9IHRoaXMudWxFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy4nICsgZXhwb3J0cy5kcm9wRG93bkxpc3RDbGFzc2VzLmxpKTtcbiAgICAgICAgICAgICAgICBpZiAobGkpIHtcbiAgICAgICAgICAgICAgICAgICAgbGkuY2xhc3NMaXN0LmFkZChleHBvcnRzLmRyb3BEb3duTGlzdENsYXNzZXMuZm9jdXMpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgRHJvcERvd25MaXN0LnByb3RvdHlwZS5jbGVhciA9IGZ1bmN0aW9uIChwcm9wZXJ0eSkge1xuICAgICAgICAgICAgdGhpcy5yZXNldFNlbGVjdGlvbigpO1xuICAgICAgICAgICAgdGhpcy5vbkNoYW5nZUV2ZW50KG51bGwpO1xuICAgICAgICB9O1xuICAgICAgICBEcm9wRG93bkxpc3QucHJvdG90eXBlLnJlc2V0U2VsZWN0aW9uID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgaWYgKHRoaXMubGlzdCkge1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLmFsbG93RmlsdGVyaW5nICYmIHRoaXMuZ2V0TW9kdWxlTmFtZSgpICE9PSAnYXV0b2NvbXBsZXRlJykge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLm9uQWN0aW9uQ29tcGxldGUodGhpcy5hY3Rpb25Db21wbGV0ZURhdGEudWxFbGVtZW50LmNsb25lTm9kZSh0cnVlKSwgdGhpcy5hY3Rpb25Db21wbGV0ZURhdGEubGlzdCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRoaXMucmVzZXRGb2N1c0VsZW1lbnQoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuaGlkZGVuRWxlbWVudC5pbm5lckhUTUwgPSAnJztcbiAgICAgICAgICAgIHRoaXMuaW5wdXRFbGVtZW50LnZhbHVlID0gJyc7XG4gICAgICAgICAgICB0aGlzLnZhbHVlID0gbnVsbDtcbiAgICAgICAgICAgIHRoaXMudGV4dCA9IG51bGw7XG4gICAgICAgICAgICB0aGlzLmluZGV4ID0gbnVsbDtcbiAgICAgICAgICAgIHRoaXMuYWN0aXZlSW5kZXggPSBudWxsO1xuICAgICAgICAgICAgdGhpcy5pdGVtID0gbnVsbDtcbiAgICAgICAgICAgIHRoaXMuaXRlbURhdGEgPSBudWxsO1xuICAgICAgICAgICAgdGhpcy5xdWVyeVN0cmluZyA9ICcnO1xuICAgICAgICAgICAgaWYgKHRoaXMudmFsdWVUZW1wRWxlbWVudCkge1xuICAgICAgICAgICAgICAgIGVqMl9iYXNlXzQuZGV0YWNoKHRoaXMudmFsdWVUZW1wRWxlbWVudCk7XG4gICAgICAgICAgICAgICAgdGhpcy5pbnB1dEVsZW1lbnQuc3R5bGUuZGlzcGxheSA9ICdibG9jayc7XG4gICAgICAgICAgICAgICAgdGhpcy52YWx1ZVRlbXBFbGVtZW50ID0gbnVsbDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuc2V0U2VsZWN0aW9uKG51bGwsIG51bGwpO1xuICAgICAgICAgICAgdGhpcy5pc1NlbGVjdEN1c3RvbSA9IGZhbHNlO1xuICAgICAgICAgICAgdGhpcy51cGRhdGVJY29uU3RhdGUoKTtcbiAgICAgICAgfTtcbiAgICAgICAgRHJvcERvd25MaXN0LnByb3RvdHlwZS5zZXRIVE1MQXR0cmlidXRlcyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGlmIChPYmplY3Qua2V5cyh0aGlzLmh0bWxBdHRyaWJ1dGVzKS5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBfaSA9IDAsIF9hID0gT2JqZWN0LmtleXModGhpcy5odG1sQXR0cmlidXRlcyk7IF9pIDwgX2EubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBodG1sQXR0ciA9IF9hW19pXTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGh0bWxBdHRyID09PSAnY2xhc3MnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmlucHV0V3JhcHBlci5jb250YWluZXIuY2xhc3NMaXN0LmFkZCh0aGlzLmh0bWxBdHRyaWJ1dGVzW2h0bWxBdHRyXSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZSBpZiAoaHRtbEF0dHIgPT09ICdkaXNhYmxlZCcgJiYgdGhpcy5odG1sQXR0cmlidXRlc1todG1sQXR0cl0gPT09ICdkaXNhYmxlZCcpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZW5hYmxlZCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zZXRFbmFibGUoKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbHNlIGlmIChodG1sQXR0ciA9PT0gJ3JlYWRvbmx5JyAmJiB0aGlzLmh0bWxBdHRyaWJ1dGVzW2h0bWxBdHRyXSA9PT0gJ3JlYWRvbmx5Jykge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5yZWFkb25seSA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmRhdGFCaW5kKCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZSBpZiAoaHRtbEF0dHIgPT09ICdzdHlsZScpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuaW5wdXRXcmFwcGVyLmNvbnRhaW5lci5zZXRBdHRyaWJ1dGUoJ3N0eWxlJywgdGhpcy5odG1sQXR0cmlidXRlc1todG1sQXR0cl0pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGRlZmF1bHRBdHRyID0gWyd0aXRsZScsICdpZCcsICduYW1lJywgJ3BsYWNlaG9sZGVyJywgJ3JlcXVpcmVkJ107XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZGVmYXVsdEF0dHIuaW5kZXhPZihodG1sQXR0cikgPiAtMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGh0bWxBdHRyID09PSAncGxhY2Vob2xkZXInID8gZWoyX2lucHV0c18xLklucHV0LnNldFBsYWNlaG9sZGVyKHRoaXMuaHRtbEF0dHJpYnV0ZXNbaHRtbEF0dHJdLCB0aGlzLmlucHV0RWxlbWVudCkgOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmVsZW1lbnQuc2V0QXR0cmlidXRlKGh0bWxBdHRyLCB0aGlzLmh0bWxBdHRyaWJ1dGVzW2h0bWxBdHRyXSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmlucHV0V3JhcHBlci5jb250YWluZXIuc2V0QXR0cmlidXRlKGh0bWxBdHRyLCB0aGlzLmh0bWxBdHRyaWJ1dGVzW2h0bWxBdHRyXSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIERyb3BEb3duTGlzdC5wcm90b3R5cGUuZ2V0QXJpYUF0dHJpYnV0ZXMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICdhcmlhLWRpc2FibGVkJzogJ2ZhbHNlJyxcbiAgICAgICAgICAgICAgICAnYXJpYS1vd25zJzogdGhpcy5lbGVtZW50LmlkICsgJ19vcHRpb25zJyxcbiAgICAgICAgICAgICAgICAncm9sZSc6ICdsaXN0Ym94JyxcbiAgICAgICAgICAgICAgICAnYXJpYS1oYXNwb3B1cCc6ICd0cnVlJyxcbiAgICAgICAgICAgICAgICAnYXJpYS1leHBhbmRlZCc6ICdmYWxzZScsXG4gICAgICAgICAgICAgICAgJ2FyaWEtYWN0aXZlZGVzY2VuZGFudCc6ICdudWxsJyxcbiAgICAgICAgICAgICAgICAnYXJpYS1sYWJlbGxlZGJ5JzogdGhpcy5oaWRkZW5FbGVtZW50LmlkXG4gICAgICAgICAgICB9O1xuICAgICAgICB9O1xuICAgICAgICBEcm9wRG93bkxpc3QucHJvdG90eXBlLnNldEVuYWJsZVJ0bCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGVqMl9pbnB1dHNfMS5JbnB1dC5zZXRFbmFibGVSdGwodGhpcy5lbmFibGVSdGwsIFt0aGlzLmlucHV0RWxlbWVudC5wYXJlbnRFbGVtZW50XSk7XG4gICAgICAgICAgICBpZiAodGhpcy5wb3B1cE9iaikge1xuICAgICAgICAgICAgICAgIHRoaXMucG9wdXBPYmouZW5hYmxlUnRsID0gdGhpcy5lbmFibGVSdGw7XG4gICAgICAgICAgICAgICAgdGhpcy5wb3B1cE9iai5kYXRhQmluZCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICBEcm9wRG93bkxpc3QucHJvdG90eXBlLnNldEVuYWJsZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGVqMl9pbnB1dHNfMS5JbnB1dC5zZXRFbmFibGVkKHRoaXMuZW5hYmxlZCwgdGhpcy5pbnB1dEVsZW1lbnQpO1xuICAgICAgICAgICAgaWYgKHRoaXMuZW5hYmxlZCkge1xuICAgICAgICAgICAgICAgIGVqMl9iYXNlXzQucmVtb3ZlQ2xhc3MoW3RoaXMuaW5wdXRXcmFwcGVyLmNvbnRhaW5lcl0sIGV4cG9ydHMuZHJvcERvd25MaXN0Q2xhc3Nlcy5kaXNhYmxlKTtcbiAgICAgICAgICAgICAgICB0aGlzLmlucHV0RWxlbWVudC5zZXRBdHRyaWJ1dGUoJ2FyaWEtZGlzYWJsZWQnLCAnZmFsc2UnKTtcbiAgICAgICAgICAgICAgICB0aGlzLnRhcmdldEVsZW1lbnQoKS5zZXRBdHRyaWJ1dGUoJ3RhYmluZGV4JywgdGhpcy50YWJJbmRleCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aGlzLmhpZGVQb3B1cCgpO1xuICAgICAgICAgICAgICAgIGVqMl9iYXNlXzQuYWRkQ2xhc3MoW3RoaXMuaW5wdXRXcmFwcGVyLmNvbnRhaW5lcl0sIGV4cG9ydHMuZHJvcERvd25MaXN0Q2xhc3Nlcy5kaXNhYmxlKTtcbiAgICAgICAgICAgICAgICB0aGlzLmlucHV0RWxlbWVudC5zZXRBdHRyaWJ1dGUoJ2FyaWEtZGlzYWJsZWQnLCAndHJ1ZScpO1xuICAgICAgICAgICAgICAgIHRoaXMudGFyZ2V0RWxlbWVudCgpLnRhYkluZGV4ID0gLTE7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIERyb3BEb3duTGlzdC5wcm90b3R5cGUuZ2V0UGVyc2lzdERhdGEgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5hZGRPblBlcnNpc3QoWyd2YWx1ZSddKTtcbiAgICAgICAgfTtcbiAgICAgICAgO1xuICAgICAgICBEcm9wRG93bkxpc3QucHJvdG90eXBlLnByZXZlbnRUYWJJbmRleCA9IGZ1bmN0aW9uIChlbGVtZW50KSB7XG4gICAgICAgICAgICBpZiAodGhpcy5nZXRNb2R1bGVOYW1lKCkgPT09ICdkcm9wZG93bmxpc3QnKSB7XG4gICAgICAgICAgICAgICAgZWxlbWVudC50YWJJbmRleCA9IC0xO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICBEcm9wRG93bkxpc3QucHJvdG90eXBlLnRhcmdldEVsZW1lbnQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5pbnB1dFdyYXBwZXIuY29udGFpbmVyO1xuICAgICAgICB9O1xuICAgICAgICBEcm9wRG93bkxpc3QucHJvdG90eXBlLmdldE5nRGlyZWN0aXZlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuICdFSi1EUk9QRE9XTkxJU1QnO1xuICAgICAgICB9O1xuICAgICAgICBEcm9wRG93bkxpc3QucHJvdG90eXBlLmdldEVsZW1lbnRCeVRleHQgPSBmdW5jdGlvbiAodGV4dCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuZ2V0RWxlbWVudEJ5VmFsdWUodGhpcy5nZXRWYWx1ZUJ5VGV4dCh0ZXh0KSk7XG4gICAgICAgIH07XG4gICAgICAgIERyb3BEb3duTGlzdC5wcm90b3R5cGUuZ2V0RWxlbWVudEJ5VmFsdWUgPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgIHZhciBpdGVtO1xuICAgICAgICAgICAgdmFyIGxpc3RJdGVtcyA9IHRoaXMuZ2V0SXRlbXMoKTtcbiAgICAgICAgICAgIGZvciAodmFyIF9pID0gMCwgbGlzdEl0ZW1zXzEgPSBsaXN0SXRlbXM7IF9pIDwgbGlzdEl0ZW1zXzEubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgICAgICAgICAgdmFyIGxpSXRlbSA9IGxpc3RJdGVtc18xW19pXTtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5nZXRGb3JtYXR0ZWRWYWx1ZShsaUl0ZW0uZ2V0QXR0cmlidXRlKCdkYXRhLXZhbHVlJykpID09PSB2YWx1ZSkge1xuICAgICAgICAgICAgICAgICAgICBpdGVtID0gbGlJdGVtO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gaXRlbTtcbiAgICAgICAgfTtcbiAgICAgICAgO1xuICAgICAgICBEcm9wRG93bkxpc3QucHJvdG90eXBlLmluaXRWYWx1ZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHRoaXMucmVuZGVyTGlzdCgpO1xuICAgICAgICAgICAgaWYgKHRoaXMuZGF0YVNvdXJjZSBpbnN0YW5jZW9mIGVqMl9kYXRhXzEuRGF0YU1hbmFnZXIpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmluaXRSZW1vdGVSZW5kZXIgPSB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpcy51cGRhdGVWYWx1ZXMoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgRHJvcERvd25MaXN0LnByb3RvdHlwZS51cGRhdGVWYWx1ZXMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBpZiAoIWVqMl9iYXNlXzIuaXNOdWxsT3JVbmRlZmluZWQodGhpcy52YWx1ZSkpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnNldFNlbGVjdGlvbih0aGlzLmdldEVsZW1lbnRCeVZhbHVlKHRoaXMudmFsdWUpLCBudWxsKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKHRoaXMudGV4dCAmJiBlajJfYmFzZV8yLmlzTnVsbE9yVW5kZWZpbmVkKHRoaXMudmFsdWUpKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5zZXRTZWxlY3Rpb24odGhpcy5nZXRFbGVtZW50QnlUZXh0KHRoaXMudGV4dCksIG51bGwpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpcy5zZXRTZWxlY3Rpb24odGhpcy5saUNvbGxlY3Rpb25zW3RoaXMuYWN0aXZlSW5kZXhdLCBudWxsKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuc2V0SGlkZGVuVmFsdWUoKTtcbiAgICAgICAgICAgIGVqMl9pbnB1dHNfMS5JbnB1dC5zZXRWYWx1ZSh0aGlzLnRleHQsIHRoaXMuaW5wdXRFbGVtZW50LCB0aGlzLmZsb2F0TGFiZWxUeXBlLCB0aGlzLnNob3dDbGVhckJ1dHRvbik7XG4gICAgICAgIH07XG4gICAgICAgIERyb3BEb3duTGlzdC5wcm90b3R5cGUub25CbHVyID0gZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgIHZhciB0YXJnZXQgPSBlLnJlbGF0ZWRUYXJnZXQ7XG4gICAgICAgICAgICB2YXIgY3VycmVudFRhcmdldCA9IGUudGFyZ2V0O1xuICAgICAgICAgICAgdmFyIGlzUHJldmVudEJsdXIgPSB0aGlzLmlzUHJldmVudEJsdXI7XG4gICAgICAgICAgICB0aGlzLmlzUHJldmVudEJsdXIgPSBmYWxzZTtcbiAgICAgICAgICAgIGlmIChpc1ByZXZlbnRCbHVyICYmICF0aGlzLmlzRG9jdW1lbnRDbGljayAmJiB0aGlzLmlzUG9wdXBPcGVuICYmICghZWoyX2Jhc2VfMi5pc051bGxPclVuZGVmaW5lZChjdXJyZW50VGFyZ2V0KSB8fFxuICAgICAgICAgICAgICAgICF0aGlzLmlzRmlsdGVyTGF5b3V0KCkgJiYgZWoyX2Jhc2VfMi5pc051bGxPclVuZGVmaW5lZCh0YXJnZXQpKSkge1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLmdldE1vZHVsZU5hbWUoKSA9PT0gJ2Ryb3Bkb3dubGlzdCcgJiYgdGhpcy5hbGxvd0ZpbHRlcmluZyAmJiB0aGlzLmlzUG9wdXBPcGVuKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZmlsdGVySW5wdXQuZm9jdXMoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMudGFyZ2V0RWxlbWVudCgpLmZvY3VzKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh0aGlzLmlzRG9jdW1lbnRDbGljayB8fCAoIWVqMl9iYXNlXzIuaXNOdWxsT3JVbmRlZmluZWQodGhpcy5wb3B1cE9iailcbiAgICAgICAgICAgICAgICAmJiBkb2N1bWVudC5ib2R5LmNvbnRhaW5zKHRoaXMucG9wdXBPYmouZWxlbWVudCkgJiZcbiAgICAgICAgICAgICAgICB0aGlzLnBvcHVwT2JqLmVsZW1lbnQuY2xhc3NMaXN0LmNvbnRhaW5zKGV4cG9ydHMuZHJvcERvd25MaXN0Q2xhc3Nlcy5tb2JpbGVGaWx0ZXIpKSkge1xuICAgICAgICAgICAgICAgIGlmICghdGhpcy5iZWZvcmVQb3B1cE9wZW4pIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5pc0RvY3VtZW50Q2xpY2sgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKCgodGhpcy5nZXRNb2R1bGVOYW1lKCkgPT09ICdkcm9wZG93bmxpc3QnICYmICF0aGlzLmlzRmlsdGVyRm9jdXMgJiYgdGFyZ2V0ICE9PSB0aGlzLmlucHV0RWxlbWVudClcbiAgICAgICAgICAgICAgICAmJiAoZG9jdW1lbnQuYWN0aXZlRWxlbWVudCAhPT0gdGFyZ2V0IHx8IChkb2N1bWVudC5hY3RpdmVFbGVtZW50ID09PSB0YXJnZXQgJiZcbiAgICAgICAgICAgICAgICAgICAgY3VycmVudFRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoZXhwb3J0cy5kcm9wRG93bkxpc3RDbGFzc2VzLmlucHV0Rm9jdXMpKSkpIHx8XG4gICAgICAgICAgICAgICAgKGVqMl9iYXNlXzIuaXNOdWxsT3JVbmRlZmluZWQodGFyZ2V0KSAmJiB0aGlzLmdldE1vZHVsZU5hbWUoKSA9PT0gJ2Ryb3Bkb3dubGlzdCcgJiYgdGhpcy5hbGxvd0ZpbHRlcmluZyAmJlxuICAgICAgICAgICAgICAgICAgICBjdXJyZW50VGFyZ2V0ICE9PSB0aGlzLmlucHV0V3JhcHBlci5jb250YWluZXIpIHx8IHRoaXMuZ2V0TW9kdWxlTmFtZSgpICE9PSAnZHJvcGRvd25saXN0JyAmJlxuICAgICAgICAgICAgICAgICF0aGlzLmlucHV0V3JhcHBlci5jb250YWluZXIuY29udGFpbnModGFyZ2V0KSB8fCB0aGlzLmlzVGFiS2V5KSB7XG4gICAgICAgICAgICAgICAgdGhpcy5pc0RvY3VtZW50Q2xpY2sgPSB0aGlzLmlzUG9wdXBPcGVuID8gdHJ1ZSA6IGZhbHNlO1xuICAgICAgICAgICAgICAgIHRoaXMuZm9jdXNPdXRBY3Rpb24oKTtcbiAgICAgICAgICAgICAgICB0aGlzLmlzVGFiS2V5ID0gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIERyb3BEb3duTGlzdC5wcm90b3R5cGUuZm9jdXNPdXRBY3Rpb24gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB0aGlzLmlzSW50ZXJhY3RlZCA9IGZhbHNlO1xuICAgICAgICAgICAgdGhpcy5mb2N1c091dCgpO1xuICAgICAgICAgICAgdGhpcy5vbkZvY3VzT3V0KCk7XG4gICAgICAgIH07XG4gICAgICAgIERyb3BEb3duTGlzdC5wcm90b3R5cGUub25Gb2N1c091dCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLmlzU2VsZWN0ZWQpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmlzU2VsZWN0Q3VzdG9tID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgdGhpcy5vbkNoYW5nZUV2ZW50KG51bGwpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5mbG9hdExhYmVsQ2hhbmdlKCk7XG4gICAgICAgICAgICB0aGlzLmRpc3BhdGNoRXZlbnQodGhpcy5oaWRkZW5FbGVtZW50LCAnY2hhbmdlJyk7XG4gICAgICAgICAgICBpZiAodGhpcy5pbnB1dFdyYXBwZXIuY2xlYXJCdXR0b24pIHtcbiAgICAgICAgICAgICAgICBlajJfYmFzZV80LmFkZENsYXNzKFt0aGlzLmlucHV0V3JhcHBlci5jbGVhckJ1dHRvbl0sIGV4cG9ydHMuZHJvcERvd25MaXN0Q2xhc3Nlcy5jbGVhckljb25IaWRlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMudHJpZ2dlcignYmx1cicpO1xuICAgICAgICB9O1xuICAgICAgICBEcm9wRG93bkxpc3QucHJvdG90eXBlLm9uRm9jdXMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBpZiAoIXRoaXMuaXNJbnRlcmFjdGVkKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5pc0ludGVyYWN0ZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgIHRoaXMudHJpZ2dlcignZm9jdXMnKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMudXBkYXRlSWNvblN0YXRlKCk7XG4gICAgICAgIH07XG4gICAgICAgIERyb3BEb3duTGlzdC5wcm90b3R5cGUud2lyZUV2ZW50ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgZWoyX2Jhc2VfMS5FdmVudEhhbmRsZXIuYWRkKHRoaXMuaW5wdXRXcmFwcGVyLmNvbnRhaW5lciwgJ21vdXNlZG93bicsIHRoaXMuZHJvcERvd25DbGljaywgdGhpcyk7XG4gICAgICAgICAgICBlajJfYmFzZV8xLkV2ZW50SGFuZGxlci5hZGQodGhpcy5pbnB1dFdyYXBwZXIuY29udGFpbmVyLCAnZm9jdXMnLCB0aGlzLmZvY3VzSW4sIHRoaXMpO1xuICAgICAgICAgICAgZWoyX2Jhc2VfMS5FdmVudEhhbmRsZXIuYWRkKHRoaXMuaW5wdXRXcmFwcGVyLmNvbnRhaW5lciwgJ2tleXByZXNzJywgdGhpcy5vblNlYXJjaCwgdGhpcyk7XG4gICAgICAgICAgICB0aGlzLmJpbmRDb21tb25FdmVudCgpO1xuICAgICAgICB9O1xuICAgICAgICBEcm9wRG93bkxpc3QucHJvdG90eXBlLmJpbmRDb21tb25FdmVudCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGVqMl9iYXNlXzEuRXZlbnRIYW5kbGVyLmFkZCh0aGlzLnRhcmdldEVsZW1lbnQoKSwgJ2JsdXInLCB0aGlzLm9uQmx1ciwgdGhpcyk7XG4gICAgICAgICAgICBpZiAoIWVqMl9iYXNlXzMuQnJvd3Nlci5pc0RldmljZSkge1xuICAgICAgICAgICAgICAgIHRoaXMua2V5Ym9hcmRNb2R1bGUgPSBuZXcgZWoyX2Jhc2VfMS5LZXlib2FyZEV2ZW50cyh0aGlzLnRhcmdldEVsZW1lbnQoKSwge1xuICAgICAgICAgICAgICAgICAgICBrZXlBY3Rpb246IHRoaXMua2V5QWN0aW9uSGFuZGxlci5iaW5kKHRoaXMpLCBrZXlDb25maWdzOiB0aGlzLmtleUNvbmZpZ3VyZSwgZXZlbnROYW1lOiAna2V5ZG93bidcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuYmluZENsZWFyRXZlbnQoKTtcbiAgICAgICAgfTtcbiAgICAgICAgRHJvcERvd25MaXN0LnByb3RvdHlwZS5iaW5kQ2xlYXJFdmVudCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLnNob3dDbGVhckJ1dHRvbikge1xuICAgICAgICAgICAgICAgIGVqMl9iYXNlXzEuRXZlbnRIYW5kbGVyLmFkZCh0aGlzLmlucHV0V3JhcHBlci5jbGVhckJ1dHRvbiwgJ21vdXNlZG93bicsIHRoaXMucmVzZXRIYW5kbGVyLCB0aGlzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgRHJvcERvd25MaXN0LnByb3RvdHlwZS51bkJpbmRDb21tb25FdmVudCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGVqMl9iYXNlXzEuRXZlbnRIYW5kbGVyLnJlbW92ZSh0aGlzLnRhcmdldEVsZW1lbnQoKSwgJ2JsdXInLCB0aGlzLm9uQmx1cik7XG4gICAgICAgICAgICBpZiAoIWVqMl9iYXNlXzMuQnJvd3Nlci5pc0RldmljZSkge1xuICAgICAgICAgICAgICAgIHRoaXMua2V5Ym9hcmRNb2R1bGUuZGVzdHJveSgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHRoaXMuc2hvd0NsZWFyQnV0dG9uKSB7XG4gICAgICAgICAgICAgICAgZWoyX2Jhc2VfMS5FdmVudEhhbmRsZXIucmVtb3ZlKHRoaXMuaW5wdXRXcmFwcGVyLmNsZWFyQnV0dG9uLCAnbW91c2Vkb3duJywgdGhpcy5yZXNldEhhbmRsZXIpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICBEcm9wRG93bkxpc3QucHJvdG90eXBlLnVwZGF0ZUljb25TdGF0ZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLnNob3dDbGVhckJ1dHRvbikge1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLmlucHV0RWxlbWVudC52YWx1ZSAhPT0gJycpIHtcbiAgICAgICAgICAgICAgICAgICAgZWoyX2Jhc2VfNC5yZW1vdmVDbGFzcyhbdGhpcy5pbnB1dFdyYXBwZXIuY2xlYXJCdXR0b25dLCBleHBvcnRzLmRyb3BEb3duTGlzdENsYXNzZXMuY2xlYXJJY29uSGlkZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBlajJfYmFzZV80LmFkZENsYXNzKFt0aGlzLmlucHV0V3JhcHBlci5jbGVhckJ1dHRvbl0sIGV4cG9ydHMuZHJvcERvd25MaXN0Q2xhc3Nlcy5jbGVhckljb25IaWRlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIERyb3BEb3duTGlzdC5wcm90b3R5cGUud2lyZUxpc3RFdmVudHMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBlajJfYmFzZV8xLkV2ZW50SGFuZGxlci5hZGQodGhpcy5saXN0LCAnY2xpY2snLCB0aGlzLm9uTW91c2VDbGljaywgdGhpcyk7XG4gICAgICAgICAgICBlajJfYmFzZV8xLkV2ZW50SGFuZGxlci5hZGQodGhpcy5saXN0LCAnbW91c2VvdmVyJywgdGhpcy5vbk1vdXNlT3ZlciwgdGhpcyk7XG4gICAgICAgICAgICBlajJfYmFzZV8xLkV2ZW50SGFuZGxlci5hZGQodGhpcy5saXN0LCAnbW91c2VvdXQnLCB0aGlzLm9uTW91c2VMZWF2ZSwgdGhpcyk7XG4gICAgICAgIH07XG4gICAgICAgIDtcbiAgICAgICAgRHJvcERvd25MaXN0LnByb3RvdHlwZS5vblNlYXJjaCA9IGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgICBpZiAoZS5jaGFyQ29kZSAhPT0gMzIgJiYgZS5jaGFyQ29kZSAhPT0gMTMpIHtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5saXN0ID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5yZW5kZXJMaXN0KCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRoaXMuc2VhcmNoS2V5RXZlbnQgPSBlO1xuICAgICAgICAgICAgICAgIGlmICghdGhpcy5pc1JlcXVlc3RlZCAmJiAhZWoyX2Jhc2VfMi5pc051bGxPclVuZGVmaW5lZCh0aGlzLmxpc3QucXVlcnlTZWxlY3RvcignbGknKSkpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5pbmNyZW1lbnRhbFNlYXJjaChlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIERyb3BEb3duTGlzdC5wcm90b3R5cGUub25Nb3VzZUNsaWNrID0gZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgIHZhciB0YXJnZXQgPSBlLnRhcmdldDtcbiAgICAgICAgICAgIHZhciBjbGFzc0xpc3QgPSB0YXJnZXQuY2xhc3NMaXN0O1xuICAgICAgICAgICAgdmFyIGxpID0gZWoyX2Jhc2VfNC5jbG9zZXN0KHRhcmdldCwgJy4nICsgZHJvcF9kb3duX2Jhc2VfMS5kcm9wRG93bkJhc2VDbGFzc2VzLmxpKTtcbiAgICAgICAgICAgIGlmICghdGhpcy5pc1ZhbGlkTEkobGkpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5zZXRTZWxlY3Rpb24obGksIGUpO1xuICAgICAgICAgICAgaWYgKGVqMl9iYXNlXzMuQnJvd3Nlci5pc0RldmljZSAmJiB0aGlzLmlzRmlsdGVyTGF5b3V0KCkpIHtcbiAgICAgICAgICAgICAgICBoaXN0b3J5LmJhY2soKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHZhciBkZWxheSA9IDEwMDtcbiAgICAgICAgICAgICAgICB0aGlzLmNsb3NlUG9wdXAoZGVsYXkpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICBEcm9wRG93bkxpc3QucHJvdG90eXBlLm9uTW91c2VPdmVyID0gZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgIHZhciBjdXJyZW50TGkgPSBlajJfYmFzZV80LmNsb3Nlc3QoZS50YXJnZXQsICcuJyArIGRyb3BfZG93bl9iYXNlXzEuZHJvcERvd25CYXNlQ2xhc3Nlcy5saSk7XG4gICAgICAgICAgICB0aGlzLnNldEhvdmVyKGN1cnJlbnRMaSk7XG4gICAgICAgIH07XG4gICAgICAgIDtcbiAgICAgICAgRHJvcERvd25MaXN0LnByb3RvdHlwZS5zZXRIb3ZlciA9IGZ1bmN0aW9uIChsaSkge1xuICAgICAgICAgICAgaWYgKHRoaXMuZW5hYmxlZCAmJiB0aGlzLmlzVmFsaWRMSShsaSkgJiYgIWxpLmNsYXNzTGlzdC5jb250YWlucyhkcm9wX2Rvd25fYmFzZV8xLmRyb3BEb3duQmFzZUNsYXNzZXMuaG92ZXIpKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5yZW1vdmVIb3ZlcigpO1xuICAgICAgICAgICAgICAgIGVqMl9iYXNlXzQuYWRkQ2xhc3MoW2xpXSwgZHJvcF9kb3duX2Jhc2VfMS5kcm9wRG93bkJhc2VDbGFzc2VzLmhvdmVyKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgO1xuICAgICAgICBEcm9wRG93bkxpc3QucHJvdG90eXBlLm9uTW91c2VMZWF2ZSA9IGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgICB0aGlzLnJlbW92ZUhvdmVyKCk7XG4gICAgICAgIH07XG4gICAgICAgIDtcbiAgICAgICAgRHJvcERvd25MaXN0LnByb3RvdHlwZS5yZW1vdmVIb3ZlciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciBob3ZlcmVkSXRlbSA9IHRoaXMubGlzdC5xdWVyeVNlbGVjdG9yQWxsKCcuJyArIGRyb3BfZG93bl9iYXNlXzEuZHJvcERvd25CYXNlQ2xhc3Nlcy5ob3Zlcik7XG4gICAgICAgICAgICBpZiAoaG92ZXJlZEl0ZW0gJiYgaG92ZXJlZEl0ZW0ubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgZWoyX2Jhc2VfNC5yZW1vdmVDbGFzcyhob3ZlcmVkSXRlbSwgZHJvcF9kb3duX2Jhc2VfMS5kcm9wRG93bkJhc2VDbGFzc2VzLmhvdmVyKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgO1xuICAgICAgICBEcm9wRG93bkxpc3QucHJvdG90eXBlLmlzVmFsaWRMSSA9IGZ1bmN0aW9uIChsaSkge1xuICAgICAgICAgICAgcmV0dXJuIChsaSAmJiBsaS5oYXNBdHRyaWJ1dGUoJ3JvbGUnKSAmJiBsaS5nZXRBdHRyaWJ1dGUoJ3JvbGUnKSA9PT0gJ29wdGlvbicpO1xuICAgICAgICB9O1xuICAgICAgICA7XG4gICAgICAgIERyb3BEb3duTGlzdC5wcm90b3R5cGUuaW5jcmVtZW50YWxTZWFyY2ggPSBmdW5jdGlvbiAoZSkge1xuICAgICAgICAgICAgaWYgKHRoaXMubGlDb2xsZWN0aW9ucy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgdmFyIGxpID0gaW5jcmVtZW50YWxfc2VhcmNoXzEuaW5jcmVtZW50YWxTZWFyY2goZS5jaGFyQ29kZSwgdGhpcy5saUNvbGxlY3Rpb25zLCB0aGlzLmFjdGl2ZUluZGV4LCB0cnVlKTtcbiAgICAgICAgICAgICAgICBpZiAoIWVqMl9iYXNlXzIuaXNOdWxsT3JVbmRlZmluZWQobGkpKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc2V0U2VsZWN0aW9uKGxpLCBlKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zZXRTY3JvbGxQb3NpdGlvbigpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgO1xuICAgICAgICBEcm9wRG93bkxpc3QucHJvdG90eXBlLmhpZGVTcGlubmVyID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgaWYgKCFlajJfYmFzZV8yLmlzTnVsbE9yVW5kZWZpbmVkKHRoaXMuc3Bpbm5lckVsZW1lbnQpKSB7XG4gICAgICAgICAgICAgICAgZWoyX3BvcHVwc18xLmhpZGVTcGlubmVyKHRoaXMuc3Bpbm5lckVsZW1lbnQpO1xuICAgICAgICAgICAgICAgIGVqMl9iYXNlXzQucmVtb3ZlQ2xhc3MoW3RoaXMuc3Bpbm5lckVsZW1lbnRdLCBleHBvcnRzLmRyb3BEb3duTGlzdENsYXNzZXMuZGlzYWJsZUljb24pO1xuICAgICAgICAgICAgICAgIHRoaXMuc3Bpbm5lckVsZW1lbnQuaW5uZXJIVE1MID0gJyc7XG4gICAgICAgICAgICAgICAgdGhpcy5zcGlubmVyRWxlbWVudCA9IG51bGw7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIERyb3BEb3duTGlzdC5wcm90b3R5cGUuc2hvd1NwaW5uZXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBpZiAoZWoyX2Jhc2VfMi5pc051bGxPclVuZGVmaW5lZCh0aGlzLnNwaW5uZXJFbGVtZW50KSkge1xuICAgICAgICAgICAgICAgIHRoaXMuc3Bpbm5lckVsZW1lbnQgPSBlajJfYmFzZV8zLkJyb3dzZXIuaXNEZXZpY2UgJiYgIWVqMl9iYXNlXzIuaXNOdWxsT3JVbmRlZmluZWQodGhpcy5maWx0ZXJJbnB1dE9iaikgJiYgdGhpcy5maWx0ZXJJbnB1dE9iai5idXR0b25zWzFdIHx8XG4gICAgICAgICAgICAgICAgICAgICFlajJfYmFzZV8yLmlzTnVsbE9yVW5kZWZpbmVkKHRoaXMuZmlsdGVySW5wdXRPYmopICYmIHRoaXMuZmlsdGVySW5wdXRPYmouYnV0dG9uc1swXSB8fCB0aGlzLmlucHV0V3JhcHBlci5idXR0b25zWzBdO1xuICAgICAgICAgICAgICAgIGVqMl9iYXNlXzQuYWRkQ2xhc3MoW3RoaXMuc3Bpbm5lckVsZW1lbnRdLCBleHBvcnRzLmRyb3BEb3duTGlzdENsYXNzZXMuZGlzYWJsZUljb24pO1xuICAgICAgICAgICAgICAgIGVqMl9wb3B1cHNfMS5jcmVhdGVTcGlubmVyKHtcbiAgICAgICAgICAgICAgICAgICAgdGFyZ2V0OiB0aGlzLnNwaW5uZXJFbGVtZW50LFxuICAgICAgICAgICAgICAgICAgICB3aWR0aDogZHJvcF9kb3duX2Jhc2VfMS5TUElOTkVSX1NJWkVcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICBlajJfcG9wdXBzXzEuc2hvd1NwaW5uZXIodGhpcy5zcGlubmVyRWxlbWVudCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIERyb3BEb3duTGlzdC5wcm90b3R5cGUua2V5QWN0aW9uSGFuZGxlciA9IGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgICB2YXIgcHJldmVudEFjdGlvbiA9IGUuYWN0aW9uID09PSAncGFnZVVwJyB8fCBlLmFjdGlvbiA9PT0gJ3BhZ2VEb3duJztcbiAgICAgICAgICAgIHZhciBwcmV2ZW50SG9tZUVuZCA9IHRoaXMuZ2V0TW9kdWxlTmFtZSgpICE9PSAnZHJvcGRvd25saXN0JyAmJiAoZS5hY3Rpb24gPT09ICdob21lJyB8fCBlLmFjdGlvbiA9PT0gJ2VuZCcpO1xuICAgICAgICAgICAgdGhpcy5pc0VzY2FwZUtleSA9IGUuYWN0aW9uID09PSAnZXNjYXBlJztcbiAgICAgICAgICAgIHRoaXMuaXNUYWJLZXkgPSAhdGhpcy5pc1BvcHVwT3BlbiAmJiBlLmFjdGlvbiA9PT0gJ3RhYic7XG4gICAgICAgICAgICB2YXIgaXNOYXZpZ2F0aW9uID0gKGUuYWN0aW9uID09PSAnZG93bicgfHwgZS5hY3Rpb24gPT09ICd1cCcgfHwgZS5hY3Rpb24gPT09ICdwYWdlVXAnIHx8IGUuYWN0aW9uID09PSAncGFnZURvd24nXG4gICAgICAgICAgICAgICAgfHwgZS5hY3Rpb24gPT09ICdob21lJyB8fCBlLmFjdGlvbiA9PT0gJ2VuZCcpO1xuICAgICAgICAgICAgaWYgKCh0aGlzLmlzRWRpdFRleHRCb3goKSB8fCBwcmV2ZW50QWN0aW9uIHx8IHByZXZlbnRIb21lRW5kKSAmJiAhdGhpcy5pc1BvcHVwT3Blbikge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICghdGhpcy5yZWFkb25seSkge1xuICAgICAgICAgICAgICAgIHZhciBpc1RhYkFjdGlvbiA9IGUuYWN0aW9uID09PSAndGFiJyB8fCBlLmFjdGlvbiA9PT0gJ2Nsb3NlJztcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5saXN0ID09PSB1bmRlZmluZWQgJiYgIXRoaXMuaXNSZXF1ZXN0ZWQgJiYgIWlzVGFiQWN0aW9uICYmIGUuYWN0aW9uICE9PSAnZXNjYXBlJykge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnNlYXJjaEtleUV2ZW50ID0gZTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5yZW5kZXJMaXN0KCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChlajJfYmFzZV8yLmlzTnVsbE9yVW5kZWZpbmVkKHRoaXMubGlzdCkgfHwgKCFlajJfYmFzZV8yLmlzTnVsbE9yVW5kZWZpbmVkKHRoaXMubGlDb2xsZWN0aW9ucykgJiZcbiAgICAgICAgICAgICAgICAgICAgaXNOYXZpZ2F0aW9uICYmIHRoaXMubGlDb2xsZWN0aW9ucy5sZW5ndGggPT09IDApIHx8IHRoaXMuaXNSZXF1ZXN0ZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoaXNUYWJBY3Rpb24gJiYgdGhpcy5pc1BvcHVwT3BlbiB8fCBlLmFjdGlvbiA9PT0gJ2VzY2FwZScpIHtcbiAgICAgICAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB0aGlzLmlzU2VsZWN0ZWQgPSBlLmFjdGlvbiA9PT0gJ2VzY2FwZScgPyBmYWxzZSA6IHRoaXMuaXNTZWxlY3RlZDtcbiAgICAgICAgICAgICAgICB0aGlzLmlzVHlwZWQgPSAoaXNOYXZpZ2F0aW9uIHx8IGUuYWN0aW9uID09PSAnZXNjYXBlJykgPyBmYWxzZSA6IHRoaXMuaXNUeXBlZDtcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKGUuYWN0aW9uKSB7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgJ2Rvd24nOlxuICAgICAgICAgICAgICAgICAgICBjYXNlICd1cCc6XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgZm9jdXNFbGUgPSB0aGlzLmxpc3QucXVlcnlTZWxlY3RvcignLicgKyBleHBvcnRzLmRyb3BEb3duTGlzdENsYXNzZXMuZm9jdXMpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuaXNTZWxlY3RGb2N1c0l0ZW0oZm9jdXNFbGUpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zZXRTZWxlY3Rpb24oZm9jdXNFbGUsIGUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG5leHRJdGVtID0gdm9pZCAwO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpbmRleCA9IGUuYWN0aW9uID09PSAnZG93bicgPyB0aGlzLmFjdGl2ZUluZGV4ICsgMSA6IHRoaXMuYWN0aXZlSW5kZXggLSAxO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzdGFydEluZGV4ID0gMDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5nZXRNb2R1bGVOYW1lKCkgPT09ICdhdXRvY29tcGxldGUnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0YXJ0SW5kZXggPSBlLmFjdGlvbiA9PT0gJ2Rvd24nICYmIGVqMl9iYXNlXzIuaXNOdWxsT3JVbmRlZmluZWQodGhpcy5hY3RpdmVJbmRleCkgPyAwIDogdGhpcy5saUNvbGxlY3Rpb25zLmxlbmd0aCAtIDE7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluZGV4ID0gaW5kZXggPCAwID8gdGhpcy5saUNvbGxlY3Rpb25zLmxlbmd0aCAtIDEgOiBpbmRleCA9PT0gdGhpcy5saUNvbGxlY3Rpb25zLmxlbmd0aCA/IDAgOiBpbmRleDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV4dEl0ZW0gPSBlajJfYmFzZV8yLmlzTnVsbE9yVW5kZWZpbmVkKHRoaXMuYWN0aXZlSW5kZXgpID8gdGhpcy5saUNvbGxlY3Rpb25zW3N0YXJ0SW5kZXhdIDogdGhpcy5saUNvbGxlY3Rpb25zW2luZGV4XTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnNldFNlbGVjdGlvbihuZXh0SXRlbSwgZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAncGFnZVVwJzpcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucGFnZVVwU2VsZWN0aW9uKHRoaXMuYWN0aXZlSW5kZXggLSB0aGlzLmdldFBhZ2VDb3VudCgpLCBlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICBjYXNlICdwYWdlRG93bic6XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBhZ2VEb3duU2VsZWN0aW9uKHRoaXMuYWN0aXZlSW5kZXggKyB0aGlzLmdldFBhZ2VDb3VudCgpLCBlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICBjYXNlICdob21lJzpcbiAgICAgICAgICAgICAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmFjdGl2ZUluZGV4ID09PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zZXRTZWxlY3Rpb24odGhpcy5saUNvbGxlY3Rpb25zWzBdLCBlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICBjYXNlICdlbmQnOlxuICAgICAgICAgICAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGxhc3RMaSA9IHRoaXMuZ2V0SXRlbXMoKS5sZW5ndGggLSAxO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuYWN0aXZlSW5kZXggPT09IGxhc3RMaSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2V0U2VsZWN0aW9uKHRoaXMubGlDb2xsZWN0aW9uc1tsYXN0TGldLCBlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICBjYXNlICdzcGFjZSc6XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5nZXRNb2R1bGVOYW1lKCkgPT09ICdkcm9wZG93bmxpc3QnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCF0aGlzLmJlZm9yZVBvcHVwT3Blbikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnNob3dQb3B1cCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICBjYXNlICdvcGVuJzpcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2hvd1BvcHVwKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAnaGlkZSc6XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnByZXZlbnRBbHRVcCA9IHRoaXMuaXNQb3B1cE9wZW47XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmhpZGVQb3B1cCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5mb2N1c0Ryb3BEb3duKGUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgJ2VudGVyJzpcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2VsZWN0Q3VycmVudEl0ZW0oZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAnZXNjYXBlJzpcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAndGFiJzpcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAnY2xvc2UnOlxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuaXNQb3B1cE9wZW4pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmhpZGVQb3B1cCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZm9jdXNEcm9wRG93bihlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgRHJvcERvd25MaXN0LnByb3RvdHlwZS5zZWxlY3RDdXJyZW50SXRlbSA9IGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5pc1BvcHVwT3Blbikge1xuICAgICAgICAgICAgICAgIHZhciBsaSA9IHRoaXMubGlzdC5xdWVyeVNlbGVjdG9yKCcuJyArIGV4cG9ydHMuZHJvcERvd25MaXN0Q2xhc3Nlcy5mb2N1cyk7XG4gICAgICAgICAgICAgICAgaWYgKGxpKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc2V0U2VsZWN0aW9uKGxpLCBlKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5pc1R5cGVkID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmICh0aGlzLmlzU2VsZWN0ZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5pc1NlbGVjdEN1c3RvbSA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLm9uQ2hhbmdlRXZlbnQoZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRoaXMuaGlkZVBvcHVwKCk7XG4gICAgICAgICAgICAgICAgdGhpcy5mb2N1c0Ryb3BEb3duKGUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpcy5zaG93UG9wdXAoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgRHJvcERvd25MaXN0LnByb3RvdHlwZS5pc1NlbGVjdEZvY3VzSXRlbSA9IGZ1bmN0aW9uIChlbGVtZW50KSB7XG4gICAgICAgICAgICByZXR1cm4gIWVqMl9iYXNlXzIuaXNOdWxsT3JVbmRlZmluZWQoZWxlbWVudCk7XG4gICAgICAgIH07XG4gICAgICAgIERyb3BEb3duTGlzdC5wcm90b3R5cGUuZ2V0UGFnZUNvdW50ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIGxpSGVpZ2h0ID0gdGhpcy5saXN0LmNsYXNzTGlzdC5jb250YWlucyhkcm9wX2Rvd25fYmFzZV8xLmRyb3BEb3duQmFzZUNsYXNzZXMubm9EYXRhKSA/IG51bGwgOlxuICAgICAgICAgICAgICAgIGdldENvbXB1dGVkU3R5bGUodGhpcy5nZXRJdGVtcygpWzBdLCBudWxsKS5nZXRQcm9wZXJ0eVZhbHVlKCdoZWlnaHQnKTtcbiAgICAgICAgICAgIHJldHVybiBNYXRoLnJvdW5kKHRoaXMubGlzdC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS5oZWlnaHQgLyBwYXJzZUludChsaUhlaWdodCwgMTApKTtcbiAgICAgICAgfTtcbiAgICAgICAgRHJvcERvd25MaXN0LnByb3RvdHlwZS5wYWdlVXBTZWxlY3Rpb24gPSBmdW5jdGlvbiAoc3RlcHMsIGV2ZW50KSB7XG4gICAgICAgICAgICB2YXIgcHJldmlvdXNJdGVtID0gc3RlcHMgPj0gMCA/IHRoaXMubGlDb2xsZWN0aW9uc1tzdGVwcyArIDFdIDogdGhpcy5saUNvbGxlY3Rpb25zWzBdO1xuICAgICAgICAgICAgdGhpcy5zZXRTZWxlY3Rpb24ocHJldmlvdXNJdGVtLCBldmVudCk7XG4gICAgICAgIH07XG4gICAgICAgIDtcbiAgICAgICAgRHJvcERvd25MaXN0LnByb3RvdHlwZS5wYWdlRG93blNlbGVjdGlvbiA9IGZ1bmN0aW9uIChzdGVwcywgZXZlbnQpIHtcbiAgICAgICAgICAgIHZhciBsaXN0ID0gdGhpcy5nZXRJdGVtcygpO1xuICAgICAgICAgICAgdmFyIHByZXZpb3VzSXRlbSA9IHN0ZXBzIDw9IGxpc3QubGVuZ3RoID8gdGhpcy5saUNvbGxlY3Rpb25zW3N0ZXBzIC0gMV0gOiB0aGlzLmxpQ29sbGVjdGlvbnNbbGlzdC5sZW5ndGggLSAxXTtcbiAgICAgICAgICAgIHRoaXMuc2V0U2VsZWN0aW9uKHByZXZpb3VzSXRlbSwgZXZlbnQpO1xuICAgICAgICB9O1xuICAgICAgICA7XG4gICAgICAgIERyb3BEb3duTGlzdC5wcm90b3R5cGUudW5XaXJlRXZlbnQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBlajJfYmFzZV8xLkV2ZW50SGFuZGxlci5yZW1vdmUodGhpcy5pbnB1dFdyYXBwZXIuY29udGFpbmVyLCAnbW91c2Vkb3duJywgdGhpcy5kcm9wRG93bkNsaWNrKTtcbiAgICAgICAgICAgIGVqMl9iYXNlXzEuRXZlbnRIYW5kbGVyLnJlbW92ZSh0aGlzLmlucHV0V3JhcHBlci5jb250YWluZXIsICdrZXlwcmVzcycsIHRoaXMub25TZWFyY2gpO1xuICAgICAgICAgICAgZWoyX2Jhc2VfMS5FdmVudEhhbmRsZXIucmVtb3ZlKHRoaXMuaW5wdXRXcmFwcGVyLmNvbnRhaW5lciwgJ2ZvY3VzJywgdGhpcy5mb2N1c0luKTtcbiAgICAgICAgICAgIHRoaXMudW5CaW5kQ29tbW9uRXZlbnQoKTtcbiAgICAgICAgfTtcbiAgICAgICAgRHJvcERvd25MaXN0LnByb3RvdHlwZS51bldpcmVMaXN0RXZlbnRzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgZWoyX2Jhc2VfMS5FdmVudEhhbmRsZXIucmVtb3ZlKHRoaXMubGlzdCwgJ2NsaWNrJywgdGhpcy5vbk1vdXNlQ2xpY2spO1xuICAgICAgICAgICAgZWoyX2Jhc2VfMS5FdmVudEhhbmRsZXIucmVtb3ZlKHRoaXMubGlzdCwgJ21vdXNlb3ZlcicsIHRoaXMub25Nb3VzZU92ZXIpO1xuICAgICAgICAgICAgZWoyX2Jhc2VfMS5FdmVudEhhbmRsZXIucmVtb3ZlKHRoaXMubGlzdCwgJ21vdXNlb3V0JywgdGhpcy5vbk1vdXNlTGVhdmUpO1xuICAgICAgICB9O1xuICAgICAgICA7XG4gICAgICAgIERyb3BEb3duTGlzdC5wcm90b3R5cGUub25Eb2N1bWVudENsaWNrID0gZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgIHZhciB0YXJnZXQgPSBlLnRhcmdldDtcbiAgICAgICAgICAgIGlmICghKCFlajJfYmFzZV8yLmlzTnVsbE9yVW5kZWZpbmVkKHRoaXMucG9wdXBPYmopICYmIGVqMl9iYXNlXzQuY2xvc2VzdCh0YXJnZXQsICcjJyArIHRoaXMucG9wdXBPYmouZWxlbWVudC5pZCkpICYmXG4gICAgICAgICAgICAgICAgIXRoaXMuaW5wdXRXcmFwcGVyLmNvbnRhaW5lci5jb250YWlucyhlLnRhcmdldCkpIHtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5pbnB1dFdyYXBwZXIuY29udGFpbmVyLmNsYXNzTGlzdC5jb250YWlucyhleHBvcnRzLmRyb3BEb3duTGlzdENsYXNzZXMuaW5wdXRGb2N1cykgfHwgdGhpcy5pc1BvcHVwT3Blbikge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmlzRG9jdW1lbnRDbGljayA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIHZhciBpc0FjdGl2ZSA9IHRoaXMuaXNSZXF1ZXN0ZWQ7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuaXNJbnRlcmFjdGVkID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuaGlkZVBvcHVwKCk7XG4gICAgICAgICAgICAgICAgICAgIGlmICghaXNBY3RpdmUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMub25Gb2N1c091dCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5pbnB1dFdyYXBwZXIuY29udGFpbmVyLmNsYXNzTGlzdC5yZW1vdmUoZXhwb3J0cy5kcm9wRG93bkxpc3RDbGFzc2VzLmlucHV0Rm9jdXMpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAodGFyZ2V0ICE9PSB0aGlzLmlucHV0RWxlbWVudCAmJiAhKHRoaXMuYWxsb3dGaWx0ZXJpbmcgJiYgdGFyZ2V0ID09PSB0aGlzLmZpbHRlcklucHV0KVxuICAgICAgICAgICAgICAgICYmICEodGhpcy5nZXRNb2R1bGVOYW1lKCkgPT09ICdjb21ib2JveCcgJiZcbiAgICAgICAgICAgICAgICAgICAgIXRoaXMuYWxsb3dGaWx0ZXJpbmcgJiYgZWoyX2Jhc2VfMy5Ccm93c2VyLmlzRGV2aWNlICYmIHRhcmdldCA9PT0gdGhpcy5pbnB1dFdyYXBwZXIuYnV0dG9uc1swXSkpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmlzUHJldmVudEJsdXIgPSAoZWoyX2Jhc2VfMy5Ccm93c2VyLmlzSUUgfHwgZWoyX2Jhc2VfMy5Ccm93c2VyLmluZm8ubmFtZSA9PT0gJ2VkZ2UnKSAmJiAoZG9jdW1lbnQuYWN0aXZlRWxlbWVudCA9PT0gdGhpcy50YXJnZXRFbGVtZW50KCkgfHxcbiAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuYWN0aXZlRWxlbWVudCA9PT0gdGhpcy5maWx0ZXJJbnB1dCk7XG4gICAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICBEcm9wRG93bkxpc3QucHJvdG90eXBlLmFjdGl2ZVN0YXRlQ2hhbmdlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgaWYgKHRoaXMuaXNEb2N1bWVudENsaWNrKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5oaWRlUG9wdXAoKTtcbiAgICAgICAgICAgICAgICB0aGlzLm9uRm9jdXNPdXQoKTtcbiAgICAgICAgICAgICAgICB0aGlzLmlucHV0V3JhcHBlci5jb250YWluZXIuY2xhc3NMaXN0LnJlbW92ZShleHBvcnRzLmRyb3BEb3duTGlzdENsYXNzZXMuaW5wdXRGb2N1cyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIERyb3BEb3duTGlzdC5wcm90b3R5cGUuZm9jdXNEcm9wRG93biA9IGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgICBpZiAoIXRoaXMuaW5pdGlhbCAmJiB0aGlzLmlzRmlsdGVyTGF5b3V0KCkpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmZvY3VzSW4oKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgRHJvcERvd25MaXN0LnByb3RvdHlwZS5kcm9wRG93bkNsaWNrID0gZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLnRhcmdldEVsZW1lbnQoKS5jbGFzc0xpc3QuY29udGFpbnMoZXhwb3J0cy5kcm9wRG93bkxpc3RDbGFzc2VzLmRpc2FibGUpIHx8IHRoaXMuaW5wdXRXcmFwcGVyLmNsZWFyQnV0dG9uID09PSBlLnRhcmdldCkge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciB0YXJnZXQgPSBlLnRhcmdldDtcbiAgICAgICAgICAgIGlmICh0YXJnZXQgIT09IHRoaXMuaW5wdXRFbGVtZW50ICYmICEodGhpcy5hbGxvd0ZpbHRlcmluZyAmJiB0YXJnZXQgPT09IHRoaXMuZmlsdGVySW5wdXQpICYmIHRoaXMuZ2V0TW9kdWxlTmFtZSgpICE9PSAnY29tYm9ib3gnKSB7XG4gICAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKCF0aGlzLnJlYWRvbmx5KSB7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuaXNQb3B1cE9wZW4pIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5oaWRlUG9wdXAoKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuaXNGaWx0ZXJMYXlvdXQoKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5mb2N1c0Ryb3BEb3duKGUpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmZvY3VzSW4oKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5mbG9hdExhYmVsQ2hhbmdlKCk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucXVlcnlTdHJpbmcgPSB0aGlzLmlucHV0RWxlbWVudC52YWx1ZS50cmltKCkgPT09ICcnID8gbnVsbCA6IHRoaXMuaW5wdXRFbGVtZW50LnZhbHVlO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmlzRHJvcERvd25DbGljayA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc2hvd1BvcHVwKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICBEcm9wRG93bkxpc3QucHJvdG90eXBlLnVwZGF0ZVNlbGVjdGVkSXRlbSA9IGZ1bmN0aW9uIChsaSwgZSwgcHJldmVudFNlbGVjdCkge1xuICAgICAgICAgICAgdGhpcy5yZW1vdmVTZWxlY3Rpb24oKTtcbiAgICAgICAgICAgIGxpLmNsYXNzTGlzdC5hZGQoZHJvcF9kb3duX2Jhc2VfMS5kcm9wRG93bkJhc2VDbGFzc2VzLnNlbGVjdGVkKTtcbiAgICAgICAgICAgIHRoaXMucmVtb3ZlSG92ZXIoKTtcbiAgICAgICAgICAgIHZhciB2YWx1ZSA9IHRoaXMuZ2V0Rm9ybWF0dGVkVmFsdWUobGkuZ2V0QXR0cmlidXRlKCdkYXRhLXZhbHVlJykpO1xuICAgICAgICAgICAgdGhpcy5pdGVtID0gbGk7XG4gICAgICAgICAgICB0aGlzLml0ZW1EYXRhID0gdGhpcy5nZXREYXRhQnlWYWx1ZSh2YWx1ZSk7XG4gICAgICAgICAgICBpZiAoIXRoaXMuaW5pdGlhbCAmJiAhcHJldmVudFNlbGVjdCkge1xuICAgICAgICAgICAgICAgIHRoaXMuaXNTZWxlY3RlZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgdmFyIGV2ZW50QXJncyA9IHtcbiAgICAgICAgICAgICAgICAgICAgZTogZSxcbiAgICAgICAgICAgICAgICAgICAgaXRlbTogdGhpcy5pdGVtLFxuICAgICAgICAgICAgICAgICAgICBpdGVtRGF0YTogdGhpcy5pdGVtRGF0YSxcbiAgICAgICAgICAgICAgICAgICAgaXNJbnRlcmFjdGVkOiBlID8gdHJ1ZSA6IGZhbHNlXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICB0aGlzLnRyaWdnZXIoJ3NlbGVjdCcsIGV2ZW50QXJncyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgZm9jdXNlZEl0ZW0gPSB0aGlzLmxpc3QucXVlcnlTZWxlY3RvcignLicgKyBkcm9wX2Rvd25fYmFzZV8xLmRyb3BEb3duQmFzZUNsYXNzZXMuZm9jdXMpO1xuICAgICAgICAgICAgaWYgKGZvY3VzZWRJdGVtKSB7XG4gICAgICAgICAgICAgICAgZWoyX2Jhc2VfNC5yZW1vdmVDbGFzcyhbZm9jdXNlZEl0ZW1dLCBkcm9wX2Rvd25fYmFzZV8xLmRyb3BEb3duQmFzZUNsYXNzZXMuZm9jdXMpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgbGkuc2V0QXR0cmlidXRlKCdhcmlhLXNlbGVjdGVkJywgJ3RydWUnKTtcbiAgICAgICAgICAgIHRoaXMuYWN0aXZlSW5kZXggPSB0aGlzLmdldEluZGV4QnlWYWx1ZSh2YWx1ZSk7XG4gICAgICAgIH07XG4gICAgICAgIERyb3BEb3duTGlzdC5wcm90b3R5cGUuYWN0aXZlSXRlbSA9IGZ1bmN0aW9uIChsaSkge1xuICAgICAgICAgICAgaWYgKHRoaXMuaXNWYWxpZExJKGxpKSAmJiAhbGkuY2xhc3NMaXN0LmNvbnRhaW5zKGRyb3BfZG93bl9iYXNlXzEuZHJvcERvd25CYXNlQ2xhc3Nlcy5zZWxlY3RlZCkpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnJlbW92ZVNlbGVjdGlvbigpO1xuICAgICAgICAgICAgICAgIGxpLmNsYXNzTGlzdC5hZGQoZHJvcF9kb3duX2Jhc2VfMS5kcm9wRG93bkJhc2VDbGFzc2VzLnNlbGVjdGVkKTtcbiAgICAgICAgICAgICAgICB0aGlzLnJlbW92ZUhvdmVyKCk7XG4gICAgICAgICAgICAgICAgbGkuc2V0QXR0cmlidXRlKCdhcmlhLXNlbGVjdGVkJywgJ3RydWUnKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgRHJvcERvd25MaXN0LnByb3RvdHlwZS5zZXRWYWx1ZSA9IGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgICB2YXIgZGF0YUl0ZW0gPSB0aGlzLmdldEl0ZW1EYXRhKCk7XG4gICAgICAgICAgICBpZiAoZGF0YUl0ZW0udmFsdWUgPT09IG51bGwpIHtcbiAgICAgICAgICAgICAgICBlajJfaW5wdXRzXzEuSW5wdXQuc2V0VmFsdWUobnVsbCwgdGhpcy5pbnB1dEVsZW1lbnQsIHRoaXMuZmxvYXRMYWJlbFR5cGUsIHRoaXMuc2hvd0NsZWFyQnV0dG9uKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGVqMl9pbnB1dHNfMS5JbnB1dC5zZXRWYWx1ZShkYXRhSXRlbS50ZXh0LCB0aGlzLmlucHV0RWxlbWVudCwgdGhpcy5mbG9hdExhYmVsVHlwZSwgdGhpcy5zaG93Q2xlYXJCdXR0b24pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHRoaXMucHJldmlvdXNWYWx1ZSA9PT0gZGF0YUl0ZW0udmFsdWUpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmlzU2VsZWN0ZWQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHRoaXMuaXNTZWxlY3RlZCA9ICF0aGlzLmluaXRpYWwgPyB0cnVlIDogZmFsc2U7XG4gICAgICAgICAgICAgICAgdGhpcy5pc1NlbGVjdEN1c3RvbSA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLmdldE1vZHVsZU5hbWUoKSA9PT0gJ2Ryb3Bkb3dubGlzdCcpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy51cGRhdGVJY29uU3RhdGUoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICBEcm9wRG93bkxpc3QucHJvdG90eXBlLnNldFNlbGVjdGlvbiA9IGZ1bmN0aW9uIChsaSwgZSkge1xuICAgICAgICAgICAgaWYgKHRoaXMuaXNWYWxpZExJKGxpKSAmJiAhbGkuY2xhc3NMaXN0LmNvbnRhaW5zKGRyb3BfZG93bl9iYXNlXzEuZHJvcERvd25CYXNlQ2xhc3Nlcy5zZWxlY3RlZCkpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnVwZGF0ZVNlbGVjdGVkSXRlbShsaSwgZSwgZmFsc2UpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHRoaXMubGlzdCkge1xuICAgICAgICAgICAgICAgIHRoaXMucmVtb3ZlSG92ZXIoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuc2VsZWN0ZWRMSSA9IGxpO1xuICAgICAgICAgICAgaWYgKHRoaXMuc2V0VmFsdWUoZSkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAodGhpcy52YWx1ZVRlbXBsYXRlICYmIHRoaXMuaXRlbURhdGEgIT09IG51bGwpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnNldFZhbHVlVGVtcGxhdGUoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKHRoaXMuaW5wdXRFbGVtZW50LnByZXZpb3VzU2libGluZyA9PT0gdGhpcy52YWx1ZVRlbXBFbGVtZW50KSB7XG4gICAgICAgICAgICAgICAgZWoyX2Jhc2VfNC5kZXRhY2godGhpcy52YWx1ZVRlbXBFbGVtZW50KTtcbiAgICAgICAgICAgICAgICB0aGlzLmlucHV0RWxlbWVudC5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh0aGlzLmlzUG9wdXBPcGVuKSB7XG4gICAgICAgICAgICAgICAgZWoyX2Jhc2VfMi5hdHRyaWJ1dGVzKHRoaXMudGFyZ2V0RWxlbWVudCgpLCB7ICdhcmlhLWFjdGl2ZWRlc2NlbmRhbnQnOiB0aGlzLnNlbGVjdGVkTEkgPyB0aGlzLnNlbGVjdGVkTEkuaWQgOiBudWxsIH0pO1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLmlzRmlsdGVyTGF5b3V0KCkpIHtcbiAgICAgICAgICAgICAgICAgICAgZWoyX2Jhc2VfMi5hdHRyaWJ1dGVzKHRoaXMuZmlsdGVySW5wdXQsIHsgJ2FyaWEtYWN0aXZlZGVzY2VuZGFudCc6IHRoaXMuc2VsZWN0ZWRMSSA/IHRoaXMuc2VsZWN0ZWRMSS5pZCA6IG51bGwgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKCghdGhpcy5pc1BvcHVwT3BlbiAmJiAhZWoyX2Jhc2VfMi5pc051bGxPclVuZGVmaW5lZChsaSkpIHx8ICh0aGlzLmlzUG9wdXBPcGVuICYmICFlajJfYmFzZV8yLmlzTnVsbE9yVW5kZWZpbmVkKGUpICYmXG4gICAgICAgICAgICAgICAgKGUudHlwZSAhPT0gJ2tleWRvd24nIHx8IGUudHlwZSA9PT0gJ2tleWRvd24nICYmIGUuYWN0aW9uID09PSAnZW50ZXInKSkpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmlzU2VsZWN0Q3VzdG9tID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgdGhpcy5vbkNoYW5nZUV2ZW50KGUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHRoaXMuaXNQb3B1cE9wZW4gJiYgIWVqMl9iYXNlXzIuaXNOdWxsT3JVbmRlZmluZWQodGhpcy5zZWxlY3RlZExJKSAmJiB0aGlzLml0ZW1EYXRhICE9PSBudWxsICYmICghZSB8fCBlLnR5cGUgIT09ICdjbGljaycpKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5zZXRTY3JvbGxQb3NpdGlvbihlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgRHJvcERvd25MaXN0LnByb3RvdHlwZS5zZXRWYWx1ZVRlbXBsYXRlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIGNvbXBpbGVkU3RyaW5nO1xuICAgICAgICAgICAgaWYgKCF0aGlzLnZhbHVlVGVtcEVsZW1lbnQpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnZhbHVlVGVtcEVsZW1lbnQgPSBlajJfYmFzZV8xLmNyZWF0ZUVsZW1lbnQoJ3NwYW4nLCB7IGNsYXNzTmFtZTogZXhwb3J0cy5kcm9wRG93bkxpc3RDbGFzc2VzLnZhbHVlIH0pO1xuICAgICAgICAgICAgICAgIHRoaXMuaW5wdXRFbGVtZW50LnBhcmVudEVsZW1lbnQuaW5zZXJ0QmVmb3JlKHRoaXMudmFsdWVUZW1wRWxlbWVudCwgdGhpcy5pbnB1dEVsZW1lbnQpO1xuICAgICAgICAgICAgICAgIHRoaXMuaW5wdXRFbGVtZW50LnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XG4gICAgICAgICAgICAgICAgdGhpcy5pbnB1dFdyYXBwZXIuY29udGFpbmVyLmZvY3VzKCk7XG4gICAgICAgICAgICAgICAgZWoyX2Jhc2VfNC5hZGRDbGFzcyhbdGhpcy5pbnB1dFdyYXBwZXIuY29udGFpbmVyXSwgW2V4cG9ydHMuZHJvcERvd25MaXN0Q2xhc3Nlcy5pbnB1dEZvY3VzXSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLnZhbHVlVGVtcEVsZW1lbnQuaW5uZXJIVE1MID0gJyc7XG4gICAgICAgICAgICBjb21waWxlZFN0cmluZyA9IGVqMl9iYXNlXzEuY29tcGlsZSh0aGlzLnZhbHVlVGVtcGxhdGUpO1xuICAgICAgICAgICAgZm9yICh2YXIgX2kgPSAwLCBfYSA9IGNvbXBpbGVkU3RyaW5nKHRoaXMuaXRlbURhdGEpOyBfaSA8IF9hLmxlbmd0aDsgX2krKykge1xuICAgICAgICAgICAgICAgIHZhciBpdGVtID0gX2FbX2ldO1xuICAgICAgICAgICAgICAgIHRoaXMudmFsdWVUZW1wRWxlbWVudC5hcHBlbmRDaGlsZChpdGVtKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgRHJvcERvd25MaXN0LnByb3RvdHlwZS5yZW1vdmVTZWxlY3Rpb24gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgc2VsZWN0ZWRJdGVtcyA9IHRoaXMubGlzdC5xdWVyeVNlbGVjdG9yQWxsKCcuJyArIGRyb3BfZG93bl9iYXNlXzEuZHJvcERvd25CYXNlQ2xhc3Nlcy5zZWxlY3RlZCk7XG4gICAgICAgICAgICBpZiAoc2VsZWN0ZWRJdGVtcy5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICBlajJfYmFzZV80LnJlbW92ZUNsYXNzKHNlbGVjdGVkSXRlbXMsIGRyb3BfZG93bl9iYXNlXzEuZHJvcERvd25CYXNlQ2xhc3Nlcy5zZWxlY3RlZCk7XG4gICAgICAgICAgICAgICAgc2VsZWN0ZWRJdGVtc1swXS5yZW1vdmVBdHRyaWJ1dGUoJ2FyaWEtc2VsZWN0ZWQnKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgO1xuICAgICAgICBEcm9wRG93bkxpc3QucHJvdG90eXBlLmdldEl0ZW1EYXRhID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIGZpZWxkcyA9IHRoaXMuZmllbGRzO1xuICAgICAgICAgICAgdmFyIGRhdGFJdGVtID0ge307XG4gICAgICAgICAgICBkYXRhSXRlbSA9IHRoaXMuaXRlbURhdGE7XG4gICAgICAgICAgICB2YXIgdmFsdWUgPSAoIWVqMl9iYXNlXzIuaXNOdWxsT3JVbmRlZmluZWQoZGF0YUl0ZW0pICYmXG4gICAgICAgICAgICAgICAgKGRhdGFJdGVtW2ZpZWxkcy52YWx1ZV0gPT09IG51bGwgfHwgZGF0YUl0ZW1bZmllbGRzLnZhbHVlXSkgPyBkYXRhSXRlbVtmaWVsZHMudmFsdWVdIDogZGF0YUl0ZW0pO1xuICAgICAgICAgICAgdmFyIHRleHQgPSAoIWVqMl9iYXNlXzIuaXNOdWxsT3JVbmRlZmluZWQoZGF0YUl0ZW0pICYmXG4gICAgICAgICAgICAgICAgKGRhdGFJdGVtW2ZpZWxkcy50ZXh0XSA9PT0gbnVsbCB8fCBkYXRhSXRlbVtmaWVsZHMudGV4dF0pID8gZGF0YUl0ZW1bZmllbGRzLnRleHRdIDogZGF0YUl0ZW0pO1xuICAgICAgICAgICAgcmV0dXJuIHsgdmFsdWU6IHZhbHVlLCB0ZXh0OiB0ZXh0IH07XG4gICAgICAgIH07XG4gICAgICAgIERyb3BEb3duTGlzdC5wcm90b3R5cGUub25DaGFuZ2VFdmVudCA9IGZ1bmN0aW9uIChldmUpIHtcbiAgICAgICAgICAgIHZhciBkYXRhSXRlbSA9IHRoaXMuZ2V0SXRlbURhdGEoKTtcbiAgICAgICAgICAgIHZhciBpbmRleCA9IHRoaXMuaXNTZWxlY3RDdXN0b20gPyBudWxsIDogdGhpcy5hY3RpdmVJbmRleDtcbiAgICAgICAgICAgIHRoaXMuc2V0UHJvcGVydGllcyh7ICd2YWx1ZSc6IGRhdGFJdGVtLnZhbHVlLCAnaW5kZXgnOiBpbmRleCwgJ3RleHQnOiBkYXRhSXRlbS50ZXh0IH0sIHRydWUpO1xuICAgICAgICAgICAgdGhpcy5kZXRhY2hDaGFuZ2VFdmVudChldmUpO1xuICAgICAgICB9O1xuICAgICAgICA7XG4gICAgICAgIERyb3BEb3duTGlzdC5wcm90b3R5cGUuZGV0YWNoQ2hhbmdlRXZlbnQgPSBmdW5jdGlvbiAoZXZlKSB7XG4gICAgICAgICAgICB0aGlzLmlzU2VsZWN0ZWQgPSBmYWxzZTtcbiAgICAgICAgICAgIHRoaXMucHJldmlvdXNWYWx1ZSA9IHRoaXMudmFsdWU7XG4gICAgICAgICAgICB0aGlzLmFjdGl2ZUluZGV4ID0gdGhpcy5pbmRleDtcbiAgICAgICAgICAgIHRoaXMudHlwZWRTdHJpbmcgPSAhZWoyX2Jhc2VfMi5pc051bGxPclVuZGVmaW5lZCh0aGlzLnRleHQpID8gdGhpcy50ZXh0IDogJyc7XG4gICAgICAgICAgICBpZiAoIXRoaXMuaW5pdGlhbCkge1xuICAgICAgICAgICAgICAgIHRoaXMuc2V0SGlkZGVuVmFsdWUoKTtcbiAgICAgICAgICAgICAgICB2YXIgZXZlbnRBcmdzID0ge1xuICAgICAgICAgICAgICAgICAgICBlOiBldmUsXG4gICAgICAgICAgICAgICAgICAgIGl0ZW06IHRoaXMuaXRlbSxcbiAgICAgICAgICAgICAgICAgICAgaXRlbURhdGE6IHRoaXMuaXRlbURhdGEsXG4gICAgICAgICAgICAgICAgICAgIGlzSW50ZXJhY3RlZDogZXZlID8gdHJ1ZSA6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICB2YWx1ZTogdGhpcy52YWx1ZVxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgdGhpcy50cmlnZ2VyKCdjaGFuZ2UnLCBldmVudEFyZ3MpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICBEcm9wRG93bkxpc3QucHJvdG90eXBlLnNldEhpZGRlblZhbHVlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgaWYgKCFlajJfYmFzZV8yLmlzTnVsbE9yVW5kZWZpbmVkKHRoaXMudmFsdWUpKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5oaWRkZW5FbGVtZW50LmlubmVySFRNTCA9ICc8b3B0aW9uIHNlbGVjdGVkIHZhbHVlID0nICsgdGhpcy52YWx1ZSArICc+JyArIHRoaXMudGV4dCArICc8L29wdGlvbj4nO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpcy5oaWRkZW5FbGVtZW50LmlubmVySFRNTCA9ICcnO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICBEcm9wRG93bkxpc3QucHJvdG90eXBlLm9uRmlsdGVyVXAgPSBmdW5jdGlvbiAoZSkge1xuICAgICAgICAgICAgdGhpcy5pc1ZhbGlkS2V5ID0gZS5rZXlDb2RlID09PSA0MCB8fCBlLmtleUNvZGUgPT09IDM4IHx8IHRoaXMuaXNWYWxpZEtleTtcbiAgICAgICAgICAgIGlmICh0aGlzLmlzVmFsaWRLZXkpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmlzVmFsaWRLZXkgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKGUua2V5Q29kZSkge1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDM4OlxuICAgICAgICAgICAgICAgICAgICBjYXNlIDQwOlxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuZ2V0TW9kdWxlTmFtZSgpID09PSAnYXV0b2NvbXBsZXRlJyAmJiAhdGhpcy5pc1BvcHVwT3BlbiAmJiAhdGhpcy5wcmV2ZW50QWx0VXAgJiYgIXRoaXMuaXNSZXF1ZXN0ZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnByZXZlbnRBdXRvRmlsbCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zZWFyY2hMaXN0cyhlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucHJldmVudEF1dG9GaWxsID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnByZXZlbnRBbHRVcCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgNDY6XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgODpcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMudHlwZWRTdHJpbmcgPSB0aGlzLmZpbHRlcklucHV0LnZhbHVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCF0aGlzLmlzUG9wdXBPcGVuICYmIHRoaXMudHlwZWRTdHJpbmcgIT09ICcnIHx8IHRoaXMuaXNQb3B1cE9wZW4gJiYgdGhpcy5xdWVyeVN0cmluZy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wcmV2ZW50QXV0b0ZpbGwgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2VhcmNoTGlzdHMoZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBlbHNlIGlmICh0aGlzLnR5cGVkU3RyaW5nID09PSAnJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucmVzZXRGb2N1c0VsZW1lbnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmFjdGl2ZUluZGV4ID0gbnVsbDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5nZXRNb2R1bGVOYW1lKCkgPT09ICdhdXRvY29tcGxldGUnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuaGlkZVBvcHVwKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnR5cGVkU3RyaW5nID0gdGhpcy5maWx0ZXJJbnB1dC52YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucHJldmVudEF1dG9GaWxsID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnNlYXJjaExpc3RzKGUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICBEcm9wRG93bkxpc3QucHJvdG90eXBlLm9uRmlsdGVyRG93biA9IGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgICBzd2l0Y2ggKGUua2V5Q29kZSkge1xuICAgICAgICAgICAgICAgIGNhc2UgMTM6XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgNDA6XG4gICAgICAgICAgICAgICAgY2FzZSAzODpcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5xdWVyeVN0cmluZyA9IHRoaXMuZmlsdGVySW5wdXQudmFsdWU7XG4gICAgICAgICAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSA5OlxuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5pc1BvcHVwT3Blbikge1xuICAgICAgICAgICAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucHJldlNlbGVjdFBvaW50cyA9IHRoaXMuZ2V0U2VsZWN0aW9uUG9pbnRzKCk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucXVlcnlTdHJpbmcgPSB0aGlzLmZpbHRlcklucHV0LnZhbHVlO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgRHJvcERvd25MaXN0LnByb3RvdHlwZS5yZW1vdmVGaWxsU2VsZWN0aW9uID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgaWYgKHRoaXMuaXNJbnRlcmFjdGVkKSB7XG4gICAgICAgICAgICAgICAgdmFyIHNlbGVjdGlvbiA9IHRoaXMuZ2V0U2VsZWN0aW9uUG9pbnRzKCk7XG4gICAgICAgICAgICAgICAgdGhpcy5pbnB1dEVsZW1lbnQuc2V0U2VsZWN0aW9uUmFuZ2Uoc2VsZWN0aW9uLmVuZCwgc2VsZWN0aW9uLmVuZCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIERyb3BEb3duTGlzdC5wcm90b3R5cGUuZ2V0U2VsZWN0aW9uUG9pbnRzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIGlucHV0ID0gdGhpcy5pbnB1dEVsZW1lbnQ7XG4gICAgICAgICAgICByZXR1cm4geyBzdGFydDogTWF0aC5hYnMoaW5wdXQuc2VsZWN0aW9uU3RhcnQpLCBlbmQ6IE1hdGguYWJzKGlucHV0LnNlbGVjdGlvbkVuZCkgfTtcbiAgICAgICAgfTtcbiAgICAgICAgRHJvcERvd25MaXN0LnByb3RvdHlwZS5zZWFyY2hMaXN0cyA9IGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICAgICAgdGhpcy5pc1R5cGVkID0gdHJ1ZTtcbiAgICAgICAgICAgIHRoaXMuYWN0aXZlSW5kZXggPSBudWxsO1xuICAgICAgICAgICAgaWYgKHRoaXMuZmlsdGVySW5wdXQucGFyZW50RWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuJyArIGV4cG9ydHMuZHJvcERvd25MaXN0Q2xhc3Nlcy5jbGVhckljb24pKSB7XG4gICAgICAgICAgICAgICAgdmFyIGNsZWFyRWxlbWVudCA9IHRoaXMuZmlsdGVySW5wdXQucGFyZW50RWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuJyArIGV4cG9ydHMuZHJvcERvd25MaXN0Q2xhc3Nlcy5jbGVhckljb24pO1xuICAgICAgICAgICAgICAgIGNsZWFyRWxlbWVudC5zdHlsZS52aXNpYmlsaXR5ID0gdGhpcy5maWx0ZXJJbnB1dC52YWx1ZSA9PT0gJycgPyAnaGlkZGVuJyA6ICd2aXNpYmxlJztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh0aGlzLmlzRmlsdGVyaW5nKCkpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnRyaWdnZXIoJ2ZpbHRlcmluZycsIHtcbiAgICAgICAgICAgICAgICAgICAgdGV4dDogdGhpcy5maWx0ZXJJbnB1dC52YWx1ZSxcbiAgICAgICAgICAgICAgICAgICAgdXBkYXRlRGF0YTogZnVuY3Rpb24gKGRhdGFTb3VyY2UsIHF1ZXJ5LCBmaWVsZHMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghZWoyX2Jhc2VfMi5pc051bGxPclVuZGVmaW5lZChfdGhpcy5maWx0ZXJJbnB1dCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfdGhpcy5iZWZvcmVQb3B1cE9wZW4gPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChfdGhpcy5maWx0ZXJJbnB1dC52YWx1ZS50cmltKCkgPT09ICcnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzLmFjdGlvbkNvbXBsZXRlRGF0YS5pc1VwZGF0ZWQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMuaXNUeXBlZCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfdGhpcy5vbkFjdGlvbkNvbXBsZXRlKF90aGlzLmFjdGlvbkNvbXBsZXRlRGF0YS51bEVsZW1lbnQsIF90aGlzLmFjdGlvbkNvbXBsZXRlRGF0YS5saXN0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMuaXNUeXBlZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghZWoyX2Jhc2VfMi5pc051bGxPclVuZGVmaW5lZChfdGhpcy5pdGVtRGF0YSkgJiYgX3RoaXMuZ2V0TW9kdWxlTmFtZSgpID09PSAnZHJvcGRvd25saXN0Jykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMuZm9jdXNJbmRleEl0ZW0oKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzLnNldFNjcm9sbFBvc2l0aW9uKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMuaXNOb3RTZWFyY2hMaXN0ID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzLmlzTm90U2VhcmNoTGlzdCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfdGhpcy5yZXNldExpc3QoZGF0YVNvdXJjZSwgZmllbGRzLCBxdWVyeSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICBldmVudDogZVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICBEcm9wRG93bkxpc3QucHJvdG90eXBlLnNldFNlYXJjaEJveCA9IGZ1bmN0aW9uIChwb3B1cEVsZW1lbnQpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLmlzRmlsdGVyaW5nKCkpIHtcbiAgICAgICAgICAgICAgICB2YXIgcGFyZW50RWxlbWVudCA9IGVqMl9iYXNlXzEuY3JlYXRlRWxlbWVudCgnc3BhbicsIHtcbiAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lOiBleHBvcnRzLmRyb3BEb3duTGlzdENsYXNzZXMuZmlsdGVyUGFyZW50XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgdGhpcy5maWx0ZXJJbnB1dCA9IGVqMl9iYXNlXzEuY3JlYXRlRWxlbWVudCgnaW5wdXQnLCB7XG4gICAgICAgICAgICAgICAgICAgIGF0dHJzOiB7IHR5cGU6ICd0ZXh0JyB9LFxuICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU6IGV4cG9ydHMuZHJvcERvd25MaXN0Q2xhc3Nlcy5maWx0ZXJJbnB1dFxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHRoaXMuZWxlbWVudC5wYXJlbnROb2RlLmluc2VydEJlZm9yZSh0aGlzLmZpbHRlcklucHV0LCB0aGlzLmVsZW1lbnQpO1xuICAgICAgICAgICAgICAgIHZhciBiYWNrSWNvbiA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIGlmIChlajJfYmFzZV8zLkJyb3dzZXIuaXNEZXZpY2UpIHtcbiAgICAgICAgICAgICAgICAgICAgYmFja0ljb24gPSB0cnVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB0aGlzLmZpbHRlcklucHV0T2JqID0gZWoyX2lucHV0c18xLklucHV0LmNyZWF0ZUlucHV0KHtcbiAgICAgICAgICAgICAgICAgICAgZWxlbWVudDogdGhpcy5maWx0ZXJJbnB1dCxcbiAgICAgICAgICAgICAgICAgICAgYnV0dG9uczogYmFja0ljb24gP1xuICAgICAgICAgICAgICAgICAgICAgICAgW2V4cG9ydHMuZHJvcERvd25MaXN0Q2xhc3Nlcy5iYWNrSWNvbiwgZXhwb3J0cy5kcm9wRG93bkxpc3RDbGFzc2VzLmZpbHRlckJhckNsZWFySWNvbl0gOiBbZXhwb3J0cy5kcm9wRG93bkxpc3RDbGFzc2VzLmZpbHRlckJhckNsZWFySWNvbl0sXG4gICAgICAgICAgICAgICAgICAgIHByb3BlcnRpZXM6IHsgcGxhY2Vob2xkZXI6IHRoaXMuZmlsdGVyQmFyUGxhY2Vob2xkZXIgfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIGVqMl9iYXNlXzEuYXBwZW5kKFt0aGlzLmZpbHRlcklucHV0T2JqLmNvbnRhaW5lcl0sIHBhcmVudEVsZW1lbnQpO1xuICAgICAgICAgICAgICAgIGVqMl9iYXNlXzQucHJlcGVuZChbcGFyZW50RWxlbWVudF0sIHBvcHVwRWxlbWVudCk7XG4gICAgICAgICAgICAgICAgZWoyX2Jhc2VfMi5hdHRyaWJ1dGVzKHRoaXMuZmlsdGVySW5wdXQsIHtcbiAgICAgICAgICAgICAgICAgICAgJ2FyaWEtZGlzYWJsZWQnOiAnZmFsc2UnLFxuICAgICAgICAgICAgICAgICAgICAnYXJpYS1vd25zJzogdGhpcy5lbGVtZW50LmlkICsgJ19vcHRpb25zJyxcbiAgICAgICAgICAgICAgICAgICAgJ3JvbGUnOiAnbGlzdGJveCcsXG4gICAgICAgICAgICAgICAgICAgICdhcmlhLWFjdGl2ZWRlc2NlbmRhbnQnOiB0aGlzLnNlbGVjdGVkTEkgPyB0aGlzLnNlbGVjdGVkTEkuaWQgOiBudWxsLFxuICAgICAgICAgICAgICAgICAgICAnYXV0b2NvbXBsZXRlJzogJ29mZicsXG4gICAgICAgICAgICAgICAgICAgICdhdXRvY29ycmVjdCc6ICdvZmYnLFxuICAgICAgICAgICAgICAgICAgICAnYXV0b2NhcGl0YWxpemUnOiAnb2ZmJyxcbiAgICAgICAgICAgICAgICAgICAgJ3NwZWxsY2hlY2snOiAnZmFsc2UnXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgdGhpcy5jbGVhckljb25FbGVtZW50ID0gdGhpcy5maWx0ZXJJbnB1dC5wYXJlbnRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy4nICsgZXhwb3J0cy5kcm9wRG93bkxpc3RDbGFzc2VzLmNsZWFySWNvbik7XG4gICAgICAgICAgICAgICAgaWYgKCFlajJfYmFzZV8zLkJyb3dzZXIuaXNEZXZpY2UgJiYgdGhpcy5jbGVhckljb25FbGVtZW50KSB7XG4gICAgICAgICAgICAgICAgICAgIGVqMl9iYXNlXzEuRXZlbnRIYW5kbGVyLmFkZCh0aGlzLmNsZWFySWNvbkVsZW1lbnQsICdjbGljaycsIHRoaXMuY2xlYXJUZXh0LCB0aGlzKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jbGVhckljb25FbGVtZW50LnN0eWxlLnZpc2liaWxpdHkgPSAnaGlkZGVuJztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKCFlajJfYmFzZV8zLkJyb3dzZXIuaXNEZXZpY2UpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zZWFyY2hLZXlNb2R1bGUgPSBuZXcgZWoyX2Jhc2VfMS5LZXlib2FyZEV2ZW50cyh0aGlzLmZpbHRlcklucHV0LCB7XG4gICAgICAgICAgICAgICAgICAgICAgICBrZXlBY3Rpb246IHRoaXMua2V5QWN0aW9uSGFuZGxlci5iaW5kKHRoaXMpLFxuICAgICAgICAgICAgICAgICAgICAgICAga2V5Q29uZmlnczogdGhpcy5rZXlDb25maWd1cmUsXG4gICAgICAgICAgICAgICAgICAgICAgICBldmVudE5hbWU6ICdrZXlkb3duJ1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWoyX2Jhc2VfMS5FdmVudEhhbmRsZXIuYWRkKHRoaXMuZmlsdGVySW5wdXQsICdpbnB1dCcsIHRoaXMub25JbnB1dCwgdGhpcyk7XG4gICAgICAgICAgICAgICAgZWoyX2Jhc2VfMS5FdmVudEhhbmRsZXIuYWRkKHRoaXMuZmlsdGVySW5wdXQsICdrZXl1cCcsIHRoaXMub25GaWx0ZXJVcCwgdGhpcyk7XG4gICAgICAgICAgICAgICAgZWoyX2Jhc2VfMS5FdmVudEhhbmRsZXIuYWRkKHRoaXMuZmlsdGVySW5wdXQsICdrZXlkb3duJywgdGhpcy5vbkZpbHRlckRvd24sIHRoaXMpO1xuICAgICAgICAgICAgICAgIGVqMl9iYXNlXzEuRXZlbnRIYW5kbGVyLmFkZCh0aGlzLmZpbHRlcklucHV0LCAnYmx1cicsIHRoaXMub25CbHVyLCB0aGlzKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5maWx0ZXJJbnB1dE9iajtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHJldHVybiBpbnB1dE9iamVjdDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgO1xuICAgICAgICBEcm9wRG93bkxpc3QucHJvdG90eXBlLm9uSW5wdXQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB0aGlzLmlzVmFsaWRLZXkgPSB0cnVlO1xuICAgICAgICB9O1xuICAgICAgICBEcm9wRG93bkxpc3QucHJvdG90eXBlLm9uQWN0aW9uRmFpbHVyZSA9IGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgICBfc3VwZXIucHJvdG90eXBlLm9uQWN0aW9uRmFpbHVyZS5jYWxsKHRoaXMsIGUpO1xuICAgICAgICAgICAgdGhpcy5yZW5kZXJQb3B1cCgpO1xuICAgICAgICB9O1xuICAgICAgICBEcm9wRG93bkxpc3QucHJvdG90eXBlLm9uQWN0aW9uQ29tcGxldGUgPSBmdW5jdGlvbiAodWxFbGVtZW50LCBsaXN0LCBlLCBpc1VwZGF0ZWQpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLmlzTm90U2VhcmNoTGlzdCkge1xuICAgICAgICAgICAgICAgIHRoaXMuaXNOb3RTZWFyY2hMaXN0ID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHRoaXMuaXNBY3RpdmUpIHtcbiAgICAgICAgICAgICAgICB2YXIgc2VsZWN0ZWRJdGVtID0gdGhpcy5zZWxlY3RlZExJID8gdGhpcy5zZWxlY3RlZExJLmNsb25lTm9kZSh0cnVlKSA6IG51bGw7XG4gICAgICAgICAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5vbkFjdGlvbkNvbXBsZXRlLmNhbGwodGhpcywgdWxFbGVtZW50LCBsaXN0LCBlKTtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5pc1JlcXVlc3RlZCAmJiAhZWoyX2Jhc2VfMi5pc051bGxPclVuZGVmaW5lZCh0aGlzLnNlYXJjaEtleUV2ZW50KSAmJiB0aGlzLnNlYXJjaEtleUV2ZW50LnR5cGUgPT09ICdrZXlkb3duJykge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmlzUmVxdWVzdGVkID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMua2V5QWN0aW9uSGFuZGxlcih0aGlzLnNlYXJjaEtleUV2ZW50KTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zZWFyY2hLZXlFdmVudCA9IG51bGw7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmICh0aGlzLmlzUmVxdWVzdGVkICYmICFlajJfYmFzZV8yLmlzTnVsbE9yVW5kZWZpbmVkKHRoaXMuc2VhcmNoS2V5RXZlbnQpKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuaW5jcmVtZW50YWxTZWFyY2godGhpcy5zZWFyY2hLZXlFdmVudCk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc2VhcmNoS2V5RXZlbnQgPSBudWxsO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB0aGlzLmxpc3Quc2Nyb2xsVG9wID0gMDtcbiAgICAgICAgICAgICAgICBpZiAoIWVqMl9iYXNlXzIuaXNOdWxsT3JVbmRlZmluZWQodWxFbGVtZW50KSkge1xuICAgICAgICAgICAgICAgICAgICBlajJfYmFzZV8yLmF0dHJpYnV0ZXModWxFbGVtZW50LCB7ICdpZCc6IHRoaXMuZWxlbWVudC5pZCArICdfb3B0aW9ucycsICdyb2xlJzogJ2xpc3Rib3gnLCAnYXJpYS1oaWRkZW4nOiAnZmFsc2UnIH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAodGhpcy5pbml0UmVtb3RlUmVuZGVyKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuaW5pdGlhbCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuYWN0aXZlSW5kZXggPSB0aGlzLmluZGV4O1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnVwZGF0ZVZhbHVlcygpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmluaXRSZW1vdGVSZW5kZXIgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5pbml0aWFsID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmICh0aGlzLmdldE1vZHVsZU5hbWUoKSAhPT0gJ2F1dG9jb21wbGV0ZScgJiYgdGhpcy5pc0ZpbHRlcmluZygpICYmICF0aGlzLmlzVHlwZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCF0aGlzLmFjdGlvbkNvbXBsZXRlRGF0YS5pc1VwZGF0ZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYWN0aW9uQ29tcGxldGVEYXRhID0geyB1bEVsZW1lbnQ6IHVsRWxlbWVudC5jbG9uZU5vZGUodHJ1ZSksIGxpc3Q6IGxpc3QsIGlzVXBkYXRlZDogdHJ1ZSB9O1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuYWRkTmV3SXRlbShsaXN0LCBzZWxlY3RlZEl0ZW0pO1xuICAgICAgICAgICAgICAgICAgICBpZiAoIWVqMl9iYXNlXzIuaXNOdWxsT3JVbmRlZmluZWQodGhpcy5pdGVtRGF0YSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZm9jdXNJbmRleEl0ZW0oKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAodGhpcy5iZWZvcmVQb3B1cE9wZW4pIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5yZW5kZXJQb3B1cCgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgRHJvcERvd25MaXN0LnByb3RvdHlwZS5hZGROZXdJdGVtID0gZnVuY3Rpb24gKGxpc3REYXRhLCBuZXdFbGVtZW50KSB7XG4gICAgICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICAgICAgaWYgKCFlajJfYmFzZV8yLmlzTnVsbE9yVW5kZWZpbmVkKHRoaXMuaXRlbURhdGEpICYmICFlajJfYmFzZV8yLmlzTnVsbE9yVW5kZWZpbmVkKG5ld0VsZW1lbnQpKSB7XG4gICAgICAgICAgICAgICAgdmFyIHZhbHVlXzEgPSB0aGlzLmdldEl0ZW1EYXRhKCkudmFsdWU7XG4gICAgICAgICAgICAgICAgdmFyIGlzRXhpc3QgPSBsaXN0RGF0YS5zb21lKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBkYXRhW190aGlzLmZpZWxkcy52YWx1ZV0gPT09IHZhbHVlXzE7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgaWYgKCFpc0V4aXN0KSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuYWRkSXRlbSh0aGlzLml0ZW1EYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5hY3Rpb25Db21wbGV0ZURhdGEubGlzdC5wdXNoKHRoaXMuaXRlbURhdGEpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmFjdGlvbkNvbXBsZXRlRGF0YS51bEVsZW1lbnQuYXBwZW5kQ2hpbGQobmV3RWxlbWVudCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHZhciBzZWxlY3RlZEl0ZW1zID0gdm9pZCAwO1xuICAgICAgICAgICAgICAgIHZhciB1bEVsZW1lbnQgPSB0aGlzLmFjdGlvbkNvbXBsZXRlRGF0YS51bEVsZW1lbnQ7XG4gICAgICAgICAgICAgICAgc2VsZWN0ZWRJdGVtcyA9IHVsRWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuJyArIGRyb3BfZG93bl9iYXNlXzEuZHJvcERvd25CYXNlQ2xhc3Nlcy5zZWxlY3RlZCk7XG4gICAgICAgICAgICAgICAgaWYgKHNlbGVjdGVkSXRlbXMubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgICAgIGVqMl9iYXNlXzQucmVtb3ZlQ2xhc3Moc2VsZWN0ZWRJdGVtcywgZHJvcF9kb3duX2Jhc2VfMS5kcm9wRG93bkJhc2VDbGFzc2VzLnNlbGVjdGVkKTtcbiAgICAgICAgICAgICAgICAgICAgc2VsZWN0ZWRJdGVtc1swXS5yZW1vdmVBdHRyaWJ1dGUoJ2FyaWEtc2VsZWN0ZWQnKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIERyb3BEb3duTGlzdC5wcm90b3R5cGUudXBkYXRlQWN0aW9uQ29tcGxldGVEYXRhID0gZnVuY3Rpb24gKGxpLCBpdGVtKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5nZXRNb2R1bGVOYW1lKCkgIT09ICdhdXRvY29tcGxldGUnICYmIHRoaXMuYWN0aW9uQ29tcGxldGVEYXRhLnVsRWxlbWVudCkge1xuICAgICAgICAgICAgICAgIHRoaXMuYWN0aW9uQ29tcGxldGVEYXRhLnVsRWxlbWVudC5hcHBlbmRDaGlsZChsaS5jbG9uZU5vZGUodHJ1ZSkpO1xuICAgICAgICAgICAgICAgIHRoaXMuYWN0aW9uQ29tcGxldGVEYXRhLmxpc3QucHVzaChpdGVtKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgRHJvcERvd25MaXN0LnByb3RvdHlwZS5mb2N1c0luZGV4SXRlbSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciB2YWx1ZSA9IHRoaXMuZ2V0SXRlbURhdGEoKS52YWx1ZTtcbiAgICAgICAgICAgIHRoaXMuYWN0aXZlSW5kZXggPSB0aGlzLmdldEluZGV4QnlWYWx1ZSh2YWx1ZSk7XG4gICAgICAgICAgICB2YXIgZWxlbWVudCA9IHRoaXMubGlzdC5xdWVyeVNlbGVjdG9yKCdbZGF0YS12YWx1ZT1cIicgKyB2YWx1ZSArICdcIl0nKTtcbiAgICAgICAgICAgIHRoaXMuc2VsZWN0ZWRMSSA9IGVsZW1lbnQ7XG4gICAgICAgICAgICB0aGlzLmFjdGl2ZUl0ZW0oZWxlbWVudCk7XG4gICAgICAgICAgICB0aGlzLnJlbW92ZUZvY3VzKCk7XG4gICAgICAgIH07XG4gICAgICAgIERyb3BEb3duTGlzdC5wcm90b3R5cGUudXBkYXRlU2VsZWN0aW9uID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIHNlbGVjdGVkSXRlbSA9IHRoaXMubGlzdC5xdWVyeVNlbGVjdG9yKCcuJyArIGRyb3BfZG93bl9iYXNlXzEuZHJvcERvd25CYXNlQ2xhc3Nlcy5zZWxlY3RlZCk7XG4gICAgICAgICAgICBpZiAoc2VsZWN0ZWRJdGVtKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5zZXRQcm9wZXJ0aWVzKHsgJ2luZGV4JzogdGhpcy5nZXRJbmRleEJ5VmFsdWUoc2VsZWN0ZWRJdGVtLmdldEF0dHJpYnV0ZSgnZGF0YS12YWx1ZScpKSB9KTtcbiAgICAgICAgICAgICAgICB0aGlzLmFjdGl2ZUluZGV4ID0gdGhpcy5pbmRleDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHRoaXMucmVtb3ZlRm9jdXMoKTtcbiAgICAgICAgICAgICAgICB0aGlzLmxpc3QucXVlcnlTZWxlY3RvcignLicgKyBkcm9wX2Rvd25fYmFzZV8xLmRyb3BEb3duQmFzZUNsYXNzZXMubGkpLmNsYXNzTGlzdC5hZGQoZXhwb3J0cy5kcm9wRG93bkxpc3RDbGFzc2VzLmZvY3VzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgRHJvcERvd25MaXN0LnByb3RvdHlwZS5yZW1vdmVGb2N1cyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciBoaWdobGlnaHRlZEl0ZW0gPSB0aGlzLmxpc3QucXVlcnlTZWxlY3RvckFsbCgnLicgKyBleHBvcnRzLmRyb3BEb3duTGlzdENsYXNzZXMuZm9jdXMpO1xuICAgICAgICAgICAgaWYgKGhpZ2hsaWdodGVkSXRlbSAmJiBoaWdobGlnaHRlZEl0ZW0ubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgZWoyX2Jhc2VfNC5yZW1vdmVDbGFzcyhoaWdobGlnaHRlZEl0ZW0sIGV4cG9ydHMuZHJvcERvd25MaXN0Q2xhc3Nlcy5mb2N1cyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIDtcbiAgICAgICAgRHJvcERvd25MaXN0LnByb3RvdHlwZS5yZW5kZXJQb3B1cCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLnBvcHVwT2JqICYmIGRvY3VtZW50LmJvZHkuY29udGFpbnModGhpcy5wb3B1cE9iai5lbGVtZW50KSkge1xuICAgICAgICAgICAgICAgIHRoaXMucmVmcmVzaFBvcHVwKCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIHBvcHVwRWxlID0gZWoyX2Jhc2VfMS5jcmVhdGVFbGVtZW50KCdkaXYnLCB7IGlkOiB0aGlzLmVsZW1lbnQuaWQgKyAnX3BvcHVwJywgY2xhc3NOYW1lOiAnZS1kZGwgZS1wb3B1cCcgfSk7XG4gICAgICAgICAgICB2YXIgc2VhcmNoQm94ID0gdGhpcy5zZXRTZWFyY2hCb3gocG9wdXBFbGUpO1xuICAgICAgICAgICAgdGhpcy5saXN0SGVpZ2h0ID0gZWoyX2Jhc2VfMi5mb3JtYXRVbml0KHRoaXMucG9wdXBIZWlnaHQpO1xuICAgICAgICAgICAgaWYgKHRoaXMuaGVhZGVyVGVtcGxhdGUpIHtcbiAgICAgICAgICAgICAgICB2YXIgY29tcGlsZWRTdHJpbmcgPSB2b2lkIDA7XG4gICAgICAgICAgICAgICAgdGhpcy5oZWFkZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICAgICAgICAgICAgICBlajJfYmFzZV80LmFkZENsYXNzKFt0aGlzLmhlYWRlcl0sIGV4cG9ydHMuZHJvcERvd25MaXN0Q2xhc3Nlcy5oZWFkZXIpO1xuICAgICAgICAgICAgICAgIGNvbXBpbGVkU3RyaW5nID0gZWoyX2Jhc2VfMS5jb21waWxlKHRoaXMuaGVhZGVyVGVtcGxhdGUpO1xuICAgICAgICAgICAgICAgIGZvciAodmFyIF9pID0gMCwgX2EgPSBjb21waWxlZFN0cmluZyh7fSk7IF9pIDwgX2EubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBpdGVtID0gX2FbX2ldO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmhlYWRlci5hcHBlbmRDaGlsZChpdGVtKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWoyX2Jhc2VfMS5hcHBlbmQoW3RoaXMuaGVhZGVyXSwgcG9wdXBFbGUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWoyX2Jhc2VfMS5hcHBlbmQoW3RoaXMubGlzdF0sIHBvcHVwRWxlKTtcbiAgICAgICAgICAgIGlmICh0aGlzLmZvb3RlclRlbXBsYXRlKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5zZXRGb290ZXJUZW1wbGF0ZShwb3B1cEVsZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKHBvcHVwRWxlKTtcbiAgICAgICAgICAgIHBvcHVwRWxlLnN0eWxlLnZpc2liaWxpdHkgPSAnaGlkZGVuJztcbiAgICAgICAgICAgIGlmICh0aGlzLnBvcHVwSGVpZ2h0ICE9PSAnYXV0bycpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnNlYXJjaEJveEhlaWdodCA9IDA7XG4gICAgICAgICAgICAgICAgaWYgKCFlajJfYmFzZV8yLmlzTnVsbE9yVW5kZWZpbmVkKHNlYXJjaEJveC5jb250YWluZXIpKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc2VhcmNoQm94SGVpZ2h0ID0gKHNlYXJjaEJveC5jb250YWluZXIucGFyZW50RWxlbWVudCkuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkuaGVpZ2h0O1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmxpc3RIZWlnaHQgPSAocGFyc2VJbnQodGhpcy5saXN0SGVpZ2h0LCAxMCkgLSAodGhpcy5zZWFyY2hCb3hIZWlnaHQpKS50b1N0cmluZygpICsgJ3B4JztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuaGVhZGVyVGVtcGxhdGUpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGhlaWdodCA9IE1hdGgucm91bmQodGhpcy5oZWFkZXIuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkuaGVpZ2h0KTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5saXN0SGVpZ2h0ID0gKHBhcnNlSW50KHRoaXMubGlzdEhlaWdodCwgMTApIC0gKGhlaWdodCArIHRoaXMuc2VhcmNoQm94SGVpZ2h0KSkudG9TdHJpbmcoKSArICdweCc7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmICh0aGlzLmZvb3RlclRlbXBsYXRlKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBoZWlnaHQgPSBNYXRoLnJvdW5kKHRoaXMuZm9vdGVyLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLmhlaWdodCk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMubGlzdEhlaWdodCA9IChwYXJzZUludCh0aGlzLmxpc3RIZWlnaHQsIDEwKSAtIChoZWlnaHQgKyB0aGlzLnNlYXJjaEJveEhlaWdodCkpLnRvU3RyaW5nKCkgKyAncHgnO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB0aGlzLmxpc3Quc3R5bGUubWF4SGVpZ2h0ID0gKHBhcnNlSW50KHRoaXMubGlzdEhlaWdodCwgMTApIC0gMikudG9TdHJpbmcoKSArICdweCc7XG4gICAgICAgICAgICAgICAgcG9wdXBFbGUuc3R5bGUubWF4SGVpZ2h0ID0gZWoyX2Jhc2VfMi5mb3JtYXRVbml0KHRoaXMucG9wdXBIZWlnaHQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgcG9wdXBFbGUuc3R5bGUuaGVpZ2h0ID0gJ2F1dG8nO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIG9mZnNldFZhbHVlID0gMDtcbiAgICAgICAgICAgIHZhciBsZWZ0O1xuICAgICAgICAgICAgaWYgKCFlajJfYmFzZV8yLmlzTnVsbE9yVW5kZWZpbmVkKHRoaXMuc2VsZWN0ZWRMSSkgJiYgKCFlajJfYmFzZV8yLmlzTnVsbE9yVW5kZWZpbmVkKHRoaXMuYWN0aXZlSW5kZXgpICYmIHRoaXMuYWN0aXZlSW5kZXggPj0gMCkpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnNldFNjcm9sbFBvc2l0aW9uKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aGlzLmxpc3Quc2Nyb2xsVG9wID0gMDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChlajJfYmFzZV8zLkJyb3dzZXIuaXNEZXZpY2UgJiYgKCF0aGlzLmFsbG93RmlsdGVyaW5nICYmICh0aGlzLmdldE1vZHVsZU5hbWUoKSA9PT0gJ2Ryb3Bkb3dubGlzdCcgfHxcbiAgICAgICAgICAgICAgICAodGhpcy5pc0Ryb3BEb3duQ2xpY2sgJiYgdGhpcy5nZXRNb2R1bGVOYW1lKCkgPT09ICdjb21ib2JveCcpKSkpIHtcbiAgICAgICAgICAgICAgICBvZmZzZXRWYWx1ZSA9IHRoaXMuZ2V0T2Zmc2V0VmFsdWUocG9wdXBFbGUpO1xuICAgICAgICAgICAgICAgIHZhciBmaXJzdEl0ZW0gPSB0aGlzLmlzRW1wdHlMaXN0KCkgPyB0aGlzLmxpc3QgOiB0aGlzLmxpQ29sbGVjdGlvbnNbMF07XG4gICAgICAgICAgICAgICAgbGVmdCA9IC0ocGFyc2VJbnQoZ2V0Q29tcHV0ZWRTdHlsZShmaXJzdEl0ZW0pLnRleHRJbmRlbnQsIDEwKSAtXG4gICAgICAgICAgICAgICAgICAgIHBhcnNlSW50KGdldENvbXB1dGVkU3R5bGUodGhpcy5pbnB1dEVsZW1lbnQpLnBhZGRpbmdMZWZ0LCAxMCkgK1xuICAgICAgICAgICAgICAgICAgICBwYXJzZUludChnZXRDb21wdXRlZFN0eWxlKHRoaXMuaW5wdXRFbGVtZW50LnBhcmVudEVsZW1lbnQpLmJvcmRlckxlZnRXaWR0aCwgMTApKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuZ2V0Rm9jdXNFbGVtZW50KCk7XG4gICAgICAgICAgICB0aGlzLmNyZWF0ZVBvcHVwKHBvcHVwRWxlLCBvZmZzZXRWYWx1ZSwgbGVmdCk7XG4gICAgICAgICAgICB0aGlzLmNoZWNrQ29sbGlzaW9uKHBvcHVwRWxlKTtcbiAgICAgICAgICAgIGlmIChlajJfYmFzZV8zLkJyb3dzZXIuaXNEZXZpY2UpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnBvcHVwT2JqLmVsZW1lbnQuY2xhc3NMaXN0LmFkZChleHBvcnRzLmRyb3BEb3duTGlzdENsYXNzZXMuZGV2aWNlKTtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5nZXRNb2R1bGVOYW1lKCkgPT09ICdkcm9wZG93bmxpc3QnIHx8ICh0aGlzLmdldE1vZHVsZU5hbWUoKSA9PT0gJ2NvbWJvYm94J1xuICAgICAgICAgICAgICAgICAgICAmJiAhdGhpcy5hbGxvd0ZpbHRlcmluZyAmJiB0aGlzLmlzRHJvcERvd25DbGljaykpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wb3B1cE9iai5jb2xsaXNpb24gPSB7IFg6ICdub25lJywgWTogJ2ZpdCcgfTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuaXNGaWx0ZXJMYXlvdXQoKSkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnBvcHVwT2JqLmVsZW1lbnQuY2xhc3NMaXN0LmFkZChleHBvcnRzLmRyb3BEb3duTGlzdENsYXNzZXMubW9iaWxlRmlsdGVyKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wb3B1cE9iai5wb3NpdGlvbiA9IHsgWDogMCwgWTogMCB9O1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnBvcHVwT2JqLmRhdGFCaW5kKCk7XG4gICAgICAgICAgICAgICAgICAgIGVqMl9iYXNlXzIuYXR0cmlidXRlcyh0aGlzLnBvcHVwT2JqLmVsZW1lbnQsIHsgc3R5bGU6ICdsZWZ0OjBweDtyaWdodDowcHg7dG9wOjBweDtib3R0b206MHB4OycgfSk7XG4gICAgICAgICAgICAgICAgICAgIGVqMl9iYXNlXzQuYWRkQ2xhc3MoW2RvY3VtZW50LmJvZHksIHRoaXMucG9wdXBPYmouZWxlbWVudF0sIGV4cG9ydHMuZHJvcERvd25MaXN0Q2xhc3Nlcy5wb3B1cEZ1bGxTY3JlZW4pO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnNldFNlYXJjaEJveFBvc2l0aW9uKCk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuYmFja0ljb25FbGVtZW50ID0gc2VhcmNoQm94LmNvbnRhaW5lci5xdWVyeVNlbGVjdG9yKCcuZS1iYWNrLWljb24nKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jbGVhckljb25FbGVtZW50ID0gc2VhcmNoQm94LmNvbnRhaW5lci5xdWVyeVNlbGVjdG9yKCcuJyArIGV4cG9ydHMuZHJvcERvd25MaXN0Q2xhc3Nlcy5jbGVhckljb24pO1xuICAgICAgICAgICAgICAgICAgICBlajJfYmFzZV8xLkV2ZW50SGFuZGxlci5hZGQodGhpcy5iYWNrSWNvbkVsZW1lbnQsICdjbGljaycsIHRoaXMuY2xpY2tPbkJhY2tJY29uLCB0aGlzKTtcbiAgICAgICAgICAgICAgICAgICAgZWoyX2Jhc2VfMS5FdmVudEhhbmRsZXIuYWRkKHRoaXMuY2xlYXJJY29uRWxlbWVudCwgJ2NsaWNrJywgdGhpcy5jbGVhclRleHQsIHRoaXMpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHBvcHVwRWxlLnN0eWxlLnZpc2liaWxpdHkgPSAndmlzaWJsZSc7XG4gICAgICAgICAgICBlajJfYmFzZV80LmFkZENsYXNzKFtwb3B1cEVsZV0sICdlLXBvcHVwLWNsb3NlJyk7XG4gICAgICAgICAgICB2YXIgc2Nyb2xsUGFyZW50RWxlbWVudHMgPSB0aGlzLnBvcHVwT2JqLmdldFNjcm9sbGFibGVQYXJlbnQodGhpcy5pbnB1dFdyYXBwZXIuY29udGFpbmVyKTtcbiAgICAgICAgICAgIGZvciAodmFyIF9iID0gMCwgc2Nyb2xsUGFyZW50RWxlbWVudHNfMSA9IHNjcm9sbFBhcmVudEVsZW1lbnRzOyBfYiA8IHNjcm9sbFBhcmVudEVsZW1lbnRzXzEubGVuZ3RoOyBfYisrKSB7XG4gICAgICAgICAgICAgICAgdmFyIGVsZW1lbnQgPSBzY3JvbGxQYXJlbnRFbGVtZW50c18xW19iXTtcbiAgICAgICAgICAgICAgICBlajJfYmFzZV8xLkV2ZW50SGFuZGxlci5hZGQoZWxlbWVudCwgJ3Njcm9sbCcsIHRoaXMuc2Nyb2xsSGFuZGxlciwgdGhpcyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoZWoyX2Jhc2VfMy5Ccm93c2VyLmlzRGV2aWNlICYmIHRoaXMuaXNGaWx0ZXJMYXlvdXQoKSkge1xuICAgICAgICAgICAgICAgIGVqMl9iYXNlXzEuRXZlbnRIYW5kbGVyLmFkZCh0aGlzLmxpc3QsICdzY3JvbGwnLCB0aGlzLmxpc3RTY3JvbGwsIHRoaXMpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWoyX2Jhc2VfMi5hdHRyaWJ1dGVzKHRoaXMudGFyZ2V0RWxlbWVudCgpLCB7ICdhcmlhLWV4cGFuZGVkJzogJ3RydWUnIH0pO1xuICAgICAgICAgICAgdmFyIGlucHV0UGFyZW50ID0gdGhpcy5pc0ZpbHRlcmluZygpID8gdGhpcy5maWx0ZXJJbnB1dC5wYXJlbnRFbGVtZW50IDogdGhpcy5pbnB1dFdyYXBwZXIuY29udGFpbmVyO1xuICAgICAgICAgICAgZWoyX2Jhc2VfNC5hZGRDbGFzcyhbaW5wdXRQYXJlbnRdLCBbZXhwb3J0cy5kcm9wRG93bkxpc3RDbGFzc2VzLmlucHV0Rm9jdXNdKTtcbiAgICAgICAgICAgIGVqMl9iYXNlXzQuYWRkQ2xhc3MoW3RoaXMuaW5wdXRXcmFwcGVyLmNvbnRhaW5lcl0sIFtleHBvcnRzLmRyb3BEb3duTGlzdENsYXNzZXMuaWNvbkFuaW1hdGlvbl0pO1xuICAgICAgICAgICAgdmFyIGFuaW1Nb2RlbCA9IHsgbmFtZTogJ0ZhZGVJbicsIGR1cmF0aW9uOiAxMDAgfTtcbiAgICAgICAgICAgIHRoaXMuYmVmb3JlUG9wdXBPcGVuID0gdHJ1ZTtcbiAgICAgICAgICAgIHZhciBldmVudEFyZ3MgPSB7IHBvcHVwOiB0aGlzLnBvcHVwT2JqIH07XG4gICAgICAgICAgICB0aGlzLnRyaWdnZXIoJ29wZW4nLCBldmVudEFyZ3MpO1xuICAgICAgICAgICAgZWoyX2Jhc2VfMS5FdmVudEhhbmRsZXIuYWRkKGRvY3VtZW50LCAnbW91c2Vkb3duJywgdGhpcy5vbkRvY3VtZW50Q2xpY2ssIHRoaXMpO1xuICAgICAgICAgICAgdGhpcy5wb3B1cE9iai5zaG93KG5ldyBlajJfYmFzZV8zLkFuaW1hdGlvbihhbmltTW9kZWwpKTtcbiAgICAgICAgfTtcbiAgICAgICAgRHJvcERvd25MaXN0LnByb3RvdHlwZS5jaGVja0NvbGxpc2lvbiA9IGZ1bmN0aW9uIChwb3B1cEVsZSkge1xuICAgICAgICAgICAgaWYgKCFlajJfYmFzZV8zLkJyb3dzZXIuaXNEZXZpY2UgfHwgKGVqMl9iYXNlXzMuQnJvd3Nlci5pc0RldmljZSAmJiAhKHRoaXMuZ2V0TW9kdWxlTmFtZSgpID09PSAnZHJvcGRvd25saXN0JyB8fCB0aGlzLmlzRHJvcERvd25DbGljaykpKSB7XG4gICAgICAgICAgICAgICAgdmFyIGNvbGxpc2lvbiA9IGVqMl9wb3B1cHNfMS5pc0NvbGxpZGUocG9wdXBFbGUpO1xuICAgICAgICAgICAgICAgIGlmIChjb2xsaXNpb24ubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgICAgICBwb3B1cEVsZS5zdHlsZS5tYXJnaW5Ub3AgPSAtcGFyc2VJbnQoZ2V0Q29tcHV0ZWRTdHlsZShwb3B1cEVsZSkubWFyZ2luVG9wLCAxMCkgKyAncHgnO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgRHJvcERvd25MaXN0LnByb3RvdHlwZS5nZXRPZmZzZXRWYWx1ZSA9IGZ1bmN0aW9uIChwb3B1cEVsZSkge1xuICAgICAgICAgICAgdmFyIHBvcHVwU3R5bGVzID0gZ2V0Q29tcHV0ZWRTdHlsZShwb3B1cEVsZSk7XG4gICAgICAgICAgICB2YXIgYm9yZGVyVG9wID0gcGFyc2VJbnQocG9wdXBTdHlsZXMuYm9yZGVyVG9wLCAxMCk7XG4gICAgICAgICAgICB2YXIgYm9yZGVyQm90dG9tID0gcGFyc2VJbnQocG9wdXBTdHlsZXMuYm9yZGVyQm90dG9tLCAxMCk7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5zZXRQb3B1cFBvc2l0aW9uKGJvcmRlclRvcCArIGJvcmRlckJvdHRvbSk7XG4gICAgICAgIH07XG4gICAgICAgIERyb3BEb3duTGlzdC5wcm90b3R5cGUuY3JlYXRlUG9wdXAgPSBmdW5jdGlvbiAoZWxlbWVudCwgb2Zmc2V0VmFsdWUsIGxlZnQpIHtcbiAgICAgICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgICAgICB0aGlzLnBvcHVwT2JqID0gbmV3IGVqMl9wb3B1cHNfMS5Qb3B1cChlbGVtZW50LCB7XG4gICAgICAgICAgICAgICAgd2lkdGg6IHRoaXMuc2V0V2lkdGgoKSwgdGFyZ2V0VHlwZTogJ3JlbGF0aXZlJyxcbiAgICAgICAgICAgICAgICByZWxhdGVUbzogdGhpcy5pbnB1dFdyYXBwZXIuY29udGFpbmVyLCBjb2xsaXNpb246IHsgWDogJ25vbmUnLCBZOiAnZmxpcCcgfSwgb2Zmc2V0WTogb2Zmc2V0VmFsdWUsXG4gICAgICAgICAgICAgICAgZW5hYmxlUnRsOiB0aGlzLmVuYWJsZVJ0bCwgb2Zmc2V0WDogbGVmdCwgcG9zaXRpb246IHsgWDogJ2xlZnQnLCBZOiAnYm90dG9tJyB9LFxuICAgICAgICAgICAgICAgIGNsb3NlOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICghX3RoaXMuaXNEb2N1bWVudENsaWNrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBfdGhpcy5mb2N1c0Ryb3BEb3duKCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgX3RoaXMuaXNEb2N1bWVudENsaWNrID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIF90aGlzLmRlc3Ryb3lQb3B1cCgpO1xuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgb3BlbjogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICBfdGhpcy5pc1BvcHVwT3BlbiA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIGlmIChfdGhpcy5pc0ZpbHRlckxheW91dCgpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBlajJfYmFzZV80LnJlbW92ZUNsYXNzKFtfdGhpcy5pbnB1dFdyYXBwZXIuY29udGFpbmVyXSwgW2V4cG9ydHMuZHJvcERvd25MaXN0Q2xhc3Nlcy5pbnB1dEZvY3VzXSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBfdGhpcy5pc0ZpbHRlckZvY3VzID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzLmZpbHRlcklucHV0LmZvY3VzKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoX3RoaXMuaW5wdXRXcmFwcGVyLmNsZWFyQnV0dG9uKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZWoyX2Jhc2VfNC5hZGRDbGFzcyhbX3RoaXMuaW5wdXRXcmFwcGVyLmNsZWFyQnV0dG9uXSwgZXhwb3J0cy5kcm9wRG93bkxpc3RDbGFzc2VzLmNsZWFySWNvbkhpZGUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIF90aGlzLmFjdGl2ZVN0YXRlQ2hhbmdlKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH07XG4gICAgICAgIERyb3BEb3duTGlzdC5wcm90b3R5cGUuaXNFbXB0eUxpc3QgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gIWVqMl9iYXNlXzIuaXNOdWxsT3JVbmRlZmluZWQodGhpcy5saUNvbGxlY3Rpb25zKSAmJiB0aGlzLmxpQ29sbGVjdGlvbnMubGVuZ3RoID09PSAwO1xuICAgICAgICB9O1xuICAgICAgICBEcm9wRG93bkxpc3QucHJvdG90eXBlLmdldEZvY3VzRWxlbWVudCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgfTtcbiAgICAgICAgRHJvcERvd25MaXN0LnByb3RvdHlwZS5pc0ZpbHRlckxheW91dCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmdldE1vZHVsZU5hbWUoKSA9PT0gJ2Ryb3Bkb3dubGlzdCcgJiYgdGhpcy5hbGxvd0ZpbHRlcmluZztcbiAgICAgICAgfTtcbiAgICAgICAgRHJvcERvd25MaXN0LnByb3RvdHlwZS5zY3JvbGxIYW5kbGVyID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgaWYgKGVqMl9iYXNlXzMuQnJvd3Nlci5pc0RldmljZSAmJiAoKHRoaXMuZ2V0TW9kdWxlTmFtZSgpID09PSAnZHJvcGRvd25saXN0JyAmJlxuICAgICAgICAgICAgICAgICF0aGlzLmlzRmlsdGVyTGF5b3V0KCkpIHx8ICh0aGlzLmdldE1vZHVsZU5hbWUoKSA9PT0gJ2NvbWJvYm94JyAmJiAhdGhpcy5hbGxvd0ZpbHRlcmluZyAmJiB0aGlzLmlzRHJvcERvd25DbGljaykpKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5oaWRlUG9wdXAoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgRHJvcERvd25MaXN0LnByb3RvdHlwZS5zZXRTZWFyY2hCb3hQb3NpdGlvbiA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciBzZWFyY2hCb3hIZWlnaHQgPSB0aGlzLmZpbHRlcklucHV0LnBhcmVudEVsZW1lbnQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkuaGVpZ2h0O1xuICAgICAgICAgICAgdGhpcy5wb3B1cE9iai5lbGVtZW50LnN0eWxlLm1heEhlaWdodCA9ICcxMDAlJztcbiAgICAgICAgICAgIHRoaXMucG9wdXBPYmouZWxlbWVudC5zdHlsZS53aWR0aCA9ICcxMDAlJztcbiAgICAgICAgICAgIHRoaXMubGlzdC5zdHlsZS5tYXhIZWlnaHQgPSAod2luZG93LmlubmVySGVpZ2h0IC0gc2VhcmNoQm94SGVpZ2h0KSArICdweCc7XG4gICAgICAgICAgICB0aGlzLmxpc3Quc3R5bGUuaGVpZ2h0ID0gKHdpbmRvdy5pbm5lckhlaWdodCAtIHNlYXJjaEJveEhlaWdodCkgKyAncHgnO1xuICAgICAgICAgICAgdmFyIGNsZWFyRWxlbWVudCA9IHRoaXMuZmlsdGVySW5wdXQucGFyZW50RWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuJyArIGV4cG9ydHMuZHJvcERvd25MaXN0Q2xhc3Nlcy5jbGVhckljb24pO1xuICAgICAgICAgICAgZWoyX2Jhc2VfNC5kZXRhY2godGhpcy5maWx0ZXJJbnB1dCk7XG4gICAgICAgICAgICBjbGVhckVsZW1lbnQucGFyZW50RWxlbWVudC5pbnNlcnRCZWZvcmUodGhpcy5maWx0ZXJJbnB1dCwgY2xlYXJFbGVtZW50KTtcbiAgICAgICAgfTtcbiAgICAgICAgRHJvcERvd25MaXN0LnByb3RvdHlwZS5zZXRQb3B1cFBvc2l0aW9uID0gZnVuY3Rpb24gKGJvcmRlcikge1xuICAgICAgICAgICAgdmFyIG9mZnNldFZhbHVlO1xuICAgICAgICAgICAgdmFyIHBvcHVwT2Zmc2V0ID0gYm9yZGVyO1xuICAgICAgICAgICAgdmFyIHNlbGVjdGVkTEkgPSB0aGlzLmxpc3QucXVlcnlTZWxlY3RvcignLicgKyBleHBvcnRzLmRyb3BEb3duTGlzdENsYXNzZXMuZm9jdXMpIHx8IHRoaXMuc2VsZWN0ZWRMSTtcbiAgICAgICAgICAgIHZhciBmaXJzdEl0ZW0gPSB0aGlzLmlzRW1wdHlMaXN0KCkgPyB0aGlzLmxpc3QgOiB0aGlzLmxpQ29sbGVjdGlvbnNbMF07XG4gICAgICAgICAgICB2YXIgbGFzdEl0ZW0gPSB0aGlzLmlzRW1wdHlMaXN0KCkgPyB0aGlzLmxpc3QgOiB0aGlzLmxpQ29sbGVjdGlvbnNbdGhpcy5nZXRJdGVtcygpLmxlbmd0aCAtIDFdO1xuICAgICAgICAgICAgdmFyIGxpSGVpZ2h0ID0gZmlyc3RJdGVtLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLmhlaWdodDtcbiAgICAgICAgICAgIHZhciBsaXN0SGVpZ2h0ID0gdGhpcy5saXN0Lm9mZnNldEhlaWdodCAvIDI7XG4gICAgICAgICAgICB2YXIgaGVpZ2h0ID0gZWoyX2Jhc2VfMi5pc051bGxPclVuZGVmaW5lZChzZWxlY3RlZExJKSA/IGZpcnN0SXRlbS5vZmZzZXRUb3AgOiBzZWxlY3RlZExJLm9mZnNldFRvcDtcbiAgICAgICAgICAgIHZhciBsYXN0SXRlbU9mZnNldFZhbHVlID0gbGFzdEl0ZW0ub2Zmc2V0VG9wO1xuICAgICAgICAgICAgaWYgKGxhc3RJdGVtT2Zmc2V0VmFsdWUgLSBsaXN0SGVpZ2h0IDwgaGVpZ2h0ICYmICFlajJfYmFzZV8yLmlzTnVsbE9yVW5kZWZpbmVkKHRoaXMubGlDb2xsZWN0aW9ucykgJiZcbiAgICAgICAgICAgICAgICB0aGlzLmxpQ29sbGVjdGlvbnMubGVuZ3RoID4gMCAmJiAhZWoyX2Jhc2VfMi5pc051bGxPclVuZGVmaW5lZChzZWxlY3RlZExJKSkge1xuICAgICAgICAgICAgICAgIHZhciBjb3VudCA9IHRoaXMubGlzdC5vZmZzZXRIZWlnaHQgLyBsaUhlaWdodDtcbiAgICAgICAgICAgICAgICB2YXIgcGFkZGluZ0JvdHRvbSA9IHBhcnNlSW50KGdldENvbXB1dGVkU3R5bGUodGhpcy5saXN0KS5wYWRkaW5nQm90dG9tLCAxMCk7XG4gICAgICAgICAgICAgICAgb2Zmc2V0VmFsdWUgPSAoY291bnQgLSAodGhpcy5saUNvbGxlY3Rpb25zLmxlbmd0aCAtIHRoaXMuYWN0aXZlSW5kZXgpKSAqIGxpSGVpZ2h0IC0gcG9wdXBPZmZzZXQgKyBwYWRkaW5nQm90dG9tO1xuICAgICAgICAgICAgICAgIHRoaXMubGlzdC5zY3JvbGxUb3AgPSBzZWxlY3RlZExJLm9mZnNldFRvcDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKGhlaWdodCA+IGxpc3RIZWlnaHQpIHtcbiAgICAgICAgICAgICAgICBvZmZzZXRWYWx1ZSA9IGxpc3RIZWlnaHQgLSBsaUhlaWdodCAvIDI7XG4gICAgICAgICAgICAgICAgdGhpcy5saXN0LnNjcm9sbFRvcCA9IGhlaWdodCAtIGxpc3RIZWlnaHQgKyBsaUhlaWdodCAvIDI7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBvZmZzZXRWYWx1ZSA9IGhlaWdodDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBpbnB1dEhlaWdodCA9IHRoaXMuaW5wdXRXcmFwcGVyLmNvbnRhaW5lci5vZmZzZXRIZWlnaHQ7XG4gICAgICAgICAgICBvZmZzZXRWYWx1ZSA9IG9mZnNldFZhbHVlICsgbGlIZWlnaHQgKyBwb3B1cE9mZnNldCAtICgobGlIZWlnaHQgLSBpbnB1dEhlaWdodCkgLyAyKTtcbiAgICAgICAgICAgIHJldHVybiAtb2Zmc2V0VmFsdWU7XG4gICAgICAgIH07XG4gICAgICAgIERyb3BEb3duTGlzdC5wcm90b3R5cGUuc2V0V2lkdGggPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgd2lkdGggPSBlajJfYmFzZV8yLmZvcm1hdFVuaXQodGhpcy5wb3B1cFdpZHRoKTtcbiAgICAgICAgICAgIGlmICh3aWR0aC5pbmRleE9mKCclJykgPiAtMSkge1xuICAgICAgICAgICAgICAgIHZhciBpbnB1dFdpZHRoID0gdGhpcy5pbnB1dFdyYXBwZXIuY29udGFpbmVyLm9mZnNldFdpZHRoICogcGFyc2VGbG9hdCh3aWR0aCkgLyAxMDA7XG4gICAgICAgICAgICAgICAgd2lkdGggPSBpbnB1dFdpZHRoLnRvU3RyaW5nKCkgKyAncHgnO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGVqMl9iYXNlXzMuQnJvd3Nlci5pc0RldmljZSAmJiAoIXRoaXMuYWxsb3dGaWx0ZXJpbmcgJiYgKHRoaXMuZ2V0TW9kdWxlTmFtZSgpID09PSAnZHJvcGRvd25saXN0JyB8fFxuICAgICAgICAgICAgICAgICh0aGlzLmlzRHJvcERvd25DbGljayAmJiB0aGlzLmdldE1vZHVsZU5hbWUoKSA9PT0gJ2NvbWJvYm94JykpKSkge1xuICAgICAgICAgICAgICAgIHZhciBmaXJzdEl0ZW0gPSB0aGlzLmlzRW1wdHlMaXN0KCkgPyB0aGlzLmxpc3QgOiB0aGlzLmxpQ29sbGVjdGlvbnNbMF07XG4gICAgICAgICAgICAgICAgd2lkdGggPSAocGFyc2VJbnQod2lkdGgsIDEwKSArIChwYXJzZUludChnZXRDb21wdXRlZFN0eWxlKGZpcnN0SXRlbSkudGV4dEluZGVudCwgMTApIC1cbiAgICAgICAgICAgICAgICAgICAgcGFyc2VJbnQoZ2V0Q29tcHV0ZWRTdHlsZSh0aGlzLmlucHV0RWxlbWVudCkucGFkZGluZ0xlZnQsIDEwKSArXG4gICAgICAgICAgICAgICAgICAgIHBhcnNlSW50KGdldENvbXB1dGVkU3R5bGUodGhpcy5pbnB1dEVsZW1lbnQucGFyZW50RWxlbWVudCkuYm9yZGVyTGVmdFdpZHRoLCAxMCkpICogMikgKyAncHgnO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHdpZHRoO1xuICAgICAgICB9O1xuICAgICAgICBEcm9wRG93bkxpc3QucHJvdG90eXBlLnNjcm9sbEJvdHRvbSA9IGZ1bmN0aW9uIChpc0luaXRpYWwpIHtcbiAgICAgICAgICAgIHZhciBjdXJyZW50T2Zmc2V0ID0gdGhpcy5saXN0Lm9mZnNldEhlaWdodDtcbiAgICAgICAgICAgIHZhciBuZXh0Qm90dG9tID0gdGhpcy5zZWxlY3RlZExJLm9mZnNldFRvcCArIHRoaXMuc2VsZWN0ZWRMSS5vZmZzZXRIZWlnaHQgLSB0aGlzLmxpc3Quc2Nyb2xsVG9wO1xuICAgICAgICAgICAgdmFyIG5leHRPZmZzZXQgPSB0aGlzLmxpc3Quc2Nyb2xsVG9wICsgbmV4dEJvdHRvbSAtIGN1cnJlbnRPZmZzZXQ7XG4gICAgICAgICAgICBuZXh0T2Zmc2V0ID0gaXNJbml0aWFsID8gbmV4dE9mZnNldCArIHBhcnNlSW50KGdldENvbXB1dGVkU3R5bGUodGhpcy5saXN0KS5wYWRkaW5nVG9wLCAxMCkgKiAyIDogbmV4dE9mZnNldDtcbiAgICAgICAgICAgIHZhciBib3hSYW5nZSA9IHRoaXMuc2VsZWN0ZWRMSS5vZmZzZXRUb3AgKyB0aGlzLnNlbGVjdGVkTEkub2Zmc2V0SGVpZ2h0IC0gdGhpcy5saXN0LnNjcm9sbFRvcDtcbiAgICAgICAgICAgIGJveFJhbmdlID0gdGhpcy5maWVsZHMuZ3JvdXBCeSAmJiAhZWoyX2Jhc2VfMi5pc051bGxPclVuZGVmaW5lZCh0aGlzLmZpeGVkSGVhZGVyRWxlbWVudCkgP1xuICAgICAgICAgICAgICAgIGJveFJhbmdlIC0gdGhpcy5maXhlZEhlYWRlckVsZW1lbnQub2Zmc2V0SGVpZ2h0IDogYm94UmFuZ2U7XG4gICAgICAgICAgICBpZiAodGhpcy5hY3RpdmVJbmRleCA9PT0gMCkge1xuICAgICAgICAgICAgICAgIHRoaXMubGlzdC5zY3JvbGxUb3AgPSAwO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAobmV4dEJvdHRvbSA+IGN1cnJlbnRPZmZzZXQgfHwgIShib3hSYW5nZSA+IDAgJiYgdGhpcy5saXN0Lm9mZnNldEhlaWdodCA+IGJveFJhbmdlKSkge1xuICAgICAgICAgICAgICAgIHRoaXMubGlzdC5zY3JvbGxUb3AgPSBuZXh0T2Zmc2V0O1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICBEcm9wRG93bkxpc3QucHJvdG90eXBlLnNjcm9sbFRvcCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciBuZXh0T2Zmc2V0ID0gdGhpcy5zZWxlY3RlZExJLm9mZnNldFRvcCAtIHRoaXMubGlzdC5zY3JvbGxUb3A7XG4gICAgICAgICAgICB2YXIgbmV4dEJvdHRvbSA9IHRoaXMuc2VsZWN0ZWRMSS5vZmZzZXRUb3AgKyB0aGlzLnNlbGVjdGVkTEkub2Zmc2V0SGVpZ2h0IC0gdGhpcy5saXN0LnNjcm9sbFRvcDtcbiAgICAgICAgICAgIG5leHRPZmZzZXQgPSB0aGlzLmZpZWxkcy5ncm91cEJ5ICYmICFlajJfYmFzZV8yLmlzTnVsbE9yVW5kZWZpbmVkKHRoaXMuZml4ZWRIZWFkZXJFbGVtZW50KSA/XG4gICAgICAgICAgICAgICAgbmV4dE9mZnNldCAtIHRoaXMuZml4ZWRIZWFkZXJFbGVtZW50Lm9mZnNldEhlaWdodCA6IG5leHRPZmZzZXQ7XG4gICAgICAgICAgICB2YXIgYm94UmFuZ2UgPSAodGhpcy5zZWxlY3RlZExJLm9mZnNldFRvcCArIHRoaXMuc2VsZWN0ZWRMSS5vZmZzZXRIZWlnaHQgLSB0aGlzLmxpc3Quc2Nyb2xsVG9wKTtcbiAgICAgICAgICAgIGlmICh0aGlzLmFjdGl2ZUluZGV4ID09PSAwKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5saXN0LnNjcm9sbFRvcCA9IDA7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChuZXh0T2Zmc2V0IDwgMCkge1xuICAgICAgICAgICAgICAgIHRoaXMubGlzdC5zY3JvbGxUb3AgPSB0aGlzLmxpc3Quc2Nyb2xsVG9wICsgbmV4dE9mZnNldDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKCEoYm94UmFuZ2UgPiAwICYmIHRoaXMubGlzdC5vZmZzZXRIZWlnaHQgPiBib3hSYW5nZSkpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmxpc3Quc2Nyb2xsVG9wID0gdGhpcy5zZWxlY3RlZExJLm9mZnNldFRvcCAtICh0aGlzLmZpZWxkcy5ncm91cEJ5ICYmICFlajJfYmFzZV8yLmlzTnVsbE9yVW5kZWZpbmVkKHRoaXMuZml4ZWRIZWFkZXJFbGVtZW50KSA/XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZml4ZWRIZWFkZXJFbGVtZW50Lm9mZnNldEhlaWdodCA6IDApO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICBEcm9wRG93bkxpc3QucHJvdG90eXBlLmlzRWRpdFRleHRCb3ggPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH07XG4gICAgICAgIERyb3BEb3duTGlzdC5wcm90b3R5cGUuaXNGaWx0ZXJpbmcgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5hbGxvd0ZpbHRlcmluZztcbiAgICAgICAgfTtcbiAgICAgICAgRHJvcERvd25MaXN0LnByb3RvdHlwZS5pc1BvcHVwQnV0dG9uID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH07XG4gICAgICAgIERyb3BEb3duTGlzdC5wcm90b3R5cGUuc2V0U2Nyb2xsUG9zaXRpb24gPSBmdW5jdGlvbiAoZSkge1xuICAgICAgICAgICAgaWYgKCFlajJfYmFzZV8yLmlzTnVsbE9yVW5kZWZpbmVkKGUpKSB7XG4gICAgICAgICAgICAgICAgc3dpdGNoIChlLmFjdGlvbikge1xuICAgICAgICAgICAgICAgICAgICBjYXNlICdwYWdlRG93bic6XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgJ2Rvd24nOlxuICAgICAgICAgICAgICAgICAgICBjYXNlICdlbmQnOlxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zY3JvbGxCb3R0b20oKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zY3JvbGxUb3AoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHRoaXMuc2Nyb2xsQm90dG9tKHRydWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICBEcm9wRG93bkxpc3QucHJvdG90eXBlLmNsZWFyVGV4dCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHRoaXMuZmlsdGVySW5wdXQudmFsdWUgPSAnJztcbiAgICAgICAgICAgIHRoaXMuc2VhcmNoTGlzdHMobnVsbCk7XG4gICAgICAgIH07XG4gICAgICAgIERyb3BEb3duTGlzdC5wcm90b3R5cGUubGlzdFNjcm9sbCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHRoaXMuZmlsdGVySW5wdXQuYmx1cigpO1xuICAgICAgICB9O1xuICAgICAgICBEcm9wRG93bkxpc3QucHJvdG90eXBlLmNsb3NlUG9wdXAgPSBmdW5jdGlvbiAoZGVsYXkpIHtcbiAgICAgICAgICAgIHRoaXMuaXNUeXBlZCA9IGZhbHNlO1xuICAgICAgICAgICAgaWYgKCEodGhpcy5wb3B1cE9iaiAmJiBkb2N1bWVudC5ib2R5LmNvbnRhaW5zKHRoaXMucG9wdXBPYmouZWxlbWVudCkpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWoyX2Jhc2VfMS5FdmVudEhhbmRsZXIucmVtb3ZlKGRvY3VtZW50LCAnbW91c2Vkb3duJywgdGhpcy5vbkRvY3VtZW50Q2xpY2spO1xuICAgICAgICAgICAgdGhpcy5pc0FjdGl2ZSA9IGZhbHNlO1xuICAgICAgICAgICAgdGhpcy5maWx0ZXJJbnB1dE9iaiA9IG51bGw7XG4gICAgICAgICAgICB0aGlzLmlzRHJvcERvd25DbGljayA9IGZhbHNlO1xuICAgICAgICAgICAgdGhpcy5wcmV2ZW50QXV0b0ZpbGwgPSBmYWxzZTtcbiAgICAgICAgICAgIHZhciBzY3JvbGxhYmxlUGFyZW50RWxlbWVudHMgPSB0aGlzLnBvcHVwT2JqLmdldFNjcm9sbGFibGVQYXJlbnQodGhpcy5pbnB1dFdyYXBwZXIuY29udGFpbmVyKTtcbiAgICAgICAgICAgIGZvciAodmFyIF9pID0gMCwgc2Nyb2xsYWJsZVBhcmVudEVsZW1lbnRzXzEgPSBzY3JvbGxhYmxlUGFyZW50RWxlbWVudHM7IF9pIDwgc2Nyb2xsYWJsZVBhcmVudEVsZW1lbnRzXzEubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgICAgICAgICAgdmFyIGVsZW1lbnQgPSBzY3JvbGxhYmxlUGFyZW50RWxlbWVudHNfMVtfaV07XG4gICAgICAgICAgICAgICAgZWoyX2Jhc2VfMS5FdmVudEhhbmRsZXIucmVtb3ZlKGVsZW1lbnQsICdzY3JvbGwnLCB0aGlzLnNjcm9sbEhhbmRsZXIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGVqMl9iYXNlXzMuQnJvd3Nlci5pc0RldmljZSAmJiB0aGlzLmlzRmlsdGVyTGF5b3V0KCkpIHtcbiAgICAgICAgICAgICAgICBlajJfYmFzZV80LnJlbW92ZUNsYXNzKFtkb2N1bWVudC5ib2R5LCB0aGlzLnBvcHVwT2JqLmVsZW1lbnRdLCBleHBvcnRzLmRyb3BEb3duTGlzdENsYXNzZXMucG9wdXBGdWxsU2NyZWVuKTtcbiAgICAgICAgICAgICAgICBlajJfYmFzZV8xLkV2ZW50SGFuZGxlci5yZW1vdmUodGhpcy5saXN0LCAnc2Nyb2xsJywgdGhpcy5saXN0U2Nyb2xsKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh0aGlzLmlzRmlsdGVyTGF5b3V0KCkpIHtcbiAgICAgICAgICAgICAgICBpZiAoIWVqMl9iYXNlXzMuQnJvd3Nlci5pc0RldmljZSkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnNlYXJjaEtleU1vZHVsZS5kZXN0cm95KCk7XG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmNsZWFySWNvbkVsZW1lbnQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGVqMl9iYXNlXzEuRXZlbnRIYW5kbGVyLnJlbW92ZSh0aGlzLmNsZWFySWNvbkVsZW1lbnQsICdjbGljaycsIHRoaXMuY2xlYXJUZXh0KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAodGhpcy5iYWNrSWNvbkVsZW1lbnQpIHtcbiAgICAgICAgICAgICAgICAgICAgZWoyX2Jhc2VfMS5FdmVudEhhbmRsZXIucmVtb3ZlKHRoaXMuYmFja0ljb25FbGVtZW50LCAnY2xpY2snLCB0aGlzLmNsaWNrT25CYWNrSWNvbik7XG4gICAgICAgICAgICAgICAgICAgIGVqMl9iYXNlXzEuRXZlbnRIYW5kbGVyLnJlbW92ZSh0aGlzLmNsZWFySWNvbkVsZW1lbnQsICdjbGljaycsIHRoaXMuY2xlYXJUZXh0KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWoyX2Jhc2VfMS5FdmVudEhhbmRsZXIucmVtb3ZlKHRoaXMuZmlsdGVySW5wdXQsICdpbnB1dCcsIHRoaXMub25JbnB1dCk7XG4gICAgICAgICAgICAgICAgZWoyX2Jhc2VfMS5FdmVudEhhbmRsZXIucmVtb3ZlKHRoaXMuZmlsdGVySW5wdXQsICdrZXl1cCcsIHRoaXMub25GaWx0ZXJVcCk7XG4gICAgICAgICAgICAgICAgZWoyX2Jhc2VfMS5FdmVudEhhbmRsZXIucmVtb3ZlKHRoaXMuZmlsdGVySW5wdXQsICdrZXlkb3duJywgdGhpcy5vbkZpbHRlckRvd24pO1xuICAgICAgICAgICAgICAgIGVqMl9iYXNlXzEuRXZlbnRIYW5kbGVyLnJlbW92ZSh0aGlzLmZpbHRlcklucHV0LCAnYmx1cicsIHRoaXMub25CbHVyKTtcbiAgICAgICAgICAgICAgICB0aGlzLmZpbHRlcklucHV0ID0gbnVsbDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVqMl9iYXNlXzIuYXR0cmlidXRlcyh0aGlzLnRhcmdldEVsZW1lbnQoKSwgeyAnYXJpYS1leHBhbmRlZCc6ICdmYWxzZScsICdhcmlhLWFjdGl2ZWRlc2NlbmRhbnQnOiBudWxsIH0pO1xuICAgICAgICAgICAgdGhpcy5pbnB1dFdyYXBwZXIuY29udGFpbmVyLmNsYXNzTGlzdC5yZW1vdmUoZXhwb3J0cy5kcm9wRG93bkxpc3RDbGFzc2VzLmljb25BbmltYXRpb24pO1xuICAgICAgICAgICAgaWYgKHRoaXMuaXNGaWx0ZXJpbmcoKSkge1xuICAgICAgICAgICAgICAgIHRoaXMuYWN0aW9uQ29tcGxldGVEYXRhLmlzVXBkYXRlZCA9IGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5iZWZvcmVQb3B1cE9wZW4gPSBmYWxzZTtcbiAgICAgICAgICAgIHZhciBldmVudEFyZ3MgPSB7IHBvcHVwOiB0aGlzLnBvcHVwT2JqIH07XG4gICAgICAgICAgICB0aGlzLnRyaWdnZXIoJ2Nsb3NlJywgZXZlbnRBcmdzKTtcbiAgICAgICAgICAgIHZhciBhbmltTW9kZWwgPSB7XG4gICAgICAgICAgICAgICAgbmFtZTogJ0ZhZGVPdXQnLFxuICAgICAgICAgICAgICAgIGR1cmF0aW9uOiAxMDAsXG4gICAgICAgICAgICAgICAgZGVsYXk6IGRlbGF5ID8gZGVsYXkgOiAwXG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgaWYgKHRoaXMuZ2V0TW9kdWxlTmFtZSgpID09PSAnYXV0b2NvbXBsZXRlJykge1xuICAgICAgICAgICAgICAgIHRoaXMucmlwcGxlRnVuKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAodGhpcy5pc1BvcHVwT3Blbikge1xuICAgICAgICAgICAgICAgIHRoaXMucG9wdXBPYmouaGlkZShuZXcgZWoyX2Jhc2VfMy5BbmltYXRpb24oYW5pbU1vZGVsKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aGlzLmRlc3Ryb3lQb3B1cCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICBEcm9wRG93bkxpc3QucHJvdG90eXBlLmRlc3Ryb3lQb3B1cCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHRoaXMuaXNQb3B1cE9wZW4gPSBmYWxzZTtcbiAgICAgICAgICAgIHRoaXMuaXNGaWx0ZXJGb2N1cyA9IGZhbHNlO1xuICAgICAgICAgICAgdGhpcy5wb3B1cE9iai5kZXN0cm95KCk7XG4gICAgICAgICAgICBlajJfYmFzZV80LmRldGFjaCh0aGlzLnBvcHVwT2JqLmVsZW1lbnQpO1xuICAgICAgICB9O1xuICAgICAgICBEcm9wRG93bkxpc3QucHJvdG90eXBlLmNsaWNrT25CYWNrSWNvbiA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHRoaXMuaGlkZVBvcHVwKCk7XG4gICAgICAgICAgICB0aGlzLmZvY3VzSW4oKTtcbiAgICAgICAgfTtcbiAgICAgICAgRHJvcERvd25MaXN0LnByb3RvdHlwZS5yZW5kZXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5lbGVtZW50LnRhZ05hbWUgPT09ICdJTlBVVCcpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmlucHV0RWxlbWVudCA9IHRoaXMuZWxlbWVudDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHRoaXMuaW5wdXRFbGVtZW50ID0gZWoyX2Jhc2VfMS5jcmVhdGVFbGVtZW50KCdpbnB1dCcpO1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLmVsZW1lbnQudGFnTmFtZSAhPT0gdGhpcy5nZXROZ0RpcmVjdGl2ZSgpKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZWxlbWVudC5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB0aGlzLmVsZW1lbnQucGFyZW50RWxlbWVudC5pbnNlcnRCZWZvcmUodGhpcy5pbnB1dEVsZW1lbnQsIHRoaXMuZWxlbWVudCk7XG4gICAgICAgICAgICAgICAgdGhpcy5wcmV2ZW50VGFiSW5kZXgodGhpcy5pbnB1dEVsZW1lbnQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5pbnB1dFdyYXBwZXIgPSBlajJfaW5wdXRzXzEuSW5wdXQuY3JlYXRlSW5wdXQoe1xuICAgICAgICAgICAgICAgIGVsZW1lbnQ6IHRoaXMuaW5wdXRFbGVtZW50LFxuICAgICAgICAgICAgICAgIGJ1dHRvbnM6IHRoaXMuaXNQb3B1cEJ1dHRvbigpID8gW2V4cG9ydHMuZHJvcERvd25MaXN0Q2xhc3Nlcy5pY29uXSA6IG51bGwsXG4gICAgICAgICAgICAgICAgZmxvYXRMYWJlbFR5cGU6IHRoaXMuZmxvYXRMYWJlbFR5cGUsXG4gICAgICAgICAgICAgICAgcHJvcGVydGllczoge1xuICAgICAgICAgICAgICAgICAgICByZWFkb25seTogdGhpcy5nZXRNb2R1bGVOYW1lKCkgPT09ICdkcm9wZG93bmxpc3QnID8gdHJ1ZSA6IHRoaXMucmVhZG9ubHksXG4gICAgICAgICAgICAgICAgICAgIHBsYWNlaG9sZGVyOiB0aGlzLnBsYWNlaG9sZGVyLFxuICAgICAgICAgICAgICAgICAgICBjc3NDbGFzczogdGhpcy5jc3NDbGFzcyxcbiAgICAgICAgICAgICAgICAgICAgZW5hYmxlZDogdGhpcy5lbmFibGVkLFxuICAgICAgICAgICAgICAgICAgICBlbmFibGVSdGw6IHRoaXMuZW5hYmxlUnRsLFxuICAgICAgICAgICAgICAgICAgICBzaG93Q2xlYXJCdXR0b246IHRoaXMuc2hvd0NsZWFyQnV0dG9uXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgaWYgKHRoaXMuZWxlbWVudC50YWdOYW1lID09PSB0aGlzLmdldE5nRGlyZWN0aXZlKCkpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmVsZW1lbnQuYXBwZW5kQ2hpbGQodGhpcy5pbnB1dFdyYXBwZXIuY29udGFpbmVyKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHRoaXMuaW5wdXRFbGVtZW50LnBhcmVudEVsZW1lbnQuaW5zZXJ0QmVmb3JlKHRoaXMuZWxlbWVudCwgdGhpcy5pbnB1dEVsZW1lbnQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIG5hbWUgPSB0aGlzLmVsZW1lbnQuZ2V0QXR0cmlidXRlKCduYW1lJykgPyB0aGlzLmVsZW1lbnQuZ2V0QXR0cmlidXRlKCduYW1lJykgOiB0aGlzLmVsZW1lbnQuZ2V0QXR0cmlidXRlKCdpZCcpO1xuICAgICAgICAgICAgdGhpcy5oaWRkZW5FbGVtZW50ID0gZWoyX2Jhc2VfMS5jcmVhdGVFbGVtZW50KCdzZWxlY3QnLCB7XG4gICAgICAgICAgICAgICAgYXR0cnM6IHsgJ25hbWUnOiBuYW1lLCAnYXJpYS1oaWRkZW4nOiAndHJ1ZScgfSwgc3R5bGVzOiAnZGlzcGxheTpub25lJ1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBlajJfYmFzZV80LnByZXBlbmQoW3RoaXMuaGlkZGVuRWxlbWVudF0sIHRoaXMuaW5wdXRXcmFwcGVyLmNvbnRhaW5lcik7XG4gICAgICAgICAgICB0aGlzLmVsZW1lbnQucmVtb3ZlQXR0cmlidXRlKCduYW1lJyk7XG4gICAgICAgICAgICB0aGlzLnNldEZpZWxkcygpO1xuICAgICAgICAgICAgdGhpcy5pbnB1dFdyYXBwZXIuY29udGFpbmVyLnN0eWxlLndpZHRoID0gZWoyX2Jhc2VfMi5mb3JtYXRVbml0KHRoaXMud2lkdGgpO1xuICAgICAgICAgICAgdGhpcy5pbnB1dFdyYXBwZXIuY29udGFpbmVyLmNsYXNzTGlzdC5hZGQoJ2UtZGRsJyk7XG4gICAgICAgICAgICB0aGlzLndpcmVFdmVudCgpO1xuICAgICAgICAgICAgdGhpcy50YWJJbmRleCA9IHRoaXMuZWxlbWVudC5oYXNBdHRyaWJ1dGUoJ3RhYmluZGV4JykgPyB0aGlzLmVsZW1lbnQuZ2V0QXR0cmlidXRlKCd0YWJpbmRleCcpIDogJzAnO1xuICAgICAgICAgICAgdGhpcy5lbGVtZW50LnJlbW92ZUF0dHJpYnV0ZSgndGFiaW5kZXgnKTtcbiAgICAgICAgICAgIHZhciBpZCA9IHRoaXMuZWxlbWVudC5nZXRBdHRyaWJ1dGUoJ2lkJykgPyB0aGlzLmVsZW1lbnQuZ2V0QXR0cmlidXRlKCdpZCcpIDogZWoyX2Jhc2VfMi5nZXRVbmlxdWVJRCgnZWoyX2Ryb3Bkb3dubGlzdCcpO1xuICAgICAgICAgICAgdGhpcy5lbGVtZW50LmlkID0gaWQ7XG4gICAgICAgICAgICB0aGlzLmhpZGRlbkVsZW1lbnQuaWQgPSBpZCArICdfaGlkZGVuJztcbiAgICAgICAgICAgIHRoaXMudGFyZ2V0RWxlbWVudCgpLnNldEF0dHJpYnV0ZSgndGFiaW5kZXgnLCB0aGlzLnRhYkluZGV4KTtcbiAgICAgICAgICAgIGVqMl9iYXNlXzIuYXR0cmlidXRlcyh0aGlzLnRhcmdldEVsZW1lbnQoKSwgdGhpcy5nZXRBcmlhQXR0cmlidXRlcygpKTtcbiAgICAgICAgICAgIHRoaXMuc2V0SFRNTEF0dHJpYnV0ZXMoKTtcbiAgICAgICAgICAgIGlmICh0aGlzLnZhbHVlICE9PSBudWxsIHx8IHRoaXMuYWN0aXZlSW5kZXggIT09IG51bGwgfHwgdGhpcy50ZXh0ICE9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5pbml0VmFsdWUoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKHRoaXMuZWxlbWVudC50YWdOYW1lID09PSAnU0VMRUNUJyAmJiB0aGlzLmVsZW1lbnQub3B0aW9uc1swXSkge1xuICAgICAgICAgICAgICAgIHZhciBzZWxlY3RFbGVtZW50ID0gdGhpcy5lbGVtZW50O1xuICAgICAgICAgICAgICAgIHRoaXMudmFsdWUgPSBzZWxlY3RFbGVtZW50Lm9wdGlvbnNbc2VsZWN0RWxlbWVudC5zZWxlY3RlZEluZGV4XS52YWx1ZTtcbiAgICAgICAgICAgICAgICB0aGlzLnRleHQgPSBlajJfYmFzZV8yLmlzTnVsbE9yVW5kZWZpbmVkKHRoaXMudmFsdWUpID8gbnVsbCA6IHNlbGVjdEVsZW1lbnQub3B0aW9uc1tzZWxlY3RFbGVtZW50LnNlbGVjdGVkSW5kZXhdLnRleHRDb250ZW50O1xuICAgICAgICAgICAgICAgIHRoaXMuaW5pdFZhbHVlKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLnByZXZlbnRUYWJJbmRleCh0aGlzLmVsZW1lbnQpO1xuICAgICAgICAgICAgaWYgKCF0aGlzLmVuYWJsZWQpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnRhcmdldEVsZW1lbnQoKS50YWJJbmRleCA9IC0xO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5pbml0aWFsID0gZmFsc2U7XG4gICAgICAgICAgICB0aGlzLmVsZW1lbnQuc3R5bGUub3BhY2l0eSA9ICcnO1xuICAgICAgICB9O1xuICAgICAgICA7XG4gICAgICAgIERyb3BEb3duTGlzdC5wcm90b3R5cGUuc2V0Rm9vdGVyVGVtcGxhdGUgPSBmdW5jdGlvbiAocG9wdXBFbGUpIHtcbiAgICAgICAgICAgIHZhciBjb21waWxlZFN0cmluZztcbiAgICAgICAgICAgIGlmICh0aGlzLmZvb3Rlcikge1xuICAgICAgICAgICAgICAgIHRoaXMuZm9vdGVyLmlubmVySFRNTCA9ICcnO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpcy5mb290ZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICAgICAgICAgICAgICBlajJfYmFzZV80LmFkZENsYXNzKFt0aGlzLmZvb3Rlcl0sIGV4cG9ydHMuZHJvcERvd25MaXN0Q2xhc3Nlcy5mb290ZXIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY29tcGlsZWRTdHJpbmcgPSBlajJfYmFzZV8xLmNvbXBpbGUodGhpcy5mb290ZXJUZW1wbGF0ZSk7XG4gICAgICAgICAgICBmb3IgKHZhciBfaSA9IDAsIF9hID0gY29tcGlsZWRTdHJpbmcoe30pOyBfaSA8IF9hLmxlbmd0aDsgX2krKykge1xuICAgICAgICAgICAgICAgIHZhciBpdGVtID0gX2FbX2ldO1xuICAgICAgICAgICAgICAgIHRoaXMuZm9vdGVyLmFwcGVuZENoaWxkKGl0ZW0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWoyX2Jhc2VfMS5hcHBlbmQoW3RoaXMuZm9vdGVyXSwgcG9wdXBFbGUpO1xuICAgICAgICB9O1xuICAgICAgICBEcm9wRG93bkxpc3QucHJvdG90eXBlLnNldE9sZFRleHQgPSBmdW5jdGlvbiAodGV4dCkge1xuICAgICAgICAgICAgdGhpcy50ZXh0ID0gdGV4dDtcbiAgICAgICAgfTtcbiAgICAgICAgRHJvcERvd25MaXN0LnByb3RvdHlwZS5zZXRPbGRWYWx1ZSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgdGhpcy52YWx1ZSA9IHZhbHVlO1xuICAgICAgICB9O1xuICAgICAgICBEcm9wRG93bkxpc3QucHJvdG90eXBlLnJlZnJlc2hQb3B1cCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGlmICghZWoyX2Jhc2VfMi5pc051bGxPclVuZGVmaW5lZCh0aGlzLnBvcHVwT2JqKSAmJiBkb2N1bWVudC5ib2R5LmNvbnRhaW5zKHRoaXMucG9wdXBPYmouZWxlbWVudCkgJiZcbiAgICAgICAgICAgICAgICAoKHRoaXMuYWxsb3dGaWx0ZXJpbmcgJiYgIShlajJfYmFzZV8zLkJyb3dzZXIuaXNEZXZpY2UgJiYgdGhpcy5pc0ZpbHRlckxheW91dCgpKSkgfHwgdGhpcy5nZXRNb2R1bGVOYW1lKCkgPT09ICdhdXRvY29tcGxldGUnKSkge1xuICAgICAgICAgICAgICAgIHRoaXMucG9wdXBPYmoucmVmcmVzaFBvc2l0aW9uKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIERyb3BEb3duTGlzdC5wcm90b3R5cGUub25Qcm9wZXJ0eUNoYW5nZWQgPSBmdW5jdGlvbiAobmV3UHJvcCwgb2xkUHJvcCkge1xuICAgICAgICAgICAgZm9yICh2YXIgX2kgPSAwLCBfYSA9IE9iamVjdC5rZXlzKG5ld1Byb3ApOyBfaSA8IF9hLmxlbmd0aDsgX2krKykge1xuICAgICAgICAgICAgICAgIHZhciBwcm9wID0gX2FbX2ldO1xuICAgICAgICAgICAgICAgIHN3aXRjaCAocHJvcCkge1xuICAgICAgICAgICAgICAgICAgICBjYXNlICdodG1sQXR0cmlidXRlcyc6XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnNldEhUTUxBdHRyaWJ1dGVzKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAnd2lkdGgnOlxuICAgICAgICAgICAgICAgICAgICAgICAgZWoyX2Jhc2VfNC5zZXRTdHlsZUF0dHJpYnV0ZSh0aGlzLmlucHV0V3JhcHBlci5jb250YWluZXIsIHsgJ3dpZHRoJzogZWoyX2Jhc2VfMi5mb3JtYXRVbml0KG5ld1Byb3Aud2lkdGgpIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgJ3BsYWNlaG9sZGVyJzpcbiAgICAgICAgICAgICAgICAgICAgICAgIGVqMl9pbnB1dHNfMS5JbnB1dC5zZXRQbGFjZWhvbGRlcihuZXdQcm9wLnBsYWNlaG9sZGVyLCB0aGlzLmlucHV0RWxlbWVudCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAnZmlsdGVyQmFyUGxhY2Vob2xkZXInOlxuICAgICAgICAgICAgICAgICAgICAgICAgZWoyX2lucHV0c18xLklucHV0LnNldFBsYWNlaG9sZGVyKG5ld1Byb3AuZmlsdGVyQmFyUGxhY2Vob2xkZXIsIHRoaXMuZmlsdGVySW5wdXQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgJ3JlYWRvbmx5JzpcbiAgICAgICAgICAgICAgICAgICAgICAgIGVqMl9pbnB1dHNfMS5JbnB1dC5zZXRSZWFkb25seShuZXdQcm9wLnJlYWRvbmx5LCB0aGlzLmlucHV0RWxlbWVudCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAnY3NzQ2xhc3MnOlxuICAgICAgICAgICAgICAgICAgICAgICAgZWoyX2lucHV0c18xLklucHV0LnNldENzc0NsYXNzKG5ld1Byb3AuY3NzQ2xhc3MsIFt0aGlzLmlucHV0V3JhcHBlci5jb250YWluZXJdKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLnBvcHVwT2JqKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wb3B1cE9iai5lbGVtZW50LmNsYXNzTGlzdC5hZGQobmV3UHJvcC5jc3NDbGFzcyk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAnZW5hYmxlUnRsJzpcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2V0RW5hYmxlUnRsKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAnZW5hYmxlZCc6XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnNldEVuYWJsZSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgJ3RleHQnOlxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG5ld1Byb3AudGV4dCA9PT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuY2xlYXIoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXRoaXMubGlzdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmRhdGFTb3VyY2UgaW5zdGFuY2VvZiBlajJfZGF0YV8xLkRhdGFNYW5hZ2VyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuaW5pdFJlbW90ZVJlbmRlciA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucmVuZGVyTGlzdCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCF0aGlzLmluaXRSZW1vdGVSZW5kZXIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgbGkgPSB0aGlzLmdldEVsZW1lbnRCeVRleHQobmV3UHJvcC50ZXh0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5pc1ZhbGlkTEkobGkpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2V0U2VsZWN0aW9uKGxpLCBudWxsKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2V0T2xkVGV4dChvbGRQcm9wLnRleHQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICBjYXNlICd2YWx1ZSc6XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAobmV3UHJvcC52YWx1ZSA9PT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuY2xlYXIoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXRoaXMubGlzdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmRhdGFTb3VyY2UgaW5zdGFuY2VvZiBlajJfZGF0YV8xLkRhdGFNYW5hZ2VyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuaW5pdFJlbW90ZVJlbmRlciA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucmVuZGVyTGlzdCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCF0aGlzLmluaXRSZW1vdGVSZW5kZXIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgaXRlbSA9IHRoaXMuZ2V0RWxlbWVudEJ5VmFsdWUobmV3UHJvcC52YWx1ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuaXNWYWxpZExJKGl0ZW0pKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2V0U2VsZWN0aW9uKGl0ZW0sIG51bGwpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zZXRPbGRWYWx1ZShvbGRQcm9wLnZhbHVlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAnaW5kZXgnOlxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG5ld1Byb3AuaW5kZXggPT09IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmNsZWFyKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCF0aGlzLmxpc3QpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5kYXRhU291cmNlIGluc3RhbmNlb2YgZWoyX2RhdGFfMS5EYXRhTWFuYWdlcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmluaXRSZW1vdGVSZW5kZXIgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnJlbmRlckxpc3QoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghdGhpcy5pbml0UmVtb3RlUmVuZGVyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGVsZW1lbnQgPSB0aGlzLmxpQ29sbGVjdGlvbnNbbmV3UHJvcC5pbmRleF07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuaXNWYWxpZExJKGVsZW1lbnQpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2V0U2VsZWN0aW9uKGVsZW1lbnQsIG51bGwpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5pbmRleCA9IG9sZFByb3AuaW5kZXg7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgJ3F1ZXJ5JzpcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAnZGF0YVNvdXJjZSc6XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmNsZWFyKHByb3ApO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5yZXNldExpc3QodGhpcy5kYXRhU291cmNlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICBjYXNlICdmb290ZXJUZW1wbGF0ZSc6XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5wb3B1cE9iaikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2V0Rm9vdGVyVGVtcGxhdGUodGhpcy5wb3B1cE9iai5lbGVtZW50KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICBjYXNlICdmbG9hdExhYmVsVHlwZSc6XG4gICAgICAgICAgICAgICAgICAgICAgICBlajJfaW5wdXRzXzEuSW5wdXQucmVtb3ZlRmxvYXRpbmcodGhpcy5pbnB1dFdyYXBwZXIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgZWoyX2lucHV0c18xLklucHV0LmFkZEZsb2F0aW5nKHRoaXMuaW5wdXRFbGVtZW50LCBuZXdQcm9wLmZsb2F0TGFiZWxUeXBlLCB0aGlzLnBsYWNlaG9sZGVyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGRkbFByb3BzID0gdm9pZCAwO1xuICAgICAgICAgICAgICAgICAgICAgICAgZGRsUHJvcHMgPSB0aGlzLmdldFByb3BPYmplY3QocHJvcCwgbmV3UHJvcCwgb2xkUHJvcCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBfc3VwZXIucHJvdG90eXBlLm9uUHJvcGVydHlDaGFuZ2VkLmNhbGwodGhpcywgZGRsUHJvcHMubmV3UHJvcGVydHksIGRkbFByb3BzLm9sZFByb3BlcnR5KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgRHJvcERvd25MaXN0LnByb3RvdHlwZS5nZXRNb2R1bGVOYW1lID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuICdkcm9wZG93bmxpc3QnO1xuICAgICAgICB9O1xuICAgICAgICBEcm9wRG93bkxpc3QucHJvdG90eXBlLnNob3dQb3B1cCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLmJlZm9yZVBvcHVwT3Blbikge1xuICAgICAgICAgICAgICAgIHRoaXMucmVmcmVzaFBvcHVwKCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5iZWZvcmVQb3B1cE9wZW4gPSB0cnVlO1xuICAgICAgICAgICAgaWYgKHRoaXMuaXNGaWx0ZXJpbmcoKSAmJiAhdGhpcy5pc0FjdGl2ZSAmJiB0aGlzLmFjdGlvbkNvbXBsZXRlRGF0YS5saXN0ICYmIHRoaXMuYWN0aW9uQ29tcGxldGVEYXRhLmxpc3RbMF0pIHtcbiAgICAgICAgICAgICAgICB0aGlzLmlzQWN0aXZlID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB0aGlzLm9uQWN0aW9uQ29tcGxldGUodGhpcy5hY3Rpb25Db21wbGV0ZURhdGEudWxFbGVtZW50LCB0aGlzLmFjdGlvbkNvbXBsZXRlRGF0YS5saXN0LCBudWxsLCB0cnVlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKGVqMl9iYXNlXzIuaXNOdWxsT3JVbmRlZmluZWQodGhpcy5saXN0KSB8fCAhZWoyX2Jhc2VfMi5pc1VuZGVmaW5lZCh0aGlzLmxpc3QpICYmIHRoaXMubGlzdC5jbGFzc0xpc3QuY29udGFpbnMoZHJvcF9kb3duX2Jhc2VfMS5kcm9wRG93bkJhc2VDbGFzc2VzLm5vRGF0YSkpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnJlbmRlckxpc3QoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChlajJfYmFzZV8zLkJyb3dzZXIuaXNEZXZpY2UgJiYgdGhpcy5pc0ZpbHRlckxheW91dCgpKSB7XG4gICAgICAgICAgICAgICAgdmFyIHByb3h5XzEgPSB0aGlzO1xuICAgICAgICAgICAgICAgIHdpbmRvdy5vbnBvcHN0YXRlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICBwcm94eV8xLmhpZGVQb3B1cCgpO1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgaGlzdG9yeS5wdXNoU3RhdGUoe30sICcnKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICghZWoyX2Jhc2VfMi5pc051bGxPclVuZGVmaW5lZCh0aGlzLmxpc3QuY2hpbGRyZW5bMF0pIHx8IHRoaXMubGlzdC5jbGFzc0xpc3QuY29udGFpbnMoZHJvcF9kb3duX2Jhc2VfMS5kcm9wRG93bkJhc2VDbGFzc2VzLm5vRGF0YSkpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnJlbmRlclBvcHVwKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlajJfYmFzZV8yLmF0dHJpYnV0ZXModGhpcy50YXJnZXRFbGVtZW50KCksIHsgJ2FyaWEtYWN0aXZlZGVzY2VuZGFudCc6IHRoaXMuc2VsZWN0ZWRMSSA/IHRoaXMuc2VsZWN0ZWRMSS5pZCA6IG51bGwgfSk7XG4gICAgICAgIH07XG4gICAgICAgIERyb3BEb3duTGlzdC5wcm90b3R5cGUuaGlkZVBvcHVwID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgaWYgKHRoaXMuaXNFc2NhcGVLZXkgJiYgdGhpcy5nZXRNb2R1bGVOYW1lKCkgPT09ICdkcm9wZG93bmxpc3QnKSB7XG4gICAgICAgICAgICAgICAgZWoyX2lucHV0c18xLklucHV0LnNldFZhbHVlKHRoaXMudGV4dCwgdGhpcy5pbnB1dEVsZW1lbnQsIHRoaXMuZmxvYXRMYWJlbFR5cGUsIHRoaXMuc2hvd0NsZWFyQnV0dG9uKTtcbiAgICAgICAgICAgICAgICB0aGlzLmlzRXNjYXBlS2V5ID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgaWYgKCFlajJfYmFzZV8yLmlzTnVsbE9yVW5kZWZpbmVkKHRoaXMuaW5kZXgpKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc2VsZWN0ZWRMSSA9IHRoaXMubGlDb2xsZWN0aW9uc1t0aGlzLmluZGV4XTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy51cGRhdGVTZWxlY3RlZEl0ZW0odGhpcy5zZWxlY3RlZExJLCBudWxsLCB0cnVlKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMudmFsdWVUZW1wbGF0ZSAmJiB0aGlzLml0ZW1EYXRhICE9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnNldFZhbHVlVGVtcGxhdGUoKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5yZXNldFNlbGVjdGlvbigpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuY2xvc2VQb3B1cCgpO1xuICAgICAgICAgICAgdmFyIGRhdGFJdGVtID0gdGhpcy5nZXRJdGVtRGF0YSgpO1xuICAgICAgICAgICAgaWYgKHRoaXMuaW5wdXRFbGVtZW50LnZhbHVlLnRyaW0oKSA9PT0gJycgJiYgIXRoaXMuaXNJbnRlcmFjdGVkICYmICh0aGlzLmlzU2VsZWN0Q3VzdG9tIHx8XG4gICAgICAgICAgICAgICAgIWVqMl9iYXNlXzIuaXNOdWxsT3JVbmRlZmluZWQodGhpcy5zZWxlY3RlZExJKSAmJiB0aGlzLmlucHV0RWxlbWVudC52YWx1ZSAhPT0gZGF0YUl0ZW0udGV4dCkpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmlzU2VsZWN0Q3VzdG9tID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgdGhpcy5jbGVhcigpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICBEcm9wRG93bkxpc3QucHJvdG90eXBlLmZvY3VzSW4gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBpZiAodGhpcy50YXJnZXRFbGVtZW50KCkuY2xhc3NMaXN0LmNvbnRhaW5zKGV4cG9ydHMuZHJvcERvd25MaXN0Q2xhc3Nlcy5kaXNhYmxlKSkge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBpc0ZvY3VzZWQgPSBmYWxzZTtcbiAgICAgICAgICAgIGlmICh0aGlzLnByZXZlbnRGb2N1cyAmJiBlajJfYmFzZV8zLkJyb3dzZXIuaXNEZXZpY2UpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmlucHV0V3JhcHBlci5jb250YWluZXIudGFiSW5kZXggPSAxO1xuICAgICAgICAgICAgICAgIHRoaXMuaW5wdXRXcmFwcGVyLmNvbnRhaW5lci5mb2N1cygpO1xuICAgICAgICAgICAgICAgIHRoaXMucHJldmVudEZvY3VzID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgaXNGb2N1c2VkID0gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICghaXNGb2N1c2VkKSB7XG4gICAgICAgICAgICAgICAgdGhpcy50YXJnZXRFbGVtZW50KCkuZm9jdXMoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVqMl9iYXNlXzQuYWRkQ2xhc3MoW3RoaXMuaW5wdXRXcmFwcGVyLmNvbnRhaW5lcl0sIFtleHBvcnRzLmRyb3BEb3duTGlzdENsYXNzZXMuaW5wdXRGb2N1c10pO1xuICAgICAgICAgICAgdGhpcy5vbkZvY3VzKCk7XG4gICAgICAgIH07XG4gICAgICAgIERyb3BEb3duTGlzdC5wcm90b3R5cGUuZm9jdXNPdXQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB0aGlzLmlzVHlwZWQgPSB0cnVlO1xuICAgICAgICAgICAgdGhpcy5oaWRlUG9wdXAoKTtcbiAgICAgICAgICAgIHRoaXMudGFyZ2V0RWxlbWVudCgpLmJsdXIoKTtcbiAgICAgICAgICAgIGVqMl9iYXNlXzQucmVtb3ZlQ2xhc3MoW3RoaXMuaW5wdXRXcmFwcGVyLmNvbnRhaW5lcl0sIFtleHBvcnRzLmRyb3BEb3duTGlzdENsYXNzZXMuaW5wdXRGb2N1c10pO1xuICAgICAgICB9O1xuICAgICAgICBEcm9wRG93bkxpc3QucHJvdG90eXBlLmRlc3Ryb3kgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICAgICAgdGhpcy5pc0FjdGl2ZSA9IGZhbHNlO1xuICAgICAgICAgICAgdGhpcy5oaWRlUG9wdXAoKTtcbiAgICAgICAgICAgIHRoaXMudW5XaXJlRXZlbnQoKTtcbiAgICAgICAgICAgIGlmICh0aGlzLmxpc3QpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnVuV2lyZUxpc3RFdmVudHMoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFsncmVhZG9ubHknLCAnYXJpYS1kaXNhYmxlZCcsICdhcmlhLXBsYWNlaG9sZGVyJywgJ3BsYWNlaG9sZGVyJ10uZm9yRWFjaChmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgICAgICBfdGhpcy5pbnB1dEVsZW1lbnQucmVtb3ZlQXR0cmlidXRlKHZhbHVlKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgdGhpcy5pbnB1dEVsZW1lbnQuc2V0QXR0cmlidXRlKCd0YWJpbmRleCcsIHRoaXMudGFiSW5kZXgpO1xuICAgICAgICAgICAgdGhpcy5pbnB1dEVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSgnZS1pbnB1dCcpO1xuICAgICAgICAgICAgZWoyX2lucHV0c18xLklucHV0LnNldFZhbHVlKCcnLCB0aGlzLmlucHV0RWxlbWVudCwgdGhpcy5mbG9hdExhYmVsVHlwZSwgdGhpcy5zaG93Q2xlYXJCdXR0b24pO1xuICAgICAgICAgICAgdGhpcy5lbGVtZW50LnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snO1xuICAgICAgICAgICAgaWYgKHRoaXMuaW5wdXRXcmFwcGVyLmNvbnRhaW5lci5wYXJlbnRFbGVtZW50LnRhZ05hbWUgPT09IHRoaXMuZ2V0TmdEaXJlY3RpdmUoKSkge1xuICAgICAgICAgICAgICAgIGVqMl9iYXNlXzQuZGV0YWNoKHRoaXMuaW5wdXRXcmFwcGVyLmNvbnRhaW5lcik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aGlzLmlucHV0V3JhcHBlci5jb250YWluZXIucGFyZW50RWxlbWVudC5pbnNlcnRCZWZvcmUodGhpcy5lbGVtZW50LCB0aGlzLmlucHV0V3JhcHBlci5jb250YWluZXIpO1xuICAgICAgICAgICAgICAgIGVqMl9iYXNlXzQuZGV0YWNoKHRoaXMuaW5wdXRXcmFwcGVyLmNvbnRhaW5lcik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBfc3VwZXIucHJvdG90eXBlLmRlc3Ryb3kuY2FsbCh0aGlzKTtcbiAgICAgICAgfTtcbiAgICAgICAgO1xuICAgICAgICByZXR1cm4gRHJvcERvd25MaXN0O1xuICAgIH0oZHJvcF9kb3duX2Jhc2VfMS5Ecm9wRG93bkJhc2UpKTtcbiAgICBfX2RlY29yYXRlKFtcbiAgICAgICAgZWoyX2Jhc2VfMS5Qcm9wZXJ0eShudWxsKVxuICAgIF0sIERyb3BEb3duTGlzdC5wcm90b3R5cGUsIFwiY3NzQ2xhc3NcIiwgdm9pZCAwKTtcbiAgICBfX2RlY29yYXRlKFtcbiAgICAgICAgZWoyX2Jhc2VfMS5Qcm9wZXJ0eSgnMTAwJScpXG4gICAgXSwgRHJvcERvd25MaXN0LnByb3RvdHlwZSwgXCJ3aWR0aFwiLCB2b2lkIDApO1xuICAgIF9fZGVjb3JhdGUoW1xuICAgICAgICBlajJfYmFzZV8xLlByb3BlcnR5KCczMDBweCcpXG4gICAgXSwgRHJvcERvd25MaXN0LnByb3RvdHlwZSwgXCJwb3B1cEhlaWdodFwiLCB2b2lkIDApO1xuICAgIF9fZGVjb3JhdGUoW1xuICAgICAgICBlajJfYmFzZV8xLlByb3BlcnR5KCcxMDAlJylcbiAgICBdLCBEcm9wRG93bkxpc3QucHJvdG90eXBlLCBcInBvcHVwV2lkdGhcIiwgdm9pZCAwKTtcbiAgICBfX2RlY29yYXRlKFtcbiAgICAgICAgZWoyX2Jhc2VfMS5Qcm9wZXJ0eShudWxsKVxuICAgIF0sIERyb3BEb3duTGlzdC5wcm90b3R5cGUsIFwicGxhY2Vob2xkZXJcIiwgdm9pZCAwKTtcbiAgICBfX2RlY29yYXRlKFtcbiAgICAgICAgZWoyX2Jhc2VfMS5Qcm9wZXJ0eShudWxsKVxuICAgIF0sIERyb3BEb3duTGlzdC5wcm90b3R5cGUsIFwiZmlsdGVyQmFyUGxhY2Vob2xkZXJcIiwgdm9pZCAwKTtcbiAgICBfX2RlY29yYXRlKFtcbiAgICAgICAgZWoyX2Jhc2VfMS5Qcm9wZXJ0eSh7fSlcbiAgICBdLCBEcm9wRG93bkxpc3QucHJvdG90eXBlLCBcImh0bWxBdHRyaWJ1dGVzXCIsIHZvaWQgMCk7XG4gICAgX19kZWNvcmF0ZShbXG4gICAgICAgIGVqMl9iYXNlXzEuUHJvcGVydHkobnVsbClcbiAgICBdLCBEcm9wRG93bkxpc3QucHJvdG90eXBlLCBcInF1ZXJ5XCIsIHZvaWQgMCk7XG4gICAgX19kZWNvcmF0ZShbXG4gICAgICAgIGVqMl9iYXNlXzEuUHJvcGVydHkobnVsbClcbiAgICBdLCBEcm9wRG93bkxpc3QucHJvdG90eXBlLCBcInZhbHVlVGVtcGxhdGVcIiwgdm9pZCAwKTtcbiAgICBfX2RlY29yYXRlKFtcbiAgICAgICAgZWoyX2Jhc2VfMS5Qcm9wZXJ0eShudWxsKVxuICAgIF0sIERyb3BEb3duTGlzdC5wcm90b3R5cGUsIFwiaGVhZGVyVGVtcGxhdGVcIiwgdm9pZCAwKTtcbiAgICBfX2RlY29yYXRlKFtcbiAgICAgICAgZWoyX2Jhc2VfMS5Qcm9wZXJ0eShudWxsKVxuICAgIF0sIERyb3BEb3duTGlzdC5wcm90b3R5cGUsIFwiZm9vdGVyVGVtcGxhdGVcIiwgdm9pZCAwKTtcbiAgICBfX2RlY29yYXRlKFtcbiAgICAgICAgZWoyX2Jhc2VfMS5Qcm9wZXJ0eShmYWxzZSlcbiAgICBdLCBEcm9wRG93bkxpc3QucHJvdG90eXBlLCBcImFsbG93RmlsdGVyaW5nXCIsIHZvaWQgMCk7XG4gICAgX19kZWNvcmF0ZShbXG4gICAgICAgIGVqMl9iYXNlXzEuUHJvcGVydHkoZmFsc2UpXG4gICAgXSwgRHJvcERvd25MaXN0LnByb3RvdHlwZSwgXCJyZWFkb25seVwiLCB2b2lkIDApO1xuICAgIF9fZGVjb3JhdGUoW1xuICAgICAgICBlajJfYmFzZV8xLlByb3BlcnR5KG51bGwpXG4gICAgXSwgRHJvcERvd25MaXN0LnByb3RvdHlwZSwgXCJ0ZXh0XCIsIHZvaWQgMCk7XG4gICAgX19kZWNvcmF0ZShbXG4gICAgICAgIGVqMl9iYXNlXzEuUHJvcGVydHkobnVsbClcbiAgICBdLCBEcm9wRG93bkxpc3QucHJvdG90eXBlLCBcInZhbHVlXCIsIHZvaWQgMCk7XG4gICAgX19kZWNvcmF0ZShbXG4gICAgICAgIGVqMl9iYXNlXzEuUHJvcGVydHkobnVsbClcbiAgICBdLCBEcm9wRG93bkxpc3QucHJvdG90eXBlLCBcImluZGV4XCIsIHZvaWQgMCk7XG4gICAgX19kZWNvcmF0ZShbXG4gICAgICAgIGVqMl9iYXNlXzEuUHJvcGVydHkoJ05ldmVyJylcbiAgICBdLCBEcm9wRG93bkxpc3QucHJvdG90eXBlLCBcImZsb2F0TGFiZWxUeXBlXCIsIHZvaWQgMCk7XG4gICAgX19kZWNvcmF0ZShbXG4gICAgICAgIGVqMl9iYXNlXzEuUHJvcGVydHkoZmFsc2UpXG4gICAgXSwgRHJvcERvd25MaXN0LnByb3RvdHlwZSwgXCJzaG93Q2xlYXJCdXR0b25cIiwgdm9pZCAwKTtcbiAgICBfX2RlY29yYXRlKFtcbiAgICAgICAgZWoyX2Jhc2VfMS5FdmVudCgpXG4gICAgXSwgRHJvcERvd25MaXN0LnByb3RvdHlwZSwgXCJmaWx0ZXJpbmdcIiwgdm9pZCAwKTtcbiAgICBfX2RlY29yYXRlKFtcbiAgICAgICAgZWoyX2Jhc2VfMS5FdmVudCgpXG4gICAgXSwgRHJvcERvd25MaXN0LnByb3RvdHlwZSwgXCJjaGFuZ2VcIiwgdm9pZCAwKTtcbiAgICBfX2RlY29yYXRlKFtcbiAgICAgICAgZWoyX2Jhc2VfMS5FdmVudCgpXG4gICAgXSwgRHJvcERvd25MaXN0LnByb3RvdHlwZSwgXCJvcGVuXCIsIHZvaWQgMCk7XG4gICAgX19kZWNvcmF0ZShbXG4gICAgICAgIGVqMl9iYXNlXzEuRXZlbnQoKVxuICAgIF0sIERyb3BEb3duTGlzdC5wcm90b3R5cGUsIFwiY2xvc2VcIiwgdm9pZCAwKTtcbiAgICBfX2RlY29yYXRlKFtcbiAgICAgICAgZWoyX2Jhc2VfMS5FdmVudCgpXG4gICAgXSwgRHJvcERvd25MaXN0LnByb3RvdHlwZSwgXCJibHVyXCIsIHZvaWQgMCk7XG4gICAgX19kZWNvcmF0ZShbXG4gICAgICAgIGVqMl9iYXNlXzEuRXZlbnQoKVxuICAgIF0sIERyb3BEb3duTGlzdC5wcm90b3R5cGUsIFwiZm9jdXNcIiwgdm9pZCAwKTtcbiAgICBEcm9wRG93bkxpc3QgPSBfX2RlY29yYXRlKFtcbiAgICAgICAgZWoyX2Jhc2VfMy5Ob3RpZnlQcm9wZXJ0eUNoYW5nZXNcbiAgICBdLCBEcm9wRG93bkxpc3QpO1xuICAgIGV4cG9ydHMuRHJvcERvd25MaXN0ID0gRHJvcERvd25MaXN0O1xufSk7XG5cblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL3NyYy9kcm9wLWRvd24tbGlzdC9kcm9wLWRvd24tbGlzdC5qc1xuLy8gbW9kdWxlIGlkID0gMTBcbi8vIG1vZHVsZSBjaHVua3MgPSAwIiwibW9kdWxlLmV4cG9ydHMgPSBfX1dFQlBBQ0tfRVhURVJOQUxfTU9EVUxFXzExX187XG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gZXh0ZXJuYWwgXCJAc3luY2Z1c2lvbi9lajItcG9wdXBzXCJcbi8vIG1vZHVsZSBpZCA9IDExXG4vLyBtb2R1bGUgY2h1bmtzID0gMCIsIm1vZHVsZS5leHBvcnRzID0gX19XRUJQQUNLX0VYVEVSTkFMX01PRFVMRV8xMl9fO1xuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIGV4dGVybmFsIFwiQHN5bmNmdXNpb24vZWoyLWlucHV0c1wiXG4vLyBtb2R1bGUgaWQgPSAxMlxuLy8gbW9kdWxlIGNodW5rcyA9IDAiLCJkZWZpbmUoW1wicmVxdWlyZVwiLCBcImV4cG9ydHNcIiwgXCIuL2NvbWJvLWJveFwiXSwgZnVuY3Rpb24gKHJlcXVpcmUsIGV4cG9ydHMsIGNvbWJvX2JveF8xKSB7XG4gICAgXCJ1c2Ugc3RyaWN0XCI7XG4gICAgZnVuY3Rpb24gX19leHBvcnQobSkge1xuICAgICAgICBmb3IgKHZhciBwIGluIG0pIGlmICghZXhwb3J0cy5oYXNPd25Qcm9wZXJ0eShwKSkgZXhwb3J0c1twXSA9IG1bcF07XG4gICAgfVxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbiAgICBfX2V4cG9ydChjb21ib19ib3hfMSk7XG59KTtcblxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vc3JjL2NvbWJvLWJveC9pbmRleC5qc1xuLy8gbW9kdWxlIGlkID0gMTNcbi8vIG1vZHVsZSBjaHVua3MgPSAwIiwidmFyIF9fZXh0ZW5kcyA9ICh0aGlzICYmIHRoaXMuX19leHRlbmRzKSB8fCAoZnVuY3Rpb24gKCkge1xuICAgIHZhciBleHRlbmRTdGF0aWNzID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8XG4gICAgICAgICh7IF9fcHJvdG9fXzogW10gfSBpbnN0YW5jZW9mIEFycmF5ICYmIGZ1bmN0aW9uIChkLCBiKSB7IGQuX19wcm90b19fID0gYjsgfSkgfHxcbiAgICAgICAgZnVuY3Rpb24gKGQsIGIpIHsgZm9yICh2YXIgcCBpbiBiKSBpZiAoYi5oYXNPd25Qcm9wZXJ0eShwKSkgZFtwXSA9IGJbcF07IH07XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChkLCBiKSB7XG4gICAgICAgIGV4dGVuZFN0YXRpY3MoZCwgYik7XG4gICAgICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfVxuICAgICAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7XG4gICAgfTtcbn0pKCk7XG52YXIgX19kZWNvcmF0ZSA9ICh0aGlzICYmIHRoaXMuX19kZWNvcmF0ZSkgfHwgZnVuY3Rpb24gKGRlY29yYXRvcnMsIHRhcmdldCwga2V5LCBkZXNjKSB7XG4gICAgdmFyIGMgPSBhcmd1bWVudHMubGVuZ3RoLCByID0gYyA8IDMgPyB0YXJnZXQgOiBkZXNjID09PSBudWxsID8gZGVzYyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IodGFyZ2V0LCBrZXkpIDogZGVzYywgZDtcbiAgICBpZiAodHlwZW9mIFJlZmxlY3QgPT09IFwib2JqZWN0XCIgJiYgdHlwZW9mIFJlZmxlY3QuZGVjb3JhdGUgPT09IFwiZnVuY3Rpb25cIikgciA9IFJlZmxlY3QuZGVjb3JhdGUoZGVjb3JhdG9ycywgdGFyZ2V0LCBrZXksIGRlc2MpO1xuICAgIGVsc2UgZm9yICh2YXIgaSA9IGRlY29yYXRvcnMubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pIGlmIChkID0gZGVjb3JhdG9yc1tpXSkgciA9IChjIDwgMyA/IGQocikgOiBjID4gMyA/IGQodGFyZ2V0LCBrZXksIHIpIDogZCh0YXJnZXQsIGtleSkpIHx8IHI7XG4gICAgcmV0dXJuIGMgPiAzICYmIHIgJiYgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwga2V5LCByKSwgcjtcbn07XG5kZWZpbmUoW1wicmVxdWlyZVwiLCBcImV4cG9ydHNcIiwgXCJAc3luY2Z1c2lvbi9lajItYmFzZVwiLCBcIkBzeW5jZnVzaW9uL2VqMi1iYXNlXCIsIFwiLi4vZHJvcC1kb3duLWxpc3QvZHJvcC1kb3duLWxpc3RcIiwgXCIuLi9kcm9wLWRvd24tYmFzZS9kcm9wLWRvd24tYmFzZVwiLCBcIi4uL2NvbW1vbi9pbmNyZW1lbnRhbC1zZWFyY2hcIiwgXCJAc3luY2Z1c2lvbi9lajItcG9wdXBzXCIsIFwiQHN5bmNmdXNpb24vZWoyLWlucHV0c1wiXSwgZnVuY3Rpb24gKHJlcXVpcmUsIGV4cG9ydHMsIGVqMl9iYXNlXzEsIGVqMl9iYXNlXzIsIGRyb3BfZG93bl9saXN0XzEsIGRyb3BfZG93bl9iYXNlXzEsIGluY3JlbWVudGFsX3NlYXJjaF8xLCBlajJfcG9wdXBzXzEsIGVqMl9pbnB1dHNfMSkge1xuICAgIFwidXNlIHN0cmljdFwiO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbiAgICBkcm9wX2Rvd25fbGlzdF8xLmRyb3BEb3duTGlzdENsYXNzZXMucm9vdCA9ICdlLWNvbWJvYm94JztcbiAgICB2YXIgaW5wdXRPYmplY3QgPSB7XG4gICAgICAgIGNvbnRhaW5lcjogbnVsbCxcbiAgICAgICAgYnV0dG9uczogW11cbiAgICB9O1xuICAgIHZhciBDb21ib0JveCA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgICAgIF9fZXh0ZW5kcyhDb21ib0JveCwgX3N1cGVyKTtcbiAgICAgICAgZnVuY3Rpb24gQ29tYm9Cb3gob3B0aW9ucywgZWxlbWVudCkge1xuICAgICAgICAgICAgcmV0dXJuIF9zdXBlci5jYWxsKHRoaXMsIG9wdGlvbnMsIGVsZW1lbnQpIHx8IHRoaXM7XG4gICAgICAgIH1cbiAgICAgICAgO1xuICAgICAgICBDb21ib0JveC5wcm90b3R5cGUucHJlUmVuZGVyID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5wcmVSZW5kZXIuY2FsbCh0aGlzKTtcbiAgICAgICAgfTtcbiAgICAgICAgQ29tYm9Cb3gucHJvdG90eXBlLndpcmVFdmVudCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLmdldE1vZHVsZU5hbWUoKSA9PT0gJ2NvbWJvYm94Jykge1xuICAgICAgICAgICAgICAgIGVqMl9iYXNlXzEuRXZlbnRIYW5kbGVyLmFkZCh0aGlzLmlucHV0V3JhcHBlci5idXR0b25zWzBdLCAnbW91c2Vkb3duJywgdGhpcy5wcmV2ZW50Qmx1ciwgdGhpcyk7XG4gICAgICAgICAgICAgICAgZWoyX2Jhc2VfMS5FdmVudEhhbmRsZXIuYWRkKHRoaXMuaW5wdXRXcmFwcGVyLmNvbnRhaW5lciwgJ2JsdXInLCB0aGlzLm9uQmx1ciwgdGhpcyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoIWVqMl9iYXNlXzIuaXNOdWxsT3JVbmRlZmluZWQodGhpcy5pbnB1dFdyYXBwZXIuYnV0dG9uc1swXSkpIHtcbiAgICAgICAgICAgICAgICBlajJfYmFzZV8xLkV2ZW50SGFuZGxlci5hZGQodGhpcy5pbnB1dFdyYXBwZXIuYnV0dG9uc1swXSwgJ21vdXNlZG93bicsIHRoaXMuZHJvcERvd25DbGljaywgdGhpcyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlajJfYmFzZV8xLkV2ZW50SGFuZGxlci5hZGQodGhpcy5pbnB1dEVsZW1lbnQsICdmb2N1cycsIHRoaXMudGFyZ2V0Rm9jdXMsIHRoaXMpO1xuICAgICAgICAgICAgaWYgKCF0aGlzLnJlYWRvbmx5KSB7XG4gICAgICAgICAgICAgICAgZWoyX2Jhc2VfMS5FdmVudEhhbmRsZXIuYWRkKHRoaXMuaW5wdXRFbGVtZW50LCAnaW5wdXQnLCB0aGlzLm9uSW5wdXQsIHRoaXMpO1xuICAgICAgICAgICAgICAgIGVqMl9iYXNlXzEuRXZlbnRIYW5kbGVyLmFkZCh0aGlzLmlucHV0RWxlbWVudCwgJ2tleXVwJywgdGhpcy5vbkZpbHRlclVwLCB0aGlzKTtcbiAgICAgICAgICAgICAgICBlajJfYmFzZV8xLkV2ZW50SGFuZGxlci5hZGQodGhpcy5pbnB1dEVsZW1lbnQsICdrZXlkb3duJywgdGhpcy5vbkZpbHRlckRvd24sIHRoaXMpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5iaW5kQ29tbW9uRXZlbnQoKTtcbiAgICAgICAgfTtcbiAgICAgICAgQ29tYm9Cb3gucHJvdG90eXBlLnByZXZlbnRCbHVyID0gZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgIGlmICgoIXRoaXMuYWxsb3dGaWx0ZXJpbmcgJiYgZG9jdW1lbnQuYWN0aXZlRWxlbWVudCAhPT0gdGhpcy5pbnB1dEVsZW1lbnQgJiZcbiAgICAgICAgICAgICAgICAhZG9jdW1lbnQuYWN0aXZlRWxlbWVudC5jbGFzc0xpc3QuY29udGFpbnMoZHJvcF9kb3duX2xpc3RfMS5kcm9wRG93bkxpc3RDbGFzc2VzLmlucHV0KSAmJiBlajJfYmFzZV8xLkJyb3dzZXIuaXNEZXZpY2UgfHwgIWVqMl9iYXNlXzEuQnJvd3Nlci5pc0RldmljZSkpIHtcbiAgICAgICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIENvbWJvQm94LnByb3RvdHlwZS50YXJnZXRFbGVtZW50ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuaW5wdXRFbGVtZW50O1xuICAgICAgICB9O1xuICAgICAgICBDb21ib0JveC5wcm90b3R5cGUuc2V0T2xkVGV4dCA9IGZ1bmN0aW9uICh0ZXh0KSB7XG4gICAgICAgICAgICBlajJfaW5wdXRzXzEuSW5wdXQuc2V0VmFsdWUodGhpcy50ZXh0LCB0aGlzLmlucHV0RWxlbWVudCwgdGhpcy5mbG9hdExhYmVsVHlwZSwgdGhpcy5zaG93Q2xlYXJCdXR0b24pO1xuICAgICAgICAgICAgdGhpcy5jdXN0b21WYWx1ZSgpO1xuICAgICAgICAgICAgdGhpcy5yZW1vdmVTZWxlY3Rpb24oKTtcbiAgICAgICAgfTtcbiAgICAgICAgQ29tYm9Cb3gucHJvdG90eXBlLnNldE9sZFZhbHVlID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5hbGxvd0N1c3RvbSkge1xuICAgICAgICAgICAgICAgIHRoaXMudmFsdWVNdXRlQ2hhbmdlKHRoaXMudmFsdWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpcy52YWx1ZU11dGVDaGFuZ2UobnVsbCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLnJlbW92ZVNlbGVjdGlvbigpO1xuICAgICAgICAgICAgdGhpcy5zZXRIaWRkZW5WYWx1ZSgpO1xuICAgICAgICB9O1xuICAgICAgICBDb21ib0JveC5wcm90b3R5cGUudmFsdWVNdXRlQ2hhbmdlID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICB2YXIgaW5wdXRWYWx1ZSA9IGVqMl9iYXNlXzIuaXNOdWxsT3JVbmRlZmluZWQodmFsdWUpID8gbnVsbCA6IHZhbHVlLnRvU3RyaW5nKCk7XG4gICAgICAgICAgICBlajJfaW5wdXRzXzEuSW5wdXQuc2V0VmFsdWUoaW5wdXRWYWx1ZSwgdGhpcy5pbnB1dEVsZW1lbnQsIHRoaXMuZmxvYXRMYWJlbFR5cGUsIHRoaXMuc2hvd0NsZWFyQnV0dG9uKTtcbiAgICAgICAgICAgIHRoaXMuc2V0UHJvcGVydGllcyh7IHZhbHVlOiB2YWx1ZSwgdGV4dDogdmFsdWUsIGluZGV4OiBudWxsIH0sIHRydWUpO1xuICAgICAgICAgICAgdGhpcy5hY3RpdmVJbmRleCA9IHRoaXMuaW5kZXg7XG4gICAgICAgICAgICB2YXIgZmllbGRzID0gdGhpcy5maWVsZHM7XG4gICAgICAgICAgICB2YXIgZGF0YUl0ZW0gPSB7fTtcbiAgICAgICAgICAgIGRhdGFJdGVtW2ZpZWxkcy50ZXh0XSA9IGVqMl9iYXNlXzIuaXNOdWxsT3JVbmRlZmluZWQodmFsdWUpID8gbnVsbCA6IHZhbHVlLnRvU3RyaW5nKCk7XG4gICAgICAgICAgICBkYXRhSXRlbVtmaWVsZHMudmFsdWVdID0gZWoyX2Jhc2VfMi5pc051bGxPclVuZGVmaW5lZCh2YWx1ZSkgPyBudWxsIDogdmFsdWUudG9TdHJpbmcoKTtcbiAgICAgICAgICAgIHRoaXMuaXRlbURhdGEgPSBkYXRhSXRlbTtcbiAgICAgICAgICAgIHRoaXMuaXRlbSA9IG51bGw7XG4gICAgICAgICAgICBpZiAodGhpcy5wcmV2aW91c1ZhbHVlICE9PSB0aGlzLnZhbHVlKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5kZXRhY2hDaGFuZ2VFdmVudChudWxsKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgQ29tYm9Cb3gucHJvdG90eXBlLnVwZGF0ZVZhbHVlcyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGlmICghZWoyX2Jhc2VfMi5pc051bGxPclVuZGVmaW5lZCh0aGlzLnZhbHVlKSkge1xuICAgICAgICAgICAgICAgIHZhciBsaSA9IHRoaXMuZ2V0RWxlbWVudEJ5VmFsdWUodGhpcy52YWx1ZSk7XG4gICAgICAgICAgICAgICAgaWYgKGxpKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc2V0U2VsZWN0aW9uKGxpLCBudWxsKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSBpZiAodGhpcy5hbGxvd0N1c3RvbSkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnZhbHVlTXV0ZUNoYW5nZSh0aGlzLnZhbHVlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMudmFsdWVNdXRlQ2hhbmdlKG51bGwpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKHRoaXMudGV4dCAmJiBlajJfYmFzZV8yLmlzTnVsbE9yVW5kZWZpbmVkKHRoaXMudmFsdWUpKSB7XG4gICAgICAgICAgICAgICAgdmFyIGxpID0gdGhpcy5nZXRFbGVtZW50QnlUZXh0KHRoaXMudGV4dCk7XG4gICAgICAgICAgICAgICAgaWYgKGxpKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc2V0U2VsZWN0aW9uKGxpLCBudWxsKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGVqMl9pbnB1dHNfMS5JbnB1dC5zZXRWYWx1ZSh0aGlzLnRleHQsIHRoaXMuaW5wdXRFbGVtZW50LCB0aGlzLmZsb2F0TGFiZWxUeXBlLCB0aGlzLnNob3dDbGVhckJ1dHRvbik7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY3VzdG9tVmFsdWUoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aGlzLnNldFNlbGVjdGlvbih0aGlzLmxpQ29sbGVjdGlvbnNbdGhpcy5hY3RpdmVJbmRleF0sIG51bGwpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5zZXRIaWRkZW5WYWx1ZSgpO1xuICAgICAgICAgICAgZWoyX2lucHV0c18xLklucHV0LnNldFZhbHVlKHRoaXMudGV4dCwgdGhpcy5pbnB1dEVsZW1lbnQsIHRoaXMuZmxvYXRMYWJlbFR5cGUsIHRoaXMuc2hvd0NsZWFyQnV0dG9uKTtcbiAgICAgICAgfTtcbiAgICAgICAgQ29tYm9Cb3gucHJvdG90eXBlLmdldEFyaWFBdHRyaWJ1dGVzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIGFyaWFBdHRyaWJ1dGVzID0ge1xuICAgICAgICAgICAgICAgICdhcmlhLW93bnMnOiB0aGlzLmVsZW1lbnQuaWQgKyAnX29wdGlvbnMnLFxuICAgICAgICAgICAgICAgICdyb2xlJzogJ2NvbWJvYm94JyxcbiAgICAgICAgICAgICAgICAnYXJpYS1hdXRvY29tcGxldGUnOiAnYm90aCcsXG4gICAgICAgICAgICAgICAgJ2FyaWEtbGFiZWxsZWRieSc6IHRoaXMuaGlkZGVuRWxlbWVudC5pZCxcbiAgICAgICAgICAgICAgICAnYXJpYS1oYXNQb3B1cCc6ICd0cnVlJyxcbiAgICAgICAgICAgICAgICAnYXJpYS1leHBhbmRlZCc6ICdmYWxzZScsXG4gICAgICAgICAgICAgICAgJ2FyaWEtcmVhZG9ubHknOiB0aGlzLnJlYWRvbmx5LnRvU3RyaW5nKCksXG4gICAgICAgICAgICAgICAgJ2F1dG9jb21wbGV0ZSc6ICdvZmYnLFxuICAgICAgICAgICAgICAgICdhdXRvY29ycmVjdCc6ICdvZmYnLFxuICAgICAgICAgICAgICAgICdhdXRvY2FwaXRhbGl6ZSc6ICdvZmYnLFxuICAgICAgICAgICAgICAgICdzcGVsbGNoZWNrJzogJ2ZhbHNlJ1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHJldHVybiBhcmlhQXR0cmlidXRlcztcbiAgICAgICAgfTtcbiAgICAgICAgQ29tYm9Cb3gucHJvdG90eXBlLnNlYXJjaExpc3RzID0gZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgIHRoaXMuaXNUeXBlZCA9IHRydWU7XG4gICAgICAgICAgICBpZiAodGhpcy5pc0ZpbHRlcmluZygpKSB7XG4gICAgICAgICAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5zZWFyY2hMaXN0cy5jYWxsKHRoaXMsIGUpO1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLmZpbHRlcklucHV0LnZhbHVlLnRyaW0oKSA9PT0gJycpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zZXRIb3Zlckxpc3QodGhpcy51bEVsZW1lbnQucXVlcnlTZWxlY3RvcignLicgKyBkcm9wX2Rvd25fbGlzdF8xLmRyb3BEb3duTGlzdENsYXNzZXMubGkpKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy51bEVsZW1lbnQgJiYgdGhpcy5pbnB1dEVsZW1lbnQudmFsdWUgPT09ICcnICYmIHRoaXMucHJldmVudEF1dG9GaWxsKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc2V0SG92ZXJMaXN0KHRoaXMudWxFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy4nICsgZHJvcF9kb3duX2xpc3RfMS5kcm9wRG93bkxpc3RDbGFzc2VzLmxpKSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRoaXMuaW5jcmVtZW50YWxTZWFyY2goZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIENvbWJvQm94LnByb3RvdHlwZS5nZXROZ0RpcmVjdGl2ZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiAnRUotQ09NQk9CT1gnO1xuICAgICAgICB9O1xuICAgICAgICBDb21ib0JveC5wcm90b3R5cGUuc2V0U2VhcmNoQm94ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdGhpcy5maWx0ZXJJbnB1dCA9IHRoaXMuaW5wdXRFbGVtZW50O1xuICAgICAgICAgICAgcmV0dXJuICh0aGlzLmlzRmlsdGVyaW5nKCkgPyB0aGlzLmlucHV0V3JhcHBlciA6IGlucHV0T2JqZWN0KTtcbiAgICAgICAgfTtcbiAgICAgICAgQ29tYm9Cb3gucHJvdG90eXBlLm9uQWN0aW9uQ29tcGxldGUgPSBmdW5jdGlvbiAodWxFbGVtZW50LCBsaXN0LCBlLCBpc1VwZGF0ZWQpIHtcbiAgICAgICAgICAgIF9zdXBlci5wcm90b3R5cGUub25BY3Rpb25Db21wbGV0ZS5jYWxsKHRoaXMsIHVsRWxlbWVudCwgbGlzdCwgZSk7XG4gICAgICAgICAgICBpZiAodGhpcy5pc1NlbGVjdEN1c3RvbSkge1xuICAgICAgICAgICAgICAgIHRoaXMucmVtb3ZlU2VsZWN0aW9uKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoIXRoaXMucHJldmVudEF1dG9GaWxsICYmIHRoaXMuZ2V0TW9kdWxlTmFtZSgpID09PSAnY29tYm9ib3gnICYmIHRoaXMuaXNUeXBlZCkge1xuICAgICAgICAgICAgICAgIHRoaXMuaW5saW5lU2VhcmNoKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIENvbWJvQm94LnByb3RvdHlwZS5nZXRGb2N1c0VsZW1lbnQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgZGF0YUl0ZW0gPSB0aGlzLmlzU2VsZWN0Q3VzdG9tID8geyB0ZXh0OiAnJyB9IDogdGhpcy5nZXRJdGVtRGF0YSgpO1xuICAgICAgICAgICAgdmFyIHNlbGVjdGVkID0gdGhpcy5saXN0LnF1ZXJ5U2VsZWN0b3IoJy4nICsgZHJvcF9kb3duX2xpc3RfMS5kcm9wRG93bkxpc3RDbGFzc2VzLnNlbGVjdGVkKTtcbiAgICAgICAgICAgIHZhciBpc1NlbGVjdGVkID0gZGF0YUl0ZW0udGV4dCA9PT0gdGhpcy5pbnB1dEVsZW1lbnQudmFsdWUgJiYgIWVqMl9iYXNlXzIuaXNOdWxsT3JVbmRlZmluZWQoc2VsZWN0ZWQpO1xuICAgICAgICAgICAgaWYgKGlzU2VsZWN0ZWQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gc2VsZWN0ZWQ7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoKGVqMl9iYXNlXzEuQnJvd3Nlci5pc0RldmljZSAmJiAhdGhpcy5pc0Ryb3BEb3duQ2xpY2sgfHwgIWVqMl9iYXNlXzEuQnJvd3Nlci5pc0RldmljZSkgJiZcbiAgICAgICAgICAgICAgICAhZWoyX2Jhc2VfMi5pc051bGxPclVuZGVmaW5lZCh0aGlzLmxpQ29sbGVjdGlvbnMpICYmIHRoaXMubGlDb2xsZWN0aW9ucy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgdmFyIGlucHV0VmFsdWUgPSB0aGlzLmlucHV0RWxlbWVudC52YWx1ZTtcbiAgICAgICAgICAgICAgICB2YXIgYWN0aXZlSXRlbSA9IGluY3JlbWVudGFsX3NlYXJjaF8xLlNlYXJjaChpbnB1dFZhbHVlLCB0aGlzLmxpQ29sbGVjdGlvbnMsICdTdGFydHNXaXRoJywgdHJ1ZSk7XG4gICAgICAgICAgICAgICAgdmFyIGFjdGl2ZUVsZW1lbnQgPSBhY3RpdmVJdGVtLml0ZW07XG4gICAgICAgICAgICAgICAgaWYgKCFlajJfYmFzZV8yLmlzTnVsbE9yVW5kZWZpbmVkKGFjdGl2ZUVsZW1lbnQpKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBjb3VudCA9IHRoaXMuZ2V0SW5kZXhCeVZhbHVlKGFjdGl2ZUVsZW1lbnQuZ2V0QXR0cmlidXRlKCdkYXRhLXZhbHVlJykpIC0gMTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGhlaWdodCA9IHBhcnNlSW50KGdldENvbXB1dGVkU3R5bGUodGhpcy5saUNvbGxlY3Rpb25zWzBdLCBudWxsKS5nZXRQcm9wZXJ0eVZhbHVlKCdoZWlnaHQnKSwgMTApO1xuICAgICAgICAgICAgICAgICAgICBpZiAoIWlzTmFOKGhlaWdodCkgJiYgdGhpcy5nZXRNb2R1bGVOYW1lKCkgIT09ICdhdXRvY29tcGxldGUnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnJlbW92ZUZvY3VzKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgZml4ZWRIZWFkID0gdGhpcy5maWVsZHMuZ3JvdXBCeSA/IHRoaXMubGlDb2xsZWN0aW9uc1swXS5vZmZzZXRIZWlnaHQgOiAwO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5saXN0LnNjcm9sbFRvcCA9IGNvdW50ICogaGVpZ2h0ICsgZml4ZWRIZWFkO1xuICAgICAgICAgICAgICAgICAgICAgICAgZWoyX2Jhc2VfMS5hZGRDbGFzcyhbYWN0aXZlRWxlbWVudF0sIGRyb3BfZG93bl9saXN0XzEuZHJvcERvd25MaXN0Q2xhc3Nlcy5mb2N1cyk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmlzU2VsZWN0Q3VzdG9tICYmIHRoaXMuaW5wdXRFbGVtZW50LnZhbHVlLnRyaW0oKSAhPT0gJycpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucmVtb3ZlRm9jdXMoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubGlzdC5zY3JvbGxUb3AgPSAwO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiBhY3RpdmVFbGVtZW50O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIENvbWJvQm94LnByb3RvdHlwZS5zZXRWYWx1ZSA9IGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgICBpZiAoZSAmJiBlLnR5cGUgPT09ICdrZXlkb3duJyAmJiBlLmFjdGlvbiA9PT0gJ2VudGVyJykge1xuICAgICAgICAgICAgICAgIHRoaXMucmVtb3ZlRmlsbFNlbGVjdGlvbigpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHRoaXMuYXV0b2ZpbGwgJiYgdGhpcy5nZXRNb2R1bGVOYW1lKCkgPT09ICdjb21ib2JveCcgJiYgZSAmJiBlLnR5cGUgPT09ICdrZXlkb3duJyAmJiBlLmFjdGlvbiAhPT0gJ2VudGVyJykge1xuICAgICAgICAgICAgICAgIHRoaXMucHJldmVudEF1dG9GaWxsID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgdGhpcy5pbmxpbmVTZWFyY2goZSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIF9zdXBlci5wcm90b3R5cGUuc2V0VmFsdWUuY2FsbCh0aGlzLCBlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgQ29tYm9Cb3gucHJvdG90eXBlLnNob3dTcGlubmVyID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgaWYgKGVqMl9iYXNlXzIuaXNOdWxsT3JVbmRlZmluZWQodGhpcy5zcGlubmVyRWxlbWVudCkpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnNwaW5uZXJFbGVtZW50ID0gdGhpcy5pbnB1dFdyYXBwZXIuYnV0dG9uc1swXSB8fCB0aGlzLmlucHV0V3JhcHBlci5jbGVhckJ1dHRvbjtcbiAgICAgICAgICAgICAgICBlajJfYmFzZV8xLmFkZENsYXNzKFt0aGlzLnNwaW5uZXJFbGVtZW50XSwgZHJvcF9kb3duX2xpc3RfMS5kcm9wRG93bkxpc3RDbGFzc2VzLmRpc2FibGVJY29uKTtcbiAgICAgICAgICAgICAgICBlajJfcG9wdXBzXzEuY3JlYXRlU3Bpbm5lcih7XG4gICAgICAgICAgICAgICAgICAgIHRhcmdldDogdGhpcy5zcGlubmVyRWxlbWVudCxcbiAgICAgICAgICAgICAgICAgICAgd2lkdGg6IGRyb3BfZG93bl9iYXNlXzEuU1BJTk5FUl9TSVpFXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgZWoyX3BvcHVwc18xLnNob3dTcGlubmVyKHRoaXMuc3Bpbm5lckVsZW1lbnQpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICBDb21ib0JveC5wcm90b3R5cGUuaGlkZVNwaW5uZXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBpZiAoIWVqMl9iYXNlXzIuaXNOdWxsT3JVbmRlZmluZWQodGhpcy5zcGlubmVyRWxlbWVudCkpIHtcbiAgICAgICAgICAgICAgICBlajJfcG9wdXBzXzEuaGlkZVNwaW5uZXIodGhpcy5zcGlubmVyRWxlbWVudCk7XG4gICAgICAgICAgICAgICAgdGhpcy5zcGlubmVyRWxlbWVudC5pbm5lckhUTUwgPSAnJztcbiAgICAgICAgICAgICAgICBlajJfYmFzZV8xLnJlbW92ZUNsYXNzKFt0aGlzLnNwaW5uZXJFbGVtZW50XSwgZHJvcF9kb3duX2xpc3RfMS5kcm9wRG93bkxpc3RDbGFzc2VzLmRpc2FibGVJY29uKTtcbiAgICAgICAgICAgICAgICB0aGlzLnNwaW5uZXJFbGVtZW50ID0gbnVsbDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgQ29tYm9Cb3gucHJvdG90eXBlLnNldEF1dG9GaWxsID0gZnVuY3Rpb24gKGFjdGl2ZUVsZW1lbnQsIGlzSG92ZXIpIHtcbiAgICAgICAgICAgIGlmICghaXNIb3Zlcikge1xuICAgICAgICAgICAgICAgIHRoaXMuc2V0SG92ZXJMaXN0KGFjdGl2ZUVsZW1lbnQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHRoaXMuYXV0b2ZpbGwgJiYgIXRoaXMucHJldmVudEF1dG9GaWxsKSB7XG4gICAgICAgICAgICAgICAgdmFyIGN1cnJlbnRWYWx1ZSA9IHRoaXMuZ2V0VGV4dEJ5VmFsdWUoYWN0aXZlRWxlbWVudC5nZXRBdHRyaWJ1dGUoJ2RhdGEtdmFsdWUnKSkudG9TdHJpbmcoKTtcbiAgICAgICAgICAgICAgICB2YXIgY3VycmVudEZpbGxWYWx1ZSA9IHRoaXMuZ2V0Rm9ybWF0dGVkVmFsdWUoYWN0aXZlRWxlbWVudC5nZXRBdHRyaWJ1dGUoJ2RhdGEtdmFsdWUnKSk7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuZ2V0TW9kdWxlTmFtZSgpID09PSAnY29tYm9ib3gnKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICghdGhpcy5pc1NlbGVjdGVkICYmIHRoaXMucHJldmlvdXNWYWx1ZSAhPT0gY3VycmVudEZpbGxWYWx1ZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy51cGRhdGVTZWxlY3RlZEl0ZW0oYWN0aXZlRWxlbWVudCwgbnVsbCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmlzU2VsZWN0ZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wcmV2aW91c1ZhbHVlID0gdGhpcy5nZXRGb3JtYXR0ZWRWYWx1ZShhY3RpdmVFbGVtZW50LmdldEF0dHJpYnV0ZSgnZGF0YS12YWx1ZScpKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMudXBkYXRlU2VsZWN0ZWRJdGVtKGFjdGl2ZUVsZW1lbnQsIG51bGwsIHRydWUpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmICghdGhpcy5pc0FuZHJvaWRBdXRvRmlsbChjdXJyZW50VmFsdWUpKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc2V0QXV0b0ZpbGxTZWxlY3Rpb24oY3VycmVudFZhbHVlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIENvbWJvQm94LnByb3RvdHlwZS5pc0FuZHJvaWRBdXRvRmlsbCA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgaWYgKGVqMl9iYXNlXzEuQnJvd3Nlci5pc0FuZHJvaWQpIHtcbiAgICAgICAgICAgICAgICB2YXIgY3VycmVudFBvaW50cyA9IHRoaXMuZ2V0U2VsZWN0aW9uUG9pbnRzKCk7XG4gICAgICAgICAgICAgICAgdmFyIHByZXZFbmQgPSB0aGlzLnByZXZTZWxlY3RQb2ludHMuZW5kO1xuICAgICAgICAgICAgICAgIHZhciBjdXJFbmQgPSBjdXJyZW50UG9pbnRzLmVuZDtcbiAgICAgICAgICAgICAgICB2YXIgcHJldlN0YXJ0ID0gdGhpcy5wcmV2U2VsZWN0UG9pbnRzLnN0YXJ0O1xuICAgICAgICAgICAgICAgIHZhciBjdXJTdGFydCA9IGN1cnJlbnRQb2ludHMuc3RhcnQ7XG4gICAgICAgICAgICAgICAgaWYgKHByZXZFbmQgIT09IDAgJiYgKChwcmV2RW5kID09PSB2YWx1ZS5sZW5ndGggJiYgcHJldlN0YXJ0ID09PSB2YWx1ZS5sZW5ndGgpIHx8XG4gICAgICAgICAgICAgICAgICAgIChwcmV2U3RhcnQgPiBjdXJTdGFydCAmJiBwcmV2RW5kID4gY3VyRW5kKSB8fCAocHJldkVuZCA9PT0gY3VyRW5kICYmIHByZXZTdGFydCA9PT0gY3VyU3RhcnQpKSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIENvbWJvQm94LnByb3RvdHlwZS5pc1NlbGVjdEZvY3VzSXRlbSA9IGZ1bmN0aW9uIChlbGVtZW50KSB7XG4gICAgICAgICAgICByZXR1cm4gIWVqMl9iYXNlXzIuaXNOdWxsT3JVbmRlZmluZWQoZWxlbWVudCk7XG4gICAgICAgIH07XG4gICAgICAgIENvbWJvQm94LnByb3RvdHlwZS5pbmxpbmVTZWFyY2ggPSBmdW5jdGlvbiAoZSkge1xuICAgICAgICAgICAgdmFyIGlzS2V5TmF2aWdhdGUgPSAoZSAmJiAoZS5hY3Rpb24gPT09ICdkb3duJyB8fCBlLmFjdGlvbiA9PT0gJ3VwJyB8fFxuICAgICAgICAgICAgICAgIGUuYWN0aW9uID09PSAnaG9tZScgfHwgZS5hY3Rpb24gPT09ICdlbmQnIHx8IGUuYWN0aW9uID09PSAncGFnZVVwJyB8fCBlLmFjdGlvbiA9PT0gJ3BhZ2VEb3duJykpO1xuICAgICAgICAgICAgdmFyIGFjdGl2ZUVsZW1lbnQgPSBpc0tleU5hdmlnYXRlID8gdGhpcy5saUNvbGxlY3Rpb25zW3RoaXMuYWN0aXZlSW5kZXhdIDogdGhpcy5nZXRGb2N1c0VsZW1lbnQoKTtcbiAgICAgICAgICAgIGlmICghZWoyX2Jhc2VfMi5pc051bGxPclVuZGVmaW5lZChhY3RpdmVFbGVtZW50KSkge1xuICAgICAgICAgICAgICAgIGlmICghaXNLZXlOYXZpZ2F0ZSkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgdmFsdWUgPSB0aGlzLmdldEZvcm1hdHRlZFZhbHVlKGFjdGl2ZUVsZW1lbnQuZ2V0QXR0cmlidXRlKCdkYXRhLXZhbHVlJykpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmFjdGl2ZUluZGV4ID0gdGhpcy5nZXRJbmRleEJ5VmFsdWUodmFsdWUpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmFjdGl2ZUluZGV4ID0gIWVqMl9iYXNlXzIuaXNOdWxsT3JVbmRlZmluZWQodGhpcy5hY3RpdmVJbmRleCkgPyB0aGlzLmFjdGl2ZUluZGV4IDogbnVsbDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdGhpcy5wcmV2ZW50QXV0b0ZpbGwgPSB0aGlzLmlucHV0RWxlbWVudC52YWx1ZSA9PT0gJycgPyBmYWxzZSA6IHRoaXMucHJldmVudEF1dG9GaWxsO1xuICAgICAgICAgICAgICAgIHRoaXMuc2V0QXV0b0ZpbGwoYWN0aXZlRWxlbWVudCwgaXNLZXlOYXZpZ2F0ZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmICh0aGlzLmlucHV0RWxlbWVudC52YWx1ZSA9PT0gJycpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmFjdGl2ZUluZGV4ID0gbnVsbDtcbiAgICAgICAgICAgICAgICB0aGlzLmxpc3Quc2Nyb2xsVG9wID0gMDtcbiAgICAgICAgICAgICAgICB2YXIgZm9jdXNJdGVtID0gdGhpcy5saXN0LnF1ZXJ5U2VsZWN0b3IoJy4nICsgZHJvcF9kb3duX2xpc3RfMS5kcm9wRG93bkxpc3RDbGFzc2VzLmxpKTtcbiAgICAgICAgICAgICAgICB0aGlzLnNldEhvdmVyTGlzdChmb2N1c0l0ZW0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpcy5hY3RpdmVJbmRleCA9IG51bGw7XG4gICAgICAgICAgICAgICAgdGhpcy5yZW1vdmVTZWxlY3Rpb24oKTtcbiAgICAgICAgICAgICAgICB0aGlzLnJlbW92ZUZvY3VzKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIENvbWJvQm94LnByb3RvdHlwZS5pbmNyZW1lbnRhbFNlYXJjaCA9IGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgICB0aGlzLnNob3dQb3B1cCgpO1xuICAgICAgICAgICAgaWYgKCFlajJfYmFzZV8yLmlzTnVsbE9yVW5kZWZpbmVkKHRoaXMubGlzdERhdGEpKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5pbmxpbmVTZWFyY2goZSk7XG4gICAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICA7XG4gICAgICAgIENvbWJvQm94LnByb3RvdHlwZS5zZXRBdXRvRmlsbFNlbGVjdGlvbiA9IGZ1bmN0aW9uIChjdXJyZW50VmFsdWUpIHtcbiAgICAgICAgICAgIHZhciBzZWxlY3Rpb24gPSB0aGlzLmdldFNlbGVjdGlvblBvaW50cygpO1xuICAgICAgICAgICAgdmFyIHZhbHVlID0gdGhpcy5pbnB1dEVsZW1lbnQudmFsdWUuc3Vic3RyKDAsIHNlbGVjdGlvbi5zdGFydCk7XG4gICAgICAgICAgICBpZiAodmFsdWUgJiYgKHZhbHVlLnRvTG93ZXJDYXNlKCkgPT09IGN1cnJlbnRWYWx1ZS5zdWJzdHIoMCwgc2VsZWN0aW9uLnN0YXJ0KS50b0xvd2VyQ2FzZSgpKSkge1xuICAgICAgICAgICAgICAgIHZhciBpbnB1dFZhbHVlID0gdmFsdWUgKyBjdXJyZW50VmFsdWUuc3Vic3RyKHZhbHVlLmxlbmd0aCwgY3VycmVudFZhbHVlLmxlbmd0aCk7XG4gICAgICAgICAgICAgICAgZWoyX2lucHV0c18xLklucHV0LnNldFZhbHVlKGlucHV0VmFsdWUsIHRoaXMuaW5wdXRFbGVtZW50LCB0aGlzLmZsb2F0TGFiZWxUeXBlLCB0aGlzLnNob3dDbGVhckJ1dHRvbik7XG4gICAgICAgICAgICAgICAgdGhpcy5pbnB1dEVsZW1lbnQuc2V0U2VsZWN0aW9uUmFuZ2Uoc2VsZWN0aW9uLnN0YXJ0LCB0aGlzLmlucHV0RWxlbWVudC52YWx1ZS5sZW5ndGgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgZWoyX2lucHV0c18xLklucHV0LnNldFZhbHVlKGN1cnJlbnRWYWx1ZSwgdGhpcy5pbnB1dEVsZW1lbnQsIHRoaXMuZmxvYXRMYWJlbFR5cGUsIHRoaXMuc2hvd0NsZWFyQnV0dG9uKTtcbiAgICAgICAgICAgICAgICB0aGlzLmlucHV0RWxlbWVudC5zZXRTZWxlY3Rpb25SYW5nZSgwLCB0aGlzLmlucHV0RWxlbWVudC52YWx1ZS5sZW5ndGgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICA7XG4gICAgICAgIENvbWJvQm94LnByb3RvdHlwZS5nZXRWYWx1ZUJ5VGV4dCA9IGZ1bmN0aW9uICh0ZXh0KSB7XG4gICAgICAgICAgICByZXR1cm4gX3N1cGVyLnByb3RvdHlwZS5nZXRWYWx1ZUJ5VGV4dC5jYWxsKHRoaXMsIHRleHQsIHRydWUpO1xuICAgICAgICB9O1xuICAgICAgICBDb21ib0JveC5wcm90b3R5cGUudW5XaXJlRXZlbnQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5nZXRNb2R1bGVOYW1lKCkgPT09ICdjb21ib2JveCcpIHtcbiAgICAgICAgICAgICAgICBlajJfYmFzZV8xLkV2ZW50SGFuZGxlci5yZW1vdmUodGhpcy5pbnB1dFdyYXBwZXIuYnV0dG9uc1swXSwgJ21vdXNlZG93bicsIHRoaXMucHJldmVudEJsdXIpO1xuICAgICAgICAgICAgICAgIGVqMl9iYXNlXzEuRXZlbnRIYW5kbGVyLnJlbW92ZSh0aGlzLmlucHV0V3JhcHBlci5jb250YWluZXIsICdibHVyJywgdGhpcy5vbkJsdXIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKCFlajJfYmFzZV8yLmlzTnVsbE9yVW5kZWZpbmVkKHRoaXMuaW5wdXRXcmFwcGVyLmJ1dHRvbnNbMF0pKSB7XG4gICAgICAgICAgICAgICAgZWoyX2Jhc2VfMS5FdmVudEhhbmRsZXIucmVtb3ZlKHRoaXMuaW5wdXRXcmFwcGVyLmJ1dHRvbnNbMF0sICdtb3VzZWRvd24nLCB0aGlzLmRyb3BEb3duQ2xpY2spO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWoyX2Jhc2VfMS5FdmVudEhhbmRsZXIucmVtb3ZlKHRoaXMuaW5wdXRFbGVtZW50LCAnZm9jdXMnLCB0aGlzLnRhcmdldEZvY3VzKTtcbiAgICAgICAgICAgIGlmICghdGhpcy5yZWFkb25seSkge1xuICAgICAgICAgICAgICAgIGVqMl9iYXNlXzEuRXZlbnRIYW5kbGVyLnJlbW92ZSh0aGlzLmlucHV0RWxlbWVudCwgJ2lucHV0JywgdGhpcy5vbklucHV0KTtcbiAgICAgICAgICAgICAgICBlajJfYmFzZV8xLkV2ZW50SGFuZGxlci5yZW1vdmUodGhpcy5pbnB1dEVsZW1lbnQsICdrZXl1cCcsIHRoaXMub25GaWx0ZXJVcCk7XG4gICAgICAgICAgICAgICAgZWoyX2Jhc2VfMS5FdmVudEhhbmRsZXIucmVtb3ZlKHRoaXMuaW5wdXRFbGVtZW50LCAna2V5ZG93bicsIHRoaXMub25GaWx0ZXJEb3duKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMudW5CaW5kQ29tbW9uRXZlbnQoKTtcbiAgICAgICAgfTtcbiAgICAgICAgQ29tYm9Cb3gucHJvdG90eXBlLnNldFNlbGVjdGlvbiA9IGZ1bmN0aW9uIChsaSwgZSkge1xuICAgICAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5zZXRTZWxlY3Rpb24uY2FsbCh0aGlzLCBsaSwgZSk7XG4gICAgICAgICAgICBpZiAoIWVqMl9iYXNlXzIuaXNOdWxsT3JVbmRlZmluZWQobGkpICYmICF0aGlzLmF1dG9maWxsICYmICF0aGlzLmlzRHJvcERvd25DbGljaykge1xuICAgICAgICAgICAgICAgIHRoaXMucmVtb3ZlRm9jdXMoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgQ29tYm9Cb3gucHJvdG90eXBlLnNlbGVjdEN1cnJlbnRJdGVtID0gZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgIHZhciBsaTtcbiAgICAgICAgICAgIGlmICh0aGlzLmlzUG9wdXBPcGVuKSB7XG4gICAgICAgICAgICAgICAgbGkgPSB0aGlzLmxpc3QucXVlcnlTZWxlY3RvcignLicgKyBkcm9wX2Rvd25fbGlzdF8xLmRyb3BEb3duTGlzdENsYXNzZXMuZm9jdXMpO1xuICAgICAgICAgICAgICAgIGlmIChsaSkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnNldFNlbGVjdGlvbihsaSwgZSk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuaXNUeXBlZCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAodGhpcy5pc1NlbGVjdGVkKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuaXNTZWxlY3RDdXN0b20gPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5vbkNoYW5nZUV2ZW50KGUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh0aGlzLmlzVHlwZWQgJiYgIXRoaXMuaXNTZWxlY3RlZCAmJiBlajJfYmFzZV8yLmlzTnVsbE9yVW5kZWZpbmVkKGxpKSkge1xuICAgICAgICAgICAgICAgIHRoaXMuY3VzdG9tVmFsdWUoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuaGlkZVBvcHVwKCk7XG4gICAgICAgIH07XG4gICAgICAgIENvbWJvQm94LnByb3RvdHlwZS5zZXRIb3Zlckxpc3QgPSBmdW5jdGlvbiAobGkpIHtcbiAgICAgICAgICAgIHRoaXMucmVtb3ZlU2VsZWN0aW9uKCk7XG4gICAgICAgICAgICBpZiAodGhpcy5pc1ZhbGlkTEkobGkpICYmICFsaS5jbGFzc0xpc3QuY29udGFpbnMoZHJvcF9kb3duX2xpc3RfMS5kcm9wRG93bkxpc3RDbGFzc2VzLnNlbGVjdGVkKSkge1xuICAgICAgICAgICAgICAgIHRoaXMucmVtb3ZlRm9jdXMoKTtcbiAgICAgICAgICAgICAgICBsaS5jbGFzc0xpc3QuYWRkKGRyb3BfZG93bl9saXN0XzEuZHJvcERvd25MaXN0Q2xhc3Nlcy5mb2N1cyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIDtcbiAgICAgICAgQ29tYm9Cb3gucHJvdG90eXBlLnRhcmdldEZvY3VzID0gZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgIGlmIChlajJfYmFzZV8xLkJyb3dzZXIuaXNEZXZpY2UgJiYgIXRoaXMuYWxsb3dGaWx0ZXJpbmcpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnByZXZlbnRGb2N1cyA9IGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5vbkZvY3VzKCk7XG4gICAgICAgIH07XG4gICAgICAgIENvbWJvQm94LnByb3RvdHlwZS5kcm9wRG93bkNsaWNrID0gZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgIGlmIChlajJfYmFzZV8xLkJyb3dzZXIuaXNEZXZpY2UgJiYgIXRoaXMuYWxsb3dGaWx0ZXJpbmcpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnByZXZlbnRGb2N1cyA9IHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBfc3VwZXIucHJvdG90eXBlLmRyb3BEb3duQ2xpY2suY2FsbCh0aGlzLCBlKTtcbiAgICAgICAgfTtcbiAgICAgICAgQ29tYm9Cb3gucHJvdG90eXBlLmN1c3RvbVZhbHVlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIHZhbHVlID0gdGhpcy5nZXRWYWx1ZUJ5VGV4dCh0aGlzLmlucHV0RWxlbWVudC52YWx1ZSk7XG4gICAgICAgICAgICBpZiAoIXRoaXMuYWxsb3dDdXN0b20gJiYgdGhpcy5pbnB1dEVsZW1lbnQudmFsdWUgIT09ICcnKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5zZXRQcm9wZXJ0aWVzKHsgdmFsdWU6IHZhbHVlIH0pO1xuICAgICAgICAgICAgICAgIGlmIChlajJfYmFzZV8yLmlzTnVsbE9yVW5kZWZpbmVkKHRoaXMudmFsdWUpKSB7XG4gICAgICAgICAgICAgICAgICAgIGVqMl9pbnB1dHNfMS5JbnB1dC5zZXRWYWx1ZSgnJywgdGhpcy5pbnB1dEVsZW1lbnQsIHRoaXMuZmxvYXRMYWJlbFR5cGUsIHRoaXMuc2hvd0NsZWFyQnV0dG9uKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmICh0aGlzLmlucHV0RWxlbWVudC52YWx1ZS50cmltKCkgIT09ICcnKSB7XG4gICAgICAgICAgICAgICAgdmFyIHByZXZpb3VzVmFsdWUgPSB0aGlzLnZhbHVlO1xuICAgICAgICAgICAgICAgIGlmIChlajJfYmFzZV8yLmlzTnVsbE9yVW5kZWZpbmVkKHZhbHVlKSkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgdmFsdWVfMSA9IHRoaXMuaW5wdXRFbGVtZW50LnZhbHVlID09PSAnJyA/IG51bGwgOiB0aGlzLmlucHV0RWxlbWVudC52YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGZpZWxkcyA9IHRoaXMuZmllbGRzO1xuICAgICAgICAgICAgICAgICAgICB2YXIgZXZlbnRBcmdzID0gdm9pZCAwO1xuICAgICAgICAgICAgICAgICAgICBldmVudEFyZ3MgPSB7IHRleHQ6IHZhbHVlXzEsIGl0ZW06IHt9IH07XG4gICAgICAgICAgICAgICAgICAgIGlmICghdGhpcy5pbml0aWFsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnRyaWdnZXIoJ2N1c3RvbVZhbHVlU3BlY2lmaWVyJywgZXZlbnRBcmdzKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB2YXIgaXRlbSA9IGV2ZW50QXJncy5pdGVtO1xuICAgICAgICAgICAgICAgICAgICB2YXIgZGF0YUl0ZW0gPSB7fTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGl0ZW0gJiYgaXRlbVtmaWVsZHMudGV4dF0gJiYgaXRlbVtmaWVsZHMudmFsdWVdKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRhSXRlbSA9IGl0ZW07XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRhSXRlbVtmaWVsZHMudGV4dF0gPSB2YWx1ZV8xO1xuICAgICAgICAgICAgICAgICAgICAgICAgZGF0YUl0ZW1bZmllbGRzLnZhbHVlXSA9IHZhbHVlXzE7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgdGhpcy5pdGVtRGF0YSA9IGRhdGFJdGVtO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnNldFByb3BlcnRpZXMoeyB0ZXh0OiB0aGlzLml0ZW1EYXRhW2ZpZWxkcy50ZXh0XSwgdmFsdWU6IHRoaXMuaXRlbURhdGFbZmllbGRzLnZhbHVlXSwgaW5kZXg6IG51bGwgfSwgdHJ1ZSk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc2V0U2VsZWN0aW9uKG51bGwsIG51bGwpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmlzU2VsZWN0Q3VzdG9tID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuaXNTZWxlY3RDdXN0b20gPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zZXRQcm9wZXJ0aWVzKHsgdmFsdWU6IHZhbHVlIH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAocHJldmlvdXNWYWx1ZSAhPT0gdGhpcy52YWx1ZSkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLm9uQ2hhbmdlRXZlbnQobnVsbCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICBDb21ib0JveC5wcm90b3R5cGUub25Qcm9wZXJ0eUNoYW5nZWQgPSBmdW5jdGlvbiAobmV3UHJvcCwgb2xkUHJvcCkge1xuICAgICAgICAgICAgZm9yICh2YXIgX2kgPSAwLCBfYSA9IE9iamVjdC5rZXlzKG5ld1Byb3ApOyBfaSA8IF9hLmxlbmd0aDsgX2krKykge1xuICAgICAgICAgICAgICAgIHZhciBwcm9wID0gX2FbX2ldO1xuICAgICAgICAgICAgICAgIHN3aXRjaCAocHJvcCkge1xuICAgICAgICAgICAgICAgICAgICBjYXNlICdyZWFkb25seSc6XG4gICAgICAgICAgICAgICAgICAgICAgICBlajJfaW5wdXRzXzEuSW5wdXQuc2V0UmVhZG9ubHkodGhpcy5yZWFkb25seSwgdGhpcy5pbnB1dEVsZW1lbnQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMucmVhZG9ubHkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlajJfYmFzZV8xLkV2ZW50SGFuZGxlci5yZW1vdmUodGhpcy5pbnB1dEVsZW1lbnQsICdrZXl1cCcsIHRoaXMub25GaWx0ZXJVcCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZWoyX2Jhc2VfMS5FdmVudEhhbmRsZXIucmVtb3ZlKHRoaXMuaW5wdXRFbGVtZW50LCAna2V5ZG93bicsIHRoaXMub25GaWx0ZXJEb3duKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVqMl9iYXNlXzEuRXZlbnRIYW5kbGVyLmFkZCh0aGlzLmlucHV0RWxlbWVudCwgJ2tleXVwJywgdGhpcy5vbkZpbHRlclVwLCB0aGlzKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlajJfYmFzZV8xLkV2ZW50SGFuZGxlci5hZGQodGhpcy5pbnB1dEVsZW1lbnQsICdrZXlkb3duJywgdGhpcy5vbkZpbHRlckRvd24sIHRoaXMpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgJ2FsbG93RmlsdGVyaW5nJzpcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2V0U2VhcmNoQm94KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAnYWxsb3dDdXN0b20nOlxuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgY29tYm9Qcm9wcyA9IHZvaWQgMDtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbWJvUHJvcHMgPSB0aGlzLmdldFByb3BPYmplY3QocHJvcCwgbmV3UHJvcCwgb2xkUHJvcCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBfc3VwZXIucHJvdG90eXBlLm9uUHJvcGVydHlDaGFuZ2VkLmNhbGwodGhpcywgY29tYm9Qcm9wcy5uZXdQcm9wZXJ0eSwgY29tYm9Qcm9wcy5vbGRQcm9wZXJ0eSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIENvbWJvQm94LnByb3RvdHlwZS5yZW5kZXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBfc3VwZXIucHJvdG90eXBlLnJlbmRlci5jYWxsKHRoaXMpO1xuICAgICAgICAgICAgdGhpcy5zZXRTZWFyY2hCb3goKTtcbiAgICAgICAgICAgIGlmICh0aGlzLmlzRmlsdGVyaW5nKCkgJiYgdGhpcy5nZXRNb2R1bGVOYW1lKCkgPT09ICdjb21ib2JveCcgJiYgZWoyX2Jhc2VfMi5pc051bGxPclVuZGVmaW5lZCh0aGlzLmxpc3QpKSB7XG4gICAgICAgICAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5yZW5kZXJMaXN0LmNhbGwodGhpcyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIDtcbiAgICAgICAgQ29tYm9Cb3gucHJvdG90eXBlLmdldE1vZHVsZU5hbWUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gJ2NvbWJvYm94JztcbiAgICAgICAgfTtcbiAgICAgICAgQ29tYm9Cb3gucHJvdG90eXBlLmhpZGVQb3B1cCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGlmICghZWoyX2Jhc2VfMi5pc051bGxPclVuZGVmaW5lZCh0aGlzLmxpc3REYXRhKSkge1xuICAgICAgICAgICAgICAgIHZhciBpc0VzY2FwZSA9IHRoaXMuaXNFc2NhcGVLZXk7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuaXNFc2NhcGVLZXkpIHtcbiAgICAgICAgICAgICAgICAgICAgZWoyX2lucHV0c18xLklucHV0LnNldFZhbHVlKHRoaXMudHlwZWRTdHJpbmcsIHRoaXMuaW5wdXRFbGVtZW50LCB0aGlzLmZsb2F0TGFiZWxUeXBlLCB0aGlzLnNob3dDbGVhckJ1dHRvbik7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuaXNFc2NhcGVLZXkgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuYXV0b2ZpbGwpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5yZW1vdmVGaWxsU2VsZWN0aW9uKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHZhciBkYXRhSXRlbSA9IHRoaXMuaXNTZWxlY3RDdXN0b20gPyB7IHRleHQ6ICcnIH0gOiB0aGlzLmdldEl0ZW1EYXRhKCk7XG4gICAgICAgICAgICAgICAgdmFyIHNlbGVjdGVkID0gdGhpcy5saXN0LnF1ZXJ5U2VsZWN0b3IoJy4nICsgZHJvcF9kb3duX2xpc3RfMS5kcm9wRG93bkxpc3RDbGFzc2VzLnNlbGVjdGVkKTtcbiAgICAgICAgICAgICAgICBpZiAoZGF0YUl0ZW0udGV4dCA9PT0gdGhpcy5pbnB1dEVsZW1lbnQudmFsdWUgJiYgIWVqMl9iYXNlXzIuaXNOdWxsT3JVbmRlZmluZWQoc2VsZWN0ZWQpKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmlzU2VsZWN0ZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMub25DaGFuZ2VFdmVudChudWxsKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuaXNTZWxlY3RDdXN0b20gPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBfc3VwZXIucHJvdG90eXBlLmhpZGVQb3B1cC5jYWxsKHRoaXMpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmICh0aGlzLmdldE1vZHVsZU5hbWUoKSA9PT0gJ2NvbWJvYm94JyAmJiB0aGlzLmlucHV0RWxlbWVudC52YWx1ZS50cmltKCkgIT09ICcnKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBzZWFyY2hJdGVtID0gaW5jcmVtZW50YWxfc2VhcmNoXzEuU2VhcmNoKHRoaXMuaW5wdXRFbGVtZW50LnZhbHVlLCB0aGlzLmxpQ29sbGVjdGlvbnMsICdFcXVhbCcsIHRydWUpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnNlbGVjdGVkTEkgPSBzZWFyY2hJdGVtLml0ZW07XG4gICAgICAgICAgICAgICAgICAgIGlmIChlajJfYmFzZV8yLmlzTnVsbE9yVW5kZWZpbmVkKHNlYXJjaEl0ZW0uaW5kZXgpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzZWFyY2hJdGVtLmluZGV4ID0gaW5jcmVtZW50YWxfc2VhcmNoXzEuU2VhcmNoKHRoaXMuaW5wdXRFbGVtZW50LnZhbHVlLCB0aGlzLmxpQ29sbGVjdGlvbnMsICdTdGFydHNXaXRoJywgdHJ1ZSkuaW5kZXg7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgdGhpcy5hY3RpdmVJbmRleCA9IHNlYXJjaEl0ZW0uaW5kZXg7XG4gICAgICAgICAgICAgICAgICAgIGlmICghZWoyX2Jhc2VfMi5pc051bGxPclVuZGVmaW5lZCh0aGlzLnNlbGVjdGVkTEkpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnVwZGF0ZVNlbGVjdGVkSXRlbSh0aGlzLnNlbGVjdGVkTEksIG51bGwsIHRydWUpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2UgaWYgKGlzRXNjYXBlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmlzU2VsZWN0Q3VzdG9tID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucmVtb3ZlU2VsZWN0aW9uKCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKCF0aGlzLmlzRXNjYXBlS2V5ICYmIHRoaXMuaXNUeXBlZCAmJiAhdGhpcy5pc0ludGVyYWN0ZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jdXN0b21WYWx1ZSgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIF9zdXBlci5wcm90b3R5cGUuaGlkZVBvcHVwLmNhbGwodGhpcyk7XG4gICAgICAgIH07XG4gICAgICAgIENvbWJvQm94LnByb3RvdHlwZS5mb2N1c0luID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgaWYgKGVqMl9iYXNlXzEuQnJvd3Nlci5pc0RldmljZSAmJiAhdGhpcy5hbGxvd0ZpbHRlcmluZykge1xuICAgICAgICAgICAgICAgIHRoaXMucHJldmVudEZvY3VzID0gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIF9zdXBlci5wcm90b3R5cGUuZm9jdXNJbi5jYWxsKHRoaXMpO1xuICAgICAgICB9O1xuICAgICAgICByZXR1cm4gQ29tYm9Cb3g7XG4gICAgfShkcm9wX2Rvd25fbGlzdF8xLkRyb3BEb3duTGlzdCkpO1xuICAgIF9fZGVjb3JhdGUoW1xuICAgICAgICBlajJfYmFzZV8xLlByb3BlcnR5KGZhbHNlKVxuICAgIF0sIENvbWJvQm94LnByb3RvdHlwZSwgXCJhdXRvZmlsbFwiLCB2b2lkIDApO1xuICAgIF9fZGVjb3JhdGUoW1xuICAgICAgICBlajJfYmFzZV8xLlByb3BlcnR5KHRydWUpXG4gICAgXSwgQ29tYm9Cb3gucHJvdG90eXBlLCBcImFsbG93Q3VzdG9tXCIsIHZvaWQgMCk7XG4gICAgX19kZWNvcmF0ZShbXG4gICAgICAgIGVqMl9iYXNlXzEuUHJvcGVydHkoe30pXG4gICAgXSwgQ29tYm9Cb3gucHJvdG90eXBlLCBcImh0bWxBdHRyaWJ1dGVzXCIsIHZvaWQgMCk7XG4gICAgX19kZWNvcmF0ZShbXG4gICAgICAgIGVqMl9iYXNlXzEuUHJvcGVydHkoZmFsc2UpXG4gICAgXSwgQ29tYm9Cb3gucHJvdG90eXBlLCBcImFsbG93RmlsdGVyaW5nXCIsIHZvaWQgMCk7XG4gICAgX19kZWNvcmF0ZShbXG4gICAgICAgIGVqMl9iYXNlXzEuUHJvcGVydHkobnVsbClcbiAgICBdLCBDb21ib0JveC5wcm90b3R5cGUsIFwicXVlcnlcIiwgdm9pZCAwKTtcbiAgICBfX2RlY29yYXRlKFtcbiAgICAgICAgZWoyX2Jhc2VfMS5Qcm9wZXJ0eSh0cnVlKVxuICAgIF0sIENvbWJvQm94LnByb3RvdHlwZSwgXCJzaG93Q2xlYXJCdXR0b25cIiwgdm9pZCAwKTtcbiAgICBfX2RlY29yYXRlKFtcbiAgICAgICAgZWoyX2Jhc2VfMS5FdmVudCgpXG4gICAgXSwgQ29tYm9Cb3gucHJvdG90eXBlLCBcImN1c3RvbVZhbHVlU3BlY2lmaWVyXCIsIHZvaWQgMCk7XG4gICAgX19kZWNvcmF0ZShbXG4gICAgICAgIGVqMl9iYXNlXzEuRXZlbnQoKVxuICAgIF0sIENvbWJvQm94LnByb3RvdHlwZSwgXCJmaWx0ZXJpbmdcIiwgdm9pZCAwKTtcbiAgICBfX2RlY29yYXRlKFtcbiAgICAgICAgZWoyX2Jhc2VfMS5Qcm9wZXJ0eShudWxsKVxuICAgIF0sIENvbWJvQm94LnByb3RvdHlwZSwgXCJ2YWx1ZVRlbXBsYXRlXCIsIHZvaWQgMCk7XG4gICAgX19kZWNvcmF0ZShbXG4gICAgICAgIGVqMl9iYXNlXzEuUHJvcGVydHkobnVsbClcbiAgICBdLCBDb21ib0JveC5wcm90b3R5cGUsIFwiZmlsdGVyQmFyUGxhY2Vob2xkZXJcIiwgdm9pZCAwKTtcbiAgICBDb21ib0JveCA9IF9fZGVjb3JhdGUoW1xuICAgICAgICBlajJfYmFzZV8yLk5vdGlmeVByb3BlcnR5Q2hhbmdlc1xuICAgIF0sIENvbWJvQm94KTtcbiAgICBleHBvcnRzLkNvbWJvQm94ID0gQ29tYm9Cb3g7XG59KTtcblxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vc3JjL2NvbWJvLWJveC9jb21iby1ib3guanNcbi8vIG1vZHVsZSBpZCA9IDE0XG4vLyBtb2R1bGUgY2h1bmtzID0gMCIsImRlZmluZShbXCJyZXF1aXJlXCIsIFwiZXhwb3J0c1wiLCBcIi4vYXV0by1jb21wbGV0ZVwiXSwgZnVuY3Rpb24gKHJlcXVpcmUsIGV4cG9ydHMsIGF1dG9fY29tcGxldGVfMSkge1xuICAgIFwidXNlIHN0cmljdFwiO1xuICAgIGZ1bmN0aW9uIF9fZXhwb3J0KG0pIHtcbiAgICAgICAgZm9yICh2YXIgcCBpbiBtKSBpZiAoIWV4cG9ydHMuaGFzT3duUHJvcGVydHkocCkpIGV4cG9ydHNbcF0gPSBtW3BdO1xuICAgIH1cbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG4gICAgX19leHBvcnQoYXV0b19jb21wbGV0ZV8xKTtcbn0pO1xuXG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi9zcmMvYXV0by1jb21wbGV0ZS9pbmRleC5qc1xuLy8gbW9kdWxlIGlkID0gMTVcbi8vIG1vZHVsZSBjaHVua3MgPSAwIiwidmFyIF9fZXh0ZW5kcyA9ICh0aGlzICYmIHRoaXMuX19leHRlbmRzKSB8fCAoZnVuY3Rpb24gKCkge1xuICAgIHZhciBleHRlbmRTdGF0aWNzID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8XG4gICAgICAgICh7IF9fcHJvdG9fXzogW10gfSBpbnN0YW5jZW9mIEFycmF5ICYmIGZ1bmN0aW9uIChkLCBiKSB7IGQuX19wcm90b19fID0gYjsgfSkgfHxcbiAgICAgICAgZnVuY3Rpb24gKGQsIGIpIHsgZm9yICh2YXIgcCBpbiBiKSBpZiAoYi5oYXNPd25Qcm9wZXJ0eShwKSkgZFtwXSA9IGJbcF07IH07XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChkLCBiKSB7XG4gICAgICAgIGV4dGVuZFN0YXRpY3MoZCwgYik7XG4gICAgICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfVxuICAgICAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7XG4gICAgfTtcbn0pKCk7XG52YXIgX19kZWNvcmF0ZSA9ICh0aGlzICYmIHRoaXMuX19kZWNvcmF0ZSkgfHwgZnVuY3Rpb24gKGRlY29yYXRvcnMsIHRhcmdldCwga2V5LCBkZXNjKSB7XG4gICAgdmFyIGMgPSBhcmd1bWVudHMubGVuZ3RoLCByID0gYyA8IDMgPyB0YXJnZXQgOiBkZXNjID09PSBudWxsID8gZGVzYyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IodGFyZ2V0LCBrZXkpIDogZGVzYywgZDtcbiAgICBpZiAodHlwZW9mIFJlZmxlY3QgPT09IFwib2JqZWN0XCIgJiYgdHlwZW9mIFJlZmxlY3QuZGVjb3JhdGUgPT09IFwiZnVuY3Rpb25cIikgciA9IFJlZmxlY3QuZGVjb3JhdGUoZGVjb3JhdG9ycywgdGFyZ2V0LCBrZXksIGRlc2MpO1xuICAgIGVsc2UgZm9yICh2YXIgaSA9IGRlY29yYXRvcnMubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pIGlmIChkID0gZGVjb3JhdG9yc1tpXSkgciA9IChjIDwgMyA/IGQocikgOiBjID4gMyA/IGQodGFyZ2V0LCBrZXksIHIpIDogZCh0YXJnZXQsIGtleSkpIHx8IHI7XG4gICAgcmV0dXJuIGMgPiAzICYmIHIgJiYgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwga2V5LCByKSwgcjtcbn07XG5kZWZpbmUoW1wicmVxdWlyZVwiLCBcImV4cG9ydHNcIiwgXCJAc3luY2Z1c2lvbi9lajItYmFzZVwiLCBcIkBzeW5jZnVzaW9uL2VqMi1iYXNlXCIsIFwiLi4vZHJvcC1kb3duLWxpc3QvZHJvcC1kb3duLWxpc3RcIiwgXCIuLi9jb21iby1ib3gvY29tYm8tYm94XCIsIFwiLi4vY29tbW9uL2hpZ2hsaWdodC1zZWFyY2hcIiwgXCIuLi9jb21tb24vaW5jcmVtZW50YWwtc2VhcmNoXCIsIFwiLi4vZHJvcC1kb3duLWJhc2UvZHJvcC1kb3duLWJhc2VcIiwgXCJAc3luY2Z1c2lvbi9lajItcG9wdXBzXCIsIFwiQHN5bmNmdXNpb24vZWoyLWlucHV0c1wiLCBcIkBzeW5jZnVzaW9uL2VqMi1kYXRhXCJdLCBmdW5jdGlvbiAocmVxdWlyZSwgZXhwb3J0cywgZWoyX2Jhc2VfMSwgZWoyX2Jhc2VfMiwgZHJvcF9kb3duX2xpc3RfMSwgY29tYm9fYm94XzEsIGhpZ2hsaWdodF9zZWFyY2hfMSwgaW5jcmVtZW50YWxfc2VhcmNoXzEsIGRyb3BfZG93bl9iYXNlXzEsIGVqMl9wb3B1cHNfMSwgZWoyX2lucHV0c18xLCBlajJfZGF0YV8xKSB7XG4gICAgXCJ1c2Ugc3RyaWN0XCI7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xuICAgIHZhciBTUElOTkVSX0NMQVNTID0gJ2UtYXRjLXNwaW5uZXItaWNvbic7XG4gICAgZHJvcF9kb3duX2xpc3RfMS5kcm9wRG93bkxpc3RDbGFzc2VzLnJvb3QgPSAnZS1hdXRvY29tcGxldGUnO1xuICAgIGRyb3BfZG93bl9saXN0XzEuZHJvcERvd25MaXN0Q2xhc3Nlcy5pY29uID0gJ2UtaW5wdXQtZ3JvdXAtaWNvbiBlLWRkbC1pY29uIGUtc2VhcmNoLWljb24nO1xuICAgIHZhciBBdXRvQ29tcGxldGUgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgICAgICBfX2V4dGVuZHMoQXV0b0NvbXBsZXRlLCBfc3VwZXIpO1xuICAgICAgICBmdW5jdGlvbiBBdXRvQ29tcGxldGUob3B0aW9ucywgZWxlbWVudCkge1xuICAgICAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcywgb3B0aW9ucywgZWxlbWVudCkgfHwgdGhpcztcbiAgICAgICAgICAgIF90aGlzLmlzRmlsdGVyZWQgPSBmYWxzZTtcbiAgICAgICAgICAgIHJldHVybiBfdGhpcztcbiAgICAgICAgfVxuICAgICAgICA7XG4gICAgICAgIEF1dG9Db21wbGV0ZS5wcm90b3R5cGUucHJlUmVuZGVyID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5wcmVSZW5kZXIuY2FsbCh0aGlzKTtcbiAgICAgICAgfTtcbiAgICAgICAgQXV0b0NvbXBsZXRlLnByb3RvdHlwZS5nZXROZ0RpcmVjdGl2ZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiAnRUotQVVUT0NPTVBMRVRFJztcbiAgICAgICAgfTtcbiAgICAgICAgQXV0b0NvbXBsZXRlLnByb3RvdHlwZS5nZXRRdWVyeSA9IGZ1bmN0aW9uIChxdWVyeSkge1xuICAgICAgICAgICAgdmFyIGZpbHRlclF1ZXJ5ID0gcXVlcnkgPyBxdWVyeSA6IHRoaXMucXVlcnkgPyB0aGlzLnF1ZXJ5LmNsb25lKCkgOiBuZXcgZWoyX2RhdGFfMS5RdWVyeSgpO1xuICAgICAgICAgICAgaWYgKHRoaXMuaXNGaWx0ZXJlZCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBmaWx0ZXJRdWVyeTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh0aGlzLnF1ZXJ5U3RyaW5nICE9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgdmFyIGRhdGFUeXBlID0gdGhpcy50eXBlT2ZEYXRhKHRoaXMuZGF0YVNvdXJjZSkudHlwZW9mO1xuICAgICAgICAgICAgICAgIGlmICghKHRoaXMuZGF0YVNvdXJjZSBpbnN0YW5jZW9mIGVqMl9kYXRhXzEuRGF0YU1hbmFnZXIpICYmIGRhdGFUeXBlID09PSAnc3RyaW5nJyB8fCBkYXRhVHlwZSA9PT0gJ251bWJlcicpIHtcbiAgICAgICAgICAgICAgICAgICAgZmlsdGVyUXVlcnkud2hlcmUoJycsIHRoaXMuZmlsdGVyVHlwZSwgdGhpcy5xdWVyeVN0cmluZywgdGhpcy5pZ25vcmVDYXNlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBmaWVsZHMgPSB0aGlzLmZpZWxkcztcbiAgICAgICAgICAgICAgICAgICAgZmlsdGVyUXVlcnkud2hlcmUoIWVqMl9iYXNlXzEuaXNOdWxsT3JVbmRlZmluZWQoZmllbGRzLnZhbHVlKSA/IGZpZWxkcy52YWx1ZSA6ICcnLCB0aGlzLmZpbHRlclR5cGUsIHRoaXMucXVlcnlTdHJpbmcsIHRoaXMuaWdub3JlQ2FzZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKCFlajJfYmFzZV8xLmlzTnVsbE9yVW5kZWZpbmVkKHRoaXMuc3VnZ2VzdGlvbkNvdW50KSkge1xuICAgICAgICAgICAgICAgIGZpbHRlclF1ZXJ5LnRha2UodGhpcy5zdWdnZXN0aW9uQ291bnQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIGZpbHRlclF1ZXJ5O1xuICAgICAgICB9O1xuICAgICAgICBBdXRvQ29tcGxldGUucHJvdG90eXBlLnNlYXJjaExpc3RzID0gZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgICAgICB0aGlzLmlzVHlwZWQgPSB0cnVlO1xuICAgICAgICAgICAgdGhpcy5pc1NlbGVjdEN1c3RvbSA9IGZhbHNlO1xuICAgICAgICAgICAgaWYgKGVqMl9iYXNlXzEuaXNOdWxsT3JVbmRlZmluZWQodGhpcy5saXN0KSkge1xuICAgICAgICAgICAgICAgIF9zdXBlci5wcm90b3R5cGUucmVuZGVyTGlzdC5jYWxsKHRoaXMsIHRydWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIGlzRG93blVwS2V5ID0gZS5rZXlDb2RlID09PSA0MCB8fCBlLmtleUNvZGUgPT09IDM4O1xuICAgICAgICAgICAgdGhpcy5xdWVyeVN0cmluZyA9IHRoaXMuZmlsdGVySW5wdXQudmFsdWU7XG4gICAgICAgICAgICBpZiAoaXNEb3duVXBLZXkpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnF1ZXJ5U3RyaW5nID0gdGhpcy5xdWVyeVN0cmluZyA9PT0gJycgPyBudWxsIDogdGhpcy5xdWVyeVN0cmluZztcbiAgICAgICAgICAgICAgICB0aGlzLmJlZm9yZVBvcHVwT3BlbiA9IHRydWU7XG4gICAgICAgICAgICAgICAgdGhpcy5yZXNldExpc3QodGhpcy5kYXRhU291cmNlLCB0aGlzLmZpZWxkcyk7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5pc1NlbGVjdGVkID0gZmFsc2U7XG4gICAgICAgICAgICB0aGlzLmFjdGl2ZUluZGV4ID0gbnVsbDtcbiAgICAgICAgICAgIHZhciBldmVudEFyZ3MgPSB7XG4gICAgICAgICAgICAgICAgcHJldmVudERlZmF1bHRBY3Rpb246IGZhbHNlLFxuICAgICAgICAgICAgICAgIHRleHQ6IHRoaXMuZmlsdGVySW5wdXQudmFsdWUsXG4gICAgICAgICAgICAgICAgdXBkYXRlRGF0YTogZnVuY3Rpb24gKGRhdGFTb3VyY2UsIHF1ZXJ5LCBmaWVsZHMpIHtcbiAgICAgICAgICAgICAgICAgICAgX3RoaXMuaXNGaWx0ZXJlZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIF90aGlzLmZpbHRlckFjdGlvbihkYXRhU291cmNlLCBxdWVyeSwgZmllbGRzKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgdGhpcy50cmlnZ2VyKCdmaWx0ZXJpbmcnLCBldmVudEFyZ3MpO1xuICAgICAgICAgICAgaWYgKCF0aGlzLmlzRmlsdGVyZWQgJiYgIWV2ZW50QXJncy5wcmV2ZW50RGVmYXVsdEFjdGlvbikge1xuICAgICAgICAgICAgICAgIHRoaXMuZmlsdGVyQWN0aW9uKHRoaXMuZGF0YVNvdXJjZSwgbnVsbCwgdGhpcy5maWVsZHMpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICBBdXRvQ29tcGxldGUucHJvdG90eXBlLmZpbHRlckFjdGlvbiA9IGZ1bmN0aW9uIChkYXRhU291cmNlLCBxdWVyeSwgZmllbGRzKSB7XG4gICAgICAgICAgICB0aGlzLmJlZm9yZVBvcHVwT3BlbiA9IHRydWU7XG4gICAgICAgICAgICBpZiAodGhpcy5xdWVyeVN0cmluZyAhPT0gJycgJiYgKHRoaXMucXVlcnlTdHJpbmcubGVuZ3RoID49IHRoaXMubWluTGVuZ3RoIHx8IHRoaXMuaXNGaWx0ZXJlZCkpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnJlc2V0TGlzdChkYXRhU291cmNlLCBmaWVsZHMsIHF1ZXJ5KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHRoaXMuaGlkZVBvcHVwKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIEF1dG9Db21wbGV0ZS5wcm90b3R5cGUuY2xlYXIgPSBmdW5jdGlvbiAocHJvcGVydHkpIHtcbiAgICAgICAgICAgIGlmIChlajJfYmFzZV8xLmlzTnVsbE9yVW5kZWZpbmVkKHByb3BlcnR5KSB8fCBwcm9wZXJ0eSAhPT0gJ2RhdGFTb3VyY2UnKSB7XG4gICAgICAgICAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5jbGVhci5jYWxsKHRoaXMpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHRoaXMuYmVmb3JlUG9wdXBPcGVuKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5oaWRlUG9wdXAoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgQXV0b0NvbXBsZXRlLnByb3RvdHlwZS5vbkFjdGlvbkNvbXBsZXRlID0gZnVuY3Rpb24gKHVsRWxlbWVudCwgbGlzdCwgZSwgaXNVcGRhdGVkKSB7XG4gICAgICAgICAgICB0aGlzLmZpeGVkSGVhZGVyRWxlbWVudCA9IG51bGw7XG4gICAgICAgICAgICBfc3VwZXIucHJvdG90eXBlLm9uQWN0aW9uQ29tcGxldGUuY2FsbCh0aGlzLCB1bEVsZW1lbnQsIGxpc3QsIGUpO1xuICAgICAgICAgICAgdmFyIGl0ZW0gPSB0aGlzLmxpc3QucXVlcnlTZWxlY3RvcignLicgKyBkcm9wX2Rvd25fbGlzdF8xLmRyb3BEb3duTGlzdENsYXNzZXMubGkpO1xuICAgICAgICAgICAgaWYgKCFlajJfYmFzZV8xLmlzTnVsbE9yVW5kZWZpbmVkKGl0ZW0pKSB7XG4gICAgICAgICAgICAgICAgZWoyX2Jhc2VfMi5yZW1vdmVDbGFzcyhbaXRlbV0sIGRyb3BfZG93bl9saXN0XzEuZHJvcERvd25MaXN0Q2xhc3Nlcy5mb2N1cyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLnBvc3RCYWNrQWN0aW9uKCk7XG4gICAgICAgIH07XG4gICAgICAgIEF1dG9Db21wbGV0ZS5wcm90b3R5cGUucG9zdEJhY2tBY3Rpb24gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5xdWVyeVN0cmluZyAhPT0gbnVsbCAmJiB0aGlzLnF1ZXJ5U3RyaW5nICE9PSAnJyAmJiB0aGlzLmhpZ2hsaWdodCkge1xuICAgICAgICAgICAgICAgIGhpZ2hsaWdodF9zZWFyY2hfMS5oaWdobGlnaHRTZWFyY2godGhpcy5saXN0LCB0aGlzLnF1ZXJ5U3RyaW5nLCB0aGlzLmlnbm9yZUNhc2UsIHRoaXMuZmlsdGVyVHlwZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAodGhpcy5hdXRvZmlsbCAmJiAhZWoyX2Jhc2VfMS5pc051bGxPclVuZGVmaW5lZCh0aGlzLmxpQ29sbGVjdGlvbnNbMF0pKSB7XG4gICAgICAgICAgICAgICAgdmFyIGl0ZW1zID0gW3RoaXMubGlDb2xsZWN0aW9uc1swXV07XG4gICAgICAgICAgICAgICAgdmFyIHNlYXJjaEl0ZW0gPSBpbmNyZW1lbnRhbF9zZWFyY2hfMS5TZWFyY2godGhpcy5pbnB1dEVsZW1lbnQudmFsdWUsIGl0ZW1zLCAnU3RhcnRzV2l0aCcsIHRoaXMuaWdub3JlQ2FzZSk7XG4gICAgICAgICAgICAgICAgaWYgKCFlajJfYmFzZV8xLmlzTnVsbE9yVW5kZWZpbmVkKHNlYXJjaEl0ZW0uaXRlbSkpIHtcbiAgICAgICAgICAgICAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5zZXRBdXRvRmlsbC5jYWxsKHRoaXMsIHRoaXMubGlDb2xsZWN0aW9uc1swXSwgdHJ1ZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICBBdXRvQ29tcGxldGUucHJvdG90eXBlLnNldFNlbGVjdGlvbiA9IGZ1bmN0aW9uIChsaSwgZSkge1xuICAgICAgICAgICAgaWYgKCF0aGlzLmlzVmFsaWRMSShsaSkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoIWVqMl9iYXNlXzEuaXNOdWxsT3JVbmRlZmluZWQoZSkgJiYgZS50eXBlID09PSAna2V5ZG93bicgJiYgZS5hY3Rpb24gIT09ICdlbnRlcicgJiYgdGhpcy5pc1ZhbGlkTEkobGkpKSB7XG4gICAgICAgICAgICAgICAgdmFyIHZhbHVlID0gdGhpcy5nZXRGb3JtYXR0ZWRWYWx1ZShsaS5nZXRBdHRyaWJ1dGUoJ2RhdGEtdmFsdWUnKSk7XG4gICAgICAgICAgICAgICAgdGhpcy5hY3RpdmVJbmRleCA9IHRoaXMuZ2V0SW5kZXhCeVZhbHVlKHZhbHVlKTtcbiAgICAgICAgICAgICAgICB0aGlzLnNldEhvdmVyTGlzdChsaSk7XG4gICAgICAgICAgICAgICAgdGhpcy5zZWxlY3RlZExJID0gbGk7XG4gICAgICAgICAgICAgICAgdGhpcy5zZXRTY3JvbGxQb3NpdGlvbihlKTtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5hdXRvZmlsbCkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnByZXZlbnRBdXRvRmlsbCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICBfc3VwZXIucHJvdG90eXBlLnNldEF1dG9GaWxsLmNhbGwodGhpcywgbGkpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlajJfYmFzZV8yLmF0dHJpYnV0ZXModGhpcy5pbnB1dEVsZW1lbnQsIHsgJ2FyaWEtYWN0aXZlZGVzY2VuZGFudCc6IHRoaXMuc2VsZWN0ZWRMSSA/IHRoaXMuc2VsZWN0ZWRMSS5pZCA6IG51bGwgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBfc3VwZXIucHJvdG90eXBlLnNldFNlbGVjdGlvbi5jYWxsKHRoaXMsIGxpLCBlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgQXV0b0NvbXBsZXRlLnByb3RvdHlwZS5zaG93U3Bpbm5lciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGlmIChlajJfYmFzZV8xLmlzTnVsbE9yVW5kZWZpbmVkKHRoaXMuc3Bpbm5lckVsZW1lbnQpKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5zcGlubmVyRWxlbWVudCA9IHRoaXMuaW5wdXRXcmFwcGVyLmJ1dHRvbnNbMF0gfHwgdGhpcy5pbnB1dFdyYXBwZXIuY2xlYXJCdXR0b24gfHxcbiAgICAgICAgICAgICAgICAgICAgZWoyX2lucHV0c18xLklucHV0LmFwcGVuZFNwYW4oJ2UtaW5wdXQtZ3JvdXAtaWNvbiAnICsgU1BJTk5FUl9DTEFTUywgdGhpcy5pbnB1dFdyYXBwZXIuY29udGFpbmVyKTtcbiAgICAgICAgICAgICAgICBlajJfYmFzZV8xLmFkZENsYXNzKFt0aGlzLnNwaW5uZXJFbGVtZW50XSwgZHJvcF9kb3duX2xpc3RfMS5kcm9wRG93bkxpc3RDbGFzc2VzLmRpc2FibGVJY29uKTtcbiAgICAgICAgICAgICAgICBlajJfcG9wdXBzXzEuY3JlYXRlU3Bpbm5lcih7XG4gICAgICAgICAgICAgICAgICAgIHRhcmdldDogdGhpcy5zcGlubmVyRWxlbWVudCxcbiAgICAgICAgICAgICAgICAgICAgd2lkdGg6IGRyb3BfZG93bl9iYXNlXzEuU1BJTk5FUl9TSVpFXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgZWoyX3BvcHVwc18xLnNob3dTcGlubmVyKHRoaXMuc3Bpbm5lckVsZW1lbnQpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICBBdXRvQ29tcGxldGUucHJvdG90eXBlLmhpZGVTcGlubmVyID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgaWYgKCFlajJfYmFzZV8xLmlzTnVsbE9yVW5kZWZpbmVkKHRoaXMuc3Bpbm5lckVsZW1lbnQpKSB7XG4gICAgICAgICAgICAgICAgZWoyX3BvcHVwc18xLmhpZGVTcGlubmVyKHRoaXMuc3Bpbm5lckVsZW1lbnQpO1xuICAgICAgICAgICAgICAgIGVqMl9iYXNlXzIucmVtb3ZlQ2xhc3MoW3RoaXMuc3Bpbm5lckVsZW1lbnRdLCBkcm9wX2Rvd25fbGlzdF8xLmRyb3BEb3duTGlzdENsYXNzZXMuZGlzYWJsZUljb24pO1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLnNwaW5uZXJFbGVtZW50LmNsYXNzTGlzdC5jb250YWlucyhTUElOTkVSX0NMQVNTKSkge1xuICAgICAgICAgICAgICAgICAgICBlajJfYmFzZV8xLmRldGFjaCh0aGlzLnNwaW5uZXJFbGVtZW50KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc3Bpbm5lckVsZW1lbnQuaW5uZXJIVE1MID0gJyc7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRoaXMuc3Bpbm5lckVsZW1lbnQgPSBudWxsO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICBBdXRvQ29tcGxldGUucHJvdG90eXBlLmlzRmlsdGVyaW5nID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH07XG4gICAgICAgIEF1dG9Db21wbGV0ZS5wcm90b3R5cGUucmVuZGVyUG9wdXAgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB0aGlzLmxpc3Quc2Nyb2xsVG9wID0gMDtcbiAgICAgICAgICAgIF9zdXBlci5wcm90b3R5cGUucmVuZGVyUG9wdXAuY2FsbCh0aGlzKTtcbiAgICAgICAgICAgIGlmICh0aGlzLmhpZ2hsaWdodCkge1xuICAgICAgICAgICAgICAgIGhpZ2hsaWdodF9zZWFyY2hfMS5oaWdobGlnaHRTZWFyY2godGhpcy5saXN0LCB0aGlzLnF1ZXJ5U3RyaW5nLCB0aGlzLmlnbm9yZUNhc2UsIHRoaXMuZmlsdGVyVHlwZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIEF1dG9Db21wbGV0ZS5wcm90b3R5cGUuaXNFZGl0VGV4dEJveCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9O1xuICAgICAgICBBdXRvQ29tcGxldGUucHJvdG90eXBlLmlzUG9wdXBCdXR0b24gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5zaG93UG9wdXBCdXR0b247XG4gICAgICAgIH07XG4gICAgICAgIEF1dG9Db21wbGV0ZS5wcm90b3R5cGUuaXNTZWxlY3RGb2N1c0l0ZW0gPSBmdW5jdGlvbiAoZWxlbWVudCkge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9O1xuICAgICAgICBBdXRvQ29tcGxldGUucHJvdG90eXBlLnNob3dQb3B1cCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLmJlZm9yZVBvcHVwT3Blbikge1xuICAgICAgICAgICAgICAgIHRoaXMucmVmcmVzaFBvcHVwKCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5iZWZvcmVQb3B1cE9wZW4gPSB0cnVlO1xuICAgICAgICAgICAgdGhpcy5wcmV2ZW50QXV0b0ZpbGwgPSB0cnVlO1xuICAgICAgICAgICAgaWYgKGVqMl9iYXNlXzEuaXNOdWxsT3JVbmRlZmluZWQodGhpcy5saXN0KSkge1xuICAgICAgICAgICAgICAgIHRoaXMucmVuZGVyTGlzdCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpcy5yZXNldExpc3QodGhpcy5kYXRhU291cmNlLCB0aGlzLmZpZWxkcyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIEF1dG9Db21wbGV0ZS5wcm90b3R5cGUuaGlkZVBvcHVwID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5oaWRlUG9wdXAuY2FsbCh0aGlzKTtcbiAgICAgICAgICAgIHRoaXMuYWN0aXZlSW5kZXggPSAtMTtcbiAgICAgICAgfTtcbiAgICAgICAgQXV0b0NvbXBsZXRlLnByb3RvdHlwZS5vblByb3BlcnR5Q2hhbmdlZCA9IGZ1bmN0aW9uIChuZXdQcm9wLCBvbGRQcm9wKSB7XG4gICAgICAgICAgICBmb3IgKHZhciBfaSA9IDAsIF9hID0gT2JqZWN0LmtleXMobmV3UHJvcCk7IF9pIDwgX2EubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgICAgICAgICAgdmFyIHByb3AgPSBfYVtfaV07XG4gICAgICAgICAgICAgICAgc3dpdGNoIChwcm9wKSB7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgJ3Nob3dQb3B1cEJ1dHRvbic6XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5zaG93UG9wdXBCdXR0b24pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgYnV0dG9uID0gZWoyX2lucHV0c18xLklucHV0LmFwcGVuZFNwYW4oZHJvcF9kb3duX2xpc3RfMS5kcm9wRG93bkxpc3RDbGFzc2VzLmljb24sIHRoaXMuaW5wdXRXcmFwcGVyLmNvbnRhaW5lcik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5pbnB1dFdyYXBwZXIuYnV0dG9uc1swXSA9IGJ1dHRvbjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlajJfYmFzZV8xLkV2ZW50SGFuZGxlci5hZGQodGhpcy5pbnB1dFdyYXBwZXIuYnV0dG9uc1swXSwgJ2NsaWNrJywgdGhpcy5kcm9wRG93bkNsaWNrLCB0aGlzKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVqMl9iYXNlXzEuZGV0YWNoKHRoaXMuaW5wdXRXcmFwcGVyLmJ1dHRvbnNbMF0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuaW5wdXRXcmFwcGVyLmJ1dHRvbnNbMF0gPSBudWxsO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgYXRjUHJvcHMgPSB2b2lkIDA7XG4gICAgICAgICAgICAgICAgICAgICAgICBhdGNQcm9wcyA9IHRoaXMuZ2V0UHJvcE9iamVjdChwcm9wLCBuZXdQcm9wLCBvbGRQcm9wKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIF9zdXBlci5wcm90b3R5cGUub25Qcm9wZXJ0eUNoYW5nZWQuY2FsbCh0aGlzLCBhdGNQcm9wcy5uZXdQcm9wZXJ0eSwgYXRjUHJvcHMub2xkUHJvcGVydHkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICBBdXRvQ29tcGxldGUucHJvdG90eXBlLmdldE1vZHVsZU5hbWUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gJ2F1dG9jb21wbGV0ZSc7XG4gICAgICAgIH07XG4gICAgICAgIEF1dG9Db21wbGV0ZS5wcm90b3R5cGUucmVuZGVyID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5yZW5kZXIuY2FsbCh0aGlzKTtcbiAgICAgICAgfTtcbiAgICAgICAgO1xuICAgICAgICByZXR1cm4gQXV0b0NvbXBsZXRlO1xuICAgIH0oY29tYm9fYm94XzEuQ29tYm9Cb3gpKTtcbiAgICBfX2RlY29yYXRlKFtcbiAgICAgICAgZWoyX2Jhc2VfMS5Qcm9wZXJ0eSh7IHZhbHVlOiBudWxsLCBpY29uQ3NzOiBudWxsLCBncm91cEJ5OiBudWxsIH0pXG4gICAgXSwgQXV0b0NvbXBsZXRlLnByb3RvdHlwZSwgXCJmaWVsZHNcIiwgdm9pZCAwKTtcbiAgICBfX2RlY29yYXRlKFtcbiAgICAgICAgZWoyX2Jhc2VfMS5Qcm9wZXJ0eSh0cnVlKVxuICAgIF0sIEF1dG9Db21wbGV0ZS5wcm90b3R5cGUsIFwiaWdub3JlQ2FzZVwiLCB2b2lkIDApO1xuICAgIF9fZGVjb3JhdGUoW1xuICAgICAgICBlajJfYmFzZV8xLlByb3BlcnR5KGZhbHNlKVxuICAgIF0sIEF1dG9Db21wbGV0ZS5wcm90b3R5cGUsIFwic2hvd1BvcHVwQnV0dG9uXCIsIHZvaWQgMCk7XG4gICAgX19kZWNvcmF0ZShbXG4gICAgICAgIGVqMl9iYXNlXzEuUHJvcGVydHkoZmFsc2UpXG4gICAgXSwgQXV0b0NvbXBsZXRlLnByb3RvdHlwZSwgXCJoaWdobGlnaHRcIiwgdm9pZCAwKTtcbiAgICBfX2RlY29yYXRlKFtcbiAgICAgICAgZWoyX2Jhc2VfMS5Qcm9wZXJ0eSgyMClcbiAgICBdLCBBdXRvQ29tcGxldGUucHJvdG90eXBlLCBcInN1Z2dlc3Rpb25Db3VudFwiLCB2b2lkIDApO1xuICAgIF9fZGVjb3JhdGUoW1xuICAgICAgICBlajJfYmFzZV8xLlByb3BlcnR5KHt9KVxuICAgIF0sIEF1dG9Db21wbGV0ZS5wcm90b3R5cGUsIFwiaHRtbEF0dHJpYnV0ZXNcIiwgdm9pZCAwKTtcbiAgICBfX2RlY29yYXRlKFtcbiAgICAgICAgZWoyX2Jhc2VfMS5Qcm9wZXJ0eShudWxsKVxuICAgIF0sIEF1dG9Db21wbGV0ZS5wcm90b3R5cGUsIFwicXVlcnlcIiwgdm9pZCAwKTtcbiAgICBfX2RlY29yYXRlKFtcbiAgICAgICAgZWoyX2Jhc2VfMS5Qcm9wZXJ0eSgxKVxuICAgIF0sIEF1dG9Db21wbGV0ZS5wcm90b3R5cGUsIFwibWluTGVuZ3RoXCIsIHZvaWQgMCk7XG4gICAgX19kZWNvcmF0ZShbXG4gICAgICAgIGVqMl9iYXNlXzEuUHJvcGVydHkoJ0NvbnRhaW5zJylcbiAgICBdLCBBdXRvQ29tcGxldGUucHJvdG90eXBlLCBcImZpbHRlclR5cGVcIiwgdm9pZCAwKTtcbiAgICBfX2RlY29yYXRlKFtcbiAgICAgICAgZWoyX2Jhc2VfMS5FdmVudCgpXG4gICAgXSwgQXV0b0NvbXBsZXRlLnByb3RvdHlwZSwgXCJmaWx0ZXJpbmdcIiwgdm9pZCAwKTtcbiAgICBfX2RlY29yYXRlKFtcbiAgICAgICAgZWoyX2Jhc2VfMS5Qcm9wZXJ0eShudWxsKVxuICAgIF0sIEF1dG9Db21wbGV0ZS5wcm90b3R5cGUsIFwiaW5kZXhcIiwgdm9pZCAwKTtcbiAgICBfX2RlY29yYXRlKFtcbiAgICAgICAgZWoyX2Jhc2VfMS5Qcm9wZXJ0eShudWxsKVxuICAgIF0sIEF1dG9Db21wbGV0ZS5wcm90b3R5cGUsIFwidmFsdWVUZW1wbGF0ZVwiLCB2b2lkIDApO1xuICAgIF9fZGVjb3JhdGUoW1xuICAgICAgICBlajJfYmFzZV8xLlByb3BlcnR5KG51bGwpXG4gICAgXSwgQXV0b0NvbXBsZXRlLnByb3RvdHlwZSwgXCJmaWx0ZXJCYXJQbGFjZWhvbGRlclwiLCB2b2lkIDApO1xuICAgIF9fZGVjb3JhdGUoW1xuICAgICAgICBlajJfYmFzZV8xLlByb3BlcnR5KGZhbHNlKVxuICAgIF0sIEF1dG9Db21wbGV0ZS5wcm90b3R5cGUsIFwiYWxsb3dGaWx0ZXJpbmdcIiwgdm9pZCAwKTtcbiAgICBfX2RlY29yYXRlKFtcbiAgICAgICAgZWoyX2Jhc2VfMS5Qcm9wZXJ0eShudWxsKVxuICAgIF0sIEF1dG9Db21wbGV0ZS5wcm90b3R5cGUsIFwidGV4dFwiLCB2b2lkIDApO1xuICAgIEF1dG9Db21wbGV0ZSA9IF9fZGVjb3JhdGUoW1xuICAgICAgICBlajJfYmFzZV8yLk5vdGlmeVByb3BlcnR5Q2hhbmdlc1xuICAgIF0sIEF1dG9Db21wbGV0ZSk7XG4gICAgZXhwb3J0cy5BdXRvQ29tcGxldGUgPSBBdXRvQ29tcGxldGU7XG59KTtcblxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vc3JjL2F1dG8tY29tcGxldGUvYXV0by1jb21wbGV0ZS5qc1xuLy8gbW9kdWxlIGlkID0gMTZcbi8vIG1vZHVsZSBjaHVua3MgPSAwIiwiZGVmaW5lKFtcInJlcXVpcmVcIiwgXCJleHBvcnRzXCIsIFwiLi9tdWx0aS1zZWxlY3RcIl0sIGZ1bmN0aW9uIChyZXF1aXJlLCBleHBvcnRzLCBtdWx0aV9zZWxlY3RfMSkge1xuICAgIFwidXNlIHN0cmljdFwiO1xuICAgIGZ1bmN0aW9uIF9fZXhwb3J0KG0pIHtcbiAgICAgICAgZm9yICh2YXIgcCBpbiBtKSBpZiAoIWV4cG9ydHMuaGFzT3duUHJvcGVydHkocCkpIGV4cG9ydHNbcF0gPSBtW3BdO1xuICAgIH1cbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG4gICAgX19leHBvcnQobXVsdGlfc2VsZWN0XzEpO1xufSk7XG5cblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL3NyYy9tdWx0aS1zZWxlY3QvaW5kZXguanNcbi8vIG1vZHVsZSBpZCA9IDE3XG4vLyBtb2R1bGUgY2h1bmtzID0gMCIsInZhciBfX2V4dGVuZHMgPSAodGhpcyAmJiB0aGlzLl9fZXh0ZW5kcykgfHwgKGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgZXh0ZW5kU3RhdGljcyA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fFxuICAgICAgICAoeyBfX3Byb3RvX186IFtdIH0gaW5zdGFuY2VvZiBBcnJheSAmJiBmdW5jdGlvbiAoZCwgYikgeyBkLl9fcHJvdG9fXyA9IGI7IH0pIHx8XG4gICAgICAgIGZ1bmN0aW9uIChkLCBiKSB7IGZvciAodmFyIHAgaW4gYikgaWYgKGIuaGFzT3duUHJvcGVydHkocCkpIGRbcF0gPSBiW3BdOyB9O1xuICAgIHJldHVybiBmdW5jdGlvbiAoZCwgYikge1xuICAgICAgICBleHRlbmRTdGF0aWNzKGQsIGIpO1xuICAgICAgICBmdW5jdGlvbiBfXygpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGQ7IH1cbiAgICAgICAgZC5wcm90b3R5cGUgPSBiID09PSBudWxsID8gT2JqZWN0LmNyZWF0ZShiKSA6IChfXy5wcm90b3R5cGUgPSBiLnByb3RvdHlwZSwgbmV3IF9fKCkpO1xuICAgIH07XG59KSgpO1xudmFyIF9fZGVjb3JhdGUgPSAodGhpcyAmJiB0aGlzLl9fZGVjb3JhdGUpIHx8IGZ1bmN0aW9uIChkZWNvcmF0b3JzLCB0YXJnZXQsIGtleSwgZGVzYykge1xuICAgIHZhciBjID0gYXJndW1lbnRzLmxlbmd0aCwgciA9IGMgPCAzID8gdGFyZ2V0IDogZGVzYyA9PT0gbnVsbCA/IGRlc2MgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKHRhcmdldCwga2V5KSA6IGRlc2MsIGQ7XG4gICAgaWYgKHR5cGVvZiBSZWZsZWN0ID09PSBcIm9iamVjdFwiICYmIHR5cGVvZiBSZWZsZWN0LmRlY29yYXRlID09PSBcImZ1bmN0aW9uXCIpIHIgPSBSZWZsZWN0LmRlY29yYXRlKGRlY29yYXRvcnMsIHRhcmdldCwga2V5LCBkZXNjKTtcbiAgICBlbHNlIGZvciAodmFyIGkgPSBkZWNvcmF0b3JzLmxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tKSBpZiAoZCA9IGRlY29yYXRvcnNbaV0pIHIgPSAoYyA8IDMgPyBkKHIpIDogYyA+IDMgPyBkKHRhcmdldCwga2V5LCByKSA6IGQodGFyZ2V0LCBrZXkpKSB8fCByO1xuICAgIHJldHVybiBjID4gMyAmJiByICYmIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGtleSwgciksIHI7XG59O1xuZGVmaW5lKFtcInJlcXVpcmVcIiwgXCJleHBvcnRzXCIsIFwiLi4vZHJvcC1kb3duLWJhc2UvZHJvcC1kb3duLWJhc2VcIiwgXCJAc3luY2Z1c2lvbi9lajItcG9wdXBzXCIsIFwiQHN5bmNmdXNpb24vZWoyLWJhc2VcIiwgXCJAc3luY2Z1c2lvbi9lajItYmFzZVwiLCBcIkBzeW5jZnVzaW9uL2VqMi1iYXNlXCIsIFwiQHN5bmNmdXNpb24vZWoyLWJhc2VcIiwgXCIuLi9jb21tb24vaW5jcmVtZW50YWwtc2VhcmNoXCIsIFwiQHN5bmNmdXNpb24vZWoyLWJhc2VcIiwgXCJAc3luY2Z1c2lvbi9lajItYmFzZVwiLCBcIkBzeW5jZnVzaW9uL2VqMi1kYXRhXCJdLCBmdW5jdGlvbiAocmVxdWlyZSwgZXhwb3J0cywgZHJvcF9kb3duX2Jhc2VfMSwgZWoyX3BvcHVwc18xLCBlajJfYmFzZV8xLCBlajJfYmFzZV8yLCBlajJfYmFzZV8zLCBlajJfYmFzZV80LCBpbmNyZW1lbnRhbF9zZWFyY2hfMSwgZWoyX2Jhc2VfNSwgZWoyX2Jhc2VfNiwgZWoyX2RhdGFfMSkge1xuICAgIFwidXNlIHN0cmljdFwiO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbiAgICB2YXIgRk9DVVMgPSAnZS1pbnB1dC1mb2N1cyc7XG4gICAgdmFyIERJU0FCTEVEID0gJ2UtZGlzYWJsZWQnO1xuICAgIHZhciBPVkVSX0FMTF9XUkFQUEVSID0gJ2UtbXVsdGlzZWxlY3QgZS1pbnB1dC1ncm91cCc7XG4gICAgdmFyIEVMRU1FTlRfV1JBUFBFUiA9ICdlLW11bHRpLXNlbGVjdC13cmFwcGVyJztcbiAgICB2YXIgRUxFTUVOVF9NT0JJTEVfV1JBUFBFUiA9ICdlLW1vYi13cmFwcGVyJztcbiAgICB2YXIgSElERV9MSVNUID0gJ2UtaGlkZS1saXN0aXRlbSc7XG4gICAgdmFyIERFTElNSVRFUl9WSUVXID0gJ2UtZGVsaW0tdmlldyc7XG4gICAgdmFyIENISVBfV1JBUFBFUiA9ICdlLWNoaXBzLWNvbGxlY3Rpb24nO1xuICAgIHZhciBDSElQID0gJ2UtY2hpcHMnO1xuICAgIHZhciBDSElQX0NPTlRFTlQgPSAnZS1jaGlwY29udGVudCc7XG4gICAgdmFyIENISVBfQ0xPU0UgPSAnZS1jaGlwcy1jbG9zZSBlLWljb24nO1xuICAgIHZhciBDSElQX1NFTEVDVEVEID0gJ2UtY2hpcC1zZWxlY3RlZCc7XG4gICAgdmFyIFNFQVJDSEJPWF9XUkFQUEVSID0gJ2Utc2VhcmNoZXInO1xuICAgIHZhciBERUxJTUlURVJfVklFV19XUkFQUEVSID0gJ2UtZGVsaW1pdGVyJztcbiAgICB2YXIgWkVST19TSVpFID0gJ2UtemVyby1zaXplJztcbiAgICB2YXIgUkVNQUlOX1dSQVBQRVIgPSAnZS1yZW1haW4nO1xuICAgIHZhciBDTE9TRUlDT05fQ0xBU1MgPSAnZS1jaGlwcy1jbG9zZSBlLWljb24gZS1jbG9zZS1ob29rZXInO1xuICAgIHZhciBERUxJTUlURVJfV1JBUFBFUiA9ICdlLWRlbGltLXZhbHVlcyc7XG4gICAgdmFyIFBPUFVQX1dSQVBQRVIgPSAnZS1kZGwgZS1wb3B1cCBlLW11bHRpLXNlbGVjdC1saXN0LXdyYXBwZXInO1xuICAgIHZhciBJTlBVVF9FTEVNRU5UID0gJ2UtZHJvcGRvd25iYXNlJztcbiAgICB2YXIgUlRMX0NMQVNTID0gJ2UtcnRsJztcbiAgICB2YXIgQ0xPU0VfSUNPTl9ISURFID0gJ2UtY2xvc2UtaWNvbi1oaWRlJztcbiAgICB2YXIgTU9CSUxFX0NISVAgPSAnZS1tb2ItY2hpcCc7XG4gICAgdmFyIEZPT1RFUiA9ICdlLWRkbC1mb290ZXInO1xuICAgIHZhciBIRUFERVIgPSAnZS1kZGwtaGVhZGVyJztcbiAgICB2YXIgRElTQUJMRV9JQ09OID0gJ2UtZGRsLWRpc2FibGUtaWNvbic7XG4gICAgdmFyIFNQSU5ORVJfQ0xBU1MgPSAnZS1tcy1zcGlubmVyLWljb24nO1xuICAgIHZhciBNdWx0aVNlbGVjdCA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgICAgIF9fZXh0ZW5kcyhNdWx0aVNlbGVjdCwgX3N1cGVyKTtcbiAgICAgICAgZnVuY3Rpb24gTXVsdGlTZWxlY3Qob3B0aW9uLCBlbGVtZW50KSB7XG4gICAgICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzLCBvcHRpb24sIGVsZW1lbnQpIHx8IHRoaXM7XG4gICAgICAgICAgICBfdGhpcy5pc1ZhbGlkS2V5ID0gZmFsc2U7XG4gICAgICAgICAgICBfdGhpcy5tYWluTGlzdENvbGxlY3Rpb24gPSBbXTtcbiAgICAgICAgICAgIF90aGlzLmJlZm9yZVBvcHVwT3BlbiA9IGZhbHNlO1xuICAgICAgICAgICAgX3RoaXMuc2Nyb2xsRm9jdXNTdGF0dXMgPSBmYWxzZTtcbiAgICAgICAgICAgIF90aGlzLmtleURvd25TdGF0dXMgPSBmYWxzZTtcbiAgICAgICAgICAgIHJldHVybiBfdGhpcztcbiAgICAgICAgfVxuICAgICAgICA7XG4gICAgICAgIE11bHRpU2VsZWN0LnByb3RvdHlwZS5lbmFibGVSVEwgPSBmdW5jdGlvbiAoc3RhdGUpIHtcbiAgICAgICAgICAgIHRoaXMuZW5hYmxlUnRsID0gc3RhdGU7XG4gICAgICAgICAgICBpZiAoc3RhdGUpIHtcbiAgICAgICAgICAgICAgICB0aGlzLm92ZXJBbGxXcmFwcGVyLmNsYXNzTGlzdC5hZGQoUlRMX0NMQVNTKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHRoaXMub3ZlckFsbFdyYXBwZXIuY2xhc3NMaXN0LnJlbW92ZShSVExfQ0xBU1MpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHRoaXMucG9wdXBPYmopIHtcbiAgICAgICAgICAgICAgICB0aGlzLnBvcHVwT2JqLmVuYWJsZVJ0bCA9IHN0YXRlO1xuICAgICAgICAgICAgICAgIHRoaXMucG9wdXBPYmouZGF0YUJpbmQoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgTXVsdGlTZWxlY3QucHJvdG90eXBlLnVwZGF0ZUhUTUxBdHRyaWJ1dGUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBpZiAoT2JqZWN0LmtleXModGhpcy5odG1sQXR0cmlidXRlcykubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgX2kgPSAwLCBfYSA9IE9iamVjdC5rZXlzKHRoaXMuaHRtbEF0dHJpYnV0ZXMpOyBfaSA8IF9hLmxlbmd0aDsgX2krKykge1xuICAgICAgICAgICAgICAgICAgICB2YXIgaHRtbEF0dHIgPSBfYVtfaV07XG4gICAgICAgICAgICAgICAgICAgIHN3aXRjaCAoaHRtbEF0dHIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ2NsYXNzJzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm92ZXJBbGxXcmFwcGVyLmNsYXNzTGlzdC5hZGQodGhpcy5odG1sQXR0cmlidXRlc1todG1sQXR0cl0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucG9wdXBXcmFwcGVyLmNsYXNzTGlzdC5hZGQodGhpcy5odG1sQXR0cmlidXRlc1todG1sQXR0cl0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnZGlzYWJsZWQnOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZW5hYmxlKGZhbHNlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ3BsYWNlaG9sZGVyJzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmlucHV0RWxlbWVudC5zZXRBdHRyaWJ1dGUoaHRtbEF0dHIsIHRoaXMuaHRtbEF0dHJpYnV0ZXNbaHRtbEF0dHJdKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ25hbWUnOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuaGlkZGVuRWxlbWVudC5zZXRBdHRyaWJ1dGUoaHRtbEF0dHIsIHRoaXMuaHRtbEF0dHJpYnV0ZXNbaHRtbEF0dHJdKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGRlZmF1bHRBdHRyID0gWyd0aXRsZScsICdpZCcsICdyZXF1aXJlZCddO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkZWZhdWx0QXR0ci5pbmRleE9mKGh0bWxBdHRyKSA+IC0xKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZWxlbWVudC5zZXRBdHRyaWJ1dGUoaHRtbEF0dHIsIHRoaXMuaHRtbEF0dHJpYnV0ZXNbaHRtbEF0dHJdKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMub3ZlckFsbFdyYXBwZXIuc2V0QXR0cmlidXRlKGh0bWxBdHRyLCB0aGlzLmh0bWxBdHRyaWJ1dGVzW2h0bWxBdHRyXSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICBNdWx0aVNlbGVjdC5wcm90b3R5cGUudXBkYXRlUmVhZG9ubHkgPSBmdW5jdGlvbiAoc3RhdGUpIHtcbiAgICAgICAgICAgIGlmIChzdGF0ZSkge1xuICAgICAgICAgICAgICAgIHRoaXMuaW5wdXRFbGVtZW50LnNldEF0dHJpYnV0ZSgncmVhZG9ubHknLCAndHJ1ZScpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpcy5pbnB1dEVsZW1lbnQucmVtb3ZlQXR0cmlidXRlKCdyZWFkb25seScpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICBNdWx0aVNlbGVjdC5wcm90b3R5cGUudXBkYXRlQ2xlYXJCdXR0b24gPSBmdW5jdGlvbiAoc3RhdGUpIHtcbiAgICAgICAgICAgIGlmIChzdGF0ZSkge1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLm92ZXJBbGxDbGVhci5wYXJlbnROb2RlKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMub3ZlckFsbENsZWFyLnN0eWxlLmRpc3BsYXkgPSAnJztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY29tcG9uZW50V3JhcHBlci5hcHBlbmRDaGlsZCh0aGlzLm92ZXJBbGxDbGVhcik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRoaXMuY29tcG9uZW50V3JhcHBlci5jbGFzc0xpc3QucmVtb3ZlKENMT1NFX0lDT05fSElERSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aGlzLm92ZXJBbGxDbGVhci5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xuICAgICAgICAgICAgICAgIHRoaXMuY29tcG9uZW50V3JhcHBlci5jbGFzc0xpc3QuYWRkKENMT1NFX0lDT05fSElERSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIE11bHRpU2VsZWN0LnByb3RvdHlwZS51cGRhdGVDc3NDbGFzcyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLmNzc0NsYXNzKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5wb3B1cFdyYXBwZXIuY2xhc3NMaXN0LmFkZCh0aGlzLmNzc0NsYXNzKTtcbiAgICAgICAgICAgICAgICB0aGlzLm92ZXJBbGxXcmFwcGVyLmNsYXNzTGlzdC5hZGQodGhpcy5jc3NDbGFzcyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIE11bHRpU2VsZWN0LnByb3RvdHlwZS5vblBvcHVwU2hvd24gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgYW5pbU1vZGVsID0geyBuYW1lOiAnRmFkZUluJywgZHVyYXRpb246IDEwMCB9O1xuICAgICAgICAgICAgdGhpcy5mb2N1c0F0Rmlyc3RMaXN0SXRlbSgpO1xuICAgICAgICAgICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZCh0aGlzLnBvcHVwT2JqLmVsZW1lbnQpO1xuICAgICAgICAgICAgdGhpcy5yZWZyZXNoUG9wdXAoKTtcbiAgICAgICAgICAgIHRoaXMucG9wdXBPYmouc2hvdyhhbmltTW9kZWwpO1xuICAgICAgICAgICAgZWoyX2Jhc2VfMS5hdHRyaWJ1dGVzKHRoaXMuaW5wdXRFbGVtZW50LCB7ICdhcmlhLWV4cGFuZGVkJzogJ3RydWUnIH0pO1xuICAgICAgICAgICAgdmFyIGV2ZW50QXJncyA9IHsgcG9wdXA6IHRoaXMucG9wdXBPYmogfTtcbiAgICAgICAgICAgIHRoaXMucmVmcmVzaExpc3RJdGVtcyhudWxsKTtcbiAgICAgICAgICAgIHRoaXMudHJpZ2dlcignb3BlbicsIGV2ZW50QXJncyk7XG4gICAgICAgIH07XG4gICAgICAgIE11bHRpU2VsZWN0LnByb3RvdHlwZS5mb2N1c0F0Rmlyc3RMaXN0SXRlbSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLnVsRWxlbWVudCAmJiB0aGlzLnVsRWxlbWVudC5xdWVyeVNlbGVjdG9yKCdsaS4nXG4gICAgICAgICAgICAgICAgKyBkcm9wX2Rvd25fYmFzZV8xLmRyb3BEb3duQmFzZUNsYXNzZXMubGkpKSB7XG4gICAgICAgICAgICAgICAgdmFyIGVsZW1lbnQgPSB0aGlzLnVsRWxlbWVudC5xdWVyeVNlbGVjdG9yKCdsaS4nXG4gICAgICAgICAgICAgICAgICAgICsgZHJvcF9kb3duX2Jhc2VfMS5kcm9wRG93bkJhc2VDbGFzc2VzLmxpICsgJzpub3QoLidcbiAgICAgICAgICAgICAgICAgICAgKyBISURFX0xJU1QgKyAnKScpO1xuICAgICAgICAgICAgICAgIGlmIChlbGVtZW50ICE9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucmVtb3ZlRm9jdXMoKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5hZGRMaXN0Rm9jdXMoZWxlbWVudCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICBNdWx0aVNlbGVjdC5wcm90b3R5cGUuZm9jdXNBdExhc3RMaXN0SXRlbSA9IGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICB2YXIgYWN0aXZlRWxlbWVudDtcbiAgICAgICAgICAgIGlmIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgYWN0aXZlRWxlbWVudCA9IGluY3JlbWVudGFsX3NlYXJjaF8xLlNlYXJjaChkYXRhLCB0aGlzLmxpQ29sbGVjdGlvbnMsICdTdGFydHNXaXRoJywgdGhpcy5pZ25vcmVDYXNlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLnZhbHVlICYmIHRoaXMudmFsdWUubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgICAgIGluY3JlbWVudGFsX3NlYXJjaF8xLlNlYXJjaCh0aGlzLnZhbHVlW3RoaXMudmFsdWUubGVuZ3RoIC0gMV0sIHRoaXMubGlDb2xsZWN0aW9ucywgJ1N0YXJ0c1dpdGgnLCB0aGlzLmlnbm9yZUNhc2UpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgYWN0aXZlRWxlbWVudCA9IG51bGw7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGFjdGl2ZUVsZW1lbnQgJiYgYWN0aXZlRWxlbWVudC5pdGVtICE9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5hZGRMaXN0Rm9jdXMoYWN0aXZlRWxlbWVudC5pdGVtKTtcbiAgICAgICAgICAgICAgICB0aGlzLnNjcm9sbEJvdHRvbShhY3RpdmVFbGVtZW50Lml0ZW0sIGFjdGl2ZUVsZW1lbnQuaW5kZXgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICBNdWx0aVNlbGVjdC5wcm90b3R5cGUuZ2V0QXJpYUF0dHJpYnV0ZXMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgYXJpYUF0dHJpYnV0ZXMgPSB7XG4gICAgICAgICAgICAgICAgJ2FyaWEtZGlzYWJsZWQnOiAnZmFsc2UnLFxuICAgICAgICAgICAgICAgICdhcmlhLW93bnMnOiB0aGlzLmVsZW1lbnQuaWQgKyAnX29wdGlvbnMnLFxuICAgICAgICAgICAgICAgICdyb2xlJzogJ2xpc3Rib3gnLFxuICAgICAgICAgICAgICAgICdhcmlhLW11bHRpc2VsZWN0YWJsZSc6ICd0cnVlJyxcbiAgICAgICAgICAgICAgICAnYXJpYS1hY3RpdmVkZXNjZW5kYW50JzogJ251bGwnLFxuICAgICAgICAgICAgICAgICdhcmlhLWhhc3BvcHVwJzogJ3RydWUnLFxuICAgICAgICAgICAgICAgICdhcmlhLWV4cGFuZGVkJzogJ2ZhbHNlJ1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHJldHVybiBhcmlhQXR0cmlidXRlcztcbiAgICAgICAgfTtcbiAgICAgICAgTXVsdGlTZWxlY3QucHJvdG90eXBlLnVwZGF0ZUxpc3RBUklBID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgZWoyX2Jhc2VfMS5hdHRyaWJ1dGVzKHRoaXMudWxFbGVtZW50LCB7ICdpZCc6IHRoaXMuZWxlbWVudC5pZCArICdfb3B0aW9ucycsICdyb2xlJzogJ2xpc3Rib3gnLCAnYXJpYS1oaWRkZW4nOiAnZmFsc2UnIH0pO1xuICAgICAgICAgICAgZWoyX2Jhc2VfMS5hdHRyaWJ1dGVzKHRoaXMuaW5wdXRFbGVtZW50LCB0aGlzLmdldEFyaWFBdHRyaWJ1dGVzKCkpO1xuICAgICAgICAgICAgdmFyIGxpO1xuICAgICAgICAgICAgbGkgPSB0aGlzLmxpc3QucXVlcnlTZWxlY3RvckFsbCgnbGkuJyArIGRyb3BfZG93bl9iYXNlXzEuZHJvcERvd25CYXNlQ2xhc3Nlcy5saSk7XG4gICAgICAgICAgICB2YXIgdGVtcCA9IGxpLmxlbmd0aDtcbiAgICAgICAgICAgIGlmIChsaSAmJiBsaS5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICB3aGlsZSAodGVtcCA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGxpW3RlbXAgLSAxXS5nZXRBdHRyaWJ1dGUoJ2FyaWEtc2VsZWN0ZWQnKSAhPT0gJ3RydWUnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBsaVt0ZW1wIC0gMV0uc2V0QXR0cmlidXRlKCdhcmlhLXNlbGVjdGVkJywgJ2ZhbHNlJyk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgdGVtcC0tO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgTXVsdGlTZWxlY3QucHJvdG90eXBlLnJlbW92ZWxhc3RTZWxlY3Rpb24gPSBmdW5jdGlvbiAoZSkge1xuICAgICAgICAgICAgdmFyIGVsZW1lbnRzO1xuICAgICAgICAgICAgZWxlbWVudHMgPSB0aGlzLmNoaXBDb2xsZWN0aW9uV3JhcHBlci5xdWVyeVNlbGVjdG9yQWxsKCdzcGFuLicgKyBDSElQKTtcbiAgICAgICAgICAgIHZhciB2YWx1ZSA9IGVsZW1lbnRzW2VsZW1lbnRzLmxlbmd0aCAtIDFdLmdldEF0dHJpYnV0ZSgnZGF0YS12YWx1ZScpO1xuICAgICAgICAgICAgdGhpcy5yZW1vdmVWYWx1ZSh2YWx1ZSwgZSk7XG4gICAgICAgICAgICB0aGlzLnJlbW92ZUNoaXBTZWxlY3Rpb24oKTtcbiAgICAgICAgICAgIHRoaXMudXBkYXRlRGVsaW1ldGVyKGUpO1xuICAgICAgICAgICAgdGhpcy5tYWtlVGV4dEJveEVtcHR5KCk7XG4gICAgICAgICAgICBpZiAodGhpcy5hbGxvd0ZpbHRlcmluZyAmJiB0aGlzLm1haW5MaXN0ICYmIHRoaXMubGlzdERhdGEpIHtcbiAgICAgICAgICAgICAgICB2YXIgbGlzdCA9IHRoaXMubWFpbkxpc3QuY2xvbmVOb2RlID8gdGhpcy5tYWluTGlzdC5jbG9uZU5vZGUodHJ1ZSkgOiB0aGlzLm1haW5MaXN0O1xuICAgICAgICAgICAgICAgIHRoaXMub25BY3Rpb25Db21wbGV0ZShsaXN0LCB0aGlzLm1haW5EYXRhKTtcbiAgICAgICAgICAgICAgICB0aGlzLnJlZnJlc2hTZWxlY3Rpb24oKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuZm9jdXNBdExhc3RMaXN0SXRlbSh2YWx1ZSk7XG4gICAgICAgIH07XG4gICAgICAgIE11bHRpU2VsZWN0LnByb3RvdHlwZS5vbkFjdGlvbkZhaWx1cmUgPSBmdW5jdGlvbiAoZSkge1xuICAgICAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5vbkFjdGlvbkZhaWx1cmUuY2FsbCh0aGlzLCBlKTtcbiAgICAgICAgICAgIHRoaXMucmVuZGVyUG9wdXAoKTtcbiAgICAgICAgICAgIHRoaXMub25Qb3B1cFNob3duKCk7XG4gICAgICAgIH07XG4gICAgICAgIE11bHRpU2VsZWN0LnByb3RvdHlwZS5vbkFjdGlvbkNvbXBsZXRlID0gZnVuY3Rpb24gKHVsRWxlbWVudCwgbGlzdCwgZSwgaXNVcGRhdGVkKSB7XG4gICAgICAgICAgICBfc3VwZXIucHJvdG90eXBlLm9uQWN0aW9uQ29tcGxldGUuY2FsbCh0aGlzLCB1bEVsZW1lbnQsIGxpc3QsIGUpO1xuICAgICAgICAgICAgaWYgKCF0aGlzLm1haW5MaXN0ICYmICF0aGlzLm1haW5EYXRhKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5tYWluTGlzdCA9IHVsRWxlbWVudC5jbG9uZU5vZGUgPyB1bEVsZW1lbnQuY2xvbmVOb2RlKHRydWUpIDogdWxFbGVtZW50O1xuICAgICAgICAgICAgICAgIHRoaXMubWFpbkRhdGEgPSBsaXN0O1xuICAgICAgICAgICAgICAgIHRoaXMubWFpbkxpc3RDb2xsZWN0aW9uID0gdGhpcy5saUNvbGxlY3Rpb25zO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHRoaXMucmVtb3RlQ3VzdG9tVmFsdWUgJiYgdGhpcy5hbGxvd0N1c3RvbVZhbHVlICYmIHRoaXMuaW5wdXRGb2N1cykge1xuICAgICAgICAgICAgICAgIHRoaXMuY2hlY2tGb3JDdXN0b21WYWx1ZSh0aGlzLnRlbXBRdWVyeSwgdGhpcy5maWVsZHMpO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh0aGlzLnZhbHVlICYmIHRoaXMudmFsdWUubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5yZWZyZXNoU2VsZWN0aW9uKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLnVwZGF0ZUxpc3RBUklBKCk7XG4gICAgICAgICAgICB0aGlzLnVud2lyZUxpc3RFdmVudHMoKTtcbiAgICAgICAgICAgIHRoaXMud2lyZUxpc3RFdmVudHMoKTtcbiAgICAgICAgICAgIGlmICghZWoyX2Jhc2VfNi5pc051bGxPclVuZGVmaW5lZCh0aGlzLnNldEluaXRpYWxWYWx1ZSkpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnNldEluaXRpYWxWYWx1ZSgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKCFlajJfYmFzZV82LmlzTnVsbE9yVW5kZWZpbmVkKHRoaXMuc2VsZWN0QWxsQWN0aW9uKSkge1xuICAgICAgICAgICAgICAgIHRoaXMuc2VsZWN0QWxsQWN0aW9uKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLnJlbmRlclBvcHVwKCk7XG4gICAgICAgICAgICB0aGlzLnJlZnJlc2hQb3B1cCgpO1xuICAgICAgICAgICAgaWYgKHRoaXMuYmVmb3JlUG9wdXBPcGVuKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5iZWZvcmVQb3B1cE9wZW4gPSBmYWxzZTtcbiAgICAgICAgICAgICAgICB0aGlzLm9uUG9wdXBTaG93bigpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICBNdWx0aVNlbGVjdC5wcm90b3R5cGUucmVmcmVzaFNlbGVjdGlvbiA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciB2YWx1ZTtcbiAgICAgICAgICAgIHZhciBlbGVtZW50O1xuICAgICAgICAgICAgdmFyIGNsYXNzTmFtZSA9IHRoaXMuaGlkZVNlbGVjdGVkSXRlbSA/XG4gICAgICAgICAgICAgICAgSElERV9MSVNUIDpcbiAgICAgICAgICAgICAgICBkcm9wX2Rvd25fYmFzZV8xLmRyb3BEb3duQmFzZUNsYXNzZXMuc2VsZWN0ZWQ7XG4gICAgICAgICAgICBmb3IgKHZhciBpbmRleCA9IDA7IHRoaXMudmFsdWVbaW5kZXhdOyBpbmRleCsrKSB7XG4gICAgICAgICAgICAgICAgdmFsdWUgPSB0aGlzLnZhbHVlW2luZGV4XTtcbiAgICAgICAgICAgICAgICBlbGVtZW50ID0gdGhpcy51bEVsZW1lbnQucXVlcnlTZWxlY3RvcignbGlbZGF0YS12YWx1ZT1cIicgKyB2YWx1ZSArICdcIl0nKTtcbiAgICAgICAgICAgICAgICBpZiAoZWxlbWVudCkge1xuICAgICAgICAgICAgICAgICAgICBlajJfYmFzZV81LmFkZENsYXNzKFtlbGVtZW50XSwgY2xhc3NOYW1lKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIE11bHRpU2VsZWN0LnByb3RvdHlwZS5LZXlVcCA9IGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgICB0aGlzLmlzVmFsaWRLZXkgPSBlLmtleUNvZGUgPT09IDggfHwgdGhpcy5pc1ZhbGlkS2V5O1xuICAgICAgICAgICAgaWYgKHRoaXMuaXNWYWxpZEtleSkge1xuICAgICAgICAgICAgICAgIHRoaXMuaXNWYWxpZEtleSA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIHRoaXMuZXhwYW5kVGV4dGJveCgpO1xuICAgICAgICAgICAgICAgIHN3aXRjaCAoZS5rZXlDb2RlKSB7XG4gICAgICAgICAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXRoaXMuaXNQb3B1cE9wZW4oKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2hvd1BvcHVwKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5saUNvbGxlY3Rpb25zKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuY2hlY2tUZXh0TGVuZ3RoKCkgJiYgIXRoaXMuYWxsb3dGaWx0ZXJpbmcgJiYgKGUua2V5Q29kZSAhPT0gOCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5mb2N1c0F0Rmlyc3RMaXN0SXRlbSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHRleHQgPSB0aGlzLmlucHV0RWxlbWVudC52YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5rZXlDb2RlID0gZS5rZXlDb2RlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5hbGxvd0ZpbHRlcmluZykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy50cmlnZ2VyKCdmaWx0ZXJpbmcnLCB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGV4dDogdGhpcy5pbnB1dEVsZW1lbnQudmFsdWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdXBkYXRlRGF0YTogdGhpcy5kYXRhVXBkYXRlci5iaW5kKHRoaXMpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV2ZW50OiBlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIGlmICh0aGlzLmFsbG93Q3VzdG9tVmFsdWUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBxdWVyeSA9IG5ldyBlajJfZGF0YV8xLlF1ZXJ5KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBxdWVyeSA9ICh0ZXh0ICE9PSAnJykgPyBxdWVyeS53aGVyZSh0aGlzLmZpZWxkcy50ZXh0LCAnc3RhcnRzd2l0aCcsIHRleHQsIHRydWUpIDogcXVlcnk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmRhdGFVcGRhdGVyKHRoaXMubWFpbkRhdGEsIHF1ZXJ5LCB0aGlzLmZpZWxkcyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBsaUNvbGxlY3Rpb25zID0gdm9pZCAwO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGlDb2xsZWN0aW9ucyA9IHRoaXMubGlzdC5xdWVyeVNlbGVjdG9yQWxsKCdsaS4nICsgZHJvcF9kb3duX2Jhc2VfMS5kcm9wRG93bkJhc2VDbGFzc2VzLmxpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhY3RpdmVFbGVtZW50ID0gaW5jcmVtZW50YWxfc2VhcmNoXzEuU2VhcmNoKHRoaXMuaW5wdXRFbGVtZW50LnZhbHVlLCBsaUNvbGxlY3Rpb25zLCAnU3RhcnRzV2l0aCcsIHRoaXMuaWdub3JlQ2FzZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYWN0aXZlRWxlbWVudCAmJiBhY3RpdmVFbGVtZW50Lml0ZW0gIT09IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmFkZExpc3RGb2N1cyhhY3RpdmVFbGVtZW50Lml0ZW0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubGlzdC5zY3JvbGxUb3AgPVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhY3RpdmVFbGVtZW50Lml0ZW0uZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkuaGVpZ2h0ICogYWN0aXZlRWxlbWVudC5pbmRleDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIE11bHRpU2VsZWN0LnByb3RvdHlwZS5kYXRhVXBkYXRlciA9IGZ1bmN0aW9uIChkYXRhU291cmNlLCBxdWVyeSwgZmllbGRzKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5pbnB1dEVsZW1lbnQudmFsdWUudHJpbSgpID09PSAnJykge1xuICAgICAgICAgICAgICAgIHZhciBsaXN0ID0gdGhpcy5tYWluTGlzdC5jbG9uZU5vZGUgPyB0aGlzLm1haW5MaXN0LmNsb25lTm9kZSh0cnVlKSA6IHRoaXMubWFpbkxpc3Q7XG4gICAgICAgICAgICAgICAgdGhpcy5vbkFjdGlvbkNvbXBsZXRlKGxpc3QsIHRoaXMubWFpbkRhdGEpO1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLnZhbHVlICYmIHRoaXMudmFsdWUubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucmVmcmVzaFNlbGVjdGlvbigpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAodGhpcy5rZXlDb2RlICE9PSA4KSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZm9jdXNBdEZpcnN0TGlzdEl0ZW0oKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aGlzLnJlc2V0TGlzdChkYXRhU291cmNlLCBmaWVsZHMsIHF1ZXJ5KTtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5hbGxvd0N1c3RvbVZhbHVlKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICghKGRhdGFTb3VyY2UgaW5zdGFuY2VvZiBlajJfZGF0YV8xLkRhdGFNYW5hZ2VyKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5jaGVja0ZvckN1c3RvbVZhbHVlKHF1ZXJ5LCBmaWVsZHMpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5yZW1vdGVDdXN0b21WYWx1ZSA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnRlbXBRdWVyeSA9IHF1ZXJ5O1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5yZWZyZXNoUG9wdXAoKTtcbiAgICAgICAgfTtcbiAgICAgICAgTXVsdGlTZWxlY3QucHJvdG90eXBlLmNoZWNrRm9yQ3VzdG9tVmFsdWUgPSBmdW5jdGlvbiAocXVlcnksIGZpZWxkcykge1xuICAgICAgICAgICAgdmFyIGRhdGFDaGVja3MgPSAhdGhpcy5nZXRWYWx1ZUJ5VGV4dCh0aGlzLmlucHV0RWxlbWVudC52YWx1ZSwgdGhpcy5pZ25vcmVDYXNlKTtcbiAgICAgICAgICAgIGlmICh0aGlzLmFsbG93Q3VzdG9tVmFsdWUgJiYgZGF0YUNoZWNrcykge1xuICAgICAgICAgICAgICAgIHZhciB0ZXh0ID0gdGhpcy5maWVsZHMudGV4dDtcbiAgICAgICAgICAgICAgICB2YXIgdmFsdWUgPSB0aGlzLmZpZWxkcy52YWx1ZTtcbiAgICAgICAgICAgICAgICB2YXIgZGF0YSA9IHt9O1xuICAgICAgICAgICAgICAgIGRhdGFbdmFsdWVdID0gZGF0YVt0ZXh0XSA9IHRoaXMuaW5wdXRFbGVtZW50LnZhbHVlO1xuICAgICAgICAgICAgICAgIHZhciB0ZW1wRGF0YSA9IEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkodGhpcy5saXN0RGF0YSkpO1xuICAgICAgICAgICAgICAgIHRlbXBEYXRhLnNwbGljZSgwLCAwLCBkYXRhKTtcbiAgICAgICAgICAgICAgICB0aGlzLnJlc2V0TGlzdCh0ZW1wRGF0YSwgZmllbGRzID8gZmllbGRzIDogdGhpcy5maWVsZHMsIHF1ZXJ5KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh0aGlzLnZhbHVlICYmIHRoaXMudmFsdWUubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5yZWZyZXNoU2VsZWN0aW9uKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIE11bHRpU2VsZWN0LnByb3RvdHlwZS5nZXROZ0RpcmVjdGl2ZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiAnRUotTVVMVElTRUxFQ1QnO1xuICAgICAgICB9O1xuICAgICAgICBNdWx0aVNlbGVjdC5wcm90b3R5cGUud3JhcHBlckNsaWNrID0gZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLnJlYWRvbmx5IHx8ICF0aGlzLmVuYWJsZWQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoZS50YXJnZXQgPT09IHRoaXMub3ZlckFsbENsZWFyKSB7XG4gICAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICghdGhpcy5pbnB1dEZvY3VzKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5pbnB1dEVsZW1lbnQuZm9jdXMoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChlLnRhcmdldCAmJiBlLnRhcmdldC5jbGFzc0xpc3QudG9TdHJpbmcoKS5pbmRleE9mKENISVBfQ0xPU0UpICE9PSAtMSkge1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLmlzUG9wdXBPcGVuKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5yZWZyZXNoUG9wdXAoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKCF0aGlzLmlzUG9wdXBPcGVuKCkpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnNob3dQb3B1cCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpcy5oaWRlUG9wdXAoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgfTtcbiAgICAgICAgTXVsdGlTZWxlY3QucHJvdG90eXBlLmVuYWJsZSA9IGZ1bmN0aW9uIChzdGF0ZSkge1xuICAgICAgICAgICAgaWYgKHN0YXRlKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5vdmVyQWxsV3JhcHBlci5jbGFzc0xpc3QucmVtb3ZlKERJU0FCTEVEKTtcbiAgICAgICAgICAgICAgICB0aGlzLmlucHV0RWxlbWVudC5yZW1vdmVBdHRyaWJ1dGUoJ2Rpc2FibGVkJyk7XG4gICAgICAgICAgICAgICAgZWoyX2Jhc2VfMS5hdHRyaWJ1dGVzKHRoaXMuaW5wdXRFbGVtZW50LCB7ICdhcmlhLWRpc2FibGVkJzogJ2ZhbHNlJyB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHRoaXMub3ZlckFsbFdyYXBwZXIuY2xhc3NMaXN0LmFkZChESVNBQkxFRCk7XG4gICAgICAgICAgICAgICAgdGhpcy5pbnB1dEVsZW1lbnQuc2V0QXR0cmlidXRlKCdkaXNhYmxlZCcsICd0cnVlJyk7XG4gICAgICAgICAgICAgICAgZWoyX2Jhc2VfMS5hdHRyaWJ1dGVzKHRoaXMuaW5wdXRFbGVtZW50LCB7ICdhcmlhLWRpc2FibGVkJzogJ3RydWUnIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHRoaXMuZW5hYmxlZCAhPT0gc3RhdGUpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmVuYWJsZWQgPSBzdGF0ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuaGlkZVBvcHVwKCk7XG4gICAgICAgIH07XG4gICAgICAgIE11bHRpU2VsZWN0LnByb3RvdHlwZS5vbkJsdXIgPSBmdW5jdGlvbiAoZXZlKSB7XG4gICAgICAgICAgICB2YXIgdGFyZ2V0ID0gIWVqMl9iYXNlXzYuaXNOdWxsT3JVbmRlZmluZWQoZXZlKSAmJiBldmUucmVsYXRlZFRhcmdldDtcbiAgICAgICAgICAgIGlmIChkb2N1bWVudC5ib2R5LmNvbnRhaW5zKHRoaXMucG9wdXBPYmouZWxlbWVudCkgJiYgdGhpcy5wb3B1cE9iai5lbGVtZW50LmNvbnRhaW5zKHRhcmdldCkpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmlucHV0RWxlbWVudC5mb2N1cygpO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh0aGlzLnNjcm9sbEZvY3VzU3RhdHVzKSB7XG4gICAgICAgICAgICAgICAgZXZlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICAgICAgdGhpcy5pbnB1dEVsZW1lbnQuZm9jdXMoKTtcbiAgICAgICAgICAgICAgICB0aGlzLnNjcm9sbEZvY3VzU3RhdHVzID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5pbnB1dEZvY3VzID0gZmFsc2U7XG4gICAgICAgICAgICB0aGlzLm92ZXJBbGxXcmFwcGVyLmNsYXNzTGlzdC5yZW1vdmUoRk9DVVMpO1xuICAgICAgICAgICAgaWYgKHRoaXMubW9kZSAhPT0gJ2JveCcpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnJlZnJlc2hMaXN0SXRlbXMobnVsbCk7XG4gICAgICAgICAgICAgICAgdGhpcy51cGRhdGVEZWxpbVZpZXcoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMudXBkYXRlVmFsdWVTdGF0ZShldmUsIHRoaXMudmFsdWUsIHRoaXMudGVtcFZhbHVlcyk7XG4gICAgICAgICAgICB0aGlzLmRpc3BhdGNoRXZlbnQodGhpcy5oaWRkZW5FbGVtZW50LCAnY2hhbmdlJyk7XG4gICAgICAgICAgICB0aGlzLm92ZXJBbGxDbGVhci5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xuICAgICAgICAgICAgaWYgKHRoaXMuaXNQb3B1cE9wZW4oKSkge1xuICAgICAgICAgICAgICAgIHRoaXMuaGlkZVBvcHVwKCk7XG4gICAgICAgICAgICAgICAgdGhpcy5tYWtlVGV4dEJveEVtcHR5KCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLnRyaWdnZXIoJ2JsdXInKTtcbiAgICAgICAgICAgIGlmIChlajJfYmFzZV80LkJyb3dzZXIuaXNEZXZpY2UgJiYgdGhpcy5tb2RlICE9PSAnZGVsaW1pdGVyJykge1xuICAgICAgICAgICAgICAgIHRoaXMucmVtb3ZlQ2hpcEZvY3VzKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLnJlbW92ZUNoaXBTZWxlY3Rpb24oKTtcbiAgICAgICAgICAgIHRoaXMucmVmcmVzaElucHV0SGlnaHQoKTtcbiAgICAgICAgICAgIHRoaXMucmVmcmVzaFBsYWNlSG9sZGVyKCk7XG4gICAgICAgIH07XG4gICAgICAgIE11bHRpU2VsZWN0LnByb3RvdHlwZS5yZWZyZXNoSW5wdXRIaWdodCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGlmICghdGhpcy52YWx1ZSB8fCAhdGhpcy52YWx1ZS5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnNlYXJjaFdyYXBwZXIuY2xhc3NMaXN0LnJlbW92ZShaRVJPX1NJWkUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpcy5zZWFyY2hXcmFwcGVyLmNsYXNzTGlzdC5hZGQoWkVST19TSVpFKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgTXVsdGlTZWxlY3QucHJvdG90eXBlLnZhbGlkYXRlVmFsdWVzID0gZnVuY3Rpb24gKG5ld1ZhbHVlLCBvbGRWYWx1ZSkge1xuICAgICAgICAgICAgcmV0dXJuIEpTT04uc3RyaW5naWZ5KG5ld1ZhbHVlLnNsaWNlKCkuc29ydCgpKSAhPT0gSlNPTi5zdHJpbmdpZnkob2xkVmFsdWUuc2xpY2UoKS5zb3J0KCkpO1xuICAgICAgICB9O1xuICAgICAgICBNdWx0aVNlbGVjdC5wcm90b3R5cGUudXBkYXRlVmFsdWVTdGF0ZSA9IGZ1bmN0aW9uIChldmVudCwgbmV3VmFsLCBvbGRWYWwpIHtcbiAgICAgICAgICAgIHZhciBuZXdWYWx1ZSA9IG5ld1ZhbCA/IG5ld1ZhbCA6IFtdO1xuICAgICAgICAgICAgdmFyIG9sZFZhbHVlID0gb2xkVmFsID8gb2xkVmFsIDogW107XG4gICAgICAgICAgICBpZiAodGhpcy52YWxpZGF0ZVZhbHVlcyhuZXdWYWx1ZSwgb2xkVmFsdWUpKSB7XG4gICAgICAgICAgICAgICAgdmFyIGV2ZW50QXJncyA9IHtcbiAgICAgICAgICAgICAgICAgICAgZTogZXZlbnQsXG4gICAgICAgICAgICAgICAgICAgIG9sZFZhbHVlOiBvbGRWYWwsXG4gICAgICAgICAgICAgICAgICAgIHZhbHVlOiBuZXdWYWwsXG4gICAgICAgICAgICAgICAgICAgIGlzSW50ZXJhY3RlZDogZXZlbnQgPyB0cnVlIDogZmFsc2VcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIHRoaXMudHJpZ2dlcignY2hhbmdlJywgZXZlbnRBcmdzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgTXVsdGlTZWxlY3QucHJvdG90eXBlLmdldFBhZ2luZ0NvdW50ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIGhlaWdodCA9IHRoaXMubGlzdC5jbGFzc0xpc3QuY29udGFpbnMoZHJvcF9kb3duX2Jhc2VfMS5kcm9wRG93bkJhc2VDbGFzc2VzLm5vRGF0YSkgPyBudWxsIDpcbiAgICAgICAgICAgICAgICBnZXRDb21wdXRlZFN0eWxlKHRoaXMuZ2V0SXRlbXMoKVswXSwgbnVsbCkuZ2V0UHJvcGVydHlWYWx1ZSgnaGVpZ2h0Jyk7XG4gICAgICAgICAgICByZXR1cm4gTWF0aC5yb3VuZCh0aGlzLmxpc3QuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkuaGVpZ2h0IC8gcGFyc2VJbnQoaGVpZ2h0LCAxMCkpO1xuICAgICAgICB9O1xuICAgICAgICBNdWx0aVNlbGVjdC5wcm90b3R5cGUucGFnZVVwU2VsZWN0aW9uID0gZnVuY3Rpb24gKHN0ZXBzKSB7XG4gICAgICAgICAgICB2YXIgcHJldmlvdXNJdGVtID0gc3RlcHMgPj0gMCA/IHRoaXMubGlDb2xsZWN0aW9uc1tzdGVwcyArIDFdIDogdGhpcy5saUNvbGxlY3Rpb25zWzBdO1xuICAgICAgICAgICAgdGhpcy5hZGRMaXN0Rm9jdXMocHJldmlvdXNJdGVtKTtcbiAgICAgICAgICAgIHRoaXMuc2Nyb2xsQm90dG9tKHByZXZpb3VzSXRlbSwgdGhpcy5nZXRJbmRleEJ5VmFsdWUocHJldmlvdXNJdGVtLmdldEF0dHJpYnV0ZSgnZGF0YS12YWx1ZScpKSk7XG4gICAgICAgIH07XG4gICAgICAgIDtcbiAgICAgICAgTXVsdGlTZWxlY3QucHJvdG90eXBlLnBhZ2VEb3duU2VsZWN0aW9uID0gZnVuY3Rpb24gKHN0ZXBzKSB7XG4gICAgICAgICAgICB2YXIgbGlzdCA9IHRoaXMuZ2V0SXRlbXMoKTtcbiAgICAgICAgICAgIHZhciBwcmV2aW91c0l0ZW0gPSBzdGVwcyA8PSBsaXN0Lmxlbmd0aCA/IHRoaXMubGlDb2xsZWN0aW9uc1tzdGVwcyAtIDFdIDogdGhpcy5saUNvbGxlY3Rpb25zW2xpc3QubGVuZ3RoIC0gMV07XG4gICAgICAgICAgICB0aGlzLmFkZExpc3RGb2N1cyhwcmV2aW91c0l0ZW0pO1xuICAgICAgICAgICAgdGhpcy5zY3JvbGxCb3R0b20ocHJldmlvdXNJdGVtLCB0aGlzLmdldEluZGV4QnlWYWx1ZShwcmV2aW91c0l0ZW0uZ2V0QXR0cmlidXRlKCdkYXRhLXZhbHVlJykpKTtcbiAgICAgICAgfTtcbiAgICAgICAgTXVsdGlTZWxlY3QucHJvdG90eXBlLmZvY3VzSW4gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5lbmFibGVkICYmICF0aGlzLnJlYWRvbmx5KSB7XG4gICAgICAgICAgICAgICAgdGhpcy5pbnB1dEZvY3VzID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICBpZiAoIXRoaXMudmFsdWUpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy50ZW1wVmFsdWVzID0gdGhpcy52YWx1ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMudGVtcFZhbHVlcyA9IHRoaXMudmFsdWUuc2xpY2UoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMudmFsdWUgJiYgdGhpcy52YWx1ZS5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMubW9kZSAhPT0gJ2RlbGltaXRlcicpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuY2hpcENvbGxlY3Rpb25XcmFwcGVyLnN0eWxlLmRpc3BsYXkgPSAnJztcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2hvd0RlbGltV3JhcHBlcigpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHRoaXMudmlld1dyYXBwZXIuc3R5bGUuZGlzcGxheSA9ICdub25lJztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdGhpcy5zZWFyY2hXcmFwcGVyLmNsYXNzTGlzdC5yZW1vdmUoWkVST19TSVpFKTtcbiAgICAgICAgICAgICAgICB0aGlzLnRyaWdnZXIoJ2ZvY3VzJyk7XG4gICAgICAgICAgICAgICAgaWYgKCF0aGlzLm92ZXJBbGxXcmFwcGVyLmNsYXNzTGlzdC5jb250YWlucyhGT0NVUykpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5vdmVyQWxsV3JhcHBlci5jbGFzc0xpc3QuYWRkKEZPQ1VTKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuaXNQb3B1cE9wZW4oKSkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnJlZnJlc2hQb3B1cCgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgTXVsdGlTZWxlY3QucHJvdG90eXBlLnNob3dEZWxpbVdyYXBwZXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB0aGlzLmRlbGltaXRlcldyYXBwZXIuc3R5bGUuZGlzcGxheSA9ICcnO1xuICAgICAgICAgICAgdGhpcy5jb21wb25lbnRXcmFwcGVyLmNsYXNzTGlzdC5hZGQoREVMSU1JVEVSX1ZJRVdfV1JBUFBFUik7XG4gICAgICAgIH07XG4gICAgICAgIE11bHRpU2VsZWN0LnByb3RvdHlwZS5oaWRlRGVsaW1XcmFwcGVyID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdGhpcy5kZWxpbWl0ZXJXcmFwcGVyLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XG4gICAgICAgICAgICB0aGlzLmNvbXBvbmVudFdyYXBwZXIuY2xhc3NMaXN0LnJlbW92ZShERUxJTUlURVJfVklFV19XUkFQUEVSKTtcbiAgICAgICAgfTtcbiAgICAgICAgTXVsdGlTZWxlY3QucHJvdG90eXBlLmV4cGFuZFRleHRib3ggPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgc2l6ZSA9IDU7XG4gICAgICAgICAgICBpZiAodGhpcy5wbGFjZWhvbGRlcikge1xuICAgICAgICAgICAgICAgIHNpemUgPSBzaXplID4gdGhpcy5pbnB1dEVsZW1lbnQucGxhY2Vob2xkZXIubGVuZ3RoID8gc2l6ZSA6IHRoaXMuaW5wdXRFbGVtZW50LnBsYWNlaG9sZGVyLmxlbmd0aDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh0aGlzLmlucHV0RWxlbWVudC52YWx1ZS5sZW5ndGggPiBzaXplKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5pbnB1dEVsZW1lbnQuc2l6ZSA9IHRoaXMuaW5wdXRFbGVtZW50LnZhbHVlLmxlbmd0aDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHRoaXMuaW5wdXRFbGVtZW50LnNpemUgPSBzaXplO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICBNdWx0aVNlbGVjdC5wcm90b3R5cGUuaXNQb3B1cE9wZW4gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gKCh0aGlzLnBvcHVwV3JhcHBlciAhPT0gbnVsbCkgJiYgKHRoaXMucG9wdXBXcmFwcGVyLnBhcmVudEVsZW1lbnQgIT09IG51bGwpKTtcbiAgICAgICAgfTtcbiAgICAgICAgTXVsdGlTZWxlY3QucHJvdG90eXBlLnJlZnJlc2hQb3B1cCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLnBvcHVwT2JqKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5wb3B1cE9iai5zZXRQcm9wZXJ0aWVzKHsgd2lkdGg6IHRoaXMuY2FsY1BvcHVwV2lkdGgoKSB9KTtcbiAgICAgICAgICAgICAgICB0aGlzLnBvcHVwT2JqLnJlZnJlc2hQb3NpdGlvbigpO1xuICAgICAgICAgICAgICAgIHRoaXMucG9wdXBPYmouc2hvdygpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICBNdWx0aVNlbGVjdC5wcm90b3R5cGUuY2hlY2tUZXh0TGVuZ3RoID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuaW5wdXRFbGVtZW50LnZhbHVlLmxlbmd0aCA8IDE7XG4gICAgICAgIH07XG4gICAgICAgIE11bHRpU2VsZWN0LnByb3RvdHlwZS5wb3B1cEtleUFjdGlvbnMgPSBmdW5jdGlvbiAoa2V5Q29kZSkge1xuICAgICAgICAgICAgc3dpdGNoIChrZXlDb2RlKSB7XG4gICAgICAgICAgICAgICAgY2FzZSAzODpcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5oaWRlUG9wdXAoKTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSA0MDpcbiAgICAgICAgICAgICAgICAgICAgaWYgKCF0aGlzLmlzUG9wdXBPcGVuKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2hvd1BvcHVwKCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIE11bHRpU2VsZWN0LnByb3RvdHlwZS51cGRhdGVBcmlhQXR0cmlidXRlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIGZvY3VzZWRJdGVtID0gdGhpcy5saXN0LnF1ZXJ5U2VsZWN0b3IoJy4nICsgZHJvcF9kb3duX2Jhc2VfMS5kcm9wRG93bkJhc2VDbGFzc2VzLmZvY3VzKTtcbiAgICAgICAgICAgIGlmICghZWoyX2Jhc2VfNi5pc051bGxPclVuZGVmaW5lZChmb2N1c2VkSXRlbSkpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmlucHV0RWxlbWVudC5zZXRBdHRyaWJ1dGUoJ2FyaWEtYWN0aXZlZGVzY2VuZGFudCcsIGZvY3VzZWRJdGVtLmlkKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgTXVsdGlTZWxlY3QucHJvdG90eXBlLm9uS2V5RG93biA9IGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgICB0aGlzLmtleURvd25TdGF0dXMgPSB0cnVlO1xuICAgICAgICAgICAgaWYgKGUua2V5Q29kZSA+IDExMSAmJiBlLmtleUNvZGUgPCAxMjQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoZS5hbHRLZXkpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnBvcHVwS2V5QWN0aW9ucyhlLmtleUNvZGUpO1xuICAgICAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmICh0aGlzLmlzUG9wdXBPcGVuKCkpIHtcbiAgICAgICAgICAgICAgICB2YXIgZm9jdXNlZEl0ZW0gPSB0aGlzLmxpc3QucXVlcnlTZWxlY3RvcignLicgKyBkcm9wX2Rvd25fYmFzZV8xLmRyb3BEb3duQmFzZUNsYXNzZXMuZm9jdXMpO1xuICAgICAgICAgICAgICAgIHZhciBhY3RpdmVJbmRleCA9IHZvaWQgMDtcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKGUua2V5Q29kZSkge1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDM2OlxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5tb3ZlQnlUb3AodHJ1ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAzNTpcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubW92ZUJ5VG9wKGZhbHNlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDMzOlxuICAgICAgICAgICAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGZvY3VzZWRJdGVtKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5nZXRJbmRleEJ5VmFsdWUoZm9jdXNlZEl0ZW0uZ2V0QXR0cmlidXRlKCdkYXRhLXZhbHVlJykpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucGFnZVVwU2VsZWN0aW9uKGFjdGl2ZUluZGV4IC0gdGhpcy5nZXRQYWdpbmdDb3VudCgpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnVwZGF0ZUFyaWFBdHRyaWJ1dGUoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAzNDpcbiAgICAgICAgICAgICAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChmb2N1c2VkSXRlbSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZ2V0SW5kZXhCeVZhbHVlKGZvY3VzZWRJdGVtLmdldEF0dHJpYnV0ZSgnZGF0YS12YWx1ZScpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBhZ2VEb3duU2VsZWN0aW9uKGFjdGl2ZUluZGV4ICsgdGhpcy5nZXRQYWdpbmdDb3VudCgpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnVwZGF0ZUFyaWFBdHRyaWJ1dGUoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAzODpcbiAgICAgICAgICAgICAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubW92ZUJ5TGlzdCgtMSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnVwZGF0ZUFyaWFBdHRyaWJ1dGUoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDQwOlxuICAgICAgICAgICAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5tb3ZlQnlMaXN0KDEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy51cGRhdGVBcmlhQXR0cmlidXRlKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAyNzpcbiAgICAgICAgICAgICAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuaGlkZVBvcHVwKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMTM6XG4gICAgICAgICAgICAgICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnNlbGVjdEJ5S2V5KGUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHN3aXRjaCAoZS5rZXlDb2RlKSB7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMTM6XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgOTpcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAxNjpcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAxNzpcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAyMDpcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSA0MDpcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2hvd1BvcHVwKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAyNzpcbiAgICAgICAgICAgICAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZXNjYXBlQWN0aW9uKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHRoaXMuY2hlY2tUZXh0TGVuZ3RoKCkpIHtcbiAgICAgICAgICAgICAgICBpZiAoKHRoaXMubW9kZSAhPT0gJ2RlbGltaXRlcicpICYmIHRoaXMudmFsdWUgJiYgdGhpcy52YWx1ZS5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICAgICAgc3dpdGNoIChlLmtleUNvZGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMzc6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubW92ZUJ5KC0xKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMzk6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubW92ZUJ5KDEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSA4OlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucmVtb3ZlbGFzdFNlbGVjdGlvbihlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgNDY6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5yZW1vdmVTZWxlY3RlZENoaXAoZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSBpZiAoZS5rZXlDb2RlID09PSA4ICYmIHRoaXMubW9kZSA9PT0gJ2RlbGltaXRlcicpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMudmFsdWUgJiYgdGhpcy52YWx1ZS5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB0ZW1wID0gdGhpcy52YWx1ZVt0aGlzLnZhbHVlLmxlbmd0aCAtIDFdO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5yZW1vdmVWYWx1ZSh0ZW1wLCBlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMudXBkYXRlRGVsaW1ldGVyKGUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5mb2N1c0F0TGFzdExpc3RJdGVtKHRlbXApO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5leHBhbmRUZXh0Ym94KCk7XG4gICAgICAgICAgICB0aGlzLnJlZnJlc2hQb3B1cCgpO1xuICAgICAgICB9O1xuICAgICAgICBNdWx0aVNlbGVjdC5wcm90b3R5cGUuc2VsZWN0QnlLZXkgPSBmdW5jdGlvbiAoZSkge1xuICAgICAgICAgICAgdGhpcy5yZW1vdmVDaGlwU2VsZWN0aW9uKCk7XG4gICAgICAgICAgICB0aGlzLnNlbGVjdExpc3RCeUtleShlKTtcbiAgICAgICAgICAgIGlmICh0aGlzLmhpZGVTZWxlY3RlZEl0ZW0pIHtcbiAgICAgICAgICAgICAgICB0aGlzLmZvY3VzQXRGaXJzdExpc3RJdGVtKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIE11bHRpU2VsZWN0LnByb3RvdHlwZS5lc2NhcGVBY3Rpb24gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgdGVtcCA9IHRoaXMudGVtcFZhbHVlcyA/IHRoaXMudGVtcFZhbHVlcy5zbGljZSgpIDogW107XG4gICAgICAgICAgICBpZiAodGhpcy52YWx1ZSAmJiB0aGlzLnZhbGlkYXRlVmFsdWVzKHRoaXMudmFsdWUsIHRlbXApKSB7XG4gICAgICAgICAgICAgICAgdGhpcy52YWx1ZSA9IHRlbXA7XG4gICAgICAgICAgICAgICAgdGhpcy5pbml0aWFsVmFsdWVVcGRhdGUoKTtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5tb2RlICE9PSAnZGVsaW1pdGVyJykge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmNoaXBDb2xsZWN0aW9uV3JhcHBlci5zdHlsZS5kaXNwbGF5ID0gJyc7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnNob3dEZWxpbVdyYXBwZXIoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdGhpcy5yZWZyZXNoUGxhY2VIb2xkZXIoKTtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy52YWx1ZS5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zaG93T3ZlckFsbENsZWFyKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmhpZGVPdmVyQWxsQ2xlYXIoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLm1ha2VUZXh0Qm94RW1wdHkoKTtcbiAgICAgICAgfTtcbiAgICAgICAgTXVsdGlTZWxlY3QucHJvdG90eXBlLnNjcm9sbEJvdHRvbSA9IGZ1bmN0aW9uIChzZWxlY3RlZExJLCBhY3RpdmVJbmRleCkge1xuICAgICAgICAgICAgdmFyIGN1cnJlbnRPZmZzZXQgPSB0aGlzLmxpc3QuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkuaGVpZ2h0O1xuICAgICAgICAgICAgdmFyIG5leHRCb3R0b20gPSBzZWxlY3RlZExJLm9mZnNldFRvcCArIHNlbGVjdGVkTEkuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkuaGVpZ2h0IC0gdGhpcy5saXN0LnNjcm9sbFRvcDtcbiAgICAgICAgICAgIHZhciBuZXh0T2Zmc2V0ID0gdGhpcy5saXN0LnNjcm9sbFRvcCArIG5leHRCb3R0b20gLSBjdXJyZW50T2Zmc2V0O1xuICAgICAgICAgICAgdmFyIGJveFJhbmdlID0gKHNlbGVjdGVkTEkub2Zmc2V0VG9wICsgc2VsZWN0ZWRMSS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS5oZWlnaHQgLSB0aGlzLmxpc3Quc2Nyb2xsVG9wKTtcbiAgICAgICAgICAgIGJveFJhbmdlID0gdGhpcy5maWVsZHMuZ3JvdXBCeSAmJiAhZWoyX2Jhc2VfNi5pc1VuZGVmaW5lZCh0aGlzLmZpeGVkSGVhZGVyRWxlbWVudCkgP1xuICAgICAgICAgICAgICAgIGJveFJhbmdlIC0gdGhpcy5maXhlZEhlYWRlckVsZW1lbnQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkuaGVpZ2h0IDogYm94UmFuZ2U7XG4gICAgICAgICAgICBpZiAoYWN0aXZlSW5kZXggPT09IDApIHtcbiAgICAgICAgICAgICAgICB0aGlzLmxpc3Quc2Nyb2xsVG9wID0gMDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKG5leHRCb3R0b20gPiBjdXJyZW50T2Zmc2V0KSB7XG4gICAgICAgICAgICAgICAgdGhpcy5saXN0LnNjcm9sbFRvcCA9IG5leHRPZmZzZXQ7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmICghKGJveFJhbmdlID4gMCAmJiB0aGlzLmxpc3QuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkuaGVpZ2h0ID4gYm94UmFuZ2UpKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5saXN0LnNjcm9sbFRvcCA9IG5leHRPZmZzZXQ7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIE11bHRpU2VsZWN0LnByb3RvdHlwZS5zY3JvbGxUb3AgPSBmdW5jdGlvbiAoc2VsZWN0ZWRMSSwgYWN0aXZlSW5kZXgpIHtcbiAgICAgICAgICAgIHZhciBuZXh0T2Zmc2V0ID0gc2VsZWN0ZWRMSS5vZmZzZXRUb3AgLSB0aGlzLmxpc3Quc2Nyb2xsVG9wO1xuICAgICAgICAgICAgdmFyIG5leHRCb3R0b20gPSBzZWxlY3RlZExJLm9mZnNldFRvcCArIHNlbGVjdGVkTEkuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkuaGVpZ2h0IC0gdGhpcy5saXN0LnNjcm9sbFRvcDtcbiAgICAgICAgICAgIG5leHRPZmZzZXQgPSB0aGlzLmZpZWxkcy5ncm91cEJ5ICYmICFlajJfYmFzZV82LmlzVW5kZWZpbmVkKHRoaXMuZml4ZWRIZWFkZXJFbGVtZW50KSA/XG4gICAgICAgICAgICAgICAgbmV4dE9mZnNldCAtIHRoaXMuZml4ZWRIZWFkZXJFbGVtZW50LmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLmhlaWdodCA6IG5leHRPZmZzZXQ7XG4gICAgICAgICAgICB2YXIgYm94UmFuZ2UgPSAoc2VsZWN0ZWRMSS5vZmZzZXRUb3AgKyBzZWxlY3RlZExJLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLmhlaWdodCAtIHRoaXMubGlzdC5zY3JvbGxUb3ApO1xuICAgICAgICAgICAgaWYgKGFjdGl2ZUluZGV4ID09PSAwKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5saXN0LnNjcm9sbFRvcCA9IDA7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChuZXh0T2Zmc2V0IDwgMCkge1xuICAgICAgICAgICAgICAgIHRoaXMubGlzdC5zY3JvbGxUb3AgPSB0aGlzLmxpc3Quc2Nyb2xsVG9wICsgbmV4dE9mZnNldDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKCEoYm94UmFuZ2UgPiAwICYmIHRoaXMubGlzdC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS5oZWlnaHQgPiBib3hSYW5nZSkpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmxpc3Quc2Nyb2xsVG9wID0gc2VsZWN0ZWRMSS5vZmZzZXRUb3AgLSAodGhpcy5maWVsZHMuZ3JvdXBCeSAmJiAhZWoyX2Jhc2VfNi5pc1VuZGVmaW5lZCh0aGlzLmZpeGVkSGVhZGVyRWxlbWVudCkgP1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmZpeGVkSGVhZGVyRWxlbWVudC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS5oZWlnaHQgOiAwKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgTXVsdGlTZWxlY3QucHJvdG90eXBlLnNlbGVjdExpc3RCeUtleSA9IGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgICB2YXIgbGkgPSB0aGlzLmxpc3QucXVlcnlTZWxlY3RvcignbGkuJyArIGRyb3BfZG93bl9iYXNlXzEuZHJvcERvd25CYXNlQ2xhc3Nlcy5mb2N1cyk7XG4gICAgICAgICAgICB2YXIgbGltaXQgPSB0aGlzLnZhbHVlICYmIHRoaXMudmFsdWUubGVuZ3RoID8gdGhpcy52YWx1ZS5sZW5ndGggOiAwO1xuICAgICAgICAgICAgaWYgKGxpICE9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuaXNWYWxpZExJKGxpKSAmJiBsaW1pdCA8IHRoaXMubWF4aW11bVNlbGVjdGlvbkxlbmd0aCkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnVwZGF0ZUxpc3RTZWxlY3Rpb24obGksIGUpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmFkZExpc3RGb2N1cyhsaSk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMudXBkYXRlRGVsaW1ldGVyKGUpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLm1ha2VUZXh0Qm94RW1wdHkoKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5yZWZyZXNoTGlzdEl0ZW1zKGxpLmdldEF0dHJpYnV0ZSgnZGF0YS1WYWx1ZScpKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5yZWZyZXNoUG9wdXAoKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMudmFsdWUgJiYgdGhpcy52YWx1ZS5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucmVtb3ZlTGlzdFNlbGVjdGlvbigpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5yZWZyZXNoU2VsZWN0aW9uKCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuY2xvc2VQb3B1cE9uU2VsZWN0KSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuaGlkZVBvcHVwKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5yZWZyZXNoUGxhY2VIb2xkZXIoKTtcbiAgICAgICAgfTtcbiAgICAgICAgTXVsdGlTZWxlY3QucHJvdG90eXBlLnJlZnJlc2hMaXN0SXRlbXMgPSBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgaWYgKCh0aGlzLmFsbG93RmlsdGVyaW5nIHx8IHRoaXMuYWxsb3dDdXN0b21WYWx1ZSkgJiYgdGhpcy5tYWluTGlzdCAmJiB0aGlzLmxpc3REYXRhKSB7XG4gICAgICAgICAgICAgICAgdmFyIGxpc3QgPSB0aGlzLm1haW5MaXN0LmNsb25lTm9kZSA/IHRoaXMubWFpbkxpc3QuY2xvbmVOb2RlKHRydWUpIDogdGhpcy5tYWluTGlzdDtcbiAgICAgICAgICAgICAgICB0aGlzLm9uQWN0aW9uQ29tcGxldGUobGlzdCwgdGhpcy5tYWluRGF0YSk7XG4gICAgICAgICAgICAgICAgdGhpcy5mb2N1c0F0TGFzdExpc3RJdGVtKGRhdGEpO1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLnZhbHVlICYmIHRoaXMudmFsdWUubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucmVmcmVzaFNlbGVjdGlvbigpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgTXVsdGlTZWxlY3QucHJvdG90eXBlLnJlbW92ZVNlbGVjdGVkQ2hpcCA9IGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgICB2YXIgc2VsZWN0ZWRFbGVtID0gdGhpcy5jaGlwQ29sbGVjdGlvbldyYXBwZXIucXVlcnlTZWxlY3Rvcignc3Bhbi4nICsgQ0hJUF9TRUxFQ1RFRCk7XG4gICAgICAgICAgICB2YXIgdGVtcDtcbiAgICAgICAgICAgIGlmIChzZWxlY3RlZEVsZW0gIT09IG51bGwpIHtcbiAgICAgICAgICAgICAgICB0ZW1wID0gc2VsZWN0ZWRFbGVtLm5leHRFbGVtZW50U2libGluZztcbiAgICAgICAgICAgICAgICBpZiAodGVtcCAhPT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnJlbW92ZUNoaXBTZWxlY3Rpb24oKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5hZGRDaGlwU2VsZWN0aW9uKHRlbXApO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB0aGlzLnJlbW92ZVZhbHVlKHNlbGVjdGVkRWxlbS5nZXRBdHRyaWJ1dGUoJ2RhdGEtdmFsdWUnKSwgZSk7XG4gICAgICAgICAgICAgICAgdGhpcy5tYWtlVGV4dEJveEVtcHR5KCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAodGhpcy5jbG9zZVBvcHVwT25TZWxlY3QpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmhpZGVQb3B1cCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICBNdWx0aVNlbGVjdC5wcm90b3R5cGUubW92ZUJ5VG9wID0gZnVuY3Rpb24gKHN0YXRlKSB7XG4gICAgICAgICAgICB2YXIgZWxlbWVudHMgPSB0aGlzLmxpc3QucXVlcnlTZWxlY3RvckFsbCgnbGkuJyArIGRyb3BfZG93bl9iYXNlXzEuZHJvcERvd25CYXNlQ2xhc3Nlcy5saSk7XG4gICAgICAgICAgICB2YXIgaW5kZXg7XG4gICAgICAgICAgICBpZiAoZWxlbWVudHMubGVuZ3RoID4gMSkge1xuICAgICAgICAgICAgICAgIHRoaXMucmVtb3ZlRm9jdXMoKTtcbiAgICAgICAgICAgICAgICBpbmRleCA9IHN0YXRlID8gMCA6IChlbGVtZW50cy5sZW5ndGggLSAxKTtcbiAgICAgICAgICAgICAgICB0aGlzLmFkZExpc3RGb2N1cyhlbGVtZW50c1tpbmRleF0pO1xuICAgICAgICAgICAgICAgIHRoaXMuc2Nyb2xsQm90dG9tKGVsZW1lbnRzW2luZGV4XSwgaW5kZXgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy51cGRhdGVBcmlhQXR0cmlidXRlKCk7XG4gICAgICAgIH07XG4gICAgICAgIE11bHRpU2VsZWN0LnByb3RvdHlwZS5tb3ZlQnlMaXN0ID0gZnVuY3Rpb24gKHBvc2l0aW9uKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5saXN0KSB7XG4gICAgICAgICAgICAgICAgdmFyIGVsZW1lbnRzID0gdGhpcy5saXN0LnF1ZXJ5U2VsZWN0b3JBbGwoJ2xpLidcbiAgICAgICAgICAgICAgICAgICAgKyBkcm9wX2Rvd25fYmFzZV8xLmRyb3BEb3duQmFzZUNsYXNzZXMubGlcbiAgICAgICAgICAgICAgICAgICAgKyAnOm5vdCguJyArIEhJREVfTElTVCArICcpJyk7XG4gICAgICAgICAgICAgICAgdmFyIHNlbGVjdGVkRWxlbSA9IHRoaXMubGlzdC5xdWVyeVNlbGVjdG9yKCdsaS4nICsgZHJvcF9kb3duX2Jhc2VfMS5kcm9wRG93bkJhc2VDbGFzc2VzLmZvY3VzKTtcbiAgICAgICAgICAgICAgICB2YXIgdGVtcCA9IC0xO1xuICAgICAgICAgICAgICAgIGlmIChlbGVtZW50cy5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaW5kZXggPSAwOyBpbmRleCA8IGVsZW1lbnRzLmxlbmd0aDsgaW5kZXgrKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGVsZW1lbnRzW2luZGV4XSA9PT0gc2VsZWN0ZWRFbGVtKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGVtcCA9IGluZGV4O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGlmIChwb3NpdGlvbiA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0ZW1wIDwgKGVsZW1lbnRzLmxlbmd0aCAtIDEpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5yZW1vdmVGb2N1cygpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYWRkTGlzdEZvY3VzKGVsZW1lbnRzWysrdGVtcF0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2Nyb2xsQm90dG9tKGVsZW1lbnRzW3RlbXBdLCB0ZW1wKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0ZW1wID4gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucmVtb3ZlRm9jdXMoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmFkZExpc3RGb2N1cyhlbGVtZW50c1stLXRlbXBdKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnNjcm9sbFRvcChlbGVtZW50c1t0ZW1wXSwgdGVtcCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIE11bHRpU2VsZWN0LnByb3RvdHlwZS5tb3ZlQnkgPSBmdW5jdGlvbiAocG9zaXRpb24pIHtcbiAgICAgICAgICAgIHZhciBlbGVtZW50cztcbiAgICAgICAgICAgIHZhciBzZWxlY3RlZEVsZW07XG4gICAgICAgICAgICB2YXIgdGVtcDtcbiAgICAgICAgICAgIGVsZW1lbnRzID0gdGhpcy5jaGlwQ29sbGVjdGlvbldyYXBwZXIucXVlcnlTZWxlY3RvckFsbCgnc3Bhbi4nICsgQ0hJUCk7XG4gICAgICAgICAgICBzZWxlY3RlZEVsZW0gPSB0aGlzLmNoaXBDb2xsZWN0aW9uV3JhcHBlci5xdWVyeVNlbGVjdG9yKCdzcGFuLicgKyBDSElQX1NFTEVDVEVEKTtcbiAgICAgICAgICAgIGlmIChzZWxlY3RlZEVsZW0gPT09IG51bGwpIHtcbiAgICAgICAgICAgICAgICBpZiAocG9zaXRpb24gPCAwKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuYWRkQ2hpcFNlbGVjdGlvbihlbGVtZW50c1tlbGVtZW50cy5sZW5ndGggLSAxXSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgaWYgKHBvc2l0aW9uIDwgMCkge1xuICAgICAgICAgICAgICAgICAgICB0ZW1wID0gc2VsZWN0ZWRFbGVtLnByZXZpb3VzRWxlbWVudFNpYmxpbmc7XG4gICAgICAgICAgICAgICAgICAgIGlmICh0ZW1wICE9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnJlbW92ZUNoaXBTZWxlY3Rpb24oKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYWRkQ2hpcFNlbGVjdGlvbih0ZW1wKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdGVtcCA9IHNlbGVjdGVkRWxlbS5uZXh0RWxlbWVudFNpYmxpbmc7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucmVtb3ZlQ2hpcFNlbGVjdGlvbigpO1xuICAgICAgICAgICAgICAgICAgICBpZiAodGVtcCAhPT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5hZGRDaGlwU2VsZWN0aW9uKHRlbXApO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICBNdWx0aVNlbGVjdC5wcm90b3R5cGUuY2hpcENsaWNrID0gZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLmVuYWJsZWQpIHtcbiAgICAgICAgICAgICAgICB2YXIgZWxlbSA9IGVqMl9iYXNlXzUuY2xvc2VzdChlLnRhcmdldCwgJy4nICsgQ0hJUCk7XG4gICAgICAgICAgICAgICAgdGhpcy5yZW1vdmVDaGlwU2VsZWN0aW9uKCk7XG4gICAgICAgICAgICAgICAgdGhpcy5hZGRDaGlwU2VsZWN0aW9uKGVsZW0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICBNdWx0aVNlbGVjdC5wcm90b3R5cGUucmVtb3ZlQ2hpcFNlbGVjdGlvbiA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLmNoaXBDb2xsZWN0aW9uV3JhcHBlcikge1xuICAgICAgICAgICAgICAgIHRoaXMucmVtb3ZlQ2hpcEZvY3VzKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIE11bHRpU2VsZWN0LnByb3RvdHlwZS5hZGRDaGlwU2VsZWN0aW9uID0gZnVuY3Rpb24gKGVsZW1lbnQpIHtcbiAgICAgICAgICAgIGVqMl9iYXNlXzUuYWRkQ2xhc3MoW2VsZW1lbnRdLCBDSElQX1NFTEVDVEVEKTtcbiAgICAgICAgfTtcbiAgICAgICAgTXVsdGlTZWxlY3QucHJvdG90eXBlLm9uQ2hpcFJlbW92ZSA9IGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5lbmFibGVkICYmICF0aGlzLnJlYWRvbmx5KSB7XG4gICAgICAgICAgICAgICAgdmFyIGVsZW1lbnQgPSBlLnRhcmdldC5wYXJlbnRFbGVtZW50O1xuICAgICAgICAgICAgICAgIHZhciB2YWx1ZSA9IHRoaXMuZ2V0Rm9ybWF0dGVkVmFsdWUoZWxlbWVudC5nZXRBdHRyaWJ1dGUoJ2RhdGEtdmFsdWUnKSk7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuaXNQb3B1cE9wZW4oKSkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmhpZGVQb3B1cCgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB0aGlzLnJlbW92ZVZhbHVlKHZhbHVlLCBlKTtcbiAgICAgICAgICAgICAgICB0aGlzLnVwZGF0ZURlbGltZXRlcihlKTtcbiAgICAgICAgICAgICAgICB0aGlzLm1ha2VUZXh0Qm94RW1wdHkoKTtcbiAgICAgICAgICAgICAgICBpZiAoIXRoaXMuaW5wdXRGb2N1cykge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmlucHV0RWxlbWVudC5mb2N1cygpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIE11bHRpU2VsZWN0LnByb3RvdHlwZS5tYWtlVGV4dEJveEVtcHR5ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdGhpcy5pbnB1dEVsZW1lbnQudmFsdWUgPSAnJztcbiAgICAgICAgICAgIHRoaXMucmVmcmVzaFBsYWNlSG9sZGVyKCk7XG4gICAgICAgIH07XG4gICAgICAgIE11bHRpU2VsZWN0LnByb3RvdHlwZS5yZWZyZXNoUGxhY2VIb2xkZXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5wbGFjZWhvbGRlcikge1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLnZhbHVlICYmIHRoaXMudmFsdWUubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuaW5wdXRFbGVtZW50LnBsYWNlaG9sZGVyID0gJyc7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmlucHV0RWxlbWVudC5wbGFjZWhvbGRlciA9IHRoaXMucGxhY2Vob2xkZXI7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5leHBhbmRUZXh0Ym94KCk7XG4gICAgICAgIH07XG4gICAgICAgIE11bHRpU2VsZWN0LnByb3RvdHlwZS5yZW1vdmVWYWx1ZSA9IGZ1bmN0aW9uICh2YWx1ZSwgZXZlKSB7XG4gICAgICAgICAgICB2YXIgaW5kZXggPSB0aGlzLnZhbHVlLmluZGV4T2YodGhpcy5nZXRGb3JtYXR0ZWRWYWx1ZSh2YWx1ZSkpO1xuICAgICAgICAgICAgdmFyIGNsYXNzTmFtZSA9IHRoaXMuaGlkZVNlbGVjdGVkSXRlbSA/XG4gICAgICAgICAgICAgICAgSElERV9MSVNUIDpcbiAgICAgICAgICAgICAgICBkcm9wX2Rvd25fYmFzZV8xLmRyb3BEb3duQmFzZUNsYXNzZXMuc2VsZWN0ZWQ7XG4gICAgICAgICAgICBpZiAoaW5kZXggIT09IC0xKSB7XG4gICAgICAgICAgICAgICAgdmFyIGVsZW1lbnQgPSB0aGlzLmxpc3QucXVlcnlTZWxlY3RvcignbGlbZGF0YS12YWx1ZT1cIicgKyB2YWx1ZSArICdcIl0nKTtcbiAgICAgICAgICAgICAgICB2YXIgZXZlbnRBcmdzID0ge1xuICAgICAgICAgICAgICAgICAgICBlOiBldmUsXG4gICAgICAgICAgICAgICAgICAgIGl0ZW06IGVsZW1lbnQsXG4gICAgICAgICAgICAgICAgICAgIGl0ZW1EYXRhOiB0aGlzLmdldERhdGFCeVZhbHVlKHZhbHVlKSxcbiAgICAgICAgICAgICAgICAgICAgaXNJbnRlcmFjdGVkOiBldmUgPyB0cnVlIDogZmFsc2VcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIHRoaXMudHJpZ2dlcigncmVtb3ZpbmcnLCBldmVudEFyZ3MpO1xuICAgICAgICAgICAgICAgIHRoaXMudmFsdWUuc3BsaWNlKGluZGV4LCAxKTtcbiAgICAgICAgICAgICAgICB0aGlzLnNldFByb3BlcnRpZXMoeyB2YWx1ZTogW10uY29uY2F0KFtdLCB0aGlzLnZhbHVlKSB9LCB0cnVlKTtcbiAgICAgICAgICAgICAgICBpZiAoZWxlbWVudCAhPT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICBlbGVtZW50LnNldEF0dHJpYnV0ZSgnYXJpYS1zZWxlY3RlZCcsICdmYWxzZScpO1xuICAgICAgICAgICAgICAgICAgICBlajJfYmFzZV81LnJlbW92ZUNsYXNzKFtlbGVtZW50XSwgY2xhc3NOYW1lKTtcbiAgICAgICAgICAgICAgICAgICAgZWoyX2Jhc2VfMS5hdHRyaWJ1dGVzKHRoaXMuaW5wdXRFbGVtZW50LCB7ICdhcmlhLWFjdGl2ZWRlc2NlbmRhbnQnOiBlbGVtZW50LmlkIH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB0aGlzLnVwZGF0ZU1haW5MaXN0KHRydWUsIHZhbHVlKTtcbiAgICAgICAgICAgICAgICB0aGlzLnJlbW92ZUNoaXAodmFsdWUpO1xuICAgICAgICAgICAgICAgIHRoaXMudXBkYXRlQ2hpcFN0YXR1cygpO1xuICAgICAgICAgICAgICAgIHRoaXMudHJpZ2dlcigncmVtb3ZlZCcsIGV2ZW50QXJncyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIE11bHRpU2VsZWN0LnByb3RvdHlwZS51cGRhdGVNYWluTGlzdCA9IGZ1bmN0aW9uIChzdGF0ZSwgdmFsdWUpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLmFsbG93RmlsdGVyaW5nKSB7XG4gICAgICAgICAgICAgICAgdmFyIGVsZW1lbnQyID0gdGhpcy5tYWluTGlzdC5xdWVyeVNlbGVjdG9yKCdsaVtkYXRhLXZhbHVlPVwiJyArIHZhbHVlICsgJ1wiXScpO1xuICAgICAgICAgICAgICAgIGlmIChlbGVtZW50Mikge1xuICAgICAgICAgICAgICAgICAgICBpZiAoc3RhdGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGVsZW1lbnQyLnNldEF0dHJpYnV0ZSgnYXJpYS1zZWxlY3RlZCcsICdmYWxzZScpO1xuICAgICAgICAgICAgICAgICAgICAgICAgZWoyX2Jhc2VfNS5yZW1vdmVDbGFzcyhbZWxlbWVudDJdLCB0aGlzLmhpZGVTZWxlY3RlZEl0ZW0gP1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIEhJREVfTElTVCA6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZHJvcF9kb3duX2Jhc2VfMS5kcm9wRG93bkJhc2VDbGFzc2VzLnNlbGVjdGVkKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGVsZW1lbnQyLnNldEF0dHJpYnV0ZSgnYXJpYS1zZWxlY3RlZCcsICd0cnVlJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICBlajJfYmFzZV81LmFkZENsYXNzKFtlbGVtZW50Ml0sIHRoaXMuaGlkZVNlbGVjdGVkSXRlbSA/XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgSElERV9MSVNUIDpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkcm9wX2Rvd25fYmFzZV8xLmRyb3BEb3duQmFzZUNsYXNzZXMuc2VsZWN0ZWQpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICBNdWx0aVNlbGVjdC5wcm90b3R5cGUucmVtb3ZlQ2hpcCA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgaWYgKHRoaXMuY2hpcENvbGxlY3Rpb25XcmFwcGVyKSB7XG4gICAgICAgICAgICAgICAgdmFyIGVsZW1lbnQgPSB0aGlzLmNoaXBDb2xsZWN0aW9uV3JhcHBlci5xdWVyeVNlbGVjdG9yKCdzcGFuW2RhdGEtdmFsdWU9XCInICsgdmFsdWUgKyAnXCJdJyk7XG4gICAgICAgICAgICAgICAgaWYgKGVsZW1lbnQpIHtcbiAgICAgICAgICAgICAgICAgICAgZWoyX2Jhc2VfNS5yZW1vdmUoZWxlbWVudCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICBNdWx0aVNlbGVjdC5wcm90b3R5cGUudXBkYXRlQ2hpcFN0YXR1cyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLnZhbHVlLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgIGlmICghZWoyX2Jhc2VfNi5pc051bGxPclVuZGVmaW5lZCh0aGlzLmNoaXBDb2xsZWN0aW9uV3JhcHBlcikpIHtcbiAgICAgICAgICAgICAgICAgICAgKHRoaXMuY2hpcENvbGxlY3Rpb25XcmFwcGVyLnN0eWxlLmRpc3BsYXkgPSAnJyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmICh0aGlzLm1vZGUgPT09ICdkZWxpbWl0ZXInKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc2hvd0RlbGltV3JhcHBlcigpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB0aGlzLnNob3dPdmVyQWxsQ2xlYXIoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGlmICghZWoyX2Jhc2VfNi5pc051bGxPclVuZGVmaW5lZCh0aGlzLmNoaXBDb2xsZWN0aW9uV3JhcHBlcikpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jaGlwQ29sbGVjdGlvbldyYXBwZXIuc3R5bGUuZGlzcGxheSA9ICdub25lJztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKCFlajJfYmFzZV82LmlzTnVsbE9yVW5kZWZpbmVkKHRoaXMuZGVsaW1pdGVyV3JhcHBlcikpIHtcbiAgICAgICAgICAgICAgICAgICAgKHRoaXMuZGVsaW1pdGVyV3JhcHBlci5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdGhpcy5oaWRlT3ZlckFsbENsZWFyKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIE11bHRpU2VsZWN0LnByb3RvdHlwZS5hZGRWYWx1ZSA9IGZ1bmN0aW9uICh2YWx1ZSwgdGV4dCwgZXZlKSB7XG4gICAgICAgICAgICBpZiAoIXRoaXMudmFsdWUpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnZhbHVlID0gW107XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLnNldFByb3BlcnRpZXMoeyB2YWx1ZTogW10uY29uY2F0KFtdLCB0aGlzLnZhbHVlLCBbdmFsdWVdKSB9LCB0cnVlKTtcbiAgICAgICAgICAgIHZhciBlbGVtZW50ID0gdGhpcy5saXN0LnF1ZXJ5U2VsZWN0b3IoJ2xpW2RhdGEtdmFsdWU9XCInICsgdmFsdWUgKyAnXCJdJyk7XG4gICAgICAgICAgICB0aGlzLnJlbW92ZUZvY3VzKCk7XG4gICAgICAgICAgICBpZiAoZWxlbWVudCkge1xuICAgICAgICAgICAgICAgIHRoaXMuYWRkTGlzdEZvY3VzKGVsZW1lbnQpO1xuICAgICAgICAgICAgICAgIHRoaXMuYWRkTGlzdFNlbGVjdGlvbihlbGVtZW50KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh0aGlzLm1vZGUgIT09ICdkZWxpbWl0ZXInKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5hZGRDaGlwKHRleHQsIHZhbHVlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMudXBkYXRlQ2hpcFN0YXR1cygpO1xuICAgICAgICAgICAgdGhpcy5kaXNwYXRjaFNlbGVjdCh2YWx1ZSwgZXZlLCBlbGVtZW50LCAoZXZlICYmIGV2ZS50eXBlICE9PSAnY2xpY2snKSk7XG4gICAgICAgIH07XG4gICAgICAgIE11bHRpU2VsZWN0LnByb3RvdHlwZS5kaXNwYXRjaFNlbGVjdCA9IGZ1bmN0aW9uICh2YWx1ZSwgZXZlLCBlbGVtZW50LCBpc05vdFRyaWdnZXIpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLmluaXRTdGF0dXMgJiYgIWlzTm90VHJpZ2dlcikge1xuICAgICAgICAgICAgICAgIHZhciBldmVudEFyZ3MgPSB7XG4gICAgICAgICAgICAgICAgICAgIGU6IGV2ZSxcbiAgICAgICAgICAgICAgICAgICAgaXRlbTogZWxlbWVudCxcbiAgICAgICAgICAgICAgICAgICAgaXRlbURhdGE6IHRoaXMuZ2V0RGF0YUJ5VmFsdWUodmFsdWUpLFxuICAgICAgICAgICAgICAgICAgICBpc0ludGVyYWN0ZWQ6IGV2ZSA/IHRydWUgOiBmYWxzZVxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgdGhpcy50cmlnZ2VyKCdzZWxlY3QnLCBldmVudEFyZ3MpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICBNdWx0aVNlbGVjdC5wcm90b3R5cGUuYWRkQ2hpcCA9IGZ1bmN0aW9uICh0ZXh0LCB2YWx1ZSkge1xuICAgICAgICAgICAgaWYgKHRoaXMuY2hpcENvbGxlY3Rpb25XcmFwcGVyKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5jaGlwQ29sbGVjdGlvbldyYXBwZXIuYXBwZW5kQ2hpbGQodGhpcy5nZXRDaGlwKHRleHQsIHZhbHVlKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIE11bHRpU2VsZWN0LnByb3RvdHlwZS5yZW1vdmVDaGlwRm9jdXMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgZWxlbWVudHM7XG4gICAgICAgICAgICB2YXIgY2xvc2VFbGVtZW50cztcbiAgICAgICAgICAgIGVsZW1lbnRzID0gdGhpcy5jaGlwQ29sbGVjdGlvbldyYXBwZXIucXVlcnlTZWxlY3RvckFsbCgnc3Bhbi4nICsgQ0hJUCk7XG4gICAgICAgICAgICBjbG9zZUVsZW1lbnRzID0gdGhpcy5jaGlwQ29sbGVjdGlvbldyYXBwZXIucXVlcnlTZWxlY3RvckFsbCgnc3Bhbi4nICsgQ0hJUF9DTE9TRS5zcGxpdCgnICcpWzBdKTtcbiAgICAgICAgICAgIGVqMl9iYXNlXzUucmVtb3ZlQ2xhc3MoZWxlbWVudHMsIENISVBfU0VMRUNURUQpO1xuICAgICAgICAgICAgaWYgKGVqMl9iYXNlXzQuQnJvd3Nlci5pc0RldmljZSkge1xuICAgICAgICAgICAgICAgIGZvciAodmFyIGluZGV4ID0gMDsgaW5kZXggPCBjbG9zZUVsZW1lbnRzLmxlbmd0aDsgaW5kZXgrKykge1xuICAgICAgICAgICAgICAgICAgICBjbG9zZUVsZW1lbnRzW2luZGV4XS5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgTXVsdGlTZWxlY3QucHJvdG90eXBlLm9uTW9iaWxlQ2hpcEludGVyYWN0aW9uID0gZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgIHZhciBjaGlwRWxlbSA9IGVqMl9iYXNlXzUuY2xvc2VzdChlLnRhcmdldCwgJy4nICsgQ0hJUCk7XG4gICAgICAgICAgICB2YXIgY2hpcENsb3NlID0gY2hpcEVsZW0ucXVlcnlTZWxlY3Rvcignc3Bhbi4nICsgQ0hJUF9DTE9TRS5zcGxpdCgnICcpWzBdKTtcbiAgICAgICAgICAgIGlmICh0aGlzLmVuYWJsZWQgJiYgIXRoaXMucmVhZG9ubHkpIHtcbiAgICAgICAgICAgICAgICBpZiAoIWNoaXBFbGVtLmNsYXNzTGlzdC5jb250YWlucyhDSElQX1NFTEVDVEVEKSkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnJlbW92ZUNoaXBGb2N1cygpO1xuICAgICAgICAgICAgICAgICAgICBjaGlwQ2xvc2Uuc3R5bGUuZGlzcGxheSA9ICcnO1xuICAgICAgICAgICAgICAgICAgICBjaGlwRWxlbS5jbGFzc0xpc3QuYWRkKENISVBfU0VMRUNURUQpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB0aGlzLnJlZnJlc2hQb3B1cCgpO1xuICAgICAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgTXVsdGlTZWxlY3QucHJvdG90eXBlLmdldENoaXAgPSBmdW5jdGlvbiAoZGF0YSwgdmFsdWUpIHtcbiAgICAgICAgICAgIHZhciBpdGVtRGF0YSA9IHsgdGV4dDogdmFsdWUsIHZhbHVlOiB2YWx1ZSB9O1xuICAgICAgICAgICAgdmFyIGNoaXAgPSBlajJfYmFzZV81LmNyZWF0ZUVsZW1lbnQoJ3NwYW4nLCB7XG4gICAgICAgICAgICAgICAgY2xhc3NOYW1lOiBDSElQLFxuICAgICAgICAgICAgICAgIGF0dHJzOiB7ICdkYXRhLXZhbHVlJzogdmFsdWUsICd0aXRsZSc6IGRhdGEgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB2YXIgY2hpcENvbnRlbnQgPSBlajJfYmFzZV81LmNyZWF0ZUVsZW1lbnQoJ3NwYW4nLCB7IGNsYXNzTmFtZTogQ0hJUF9DT05URU5UIH0pO1xuICAgICAgICAgICAgdmFyIGNoaXBDbG9zZSA9IGVqMl9iYXNlXzUuY3JlYXRlRWxlbWVudCgnc3BhbicsIHsgY2xhc3NOYW1lOiBDSElQX0NMT1NFIH0pO1xuICAgICAgICAgICAgaWYgKHRoaXMubWFpbkRhdGEpIHtcbiAgICAgICAgICAgICAgICBpdGVtRGF0YSA9IHRoaXMuZ2V0RGF0YUJ5VmFsdWUodmFsdWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHRoaXMudmFsdWVUZW1wbGF0ZSAmJiBpdGVtRGF0YSkge1xuICAgICAgICAgICAgICAgIHZhciBjb21waWxlZFN0cmluZyA9IGVqMl9iYXNlXzMuY29tcGlsZSh0aGlzLnZhbHVlVGVtcGxhdGUpO1xuICAgICAgICAgICAgICAgIGZvciAodmFyIF9pID0gMCwgX2EgPSBjb21waWxlZFN0cmluZyhpdGVtRGF0YSk7IF9pIDwgX2EubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBpdGVtID0gX2FbX2ldO1xuICAgICAgICAgICAgICAgICAgICBjaGlwQ29udGVudC5hcHBlbmRDaGlsZChpdGVtKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBjaGlwQ29udGVudC5pbm5lckhUTUwgPSBkYXRhO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY2hpcC5hcHBlbmRDaGlsZChjaGlwQ29udGVudCk7XG4gICAgICAgICAgICBpZiAoZWoyX2Jhc2VfNC5Ccm93c2VyLmlzRGV2aWNlKSB7XG4gICAgICAgICAgICAgICAgY2hpcC5jbGFzc0xpc3QuYWRkKE1PQklMRV9DSElQKTtcbiAgICAgICAgICAgICAgICBlajJfYmFzZV81LmFwcGVuZChbY2hpcENsb3NlXSwgY2hpcCk7XG4gICAgICAgICAgICAgICAgY2hpcENsb3NlLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XG4gICAgICAgICAgICAgICAgZWoyX2Jhc2VfMy5FdmVudEhhbmRsZXIuYWRkKGNoaXAsICdjbGljaycsIHRoaXMub25Nb2JpbGVDaGlwSW50ZXJhY3Rpb24sIHRoaXMpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgZWoyX2Jhc2VfMy5FdmVudEhhbmRsZXIuYWRkKGNoaXAsICdtb3VzZWRvd24nLCB0aGlzLmNoaXBDbGljaywgdGhpcyk7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuc2hvd0NsZWFyQnV0dG9uKSB7XG4gICAgICAgICAgICAgICAgICAgIGNoaXAuYXBwZW5kQ2hpbGQoY2hpcENsb3NlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlajJfYmFzZV8zLkV2ZW50SGFuZGxlci5hZGQoY2hpcENsb3NlLCAnbW91c2Vkb3duJywgdGhpcy5vbkNoaXBSZW1vdmUsIHRoaXMpO1xuICAgICAgICAgICAgcmV0dXJuIGNoaXA7XG4gICAgICAgIH07XG4gICAgICAgIE11bHRpU2VsZWN0LnByb3RvdHlwZS5jYWxjUG9wdXBXaWR0aCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciB3aWR0aCA9IGVqMl9iYXNlXzYuZm9ybWF0VW5pdCh0aGlzLnBvcHVwV2lkdGgpO1xuICAgICAgICAgICAgaWYgKHdpZHRoLmluZGV4T2YoJyUnKSA+IC0xKSB7XG4gICAgICAgICAgICAgICAgdmFyIGlucHV0V2lkdGggPSAodGhpcy5jb21wb25lbnRXcmFwcGVyLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLndpZHRoKSAqIHBhcnNlRmxvYXQod2lkdGgpIC8gMTAwO1xuICAgICAgICAgICAgICAgIHdpZHRoID0gaW5wdXRXaWR0aC50b1N0cmluZygpICsgJ3B4JztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB3aWR0aDtcbiAgICAgICAgfTtcbiAgICAgICAgTXVsdGlTZWxlY3QucHJvdG90eXBlLm1vdXNlSW4gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5lbmFibGVkICYmICF0aGlzLnJlYWRvbmx5KSB7XG4gICAgICAgICAgICAgICAgdGhpcy5zaG93T3ZlckFsbENsZWFyKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIE11bHRpU2VsZWN0LnByb3RvdHlwZS5tb3VzZU91dCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGlmICghdGhpcy5pbnB1dEZvY3VzKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5vdmVyQWxsQ2xlYXIuc3R5bGUuZGlzcGxheSA9ICdub25lJztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgTXVsdGlTZWxlY3QucHJvdG90eXBlLnJlbmRlclBvcHVwID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgICAgIGlmICghdGhpcy5saXN0KSB7XG4gICAgICAgICAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5yZW5kZXIuY2FsbCh0aGlzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICghdGhpcy5wb3B1cE9iaikge1xuICAgICAgICAgICAgICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQodGhpcy5wb3B1cFdyYXBwZXIpO1xuICAgICAgICAgICAgICAgIHZhciBvdmVyQWxsSGVpZ2h0ID0gcGFyc2VJbnQodGhpcy5wb3B1cEhlaWdodCwgMTApO1xuICAgICAgICAgICAgICAgIHRoaXMucG9wdXBXcmFwcGVyLnN0eWxlLnZpc2liaWxpdHkgPSAnaGlkZGVuJztcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5oZWFkZXJUZW1wbGF0ZSkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgY29tcGlsZWRTdHJpbmcgPSB2b2lkIDA7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuaGVhZGVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgICAgICAgICAgICAgICAgIGVqMl9iYXNlXzUuYWRkQ2xhc3MoW3RoaXMuaGVhZGVyXSwgSEVBREVSKTtcbiAgICAgICAgICAgICAgICAgICAgY29tcGlsZWRTdHJpbmcgPSBlajJfYmFzZV8zLmNvbXBpbGUodGhpcy5oZWFkZXJUZW1wbGF0ZSk7XG4gICAgICAgICAgICAgICAgICAgIHZhciBlbGVtZW50cyA9IGNvbXBpbGVkU3RyaW5nKHt9KTtcbiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgdGVtcCA9IDA7IHRlbXAgPCBlbGVtZW50cy5sZW5ndGg7IHRlbXArKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5oZWFkZXIuYXBwZW5kQ2hpbGQoZWxlbWVudHNbdGVtcF0pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVqMl9iYXNlXzUuYXBwZW5kKFt0aGlzLmhlYWRlcl0sIHRoaXMucG9wdXBXcmFwcGVyKTtcbiAgICAgICAgICAgICAgICAgICAgZWoyX2Jhc2VfMy5FdmVudEhhbmRsZXIuYWRkKHRoaXMuaGVhZGVyLCAnbW91c2Vkb3duJywgdGhpcy5vbkxpc3RNb3VzZURvd24sIHRoaXMpO1xuICAgICAgICAgICAgICAgICAgICBvdmVyQWxsSGVpZ2h0IC09IHRoaXMuaGVhZGVyLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLmhlaWdodDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWoyX2Jhc2VfNS5hcHBlbmQoW3RoaXMubGlzdF0sIHRoaXMucG9wdXBXcmFwcGVyKTtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5mb290ZXJUZW1wbGF0ZSkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgY29tcGlsZWRTdHJpbmcgPSB2b2lkIDA7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZm9vdGVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgICAgICAgICAgICAgICAgIGVqMl9iYXNlXzUuYWRkQ2xhc3MoW3RoaXMuZm9vdGVyXSwgRk9PVEVSKTtcbiAgICAgICAgICAgICAgICAgICAgY29tcGlsZWRTdHJpbmcgPSBlajJfYmFzZV8zLmNvbXBpbGUodGhpcy5mb290ZXJUZW1wbGF0ZSk7XG4gICAgICAgICAgICAgICAgICAgIHZhciBlbGVtZW50cyA9IGNvbXBpbGVkU3RyaW5nKHt9KTtcbiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgdGVtcCA9IDA7IHRlbXAgPCBlbGVtZW50cy5sZW5ndGg7IHRlbXArKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5mb290ZXIuYXBwZW5kQ2hpbGQoZWxlbWVudHNbdGVtcF0pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVqMl9iYXNlXzUuYXBwZW5kKFt0aGlzLmZvb3Rlcl0sIHRoaXMucG9wdXBXcmFwcGVyKTtcbiAgICAgICAgICAgICAgICAgICAgZWoyX2Jhc2VfMy5FdmVudEhhbmRsZXIuYWRkKHRoaXMuZm9vdGVyLCAnbW91c2Vkb3duJywgdGhpcy5vbkxpc3RNb3VzZURvd24sIHRoaXMpO1xuICAgICAgICAgICAgICAgICAgICBvdmVyQWxsSGVpZ2h0IC09IHRoaXMuZm9vdGVyLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLmhlaWdodDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMucG9wdXBIZWlnaHQgIT09ICdhdXRvJykge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmxpc3Quc3R5bGUubWF4SGVpZ2h0ID0gZWoyX2Jhc2VfNi5mb3JtYXRVbml0KG92ZXJBbGxIZWlnaHQpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnBvcHVwV3JhcHBlci5zdHlsZS5tYXhIZWlnaHQgPSBlajJfYmFzZV82LmZvcm1hdFVuaXQodGhpcy5wb3B1cEhlaWdodCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmxpc3Quc3R5bGUubWF4SGVpZ2h0ID0gZWoyX2Jhc2VfNi5mb3JtYXRVbml0KHRoaXMucG9wdXBIZWlnaHQpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB0aGlzLnBvcHVwT2JqID0gbmV3IGVqMl9wb3B1cHNfMS5Qb3B1cCh0aGlzLnBvcHVwV3JhcHBlciwge1xuICAgICAgICAgICAgICAgICAgICB3aWR0aDogdGhpcy5jYWxjUG9wdXBXaWR0aCgpLCB0YXJnZXRUeXBlOiAncmVsYXRpdmUnLCBwb3NpdGlvbjogeyBYOiAnbGVmdCcsIFk6ICdib3R0b20nIH0sXG4gICAgICAgICAgICAgICAgICAgIHJlbGF0ZVRvOiB0aGlzLm92ZXJBbGxXcmFwcGVyLCBjb2xsaXNpb246IHsgWDogJ25vbmUnLCBZOiAnZmxpcCcgfSwgb2Zmc2V0WTogMSxcbiAgICAgICAgICAgICAgICAgICAgZW5hYmxlUnRsOiB0aGlzLmVuYWJsZVJ0bCxcbiAgICAgICAgICAgICAgICAgICAgY2xvc2U6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChfdGhpcy5wb3B1cE9iai5lbGVtZW50LnBhcmVudEVsZW1lbnQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlajJfYmFzZV81LmRldGFjaChfdGhpcy5wb3B1cE9iai5lbGVtZW50KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHRoaXMucG9wdXBPYmouY2xvc2UoKTtcbiAgICAgICAgICAgICAgICB0aGlzLnBvcHVwV3JhcHBlci5zdHlsZS52aXNpYmlsaXR5ID0gJyc7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIE11bHRpU2VsZWN0LnByb3RvdHlwZS5DbGVhckFsbCA9IGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5lbmFibGVkICYmICF0aGlzLnJlYWRvbmx5KSB7XG4gICAgICAgICAgICAgICAgdmFyIHRlbXAgPSB2b2lkIDA7XG4gICAgICAgICAgICAgICAgdmFyIHRlbXBWYWx1ZXMgPSB0aGlzLnZhbHVlID8gdGhpcy52YWx1ZS5zbGljZSgpIDogW107XG4gICAgICAgICAgICAgICAgZm9yICh0ZW1wID0gdGhpcy52YWx1ZVswXTsgdGhpcy52YWx1ZS5sZW5ndGggIT09IDA7IHRlbXAgPSB0aGlzLnZhbHVlWzBdKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucmVtb3ZlVmFsdWUodGVtcCwgZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRoaXMudXBkYXRlRGVsaW1ldGVyKGUpO1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLm1vZGUgIT09ICdib3gnKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMudXBkYXRlRGVsaW1WaWV3KCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRoaXMubWFrZVRleHRCb3hFbXB0eSgpO1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLmlzUG9wdXBPcGVuKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5yZWZyZXNoUG9wdXAoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdGhpcy5yZW1vdmVGb2N1cygpO1xuICAgICAgICAgICAgICAgIGlmICghdGhpcy5pbnB1dEZvY3VzKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMudXBkYXRlVmFsdWVTdGF0ZShlLCB0aGlzLnZhbHVlLCB0ZW1wVmFsdWVzKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5pbnB1dEVsZW1lbnQuZm9jdXMoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICBNdWx0aVNlbGVjdC5wcm90b3R5cGUud2luZG93UmVzaXplID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdGhpcy5yZWZyZXNoUG9wdXAoKTtcbiAgICAgICAgICAgIGlmICghdGhpcy5pbnB1dEZvY3VzICYmIHRoaXMudmlld1dyYXBwZXIgJiYgdGhpcy52aWV3V3JhcHBlci5wYXJlbnRFbGVtZW50KSB7XG4gICAgICAgICAgICAgICAgdGhpcy51cGRhdGVEZWxpbVZpZXcoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgTXVsdGlTZWxlY3QucHJvdG90eXBlLndpcmVFdmVudCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGVqMl9iYXNlXzMuRXZlbnRIYW5kbGVyLmFkZCh0aGlzLmNvbXBvbmVudFdyYXBwZXIsICdtb3VzZWRvd24nLCB0aGlzLndyYXBwZXJDbGljaywgdGhpcyk7XG4gICAgICAgICAgICBlajJfYmFzZV8zLkV2ZW50SGFuZGxlci5hZGQod2luZG93LCAncmVzaXplJywgdGhpcy53aW5kb3dSZXNpemUsIHRoaXMpO1xuICAgICAgICAgICAgZWoyX2Jhc2VfMy5FdmVudEhhbmRsZXIuYWRkKHRoaXMuaW5wdXRFbGVtZW50LCAnZm9jdXMnLCB0aGlzLmZvY3VzSW4sIHRoaXMpO1xuICAgICAgICAgICAgZWoyX2Jhc2VfMy5FdmVudEhhbmRsZXIuYWRkKHRoaXMuaW5wdXRFbGVtZW50LCAna2V5ZG93bicsIHRoaXMub25LZXlEb3duLCB0aGlzKTtcbiAgICAgICAgICAgIGVqMl9iYXNlXzMuRXZlbnRIYW5kbGVyLmFkZCh0aGlzLmlucHV0RWxlbWVudCwgJ2tleXVwJywgdGhpcy5LZXlVcCwgdGhpcyk7XG4gICAgICAgICAgICBlajJfYmFzZV8zLkV2ZW50SGFuZGxlci5hZGQodGhpcy5pbnB1dEVsZW1lbnQsICdpbnB1dCcsIHRoaXMub25JbnB1dCwgdGhpcyk7XG4gICAgICAgICAgICBlajJfYmFzZV8zLkV2ZW50SGFuZGxlci5hZGQodGhpcy5pbnB1dEVsZW1lbnQsICdibHVyJywgdGhpcy5vbkJsdXIsIHRoaXMpO1xuICAgICAgICAgICAgZWoyX2Jhc2VfMy5FdmVudEhhbmRsZXIuYWRkKHRoaXMuY29tcG9uZW50V3JhcHBlciwgJ21vdXNlbW92ZScsIHRoaXMubW91c2VJbiwgdGhpcyk7XG4gICAgICAgICAgICBlajJfYmFzZV8zLkV2ZW50SGFuZGxlci5hZGQodGhpcy5jb21wb25lbnRXcmFwcGVyLCAnbW91c2VvdXQnLCB0aGlzLm1vdXNlT3V0LCB0aGlzKTtcbiAgICAgICAgICAgIGVqMl9iYXNlXzMuRXZlbnRIYW5kbGVyLmFkZCh0aGlzLm92ZXJBbGxDbGVhciwgJ21vdXNldXAnLCB0aGlzLkNsZWFyQWxsLCB0aGlzKTtcbiAgICAgICAgfTtcbiAgICAgICAgTXVsdGlTZWxlY3QucHJvdG90eXBlLm9uSW5wdXQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5rZXlEb3duU3RhdHVzKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5pc1ZhbGlkS2V5ID0gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHRoaXMuaXNWYWxpZEtleSA9IGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5rZXlEb3duU3RhdHVzID0gZmFsc2U7XG4gICAgICAgIH07XG4gICAgICAgIE11bHRpU2VsZWN0LnByb3RvdHlwZS5wcmVSZW5kZXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBfc3VwZXIucHJvdG90eXBlLnByZVJlbmRlci5jYWxsKHRoaXMpO1xuICAgICAgICB9O1xuICAgICAgICBNdWx0aVNlbGVjdC5wcm90b3R5cGUudXBkYXRlRGF0YSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciBkYXRhID0gJyc7XG4gICAgICAgICAgICB2YXIgZGVsaW0gPSB0aGlzLm1vZGUgPT09ICdkZWxpbWl0ZXInO1xuICAgICAgICAgICAgdmFyIHRleHQgPSBbXTtcbiAgICAgICAgICAgIHZhciB0ZW1wO1xuICAgICAgICAgICAgdmFyIHRlbXBEYXRhID0gdGhpcy5saXN0RGF0YTtcbiAgICAgICAgICAgIHRoaXMubGlzdERhdGEgPSB0aGlzLm1haW5EYXRhO1xuICAgICAgICAgICAgdGhpcy5oaWRkZW5FbGVtZW50LmlubmVySFRNTCA9ICcnO1xuICAgICAgICAgICAgZm9yICh2YXIgaW5kZXggPSAwOyB0aGlzLnZhbHVlW2luZGV4XTsgaW5kZXgrKykge1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLmxpc3REYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgIHRlbXAgPSB0aGlzLmdldFRleHRCeVZhbHVlKHRoaXMudmFsdWVbaW5kZXhdKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHRlbXAgPSB0aGlzLnZhbHVlW2luZGV4XTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZGF0YSArPSB0ZW1wICsgdGhpcy5kZWxpbWl0ZXJDaGFyICsgJyAnO1xuICAgICAgICAgICAgICAgIHRleHQucHVzaCh0ZW1wKTtcbiAgICAgICAgICAgICAgICB0aGlzLmhpZGRlbkVsZW1lbnQuaW5uZXJIVE1MICs9ICc8b3B0aW9uIHNlbGVjdGVkIHZhbHVlID0nICsgdGhpcy52YWx1ZVtpbmRleF0gKyAnPicgKyBpbmRleCArICc8L29wdGlvbj4nO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy50ZXh0ID0gdGV4dC50b1N0cmluZygpO1xuICAgICAgICAgICAgaWYgKGRlbGltKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5kZWxpbWl0ZXJXcmFwcGVyLmlubmVySFRNTCA9IGRhdGE7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLmxpc3REYXRhID0gdGVtcERhdGE7XG4gICAgICAgIH07XG4gICAgICAgIE11bHRpU2VsZWN0LnByb3RvdHlwZS5pbml0aWFsVmFsdWVVcGRhdGUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5saXN0KSB7XG4gICAgICAgICAgICAgICAgdmFyIHRleHQgPSB2b2lkIDA7XG4gICAgICAgICAgICAgICAgdmFyIHRleHRGaWVsZCA9IHZvaWQgMDtcbiAgICAgICAgICAgICAgICB2YXIgdmFsdWVGaWVsZCA9IHZvaWQgMDtcbiAgICAgICAgICAgICAgICB2YXIgZWxlbWVudCA9IHZvaWQgMDtcbiAgICAgICAgICAgICAgICB2YXIgdmFsdWUgPSB2b2lkIDA7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuY2hpcENvbGxlY3Rpb25XcmFwcGVyKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY2hpcENvbGxlY3Rpb25XcmFwcGVyLmlubmVySFRNTCA9ICcnO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB0aGlzLnJlbW92ZUxpc3RTZWxlY3Rpb24oKTtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBpbmRleCA9IDA7IHRoaXMudmFsdWVbaW5kZXhdOyBpbmRleCsrKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhbHVlID0gdGhpcy52YWx1ZVtpbmRleF07XG4gICAgICAgICAgICAgICAgICAgIGVsZW1lbnQgPSB0aGlzLmxpc3QucXVlcnlTZWxlY3RvcignbGlbZGF0YS12YWx1ZT1cIicgKyB2YWx1ZSArICdcIl0nKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGVsZW1lbnQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRleHQgPSB0aGlzLmdldFRleHRCeVZhbHVlKHZhbHVlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYWRkQ2hpcCh0ZXh0LCB2YWx1ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmFkZExpc3RTZWxlY3Rpb24oZWxlbWVudCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdGhpcy51cGRhdGVEZWxpbWV0ZXIobnVsbCk7XG4gICAgICAgICAgICAgICAgaWYgKCF0aGlzLmlucHV0Rm9jdXMpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMubW9kZSA9PT0gJ2JveCcpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuY2hpcENvbGxlY3Rpb25XcmFwcGVyLnN0eWxlLmRpc3BsYXkgPSAnJztcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbHNlIGlmICh0aGlzLm1vZGUgPT09ICdkZWxpbWl0ZXInKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnNob3dEZWxpbVdyYXBwZXIoKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgTXVsdGlTZWxlY3QucHJvdG90eXBlLmlzVmFsaWRMSSA9IGZ1bmN0aW9uIChsaSkge1xuICAgICAgICAgICAgcmV0dXJuIChsaSAmJiAhbGkuY2xhc3NMaXN0LmNvbnRhaW5zKGRyb3BfZG93bl9iYXNlXzEuZHJvcERvd25CYXNlQ2xhc3Nlcy5kaXNhYmxlZCkgJiYgIWxpLmNsYXNzTGlzdC5jb250YWlucyhkcm9wX2Rvd25fYmFzZV8xLmRyb3BEb3duQmFzZUNsYXNzZXMuZ3JvdXApICYmXG4gICAgICAgICAgICAgICAgbGkuY2xhc3NMaXN0LmNvbnRhaW5zKGRyb3BfZG93bl9iYXNlXzEuZHJvcERvd25CYXNlQ2xhc3Nlcy5saSkpO1xuICAgICAgICB9O1xuICAgICAgICA7XG4gICAgICAgIE11bHRpU2VsZWN0LnByb3RvdHlwZS51cGRhdGVMaXN0U2VsZWN0aW9uID0gZnVuY3Rpb24gKGxpLCBlKSB7XG4gICAgICAgICAgICB2YXIgdmFsdWUgPSB0aGlzLmdldEZvcm1hdHRlZFZhbHVlKGxpLmdldEF0dHJpYnV0ZSgnZGF0YS12YWx1ZScpKTtcbiAgICAgICAgICAgIHZhciB0ZXh0ID0gdGhpcy5nZXRUZXh0QnlWYWx1ZSh2YWx1ZSk7XG4gICAgICAgICAgICB0aGlzLnJlbW92ZUhvdmVyKCk7XG4gICAgICAgICAgICBpZiAoIXRoaXMudmFsdWUgfHwgdGhpcy52YWx1ZS5pbmRleE9mKHZhbHVlKSA9PT0gLTEpIHtcbiAgICAgICAgICAgICAgICBpZiAoKHRoaXMuYWxsb3dDdXN0b21WYWx1ZSB8fCB0aGlzLmFsbG93RmlsdGVyaW5nKSAmJiAhdGhpcy5tYWluTGlzdC5xdWVyeVNlbGVjdG9yKCdsaVtkYXRhLXZhbHVlPVwiJyArIHZhbHVlICsgJ1wiXScpKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciB0ZW1wID0gbGkuY2xvbmVOb2RlKHRydWUpO1xuICAgICAgICAgICAgICAgICAgICB2YXIgZGF0YSA9IHRoaXMuZ2V0RGF0YUJ5VmFsdWUodmFsdWUpO1xuICAgICAgICAgICAgICAgICAgICBlajJfYmFzZV81LmFwcGVuZChbdGVtcF0sIHRoaXMubWFpbkxpc3QpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLm1haW5EYXRhLnB1c2godGhpcy5nZXREYXRhQnlWYWx1ZSh2YWx1ZSkpO1xuICAgICAgICAgICAgICAgICAgICB2YXIgZXZlbnRBcmdzID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgbmV3RGF0YTogZGF0YVxuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnRyaWdnZXIoJ2N1c3RvbVZhbHVlU2VsZWN0aW9uJywgZXZlbnRBcmdzKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdGhpcy5yZW1vdGVDdXN0b21WYWx1ZSA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIHRoaXMuYWRkVmFsdWUodmFsdWUsIHRleHQsIGUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpcy5yZW1vdmVWYWx1ZSh2YWx1ZSwgZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIE11bHRpU2VsZWN0LnByb3RvdHlwZS5yZW1vdmVMaXN0U2VsZWN0aW9uID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIGNsYXNzTmFtZSA9IHRoaXMuaGlkZVNlbGVjdGVkSXRlbSA/XG4gICAgICAgICAgICAgICAgSElERV9MSVNUIDpcbiAgICAgICAgICAgICAgICBkcm9wX2Rvd25fYmFzZV8xLmRyb3BEb3duQmFzZUNsYXNzZXMuc2VsZWN0ZWQ7XG4gICAgICAgICAgICB2YXIgc2VsZWN0ZWRJdGVtcyA9IHRoaXMubGlzdC5xdWVyeVNlbGVjdG9yQWxsKCcuJyArIGNsYXNzTmFtZSk7XG4gICAgICAgICAgICB2YXIgdGVtcCA9IHNlbGVjdGVkSXRlbXMubGVuZ3RoO1xuICAgICAgICAgICAgaWYgKHNlbGVjdGVkSXRlbXMgJiYgc2VsZWN0ZWRJdGVtcy5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICBlajJfYmFzZV81LnJlbW92ZUNsYXNzKHNlbGVjdGVkSXRlbXMsIGNsYXNzTmFtZSk7XG4gICAgICAgICAgICAgICAgd2hpbGUgKHRlbXAgPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgIHNlbGVjdGVkSXRlbXNbdGVtcCAtIDFdLnNldEF0dHJpYnV0ZSgnYXJpYS1zZWxlY3RlZCcsICdmYWxzZScpO1xuICAgICAgICAgICAgICAgICAgICB0ZW1wLS07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICA7XG4gICAgICAgIE11bHRpU2VsZWN0LnByb3RvdHlwZS5yZW1vdmVIb3ZlciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciBob3ZlcmVkSXRlbSA9IHRoaXMubGlzdC5xdWVyeVNlbGVjdG9yQWxsKCcuJyArIGRyb3BfZG93bl9iYXNlXzEuZHJvcERvd25CYXNlQ2xhc3Nlcy5ob3Zlcik7XG4gICAgICAgICAgICBpZiAoaG92ZXJlZEl0ZW0gJiYgaG92ZXJlZEl0ZW0ubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgZWoyX2Jhc2VfNS5yZW1vdmVDbGFzcyhob3ZlcmVkSXRlbSwgZHJvcF9kb3duX2Jhc2VfMS5kcm9wRG93bkJhc2VDbGFzc2VzLmhvdmVyKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgO1xuICAgICAgICBNdWx0aVNlbGVjdC5wcm90b3R5cGUucmVtb3ZlRm9jdXMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgaG92ZXJlZEl0ZW0gPSB0aGlzLmxpc3QucXVlcnlTZWxlY3RvckFsbCgnLicgKyBkcm9wX2Rvd25fYmFzZV8xLmRyb3BEb3duQmFzZUNsYXNzZXMuZm9jdXMpO1xuICAgICAgICAgICAgdmFyIG1haW5saXN0ID0gdGhpcy5tYWluTGlzdC5xdWVyeVNlbGVjdG9yQWxsKCcuJyArIGRyb3BfZG93bl9iYXNlXzEuZHJvcERvd25CYXNlQ2xhc3Nlcy5mb2N1cyk7XG4gICAgICAgICAgICBpZiAoaG92ZXJlZEl0ZW0gJiYgaG92ZXJlZEl0ZW0ubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgZWoyX2Jhc2VfNS5yZW1vdmVDbGFzcyhob3ZlcmVkSXRlbSwgZHJvcF9kb3duX2Jhc2VfMS5kcm9wRG93bkJhc2VDbGFzc2VzLmZvY3VzKTtcbiAgICAgICAgICAgICAgICBlajJfYmFzZV81LnJlbW92ZUNsYXNzKG1haW5saXN0LCBkcm9wX2Rvd25fYmFzZV8xLmRyb3BEb3duQmFzZUNsYXNzZXMuZm9jdXMpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICA7XG4gICAgICAgIE11bHRpU2VsZWN0LnByb3RvdHlwZS5hZGRMaXN0SG92ZXIgPSBmdW5jdGlvbiAobGkpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLmVuYWJsZWQgJiYgdGhpcy5pc1ZhbGlkTEkobGkpKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5yZW1vdmVIb3ZlcigpO1xuICAgICAgICAgICAgICAgIGVqMl9iYXNlXzUuYWRkQ2xhc3MoW2xpXSwgZHJvcF9kb3duX2Jhc2VfMS5kcm9wRG93bkJhc2VDbGFzc2VzLmhvdmVyKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgO1xuICAgICAgICBNdWx0aVNlbGVjdC5wcm90b3R5cGUuYWRkTGlzdEZvY3VzID0gZnVuY3Rpb24gKGVsZW1lbnQpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLmVuYWJsZWQgJiYgdGhpcy5pc1ZhbGlkTEkoZWxlbWVudCkpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnJlbW92ZUZvY3VzKCk7XG4gICAgICAgICAgICAgICAgZWoyX2Jhc2VfNS5hZGRDbGFzcyhbZWxlbWVudF0sIGRyb3BfZG93bl9iYXNlXzEuZHJvcERvd25CYXNlQ2xhc3Nlcy5mb2N1cyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIE11bHRpU2VsZWN0LnByb3RvdHlwZS5hZGRMaXN0U2VsZWN0aW9uID0gZnVuY3Rpb24gKGVsZW1lbnQpIHtcbiAgICAgICAgICAgIHZhciBjbGFzc05hbWUgPSB0aGlzLmhpZGVTZWxlY3RlZEl0ZW0gP1xuICAgICAgICAgICAgICAgIEhJREVfTElTVCA6XG4gICAgICAgICAgICAgICAgZHJvcF9kb3duX2Jhc2VfMS5kcm9wRG93bkJhc2VDbGFzc2VzLnNlbGVjdGVkO1xuICAgICAgICAgICAgaWYgKHRoaXMuZW5hYmxlZCAmJiB0aGlzLmlzVmFsaWRMSShlbGVtZW50KSAmJiAhZWxlbWVudC5jbGFzc0xpc3QuY29udGFpbnMoZHJvcF9kb3duX2Jhc2VfMS5kcm9wRG93bkJhc2VDbGFzc2VzLmhvdmVyKSkge1xuICAgICAgICAgICAgICAgIGVqMl9iYXNlXzUuYWRkQ2xhc3MoW2VsZW1lbnRdLCBjbGFzc05hbWUpO1xuICAgICAgICAgICAgICAgIHRoaXMudXBkYXRlTWFpbkxpc3QoZmFsc2UsIGVsZW1lbnQuZ2V0QXR0cmlidXRlKCdkYXRhLXZhbHVlJykpO1xuICAgICAgICAgICAgICAgIGVsZW1lbnQuc2V0QXR0cmlidXRlKCdhcmlhLXNlbGVjdGVkJywgJ3RydWUnKTtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5jaGlwQ29sbGVjdGlvbldyYXBwZXIgIT09IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5yZW1vdmVDaGlwU2VsZWN0aW9uKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVqMl9iYXNlXzEuYXR0cmlidXRlcyh0aGlzLmlucHV0RWxlbWVudCwgeyAnYXJpYS1hY3RpdmVkZXNjZW5kYW50JzogZWxlbWVudC5pZCB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgTXVsdGlTZWxlY3QucHJvdG90eXBlLnVwZGF0ZURlbGltZXRlciA9IGZ1bmN0aW9uIChldmUpIHtcbiAgICAgICAgICAgIHRoaXMudXBkYXRlRGF0YSgpO1xuICAgICAgICB9O1xuICAgICAgICBNdWx0aVNlbGVjdC5wcm90b3R5cGUub25Nb3VzZUNsaWNrID0gZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgIHRoaXMuc2Nyb2xsRm9jdXNTdGF0dXMgPSBmYWxzZTtcbiAgICAgICAgICAgIHZhciB0YXJnZXQgPSBlLnRhcmdldDtcbiAgICAgICAgICAgIHZhciBsaSA9IGVqMl9iYXNlXzUuY2xvc2VzdCh0YXJnZXQsICcuJyArIGRyb3BfZG93bl9iYXNlXzEuZHJvcERvd25CYXNlQ2xhc3Nlcy5saSk7XG4gICAgICAgICAgICBpZiAodGhpcy5pc1ZhbGlkTEkobGkpKSB7XG4gICAgICAgICAgICAgICAgdmFyIGxpbWl0ID0gdGhpcy52YWx1ZSAmJiB0aGlzLnZhbHVlLmxlbmd0aCA/IHRoaXMudmFsdWUubGVuZ3RoIDogMDtcbiAgICAgICAgICAgICAgICBpZiAobGltaXQgPCB0aGlzLm1heGltdW1TZWxlY3Rpb25MZW5ndGgpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy51cGRhdGVMaXN0U2VsZWN0aW9uKGxpLCBlKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5hZGRMaXN0Rm9jdXMobGkpO1xuICAgICAgICAgICAgICAgICAgICBpZiAoKHRoaXMuYWxsb3dDdXN0b21WYWx1ZSB8fCB0aGlzLmFsbG93RmlsdGVyaW5nKSAmJiB0aGlzLm1haW5MaXN0ICYmIHRoaXMubGlzdERhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZm9jdXNBdExhc3RMaXN0SXRlbShsaS5nZXRBdHRyaWJ1dGUoJ2RhdGEtdmFsdWUnKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnJlZnJlc2hTZWxlY3Rpb24oKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubWFrZVRleHRCb3hFbXB0eSgpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRoaXMudXBkYXRlRGVsaW1ldGVyKGUpO1xuICAgICAgICAgICAgICAgIHRoaXMucmVmcmVzaFBvcHVwKCk7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuaGlkZVNlbGVjdGVkSXRlbSkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmZvY3VzQXRGaXJzdExpc3RJdGVtKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmICh0aGlzLmNsb3NlUG9wdXBPblNlbGVjdCkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmhpZGVQb3B1cCgpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLm1ha2VUZXh0Qm94RW1wdHkoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdmFyIHZhbHVlID0gdGhpcy5nZXRGb3JtYXR0ZWRWYWx1ZShsaS5nZXRBdHRyaWJ1dGUoJ2RhdGEtdmFsdWUnKSk7XG4gICAgICAgICAgICAgICAgdGhpcy5kaXNwYXRjaFNlbGVjdCh2YWx1ZSwgZSwgbGksIChsaS5nZXRBdHRyaWJ1dGUoJ2FyaWEtc2VsZWN0ZWQnKSA9PT0gJ3RydWUnID8gZmFsc2UgOiB0cnVlKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLnJlZnJlc2hQbGFjZUhvbGRlcigpO1xuICAgICAgICB9O1xuICAgICAgICBNdWx0aVNlbGVjdC5wcm90b3R5cGUub25Nb3VzZU92ZXIgPSBmdW5jdGlvbiAoZSkge1xuICAgICAgICAgICAgdmFyIGN1cnJlbnRMaSA9IGVqMl9iYXNlXzUuY2xvc2VzdChlLnRhcmdldCwgJy4nICsgZHJvcF9kb3duX2Jhc2VfMS5kcm9wRG93bkJhc2VDbGFzc2VzLmxpKTtcbiAgICAgICAgICAgIHRoaXMuYWRkTGlzdEhvdmVyKGN1cnJlbnRMaSk7XG4gICAgICAgIH07XG4gICAgICAgIE11bHRpU2VsZWN0LnByb3RvdHlwZS5vbk1vdXNlTGVhdmUgPSBmdW5jdGlvbiAoZSkge1xuICAgICAgICAgICAgdGhpcy5yZW1vdmVIb3ZlcigpO1xuICAgICAgICB9O1xuICAgICAgICBNdWx0aVNlbGVjdC5wcm90b3R5cGUub25MaXN0TW91c2VEb3duID0gZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgIHRoaXMuc2Nyb2xsRm9jdXNTdGF0dXMgPSB0cnVlO1xuICAgICAgICB9O1xuICAgICAgICBNdWx0aVNlbGVjdC5wcm90b3R5cGUud2lyZUxpc3RFdmVudHMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBlajJfYmFzZV8zLkV2ZW50SGFuZGxlci5hZGQodGhpcy5saXN0LCAnbW91c2Vkb3duJywgdGhpcy5vbkxpc3RNb3VzZURvd24sIHRoaXMpO1xuICAgICAgICAgICAgZWoyX2Jhc2VfMy5FdmVudEhhbmRsZXIuYWRkKHRoaXMubGlzdCwgJ21vdXNldXAnLCB0aGlzLm9uTW91c2VDbGljaywgdGhpcyk7XG4gICAgICAgICAgICBlajJfYmFzZV8zLkV2ZW50SGFuZGxlci5hZGQodGhpcy5saXN0LCAnbW91c2VvdmVyJywgdGhpcy5vbk1vdXNlT3ZlciwgdGhpcyk7XG4gICAgICAgICAgICBlajJfYmFzZV8zLkV2ZW50SGFuZGxlci5hZGQodGhpcy5saXN0LCAnbW91c2VvdXQnLCB0aGlzLm9uTW91c2VMZWF2ZSwgdGhpcyk7XG4gICAgICAgIH07XG4gICAgICAgIDtcbiAgICAgICAgTXVsdGlTZWxlY3QucHJvdG90eXBlLnVud2lyZUxpc3RFdmVudHMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5saXN0KSB7XG4gICAgICAgICAgICAgICAgZWoyX2Jhc2VfMy5FdmVudEhhbmRsZXIucmVtb3ZlKHRoaXMubGlzdCwgJ21vdXNlZG93bicsIHRoaXMub25MaXN0TW91c2VEb3duKTtcbiAgICAgICAgICAgICAgICBlajJfYmFzZV8zLkV2ZW50SGFuZGxlci5yZW1vdmUodGhpcy5saXN0LCAnbW91c2V1cCcsIHRoaXMub25Nb3VzZUNsaWNrKTtcbiAgICAgICAgICAgICAgICBlajJfYmFzZV8zLkV2ZW50SGFuZGxlci5yZW1vdmUodGhpcy5saXN0LCAnbW91c2VvdmVyJywgdGhpcy5vbk1vdXNlT3Zlcik7XG4gICAgICAgICAgICAgICAgZWoyX2Jhc2VfMy5FdmVudEhhbmRsZXIucmVtb3ZlKHRoaXMubGlzdCwgJ21vdXNlb3V0JywgdGhpcy5vbk1vdXNlTGVhdmUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICA7XG4gICAgICAgIE11bHRpU2VsZWN0LnByb3RvdHlwZS5oaWRlT3ZlckFsbENsZWFyID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgaWYgKCF0aGlzLnZhbHVlIHx8ICF0aGlzLnZhbHVlLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgIHRoaXMub3ZlckFsbENsZWFyLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIE11bHRpU2VsZWN0LnByb3RvdHlwZS5zaG93T3ZlckFsbENsZWFyID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgaWYgKHRoaXMudmFsdWUgJiYgdGhpcy52YWx1ZS5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICB0aGlzLm92ZXJBbGxDbGVhci5zdHlsZS5kaXNwbGF5ID0gJyc7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIE11bHRpU2VsZWN0LnByb3RvdHlwZS5zaG93U3Bpbm5lciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGlmIChlajJfYmFzZV82LmlzTnVsbE9yVW5kZWZpbmVkKHRoaXMuc3Bpbm5lckVsZW1lbnQpKSB7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMub3ZlckFsbENsZWFyLnN0eWxlLmRpc3BsYXkgIT09ICdub25lJykge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnNwaW5uZXJFbGVtZW50ID0gdGhpcy5vdmVyQWxsQ2xlYXI7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnNwaW5uZXJFbGVtZW50ID0gZWoyX2Jhc2VfNS5jcmVhdGVFbGVtZW50KCdzcGFuJywgeyBjbGFzc05hbWU6IENMT1NFSUNPTl9DTEFTUyArICcgJyArIFNQSU5ORVJfQ0xBU1MgfSk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY29tcG9uZW50V3JhcHBlci5hcHBlbmRDaGlsZCh0aGlzLnNwaW5uZXJFbGVtZW50KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWoyX2Jhc2VfNS5hZGRDbGFzcyhbdGhpcy5zcGlubmVyRWxlbWVudF0sIERJU0FCTEVfSUNPTik7XG4gICAgICAgICAgICAgICAgZWoyX3BvcHVwc18xLmNyZWF0ZVNwaW5uZXIoe1xuICAgICAgICAgICAgICAgICAgICB0YXJnZXQ6IHRoaXMuc3Bpbm5lckVsZW1lbnQsXG4gICAgICAgICAgICAgICAgICAgIHdpZHRoOiBkcm9wX2Rvd25fYmFzZV8xLlNQSU5ORVJfU0laRVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIGVqMl9wb3B1cHNfMS5zaG93U3Bpbm5lcih0aGlzLnNwaW5uZXJFbGVtZW50KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgTXVsdGlTZWxlY3QucHJvdG90eXBlLmhpZGVTcGlubmVyID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgaWYgKCFlajJfYmFzZV82LmlzTnVsbE9yVW5kZWZpbmVkKHRoaXMuc3Bpbm5lckVsZW1lbnQpKSB7XG4gICAgICAgICAgICAgICAgZWoyX3BvcHVwc18xLmhpZGVTcGlubmVyKHRoaXMuc3Bpbm5lckVsZW1lbnQpO1xuICAgICAgICAgICAgICAgIGVqMl9iYXNlXzUucmVtb3ZlQ2xhc3MoW3RoaXMuc3Bpbm5lckVsZW1lbnRdLCBESVNBQkxFX0lDT04pO1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLnNwaW5uZXJFbGVtZW50LmNsYXNzTGlzdC5jb250YWlucyhTUElOTkVSX0NMQVNTKSkge1xuICAgICAgICAgICAgICAgICAgICBlajJfYmFzZV81LmRldGFjaCh0aGlzLnNwaW5uZXJFbGVtZW50KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc3Bpbm5lckVsZW1lbnQuaW5uZXJIVE1MID0gJyc7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRoaXMuc3Bpbm5lckVsZW1lbnQgPSBudWxsO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICBNdWx0aVNlbGVjdC5wcm90b3R5cGUudXBkYXRlRGVsaW1WaWV3ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgaWYgKHRoaXMuZGVsaW1pdGVyV3JhcHBlcikge1xuICAgICAgICAgICAgICAgIHRoaXMuaGlkZURlbGltV3JhcHBlcigpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHRoaXMuY2hpcENvbGxlY3Rpb25XcmFwcGVyKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5jaGlwQ29sbGVjdGlvbldyYXBwZXIuc3R5bGUuZGlzcGxheSA9ICdub25lJztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMudmlld1dyYXBwZXIuc3R5bGUuZGlzcGxheSA9ICcnO1xuICAgICAgICAgICAgaWYgKHRoaXMudmFsdWUgJiYgdGhpcy52YWx1ZS5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICB2YXIgZGF0YSA9ICcnO1xuICAgICAgICAgICAgICAgIHZhciB0ZW1wID0gdm9pZCAwO1xuICAgICAgICAgICAgICAgIHZhciB0ZW1wRGF0YSA9IHZvaWQgMDtcbiAgICAgICAgICAgICAgICB2YXIgdGVtcEluZGV4ID0gMTtcbiAgICAgICAgICAgICAgICB2YXIgd3JhcHBlcmxlbmcgPSB2b2lkIDA7XG4gICAgICAgICAgICAgICAgdmFyIHJlbWFpbmluZyA9IHZvaWQgMDtcbiAgICAgICAgICAgICAgICB0aGlzLnZpZXdXcmFwcGVyLmlubmVySFRNTCA9ICcnO1xuICAgICAgICAgICAgICAgIHZhciBsMTBuTG9jYWxlID0ge1xuICAgICAgICAgICAgICAgICAgICBub1JlY29yZHNUZW1wbGF0ZTogJ05vIFJlY29yZHMgRm91bmQnLFxuICAgICAgICAgICAgICAgICAgICBhY3Rpb25GYWlsdXJlVGVtcGxhdGU6ICdUaGUgUmVxdWVzdCBGYWlsZWQnLFxuICAgICAgICAgICAgICAgICAgICBvdmVyZmxvd0NvdW50VGVtcGxhdGU6ICcrJHtjb3VudH0gbW9yZS4uJ1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgdmFyIGwxMG4gPSBuZXcgZWoyX2Jhc2VfMy5MMTBuKCdkcm9wZG93bnMnLCBsMTBuTG9jYWxlLCB0aGlzLmxvY2FsZSk7XG4gICAgICAgICAgICAgICAgdmFyIHJlbWFpbkNvbnRlbnQgPSBsMTBuLmdldENvbnN0YW50KCdvdmVyZmxvd0NvdW50VGVtcGxhdGUnKTtcbiAgICAgICAgICAgICAgICB2YXIgcmFtaW5FbGVtZW50ID0gZWoyX2Jhc2VfNS5jcmVhdGVFbGVtZW50KCdzcGFuJywge1xuICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU6IFJFTUFJTl9XUkFQUEVSXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgdmFyIGNvbXBpbGVkU3RyaW5nID0gZWoyX2Jhc2VfMy5jb21waWxlKHJlbWFpbkNvbnRlbnQpO1xuICAgICAgICAgICAgICAgIHJhbWluRWxlbWVudC5hcHBlbmRDaGlsZChjb21waWxlZFN0cmluZyh7ICdjb3VudCc6IHRoaXMudmFsdWUubGVuZ3RoIH0pWzBdKTtcbiAgICAgICAgICAgICAgICB0aGlzLnZpZXdXcmFwcGVyLmFwcGVuZENoaWxkKHJhbWluRWxlbWVudCk7XG4gICAgICAgICAgICAgICAgdmFyIHJlbWFpblNpemUgPSByYW1pbkVsZW1lbnQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkud2lkdGg7XG4gICAgICAgICAgICAgICAgZWoyX2Jhc2VfNS5yZW1vdmUocmFtaW5FbGVtZW50KTtcbiAgICAgICAgICAgICAgICB0aGlzLnZpZXdXcmFwcGVyLmlubmVySFRNTCA9ICcnO1xuICAgICAgICAgICAgICAgIHZhciBpbnB1dGxlbmcgPSB0aGlzLnNlYXJjaFdyYXBwZXIuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkud2lkdGg7XG4gICAgICAgICAgICAgICAgdmFyIG92ZXJBbGxDb250YWluZXIgPSBwYXJzZUludCh3aW5kb3cuZ2V0Q29tcHV0ZWRTdHlsZSh0aGlzLmNvbXBvbmVudFdyYXBwZXIpLndpZHRoLCAxMCkgLVxuICAgICAgICAgICAgICAgICAgICBwYXJzZUludCh3aW5kb3cuZ2V0Q29tcHV0ZWRTdHlsZSh0aGlzLmNvbXBvbmVudFdyYXBwZXIpLnBhZGRpbmdMZWZ0LCAxMCkgLVxuICAgICAgICAgICAgICAgICAgICBwYXJzZUludCh3aW5kb3cuZ2V0Q29tcHV0ZWRTdHlsZSh0aGlzLmNvbXBvbmVudFdyYXBwZXIpLnBhZGRpbmdSaWdodCwgMTApO1xuICAgICAgICAgICAgICAgIGZvciAodmFyIGluZGV4ID0gMDsgdGhpcy52YWx1ZVtpbmRleF07IGluZGV4KyspIHtcbiAgICAgICAgICAgICAgICAgICAgZGF0YSArPSAoaW5kZXggPT09IDApID8gJycgOiB0aGlzLmRlbGltaXRlckNoYXIgKyAnICc7XG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLm1haW5EYXRhICYmIHRoaXMubWFpbkRhdGEubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0ZW1wID0gdGhpcy5nZXRUZXh0QnlWYWx1ZSh0aGlzLnZhbHVlW2luZGV4XSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0ZW1wID0gdGhpcy52YWx1ZVtpbmRleF07XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZGF0YSArPSB0ZW1wO1xuICAgICAgICAgICAgICAgICAgICB0ZW1wID0gdGhpcy52aWV3V3JhcHBlci5pbm5lckhUTUw7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMudmlld1dyYXBwZXIuaW5uZXJIVE1MID0gZGF0YTtcbiAgICAgICAgICAgICAgICAgICAgd3JhcHBlcmxlbmcgPSB0aGlzLnZpZXdXcmFwcGVyLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLndpZHRoO1xuICAgICAgICAgICAgICAgICAgICBpZiAoKHdyYXBwZXJsZW5nKSA+IG92ZXJBbGxDb250YWluZXIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0ZW1wRGF0YSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGVtcCA9IHRlbXBEYXRhO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluZGV4ID0gdGVtcEluZGV4ICsgMTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMudmlld1dyYXBwZXIuaW5uZXJIVE1MID0gdGVtcDtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlbWFpbmluZyA9IHRoaXMudmFsdWUubGVuZ3RoIC0gaW5kZXg7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbHNlIGlmICgod3JhcHBlcmxlbmcgKyByZW1haW5TaXplKSA8PSBvdmVyQWxsQ29udGFpbmVyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0ZW1wRGF0YSA9IGRhdGE7XG4gICAgICAgICAgICAgICAgICAgICAgICB0ZW1wSW5kZXggPSBpbmRleDtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbHNlIGlmIChpbmRleCA9PT0gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGVtcERhdGEgPSAnJztcbiAgICAgICAgICAgICAgICAgICAgICAgIHRlbXBJbmRleCA9IC0xO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChyZW1haW5pbmcgPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgIHJhbWluRWxlbWVudC5pbm5lckhUTUwgPSAnJztcbiAgICAgICAgICAgICAgICAgICAgcmFtaW5FbGVtZW50LmFwcGVuZENoaWxkKGNvbXBpbGVkU3RyaW5nKHsgJ2NvdW50JzogcmVtYWluaW5nIH0pWzBdKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy52aWV3V3JhcHBlci5hcHBlbmRDaGlsZChyYW1pbkVsZW1lbnQpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHRoaXMudmlld1dyYXBwZXIuaW5uZXJIVE1MID0gJyc7XG4gICAgICAgICAgICAgICAgdGhpcy52aWV3V3JhcHBlci5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICBNdWx0aVNlbGVjdC5wcm90b3R5cGUudW5XaXJlRXZlbnQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBlajJfYmFzZV8zLkV2ZW50SGFuZGxlci5yZW1vdmUodGhpcy5jb21wb25lbnRXcmFwcGVyLCAnbW91c2Vkb3duJywgdGhpcy53cmFwcGVyQ2xpY2spO1xuICAgICAgICAgICAgZWoyX2Jhc2VfMy5FdmVudEhhbmRsZXIucmVtb3ZlKHdpbmRvdywgJ3Jlc2l6ZScsIHRoaXMud2luZG93UmVzaXplKTtcbiAgICAgICAgICAgIGVqMl9iYXNlXzMuRXZlbnRIYW5kbGVyLnJlbW92ZSh0aGlzLmlucHV0RWxlbWVudCwgJ2ZvY3VzJywgdGhpcy5mb2N1c0luKTtcbiAgICAgICAgICAgIGVqMl9iYXNlXzMuRXZlbnRIYW5kbGVyLnJlbW92ZSh0aGlzLmlucHV0RWxlbWVudCwgJ2tleWRvd24nLCB0aGlzLm9uS2V5RG93bik7XG4gICAgICAgICAgICBlajJfYmFzZV8zLkV2ZW50SGFuZGxlci5yZW1vdmUodGhpcy5pbnB1dEVsZW1lbnQsICdpbnB1dCcsIHRoaXMub25JbnB1dCk7XG4gICAgICAgICAgICBlajJfYmFzZV8zLkV2ZW50SGFuZGxlci5yZW1vdmUodGhpcy5pbnB1dEVsZW1lbnQsICdrZXl1cCcsIHRoaXMuS2V5VXApO1xuICAgICAgICAgICAgZWoyX2Jhc2VfMy5FdmVudEhhbmRsZXIucmVtb3ZlKHRoaXMuaW5wdXRFbGVtZW50LCAnYmx1cicsIHRoaXMub25CbHVyKTtcbiAgICAgICAgICAgIGVqMl9iYXNlXzMuRXZlbnRIYW5kbGVyLnJlbW92ZSh0aGlzLmNvbXBvbmVudFdyYXBwZXIsICdtb3VzZW1vdmUnLCB0aGlzLm1vdXNlSW4pO1xuICAgICAgICAgICAgZWoyX2Jhc2VfMy5FdmVudEhhbmRsZXIucmVtb3ZlKHRoaXMuY29tcG9uZW50V3JhcHBlciwgJ21vdXNlb3V0JywgdGhpcy5tb3VzZU91dCk7XG4gICAgICAgICAgICBlajJfYmFzZV8zLkV2ZW50SGFuZGxlci5yZW1vdmUodGhpcy5vdmVyQWxsQ2xlYXIsICdtb3VzZWRvd24nLCB0aGlzLkNsZWFyQWxsKTtcbiAgICAgICAgfTtcbiAgICAgICAgTXVsdGlTZWxlY3QucHJvdG90eXBlLnNlbGVjdEFsbEl0ZW0gPSBmdW5jdGlvbiAoc3RhdGUpIHtcbiAgICAgICAgICAgIHZhciBsaTtcbiAgICAgICAgICAgIGxpID0gdGhpcy5saXN0LnF1ZXJ5U2VsZWN0b3JBbGwoc3RhdGUgP1xuICAgICAgICAgICAgICAgICdsaVthcmlhLXNlbGVjdGVkPVwiZmFsc2VcIl0nIDpcbiAgICAgICAgICAgICAgICAnbGlbYXJpYS1zZWxlY3RlZD1cInRydWVcIl0nKTtcbiAgICAgICAgICAgIHZhciBsZW5ndGggPSBsaS5sZW5ndGg7XG4gICAgICAgICAgICBpZiAobGkgJiYgbGkubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgd2hpbGUgKGxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy51cGRhdGVMaXN0U2VsZWN0aW9uKGxpW2xlbmd0aCAtIDFdLCBudWxsKTtcbiAgICAgICAgICAgICAgICAgICAgbGVuZ3RoLS07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHRoaXMubW9kZSAhPT0gJ2JveCcgJiYgIXRoaXMuaXNQb3B1cE9wZW4oKSkge1xuICAgICAgICAgICAgICAgIHRoaXMudXBkYXRlRGVsaW1WaWV3KCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aGlzLnNlYXJjaFdyYXBwZXIuY2xhc3NMaXN0LnJlbW92ZShaRVJPX1NJWkUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy51cGRhdGVEYXRhKCk7XG4gICAgICAgICAgICB0aGlzLnJlZnJlc2hQbGFjZUhvbGRlcigpO1xuICAgICAgICB9O1xuICAgICAgICBNdWx0aVNlbGVjdC5wcm90b3R5cGUuZ2V0UGVyc2lzdERhdGEgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5hZGRPblBlcnNpc3QoWyd2YWx1ZSddKTtcbiAgICAgICAgfTtcbiAgICAgICAgO1xuICAgICAgICBNdWx0aVNlbGVjdC5wcm90b3R5cGUub25Qcm9wZXJ0eUNoYW5nZWQgPSBmdW5jdGlvbiAobmV3UHJvcCwgb2xkUHJvcCkge1xuICAgICAgICAgICAgZm9yICh2YXIgX2kgPSAwLCBfYSA9IE9iamVjdC5rZXlzKG5ld1Byb3ApOyBfaSA8IF9hLmxlbmd0aDsgX2krKykge1xuICAgICAgICAgICAgICAgIHZhciBwcm9wID0gX2FbX2ldO1xuICAgICAgICAgICAgICAgIHN3aXRjaCAocHJvcCkge1xuICAgICAgICAgICAgICAgICAgICBjYXNlICdodG1sQXR0cmlidXRlcyc6XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnVwZGF0ZUhUTUxBdHRyaWJ1dGUoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICBjYXNlICdzaG93Q2xlYXJCdXR0b24nOlxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy51cGRhdGVDbGVhckJ1dHRvbihuZXdQcm9wLnNob3dDbGVhckJ1dHRvbik7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAndmFsdWUnOlxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCF0aGlzLmlucHV0Rm9jdXMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmluaXRpYWxWYWx1ZVVwZGF0ZSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLm1vZGUgIT09ICdib3gnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMudXBkYXRlRGVsaW1WaWV3KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucmVmcmVzaElucHV0SGlnaHQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnJlZnJlc2hQbGFjZUhvbGRlcigpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMudXBkYXRlVmFsdWVTdGF0ZShudWxsLCB0aGlzLnZhbHVlLCBvbGRQcm9wLnZhbHVlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICBjYXNlICd3aWR0aCc6XG4gICAgICAgICAgICAgICAgICAgICAgICBlajJfYmFzZV81LnNldFN0eWxlQXR0cmlidXRlKHRoaXMub3ZlckFsbFdyYXBwZXIsIHsgJ3dpZHRoJzogZWoyX2Jhc2VfNi5mb3JtYXRVbml0KG5ld1Byb3Aud2lkdGgpIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wb3B1cE9iai5zZXRQcm9wZXJ0aWVzKHsgd2lkdGg6IHRoaXMuY2FsY1BvcHVwV2lkdGgoKSB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICBjYXNlICdwbGFjZWhvbGRlcic6XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnJlZnJlc2hQbGFjZUhvbGRlcigpO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgJ3F1ZXJ5JzpcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAnZGF0YVNvdXJjZSc6XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnJlc2V0TGlzdCh0aGlzLmRhdGFTb3VyY2UpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMudmFsdWUgJiYgdGhpcy52YWx1ZS5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnJlZnJlc2hTZWxlY3Rpb24oKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICBjYXNlICdjc3NDbGFzcyc6XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBvcHVwV3JhcHBlci5jbGFzc0xpc3QucmVtb3ZlKG9sZFByb3AuY3NzQ2xhc3MpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5vdmVyQWxsV3JhcHBlci5jbGFzc0xpc3QucmVtb3ZlKG9sZFByb3AuY3NzQ2xhc3MpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy51cGRhdGVDc3NDbGFzcygpO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgJ2VuYWJsZVJ0bCc6XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmVuYWJsZVJUTChuZXdQcm9wLmVuYWJsZVJ0bCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAncmVhZG9ubHknOlxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy51cGRhdGVSZWFkb25seShuZXdQcm9wLnJlYWRvbmx5KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuaGlkZVBvcHVwKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAnZW5hYmxlZCc6XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmhpZGVQb3B1cCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5lbmFibGUobmV3UHJvcC5lbmFibGVkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgTXVsdGlTZWxlY3QucHJvdG90eXBlLmhpZGVQb3B1cCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciBkZWxheSA9IDEwMDtcbiAgICAgICAgICAgIGlmICh0aGlzLmlzUG9wdXBPcGVuKCkpIHtcbiAgICAgICAgICAgICAgICB2YXIgYW5pbU1vZGVsID0ge1xuICAgICAgICAgICAgICAgICAgICBuYW1lOiAnRmFkZU91dCcsXG4gICAgICAgICAgICAgICAgICAgIGR1cmF0aW9uOiAxMDAsXG4gICAgICAgICAgICAgICAgICAgIGRlbGF5OiBkZWxheSA/IGRlbGF5IDogMFxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgdGhpcy5iZWZvcmVQb3B1cE9wZW4gPSBmYWxzZTtcbiAgICAgICAgICAgICAgICB0aGlzLnBvcHVwT2JqLmhpZGUobmV3IGVqMl9iYXNlXzQuQW5pbWF0aW9uKGFuaW1Nb2RlbCkpO1xuICAgICAgICAgICAgICAgIGVqMl9iYXNlXzEuYXR0cmlidXRlcyh0aGlzLmlucHV0RWxlbWVudCwgeyAnYXJpYS1leHBhbmRlZCc6ICdmYWxzZScgfSk7XG4gICAgICAgICAgICAgICAgdGhpcy5wb3B1cE9iai5oaWRlKCk7XG4gICAgICAgICAgICAgICAgdmFyIGV2ZW50QXJncyA9IHsgcG9wdXA6IHRoaXMucG9wdXBPYmogfTtcbiAgICAgICAgICAgICAgICB0aGlzLnRyaWdnZXIoJ2Nsb3NlJywgZXZlbnRBcmdzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgTXVsdGlTZWxlY3QucHJvdG90eXBlLnNob3dQb3B1cCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGlmICghdGhpcy51bEVsZW1lbnQpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmJlZm9yZVBvcHVwT3BlbiA9IHRydWU7XG4gICAgICAgICAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5yZW5kZXIuY2FsbCh0aGlzKTtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLm9uUG9wdXBTaG93bigpO1xuICAgICAgICB9O1xuICAgICAgICBNdWx0aVNlbGVjdC5wcm90b3R5cGUuc2VsZWN0QWxsID0gZnVuY3Rpb24gKHN0YXRlKSB7XG4gICAgICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICAgICAgaWYgKGVqMl9iYXNlXzYuaXNOdWxsT3JVbmRlZmluZWQodGhpcy5saXN0KSkge1xuICAgICAgICAgICAgICAgIHRoaXMuc2VsZWN0QWxsQWN0aW9uID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICBfdGhpcy5zZWxlY3RBbGxJdGVtKHN0YXRlKTtcbiAgICAgICAgICAgICAgICAgICAgX3RoaXMuc2VsZWN0QWxsQWN0aW9uID0gbnVsbDtcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIF9zdXBlci5wcm90b3R5cGUucmVuZGVyLmNhbGwodGhpcyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aGlzLnNlbGVjdEFsbEFjdGlvbiA9IG51bGw7XG4gICAgICAgICAgICAgICAgdGhpcy5zZWxlY3RBbGxJdGVtKHN0YXRlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgTXVsdGlTZWxlY3QucHJvdG90eXBlLmdldE1vZHVsZU5hbWUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gJ211bHRpc2VsZWN0JztcbiAgICAgICAgfTtcbiAgICAgICAgO1xuICAgICAgICBNdWx0aVNlbGVjdC5wcm90b3R5cGUucmVuZGVyID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgICAgIHRoaXMuaW5pdFN0YXR1cyA9IGZhbHNlO1xuICAgICAgICAgICAgdGhpcy5zZWFyY2hXcmFwcGVyID0gZWoyX2Jhc2VfNS5jcmVhdGVFbGVtZW50KCdzcGFuJywgeyBjbGFzc05hbWU6IFNFQVJDSEJPWF9XUkFQUEVSIH0pO1xuICAgICAgICAgICAgdGhpcy52aWV3V3JhcHBlciA9IGVqMl9iYXNlXzUuY3JlYXRlRWxlbWVudCgnc3BhbicsIHtcbiAgICAgICAgICAgICAgICBjbGFzc05hbWU6IERFTElNSVRFUl9WSUVXICsgJyAnICsgREVMSU1JVEVSX1dSQVBQRVIsXG4gICAgICAgICAgICAgICAgc3R5bGVzOiAnZGlzcGxheTpub25lOydcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgdGhpcy5vdmVyQWxsQ2xlYXIgPSBlajJfYmFzZV81LmNyZWF0ZUVsZW1lbnQoJ3NwYW4nLCB7IGNsYXNzTmFtZTogQ0xPU0VJQ09OX0NMQVNTLCBzdHlsZXM6ICdkaXNwbGF5Om5vbmU7JyB9KTtcbiAgICAgICAgICAgIHRoaXMuY29tcG9uZW50V3JhcHBlciA9IGVqMl9iYXNlXzUuY3JlYXRlRWxlbWVudCgnZGl2JywgeyBjbGFzc05hbWU6IEVMRU1FTlRfV1JBUFBFUiB9KTtcbiAgICAgICAgICAgIHRoaXMub3ZlckFsbFdyYXBwZXIgPSBlajJfYmFzZV81LmNyZWF0ZUVsZW1lbnQoJ2RpdicsIHsgY2xhc3NOYW1lOiBPVkVSX0FMTF9XUkFQUEVSIH0pO1xuICAgICAgICAgICAgaWYgKGVqMl9iYXNlXzQuQnJvd3Nlci5pc0RldmljZSkge1xuICAgICAgICAgICAgICAgIHRoaXMuY29tcG9uZW50V3JhcHBlci5jbGFzc0xpc3QuYWRkKEVMRU1FTlRfTU9CSUxFX1dSQVBQRVIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5vdmVyQWxsV3JhcHBlci5zdHlsZS53aWR0aCA9IGVqMl9iYXNlXzYuZm9ybWF0VW5pdCh0aGlzLndpZHRoKTtcbiAgICAgICAgICAgIHRoaXMub3ZlckFsbFdyYXBwZXIuYXBwZW5kQ2hpbGQodGhpcy5jb21wb25lbnRXcmFwcGVyKTtcbiAgICAgICAgICAgIHRoaXMucG9wdXBXcmFwcGVyID0gZWoyX2Jhc2VfNS5jcmVhdGVFbGVtZW50KCdkaXYnLCB7XG4gICAgICAgICAgICAgICAgaWQ6IHRoaXMuZWxlbWVudC5pZCArICdfcG9wdXAnLFxuICAgICAgICAgICAgICAgIGNsYXNzTmFtZTogUE9QVVBfV1JBUFBFUlxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBpZiAodGhpcy5tb2RlID09PSAnZGVsaW1pdGVyJykge1xuICAgICAgICAgICAgICAgIHRoaXMuZGVsaW1pdGVyV3JhcHBlciA9IGVqMl9iYXNlXzUuY3JlYXRlRWxlbWVudCgnc3BhbicsIHsgY2xhc3NOYW1lOiBERUxJTUlURVJfV1JBUFBFUiwgc3R5bGVzOiAnZGlzcGxheTpub25lJyB9KTtcbiAgICAgICAgICAgICAgICB0aGlzLmNvbXBvbmVudFdyYXBwZXIuYXBwZW5kQ2hpbGQodGhpcy5kZWxpbWl0ZXJXcmFwcGVyKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHRoaXMuY2hpcENvbGxlY3Rpb25XcmFwcGVyID0gZWoyX2Jhc2VfNS5jcmVhdGVFbGVtZW50KCdzcGFuJywge1xuICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU6IENISVBfV1JBUFBFUixcbiAgICAgICAgICAgICAgICAgICAgc3R5bGVzOiAnZGlzcGxheTpub25lJ1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHRoaXMuY29tcG9uZW50V3JhcHBlci5hcHBlbmRDaGlsZCh0aGlzLmNoaXBDb2xsZWN0aW9uV3JhcHBlcik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAodGhpcy5tb2RlICE9PSAnYm94Jykge1xuICAgICAgICAgICAgICAgIHRoaXMuY29tcG9uZW50V3JhcHBlci5hcHBlbmRDaGlsZCh0aGlzLnZpZXdXcmFwcGVyKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuY29tcG9uZW50V3JhcHBlci5hcHBlbmRDaGlsZCh0aGlzLnNlYXJjaFdyYXBwZXIpO1xuICAgICAgICAgICAgaWYgKHRoaXMuc2hvd0NsZWFyQnV0dG9uICYmICFlajJfYmFzZV80LkJyb3dzZXIuaXNEZXZpY2UpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmNvbXBvbmVudFdyYXBwZXIuYXBwZW5kQ2hpbGQodGhpcy5vdmVyQWxsQ2xlYXIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpcy5jb21wb25lbnRXcmFwcGVyLmNsYXNzTGlzdC5hZGQoQ0xPU0VfSUNPTl9ISURFKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuaW5wdXRFbGVtZW50ID0gZWoyX2Jhc2VfNS5jcmVhdGVFbGVtZW50KCdpbnB1dCcsIHtcbiAgICAgICAgICAgICAgICBjbGFzc05hbWU6IElOUFVUX0VMRU1FTlQsXG4gICAgICAgICAgICAgICAgYXR0cnM6IHtcbiAgICAgICAgICAgICAgICAgICAgc3BlbGxjaGVjazogJ2ZhbHNlJyxcbiAgICAgICAgICAgICAgICAgICAgdHlwZTogJ3RleHQnLFxuICAgICAgICAgICAgICAgICAgICBhdXRvY29tcGxldGU6ICdvZmYnLFxuICAgICAgICAgICAgICAgICAgICB0YWJpbmRleDogJzAnXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB0aGlzLnJlZnJlc2hQbGFjZUhvbGRlcigpO1xuICAgICAgICAgICAgaWYgKHRoaXMuZWxlbWVudC50YWdOYW1lICE9PSB0aGlzLmdldE5nRGlyZWN0aXZlKCkpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmVsZW1lbnQuc3R5bGUuZGlzcGxheSA9ICdub25lJztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh0aGlzLmVsZW1lbnQudGFnTmFtZSA9PT0gdGhpcy5nZXROZ0RpcmVjdGl2ZSgpKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5lbGVtZW50LmFwcGVuZENoaWxkKHRoaXMub3ZlckFsbFdyYXBwZXIpO1xuICAgICAgICAgICAgICAgIHRoaXMuc2VhcmNoV3JhcHBlci5hcHBlbmRDaGlsZCh0aGlzLmlucHV0RWxlbWVudCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aGlzLmVsZW1lbnQucGFyZW50RWxlbWVudC5pbnNlcnRCZWZvcmUodGhpcy5vdmVyQWxsV3JhcHBlciwgdGhpcy5lbGVtZW50KTtcbiAgICAgICAgICAgICAgICB0aGlzLnNlYXJjaFdyYXBwZXIuYXBwZW5kQ2hpbGQodGhpcy5pbnB1dEVsZW1lbnQpO1xuICAgICAgICAgICAgICAgIHRoaXMuc2VhcmNoV3JhcHBlci5hcHBlbmRDaGlsZCh0aGlzLmVsZW1lbnQpO1xuICAgICAgICAgICAgICAgIHRoaXMuZWxlbWVudC5yZW1vdmVBdHRyaWJ1dGUoJ3RhYmluZGV4Jyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgbmFtZSA9IHRoaXMuZWxlbWVudC5nZXRBdHRyaWJ1dGUoJ25hbWUnKSA/IHRoaXMuZWxlbWVudC5nZXRBdHRyaWJ1dGUoJ25hbWUnKSA6IHRoaXMuZWxlbWVudC5nZXRBdHRyaWJ1dGUoJ2lkJyk7XG4gICAgICAgICAgICB2YXIgaWQgPSB0aGlzLmVsZW1lbnQuZ2V0QXR0cmlidXRlKCdpZCcpID8gdGhpcy5lbGVtZW50LmdldEF0dHJpYnV0ZSgnaWQnKSA6IGVqMl9iYXNlXzYuZ2V0VW5pcXVlSUQoJ2VqMl9kcm9wZG93bmxpc3QnKTtcbiAgICAgICAgICAgIHRoaXMuZWxlbWVudC5pZCA9IGlkO1xuICAgICAgICAgICAgdGhpcy5lbGVtZW50LnN0eWxlLm9wYWNpdHkgPSAnJztcbiAgICAgICAgICAgIHRoaXMuaGlkZGVuRWxlbWVudCA9IGVqMl9iYXNlXzUuY3JlYXRlRWxlbWVudCgnc2VsZWN0Jywge1xuICAgICAgICAgICAgICAgIGF0dHJzOiB7ICduYW1lJzogbmFtZSwgJ2FyaWEtaGlkZGVuJzogJ3RydWUnLCAnbXVsdGlwbGUnOiAndHJ1ZScgfSwgc3R5bGVzOiAnZGlzcGxheTpub25lJ1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB0aGlzLmVsZW1lbnQucmVtb3ZlQXR0cmlidXRlKCduYW1lJyk7XG4gICAgICAgICAgICB0aGlzLnNlYXJjaFdyYXBwZXIuYXBwZW5kQ2hpbGQodGhpcy5oaWRkZW5FbGVtZW50KTtcbiAgICAgICAgICAgIHRoaXMuaGlkZU92ZXJBbGxDbGVhcigpO1xuICAgICAgICAgICAgdGhpcy53aXJlRXZlbnQoKTtcbiAgICAgICAgICAgIHRoaXMuZW5hYmxlKHRoaXMuZW5hYmxlZCk7XG4gICAgICAgICAgICB0aGlzLmVuYWJsZVJUTCh0aGlzLmVuYWJsZVJ0bCk7XG4gICAgICAgICAgICBpZiAoISh0aGlzLmRhdGFTb3VyY2UgaW5zdGFuY2VvZiBlajJfZGF0YV8xLkRhdGFNYW5hZ2VyKSkge1xuICAgICAgICAgICAgICAgIHRoaXMucmVuZGVyUG9wdXAoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh0aGlzLnZhbHVlICYmIHRoaXMudmFsdWUubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgaWYgKCEodGhpcy5kYXRhU291cmNlIGluc3RhbmNlb2YgZWoyX2RhdGFfMS5EYXRhTWFuYWdlcikpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5pbml0aWFsVmFsdWVVcGRhdGUoKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5pbml0aWFsVXBkYXRlKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnNldEluaXRpYWxWYWx1ZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzLmluaXRpYWxWYWx1ZVVwZGF0ZSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMuaW5pdGlhbFVwZGF0ZSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMuc2V0SW5pdGlhbFZhbHVlID0gbnVsbDtcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5yZW5kZXIuY2FsbCh0aGlzKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aGlzLmluaXRpYWxVcGRhdGUoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuaW5pdFN0YXR1cyA9IHRydWU7XG4gICAgICAgIH07XG4gICAgICAgIDtcbiAgICAgICAgTXVsdGlTZWxlY3QucHJvdG90eXBlLmluaXRpYWxVcGRhdGUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5tb2RlICE9PSAnYm94Jykge1xuICAgICAgICAgICAgICAgIHRoaXMudXBkYXRlRGVsaW1WaWV3KCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLnVwZGF0ZUNzc0NsYXNzKCk7XG4gICAgICAgICAgICB0aGlzLnVwZGF0ZUhUTUxBdHRyaWJ1dGUoKTtcbiAgICAgICAgICAgIHRoaXMudXBkYXRlUmVhZG9ubHkodGhpcy5yZWFkb25seSk7XG4gICAgICAgICAgICB0aGlzLnJlZnJlc2hJbnB1dEhpZ2h0KCk7XG4gICAgICAgIH07XG4gICAgICAgIE11bHRpU2VsZWN0LnByb3RvdHlwZS5kZXN0cm95ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgaWYgKHRoaXMucG9wdXBPYmopIHtcbiAgICAgICAgICAgICAgICB0aGlzLnBvcHVwT2JqLmhpZGUoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMudW53aXJlTGlzdEV2ZW50cygpO1xuICAgICAgICAgICAgdGhpcy51bldpcmVFdmVudCgpO1xuICAgICAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5kZXN0cm95LmNhbGwodGhpcyk7XG4gICAgICAgICAgICB2YXIgdGVtcCA9IFsncmVhZG9ubHknLCAnYXJpYS1kaXNhYmxlZCcsICdhcmlhLXBsYWNlaG9sZGVyJywgJ3BsYWNlaG9sZGVyJ107XG4gICAgICAgICAgICB2YXIgbGVuZ3RoID0gdGVtcC5sZW5ndGg7XG4gICAgICAgICAgICB3aGlsZSAobGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgIHRoaXMuaW5wdXRFbGVtZW50LnJlbW92ZUF0dHJpYnV0ZSh0ZW1wW2xlbmd0aCAtIDFdKTtcbiAgICAgICAgICAgICAgICBsZW5ndGgtLTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuZWxlbWVudC5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJztcbiAgICAgICAgICAgIGlmICh0aGlzLm92ZXJBbGxXcmFwcGVyLnBhcmVudEVsZW1lbnQpIHtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5vdmVyQWxsV3JhcHBlci5wYXJlbnRFbGVtZW50LnRhZ05hbWUgPT09IHRoaXMuZ2V0TmdEaXJlY3RpdmUoKSkge1xuICAgICAgICAgICAgICAgICAgICBlajJfYmFzZV81LnJlbW92ZSh0aGlzLm92ZXJBbGxXcmFwcGVyKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMub3ZlckFsbFdyYXBwZXIucGFyZW50RWxlbWVudC5pbnNlcnRCZWZvcmUodGhpcy5lbGVtZW50LCB0aGlzLm92ZXJBbGxXcmFwcGVyKTtcbiAgICAgICAgICAgICAgICAgICAgZWoyX2Jhc2VfNS5yZW1vdmUodGhpcy5vdmVyQWxsV3JhcHBlcik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICA7XG4gICAgICAgIHJldHVybiBNdWx0aVNlbGVjdDtcbiAgICB9KGRyb3BfZG93bl9iYXNlXzEuRHJvcERvd25CYXNlKSk7XG4gICAgX19kZWNvcmF0ZShbXG4gICAgICAgIGVqMl9iYXNlXzMuUHJvcGVydHkobnVsbClcbiAgICBdLCBNdWx0aVNlbGVjdC5wcm90b3R5cGUsIFwiY3NzQ2xhc3NcIiwgdm9pZCAwKTtcbiAgICBfX2RlY29yYXRlKFtcbiAgICAgICAgZWoyX2Jhc2VfMy5Qcm9wZXJ0eSgnMTAwJScpXG4gICAgXSwgTXVsdGlTZWxlY3QucHJvdG90eXBlLCBcIndpZHRoXCIsIHZvaWQgMCk7XG4gICAgX19kZWNvcmF0ZShbXG4gICAgICAgIGVqMl9iYXNlXzMuUHJvcGVydHkoJzMwMHB4JylcbiAgICBdLCBNdWx0aVNlbGVjdC5wcm90b3R5cGUsIFwicG9wdXBIZWlnaHRcIiwgdm9pZCAwKTtcbiAgICBfX2RlY29yYXRlKFtcbiAgICAgICAgZWoyX2Jhc2VfMy5Qcm9wZXJ0eSgnMTAwJScpXG4gICAgXSwgTXVsdGlTZWxlY3QucHJvdG90eXBlLCBcInBvcHVwV2lkdGhcIiwgdm9pZCAwKTtcbiAgICBfX2RlY29yYXRlKFtcbiAgICAgICAgZWoyX2Jhc2VfMy5Qcm9wZXJ0eShudWxsKVxuICAgIF0sIE11bHRpU2VsZWN0LnByb3RvdHlwZSwgXCJwbGFjZWhvbGRlclwiLCB2b2lkIDApO1xuICAgIF9fZGVjb3JhdGUoW1xuICAgICAgICBlajJfYmFzZV8zLlByb3BlcnR5KHt9KVxuICAgIF0sIE11bHRpU2VsZWN0LnByb3RvdHlwZSwgXCJodG1sQXR0cmlidXRlc1wiLCB2b2lkIDApO1xuICAgIF9fZGVjb3JhdGUoW1xuICAgICAgICBlajJfYmFzZV8zLlByb3BlcnR5KG51bGwpXG4gICAgXSwgTXVsdGlTZWxlY3QucHJvdG90eXBlLCBcInZhbHVlVGVtcGxhdGVcIiwgdm9pZCAwKTtcbiAgICBfX2RlY29yYXRlKFtcbiAgICAgICAgZWoyX2Jhc2VfMy5Qcm9wZXJ0eShudWxsKVxuICAgIF0sIE11bHRpU2VsZWN0LnByb3RvdHlwZSwgXCJoZWFkZXJUZW1wbGF0ZVwiLCB2b2lkIDApO1xuICAgIF9fZGVjb3JhdGUoW1xuICAgICAgICBlajJfYmFzZV8zLlByb3BlcnR5KG51bGwpXG4gICAgXSwgTXVsdGlTZWxlY3QucHJvdG90eXBlLCBcImZvb3RlclRlbXBsYXRlXCIsIHZvaWQgMCk7XG4gICAgX19kZWNvcmF0ZShbXG4gICAgICAgIGVqMl9iYXNlXzMuUHJvcGVydHkobnVsbClcbiAgICBdLCBNdWx0aVNlbGVjdC5wcm90b3R5cGUsIFwiaXRlbVRlbXBsYXRlXCIsIHZvaWQgMCk7XG4gICAgX19kZWNvcmF0ZShbXG4gICAgICAgIGVqMl9iYXNlXzMuUHJvcGVydHkoZmFsc2UpXG4gICAgXSwgTXVsdGlTZWxlY3QucHJvdG90eXBlLCBcImFsbG93RmlsdGVyaW5nXCIsIHZvaWQgMCk7XG4gICAgX19kZWNvcmF0ZShbXG4gICAgICAgIGVqMl9iYXNlXzMuUHJvcGVydHkoZmFsc2UpXG4gICAgXSwgTXVsdGlTZWxlY3QucHJvdG90eXBlLCBcImFsbG93Q3VzdG9tVmFsdWVcIiwgdm9pZCAwKTtcbiAgICBfX2RlY29yYXRlKFtcbiAgICAgICAgZWoyX2Jhc2VfMy5Qcm9wZXJ0eSh0cnVlKVxuICAgIF0sIE11bHRpU2VsZWN0LnByb3RvdHlwZSwgXCJzaG93Q2xlYXJCdXR0b25cIiwgdm9pZCAwKTtcbiAgICBfX2RlY29yYXRlKFtcbiAgICAgICAgZWoyX2Jhc2VfMy5Qcm9wZXJ0eSgxMDAwKVxuICAgIF0sIE11bHRpU2VsZWN0LnByb3RvdHlwZSwgXCJtYXhpbXVtU2VsZWN0aW9uTGVuZ3RoXCIsIHZvaWQgMCk7XG4gICAgX19kZWNvcmF0ZShbXG4gICAgICAgIGVqMl9iYXNlXzMuUHJvcGVydHkoZmFsc2UpXG4gICAgXSwgTXVsdGlTZWxlY3QucHJvdG90eXBlLCBcInJlYWRvbmx5XCIsIHZvaWQgMCk7XG4gICAgX19kZWNvcmF0ZShbXG4gICAgICAgIGVqMl9iYXNlXzMuUHJvcGVydHkobnVsbClcbiAgICBdLCBNdWx0aVNlbGVjdC5wcm90b3R5cGUsIFwidGV4dFwiLCB2b2lkIDApO1xuICAgIF9fZGVjb3JhdGUoW1xuICAgICAgICBlajJfYmFzZV8zLlByb3BlcnR5KG51bGwpXG4gICAgXSwgTXVsdGlTZWxlY3QucHJvdG90eXBlLCBcInZhbHVlXCIsIHZvaWQgMCk7XG4gICAgX19kZWNvcmF0ZShbXG4gICAgICAgIGVqMl9iYXNlXzMuUHJvcGVydHkoZmFsc2UpXG4gICAgXSwgTXVsdGlTZWxlY3QucHJvdG90eXBlLCBcImhpZGVTZWxlY3RlZEl0ZW1cIiwgdm9pZCAwKTtcbiAgICBfX2RlY29yYXRlKFtcbiAgICAgICAgZWoyX2Jhc2VfMy5Qcm9wZXJ0eSh0cnVlKVxuICAgIF0sIE11bHRpU2VsZWN0LnByb3RvdHlwZSwgXCJjbG9zZVBvcHVwT25TZWxlY3RcIiwgdm9pZCAwKTtcbiAgICBfX2RlY29yYXRlKFtcbiAgICAgICAgZWoyX2Jhc2VfMy5Qcm9wZXJ0eSgnZGVmYXVsdCcpXG4gICAgXSwgTXVsdGlTZWxlY3QucHJvdG90eXBlLCBcIm1vZGVcIiwgdm9pZCAwKTtcbiAgICBfX2RlY29yYXRlKFtcbiAgICAgICAgZWoyX2Jhc2VfMy5Qcm9wZXJ0eSgnLCcpXG4gICAgXSwgTXVsdGlTZWxlY3QucHJvdG90eXBlLCBcImRlbGltaXRlckNoYXJcIiwgdm9pZCAwKTtcbiAgICBfX2RlY29yYXRlKFtcbiAgICAgICAgZWoyX2Jhc2VfMy5Qcm9wZXJ0eSh0cnVlKVxuICAgIF0sIE11bHRpU2VsZWN0LnByb3RvdHlwZSwgXCJpZ25vcmVDYXNlXCIsIHZvaWQgMCk7XG4gICAgX19kZWNvcmF0ZShbXG4gICAgICAgIGVqMl9iYXNlXzMuRXZlbnQoKVxuICAgIF0sIE11bHRpU2VsZWN0LnByb3RvdHlwZSwgXCJjaGFuZ2VcIiwgdm9pZCAwKTtcbiAgICBfX2RlY29yYXRlKFtcbiAgICAgICAgZWoyX2Jhc2VfMy5FdmVudCgpXG4gICAgXSwgTXVsdGlTZWxlY3QucHJvdG90eXBlLCBcInJlbW92aW5nXCIsIHZvaWQgMCk7XG4gICAgX19kZWNvcmF0ZShbXG4gICAgICAgIGVqMl9iYXNlXzMuRXZlbnQoKVxuICAgIF0sIE11bHRpU2VsZWN0LnByb3RvdHlwZSwgXCJyZW1vdmVkXCIsIHZvaWQgMCk7XG4gICAgX19kZWNvcmF0ZShbXG4gICAgICAgIGVqMl9iYXNlXzMuRXZlbnQoKVxuICAgIF0sIE11bHRpU2VsZWN0LnByb3RvdHlwZSwgXCJvcGVuXCIsIHZvaWQgMCk7XG4gICAgX19kZWNvcmF0ZShbXG4gICAgICAgIGVqMl9iYXNlXzMuRXZlbnQoKVxuICAgIF0sIE11bHRpU2VsZWN0LnByb3RvdHlwZSwgXCJjbG9zZVwiLCB2b2lkIDApO1xuICAgIF9fZGVjb3JhdGUoW1xuICAgICAgICBlajJfYmFzZV8zLkV2ZW50KClcbiAgICBdLCBNdWx0aVNlbGVjdC5wcm90b3R5cGUsIFwiYmx1clwiLCB2b2lkIDApO1xuICAgIF9fZGVjb3JhdGUoW1xuICAgICAgICBlajJfYmFzZV8zLkV2ZW50KClcbiAgICBdLCBNdWx0aVNlbGVjdC5wcm90b3R5cGUsIFwiZm9jdXNcIiwgdm9pZCAwKTtcbiAgICBfX2RlY29yYXRlKFtcbiAgICAgICAgZWoyX2Jhc2VfMy5FdmVudCgpXG4gICAgXSwgTXVsdGlTZWxlY3QucHJvdG90eXBlLCBcImZpbHRlcmluZ1wiLCB2b2lkIDApO1xuICAgIF9fZGVjb3JhdGUoW1xuICAgICAgICBlajJfYmFzZV8zLkV2ZW50KClcbiAgICBdLCBNdWx0aVNlbGVjdC5wcm90b3R5cGUsIFwiY3VzdG9tVmFsdWVTZWxlY3Rpb25cIiwgdm9pZCAwKTtcbiAgICBNdWx0aVNlbGVjdCA9IF9fZGVjb3JhdGUoW1xuICAgICAgICBlajJfYmFzZV8yLk5vdGlmeVByb3BlcnR5Q2hhbmdlc1xuICAgIF0sIE11bHRpU2VsZWN0KTtcbiAgICBleHBvcnRzLk11bHRpU2VsZWN0ID0gTXVsdGlTZWxlY3Q7XG59KTtcblxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vc3JjL211bHRpLXNlbGVjdC9tdWx0aS1zZWxlY3QuanNcbi8vIG1vZHVsZSBpZCA9IDE4XG4vLyBtb2R1bGUgY2h1bmtzID0gMCJdLCJzb3VyY2VSb290IjoiIn0="]}